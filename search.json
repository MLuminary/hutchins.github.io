[{"title":"åŸºäº mpvue çš„åœ†å½¢è¿›åº¦æ¡ç»„ä»¶","url":"%2F2018%2F09%2F28%2F%E5%9F%BA%E4%BA%8Empvue%E7%9A%84%E5%9C%86%E5%BD%A2%E8%BF%9B%E5%BA%A6%E6%9D%A1%2F","content":"\n> è‡ªå·±æœ¬èº«æ˜¯ä¸€ä¸ªå°ç¨‹åºå°ç™½ï¼Œå‰å‡ å¤©åˆšå¼€å§‹å­¦ä¹ ã€‚ç¢°åˆ°ä¸€ä¸ªéœ€æ±‚æ˜¯è¦å®ç°å¤šä¸ªåœ†å½¢å¸¦ç¼ºå£çš„è¿›åº¦æ¡ï¼Œåœ¨ç½‘ä¸Šæ²¡æœ‰æ‰¾åˆ°ç›¸å…³æ’ä»¶åå†³å®šè‡ªå·±ç¼–å†™ä¸€ä¸ªï¼Œå¦‚æœèƒ½å¸®åˆ°éœ€è¦çš„äººé‚£çœŸæ˜¯å¤ªå¥½äº†, ä¸‹é¢ä¼šä»‹ç»ä¸€ä¸‹è‡ªå·±çš„å®ç°è¿‡ç¨‹ï¼Œå¦‚æœåªå…³å¿ƒå¦‚ä½•ç”¨çš„è¯å¯ä»¥ä¼ é€åˆ°ä¸‹é¢çš„é¡µé¢\n\n[mini-circleprogress æºç ](https://github.com/MLuminary/subentry/tree/master/mini-circleProgress)\n\n<!--more-->\n\n\n## å¤–è§‚\n\n![åŸºäº mpvue çš„åœ†å½¢è¿›åº¦æ¡](åŸºäºmpvueçš„åœ†å½¢è¿›åº¦æ¡/default.jpg)\n\n![åŸºäº mpvue çš„åœ†å½¢è¿›åº¦æ¡](åŸºäºmpvueçš„åœ†å½¢è¿›åº¦æ¡/gap.jpg)\n\n## è¿‡ç¨‹\n\nä¸€å¼€å§‹çš„æ€è·¯æ˜¯ç”¨ svgï¼Œ è‡ªå·±ç¼–å†™å®Œæ¯•åï¼Œå‘ç°å°ç¨‹åºä¸æ”¯æŒç›´æ¥å¼•å…¥ svgï¼Œ å› æ­¤æœ€ç»ˆå®ç°æ˜¯ä½¿ç”¨çš„å°ç¨‹åºè‡ªå¸¦çš„ canvas\n\nå¦‚ä½•ç”»åœ†å·²ç»æœ‰å¤§ä½¬è®²è§£è¿‡äº†ï¼Œæˆ‘å°±ä¸é‡å¤åŠ³åŠ¨äº†ï¼Œä¸‹é¢æ˜¯é“¾æ¥\n\nhttps://segmentfault.com/a/1190000013219501\n\nåœ¨æ­¤è¯´æ˜ä¸€ä¸‹æ­¤ç»„ä»¶å®ç°çš„åŠŸèƒ½å’Œä¸€äº›æ³¨æ„ç‚¹\n\n## å®Œå…¨å“åº”å¼\n\n### é€‚åº”åŒ…è£¹å…ƒç´ çš„å®½åº¦å’Œé«˜åº¦\n\nä¸€å¼€å§‹çš„æ€è·¯æ˜¯è®¾ç½® canvas çš„å®½é«˜ä¸º 100%ï¼Œå‘ç°å¹¶æ²¡æœ‰ä»€ä¹ˆç”¨ï¼Œç„¶åæƒ³è·å– canvas åŠ¨æ€æ”¹å˜å…¶å®½é«˜ï¼Œå‘ç°å°ç¨‹åºä¸èƒ½æ“ä½œ dom, `ref` ä¹Ÿéƒ½ä¸èƒ½ä½¿ç”¨ã€‚å› æ­¤åªèƒ½è®¾ç½®ä¸€ä¸ª `props`,éº»çƒ¦ä½¿ç”¨è€…å‘ŠçŸ¥ä¸€ä¸‹çˆ¶å…ƒç´ çš„å®½é«˜ï¼Œåœ¨è¿™é‡Œå› ä¸ºæ­¤å›¾å½¢æ˜¯ä¸€ä¸ªæ­£æ–¹å½¢ï¼Œæ‰€ä»¥åªéœ€è¦ä¼ é€’ä¸€ä¸ªå€¼å°±å¯ä»¥äº†ã€‚\n\n### é€‚åº”è®¾å¤‡çš„å®½åº¦å’Œé«˜åº¦\n\ncanvas ä¸­çš„ç”»å¸ƒå•ä½é»˜è®¤éƒ½æ˜¯ pxï¼Œç”»å‡ºæ¥çš„å›¾å½¢æ˜¯ä¸èƒ½å¾ˆå¥½çš„é€‚åº”å®½åº¦ä¸åŒçš„è®¾å¤‡çš„ï¼Œå› æ­¤è‡ªå·±åœ¨å†…éƒ¨å®ç°äº†ä¸€ä¸ª rpxï¼Œå…·ä½“å®ç°æ€è·¯å¦‚ä¸‹\n\n```js\ngetRpx () {\n  let rpx = 1 // ç›¸å¯¹å•ä½\n  return new Promise(resolve => {\n    wx.getSystemInfo({\n      success: function (res) {\n        rpx = res.windowWidth / 375\n        resolve(rpx)\n      }\n    })\n  })\n}\n```\n\nç„¶åä¸ä¹‹å‰çš„ç”»å¸ƒçš„æ•°å€¼ç›¸ä¹˜å³å¯ï¼Œæƒ³å…·ä½“çœ‹æ€ä¹ˆå®ç°çš„å¯ä»¥å»çœ‹ä¸‹æºç \n\n## æœ‰å…³ canvas-id\n\ncanvas åœ¨ä¸€ä¸ªé¡µé¢ä¸­ id æ˜¯ä¸èƒ½ç›¸åŒçš„ï¼Œå°±ç®—å‡ºç°ç›¸åŒçš„ä¹Ÿåªä¼šæ¸²æŸ“ç¬¬ä¸€ä¸ªï¼Œå› æ­¤éœ€è¦å¤šä¸ª canvas åªèƒ½è®©å…¶ id å„ä¸ç›¸åŒã€‚ä½¿ç”¨è€…æƒ³ä½¿ç”¨å¤šä¸ªåœ†å½¢è¿›åº¦æ¡ç»„ä»¶çš„æ—¶å€™ï¼Œè¯·ä¼ é€’ `canvasId` å€¼ã€‚\n\n","tags":["Idea"],"categories":["Fun"]},{"title":"æ ¹æ® url è·å–å›¾æ ‡åŠ title","url":"%2F2018%2F09%2F07%2F%E6%A0%B9%E6%8D%AEurl%E8%8E%B7%E5%8F%96%E5%9B%BE%E6%A0%87%E5%8F%8Atitle%2F","content":"\n> æœ€è¿‘åœ¨åšä¸€ä¸ªå°é¡¹ç›®æœ‰ä¸€ä¸ªç±»ä¼¼æ·»åŠ ä¹¦ç­¾çš„åŠŸèƒ½ï¼Œç”¨æˆ·ç‚¹å‡»æ·»åŠ åï¼Œå¼¹å‡ºè¾“å…¥æ¨¡å—ï¼Œç”¨æˆ·åªéœ€è¦å°†éœ€è¦æ”¶å½•çš„é“¾æ¥æ·»åŠ è¿›å»ï¼Œä¾¿å¯ä»¥è‡ªåŠ¨ç”Ÿæˆå¸¦æœ‰æ­¤ç½‘ç«™å›¾æ ‡å’Œæ­¤ç½‘ç«™æ ‡é¢˜çš„å¡ç‰‡\n\n<!--more-->\n\n## è®¾ç½® icon\n\næƒ³è¦çŸ¥é“å¦‚ä½•è·å–è‚¯å®šè¦çŸ¥é“ç½‘ç«™çš„ icon æ˜¯å¦‚ä½•è®¾ç½®çš„ï¼Œè®¾ç½® icon çš„æ–¹å¼æ®æˆ‘äº†è§£çš„æœ‰ä¸¤ç§\n\n- ä¸€èˆ¬éƒ½æ˜¯åœ¨ `html` ä»£ç çš„ `head` æ ‡ç­¾ä¸­è®¾ç½®ä¸€ä¸ª `link` æ ‡ç­¾ï¼Œå°†å…¶ `rel` å±æ€§è®¾ç½®ä¸º \"icon\" æˆ–è€… \"shortcut icon\",  `href` å°±æ˜¯å›¾æ ‡çš„ä½ç½®ã€‚\n- å¤§éƒ¨åˆ†ç½‘ç«™ä¼šåœ¨å…¶æ ¹ç›®å½•ä¸‹æ”¾ç½®ä¸€ä¸ª`favicon.ico` æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯ç½‘ç«™çš„å›¾æ ‡ã€‚\n\n![pg1](æ ¹æ®urlè·å–å›¾æ ‡åŠtitle/pg1.png)\n\n## è·å– icon\n\nä¸¤æ¡é€”å¾„è®¾ç½® iconï¼Œæ˜æ˜¾è§£æ html è¦ç›¸å¯¹éº»çƒ¦ä¸€ç‚¹ï¼Œå› æ­¤æˆ‘ä»¬å…ˆå»ç½‘ç«™æ ¹ç›®å½•ä¸‹å»è·å– favicon.ico, å¦‚æœä¸å­˜åœ¨æ­¤æ–‡ä»¶ï¼Œå†è§£æ htmlï¼Œå½“ç„¶å¦‚æœç½‘ç«™æœ¬èº«å°±æ²¡æœ‰ icon ï¼Œé‚£å°±è‡ªå·±è®¾ç½®ä¸€ä¸ªé»˜è®¤çš„å›¾æ ‡å°±å¥½äº†ã€‚\n\næˆ‘çš„æ€è·¯æ˜¯æ‹¿åˆ°éœ€è¦æ”¶å½•çš„é“¾æ¥ï¼Œç„¶åç”¨ `node` çš„ `url` æ¨¡å—å»è§£æï¼Œå†ç”¨ `get` æ–¹æ³•å»æŠ“å–æ­¤ç½‘é¡µï¼Œå¦‚æœä¸æ˜¯ `200` å°±ä»£è¡¨æ ¹ç›®å½•ä¸‹æ²¡æœ‰æ­¤æ–‡ä»¶ã€‚\n\n```js\nconst express = require('express')\nconst url = require('url')\nconst axios = require('axios')\n\nlet app = express()\n\n\napp.get('/',function(req, res) {\n  let targetUrl = 'https://github.com/MLuminary'\n  let urlString = url.parse(targetUrl)\n  let iconUrl = `${urlString.protocol}//${urlString.host}/favicon.ico`\n  isHasRootIcon(iconUrl)\n})\n\n// åˆ¤æ–­ç½‘ç«™æ ¹ç›®å½•ä¸‹æ˜¯å¦æœ‰ favicon.ico æ–‡ä»¶\nfunction isHasRootIcon(url) {\n   axios.get(url).then(response=>{\n     console.log(1)\n   }).catch(error=>{\n     console.log(0)\n   })\n}\n```\n\n**ä»¥ä¸Šæ€è·¯å¤§éƒ¨åˆ†ç½‘ç«™è¿˜æ˜¯å¯ä»¥çš„**ï¼Œä½†æ˜¯æœ‰ä¸€äº›ç½‘ç«™ä¼šé‡åˆ°é‡å®šå‘çš„é—®é¢˜ï¼Œä¼šè·³åˆ° 404 é¡µé¢æˆ–è€… error é¡µé¢ï¼Œ**æ­¤æ—¶è¿”å›çš„ `status` ä¹Ÿæ˜¯ `200` **ï¼Œä¸Šé¢çš„æ–¹æ³•å°±ä¹Ÿä¼šè®¤ä¸ºå·²æ‰¾åˆ° icon, ä½†å®é™…ä¸Šé“¾æ¥æ˜¯ `html` é¡µé¢ï¼Œå› æ­¤æˆ‘å°±æƒ³èƒ½ä¸èƒ½è·å–åˆ°é‡å®šå‘åçš„é“¾æ¥ï¼Œåˆ¤æ–­å…¶ç±»å‹ï¼Œå¦‚æœé‡å®šå‘çš„ç±»å‹ä¸æ˜¯ icoã€pngç­‰å›¾ç‰‡ç±»å‹ï¼Œå°±ä¹Ÿåˆ¤æ–­ä¸ºæ²¡æ‰¾åˆ°ã€‚æ‰¾æ¥æ‰¾å»å‘ç°äº† `request` åŒ…å¯ä»¥å®ç°, ä¸‹é¢æ˜¯å…·ä½“å®ç°\n\n```js\napp.get('/',function(req, res) {\n  let targetUrl = 'http://www.12306.cn/mormhweb/'\n  let urlString = url.parse(targetUrl)\n  let iconUrl = `${urlString.protocol}//${urlString.host}/favicon.ico`\n  isHasRootIcon(iconUrl).then(res=>{console.log(res)})\n})\n\n// åˆ¤æ–­ç½‘ç«™æ ¹ç›®å½•ä¸‹æ˜¯å¦æœ‰ favicon.ico æ–‡ä»¶\nfunction isHasRootIcon(url) {\n  let pattern = ['ico','png', 'svg', 'jpg']\n\n  return new Promise((resolve)=>{\n    let returnValue = false\n    request.get(url,function(err, res) {\n      if(res.statusCode === 200) {\n        let redirectPath = res.request.uri.path // é‡å®šå‘çš„é¡µé¢è·¯å¾„\n        pattern.forEach(item=>{\n          if(redirectPath.split('.')[1]===item) {\n            // å¦‚æœç»“å°¾æ˜¯ pattern æ•°ç»„ä¸­çš„ä¸€ç§ åˆ™è¿”å› true\n            returnValue = true\n            resolve(returnValue)\n          }\n        })\n      }\n      resolve(returnValue)\n    })\n  })\n}\n```\n\nå¦‚æœæ ¹ç›®å½•ä¸‹ä¸å­˜åœ¨ favicon.ico æ–‡ä»¶ï¼Œåˆ™éœ€è¦è§£æå…¶é“¾æ¥çš„ html ï¼Œç„¶åæå–å‡º icon çš„è·¯å¾„ï¼Œä½†æ˜¯è¿™å…¶ä¸­è¿˜æœ‰ä¸€äº›é—®é¢˜ï¼Œ**icon çš„è·¯å¾„æœ‰å¯èƒ½æ˜¯ç»å¯¹è·¯å¾„æˆ–è€…æ˜¯ç›¸å¯¹è·¯å¾„**ï¼Œå› æ­¤åœ¨æ­¤è¿˜éœ€è¦åœ¨åˆ¤æ–­ä¸€ä¸‹ï¼Œä¸‹é¢æ˜¯å…·ä½“ä»£ç \n\n```js\nfunction resolveHtml(targetUrl) {\n  return new Promise(resolve=>{\n    let defaultUrl = ''// è‡ªå·±é»˜è®¤çš„å›¾ç‰‡é“¾æ¥\n    superagent.get(targetUrl).end(function (err, content) {\n      let $ = cheerio.load(content.text)\n      let iconUrl = $(\"link[rel*='icon']\").eq(0).attr('href') // è·å¾— icon çš„é“¾æ¥\n      // å¦‚æœ iconUrl å­˜åœ¨ è¿˜éœ€è¦åˆ¤æ–­å…¶æ˜¯å¦æ˜¯ç›¸å¯¹ä½ç½®\n      if(iconUrl) {\n        // å¦‚æœä¸å­˜åœ¨ 'http'\n        if(iconUrl.indexOf('http') === -1 ) {\n          // åˆ¤æ–­æ˜¯å¦ä¸ºç›¸å¯¹è·¯å¾„æˆ–æ ¹è·¯å¾„\n          if(iconUrl.charAt(0) === '/') {\n            let urlString = url.parse(targetUrl)\n            iconUrl = `${urlString.protocol}//${urlString.host}${iconUrl}`\n          }else {\n            iconUrl = targetUrl + \"/\" + iconUrl\n          }\n        }\n        resolve(iconUrl)\n      }else {\n        resolve(defaultUrl)\n      }\n    })\n  })\n}\n```\n\nè·å– icon è¿æ¥æ—¶ä¸ºä»€ä¹ˆæˆ‘åŠ äº†ä¸€ä¸ª `eq(0)` å‘¢ï¼Œæ˜¯å› ä¸ºæˆ‘å‘ç°æœ‰äº›ç½‘ç«™æœ‰ä¸¤ç§ç±»å‹çš„ `link` å¯ä»¥æ·»åŠ å›¾æ ‡ï¼Œä¸€ç§æ˜¯`shortcunt icon` ä¸€ç§æ˜¯ `icon`ï¼Œå› æ­¤æˆ‘ä»¬åªè¦è·å–å…¶ä¸­ä¸€ä¸ªå°±å¯ä»¥äº†ï¼Œä¸¤ä¸ªéƒ½è·å–åˆ°å¯èƒ½ä¼šæŠ¥é”™ã€‚\n\n## è·å–title\n\nè·å– title å°±ç›¸å½“äºè§£æ Html è·å– icon, è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œåœ¨æ­¤å°±ä¸æ”¾ä»£ç äº†ã€‚\n\n## æˆæœ\n\nä¸‹é¢å°±æ˜¯ä¼ å…¥æ˜é‡‘é¦–é¡µæŠ“å–åˆ°çš„ä¿¡æ¯\n\n![pg2](æ ¹æ®urlè·å–å›¾æ ‡åŠtitle/pg2.png)","tags":["Idea"],"categories":["Fun"]},{"title":"è·å–ç™¾åº¦æœç´¢æç¤ºç»“æœ","url":"%2F2018%2F08%2F15%2F%E8%8E%B7%E5%8F%96%E7%99%BE%E5%BA%A6%E6%90%9C%E7%B4%A2%E6%8F%90%E7%A4%BA%E7%BB%93%E6%9E%9C%2F","content":"\n> æœ€è¿‘è‡ªå·±æƒ³åšçš„é¡¹ç›®éœ€è¦ä¸€ä¸ªæœç´¢æ¡†ï¼Œå¹¶æƒ³å®ç°å¦‚ä¸‹æœç´¢æç¤ºçš„åŠŸèƒ½\n\n![pg1](è·å–ç™¾åº¦æœç´¢æç¤ºç»“æœ/pg1.jpg)\n\næœ¬æ¥è§‰å¾—æŸ¥æŸ¥ network éšä¾¿æŠ“å–ä¸€ä¸‹å°±å¯ä»¥è·å¾—åˆ°æ•°æ®ï¼Œä½†äº‹æƒ…å´ä¸æ˜¯è¿™ä¹ˆç®€å•\n\n<!--more-->\n\n### è¿‡ç¨‹\n\nåœ¨ç™¾åº¦åœ¨éšä¾¿è¾“å…¥å­—ç¬¦ï¼ŒæŸ¥çœ‹ networkï¼Œæ‰¾åˆ°æ­¤æ—¶è¯·æ±‚çš„é“¾æ¥\n\n![pg2](è·å–ç™¾åº¦æœç´¢æç¤ºç»“æœ/pg2.png)\n\nä¼šå‘ç°ä½¿ç”¨ get æ–¹å¼ä¼ äº†å››ä¸ªå€¼,å…¶ä¸­ `p` å’Œ `cb` éƒ½æ˜¯å¯ä»¥å›ºå®šçš„ï¼Œå‰©ä¸‹çš„å°±æ˜¯å…³é”®å­— `wd` å’Œæ­¤æ—¶çš„æ—¶é—´æˆ³ `t`ï¼Œè‡ªå·±å› ä¸ºæœ¬èº«æ˜¯ vue çš„é¡¹ç›®ï¼Œå°±ç”¨ `axios` å¯¹æ­¤è¿›è¡Œè¯·æ±‚ï¼Œç»“æœæŠ¥é”™ä¸º **è·¨åŸŸ** å¹¶ä¸” **ä¸­æ–‡ä¹±ç **\n\n#### gzip\n\nå› ä¸ºå‘ç”Ÿäº†è·¨åŸŸï¼Œå› æ­¤å°±æƒ³ç”¨ `node` å»ä¿®æ”¹è¯·æ±‚å¤´å»è¯·æ±‚ï¼Œã€Œåæ¥å‘ç°ç”¨ `node` å»è¯·æ±‚ä¸éœ€è¦ä¿®æ”¹è¯·æ±‚å¤´ä¹Ÿä¸ä¼šè·¨åŸŸã€ï¼Œä½†æ˜¯è¿˜æœ‰ä¸€ä¸ªé—®é¢˜è¿”å›çš„ä¸­æ–‡éƒ½æ˜¯ä¹±ç ã€‚ç„¶åæˆ‘å°±å»å…³æ³¨äº†ä¸€ä¸‹å“åº”å¤´ï¼Œå¦‚ä¸Šé¢çš„å›¾ç‰‡ï¼Œå…¶ä¸­ `content-encoding: gzip` å¼•èµ·äº†æˆ‘çš„æ³¨æ„ã€‚\n\ngzip æ˜¯ä»€ä¹ˆåœ¨æ­¤æˆ‘å°±ä¸åšè¿‡å¤šçš„è§£é‡Šï¼Œå»ç½‘ä¸ŠæŸ¥åªæ˜¯è¯´æƒ³è¦**è·å– gzip æ ¼å¼çš„ç½‘é¡µä¿¡æ¯éœ€è¦è§£å‹ï¼Œè¦ä¸ç„¶è·å¾—åˆ°çš„ä¿¡æ¯ä¼šæ˜¯ä¹±ç **ï¼Œå…¶ä¸­ç”¨åˆ°äº† `zlib` å’Œ `request` ä¸¤ä¸ªåŒ…\n\n```js\n  zlib = require('zlib');\n\nfunction response (err, res, body) {\n//check res header it is gzip\n console.log(res.headers['content-encoding'])\n//now body it is gzip stream buffer\n      zlib.unzip(body, function(err, buffer) {\n             console.log(buffer.toString())\n       }\n\n}\n    request.get({\n        url : apiUrl,\n        headers: {\n            'Accept-Encoding' : 'gzip',\n          },\n        encoding : null  // it is very import!!\n    }, response)\n```\n\nä½†æ˜¯æˆ‘æ»¡æ€€æœŸå¾…çš„å°†å…¶è§£å‹æå–ä¿¡æ¯åè·å¾—çš„ç»“æœä¾ç„¶æ˜¯ä¹±ç ï¼Œmake my heart cold cold\n\n**gbk**\n\næœ€ååˆæŠŠç›®å…‰è½¬å‘å“åº”å¤´ï¼Œæ„Ÿè§‰ `charset=gbk` å¥½åƒæœ‰ç‚¹ä¸œè¥¿, å…¶ä¸­ç”¨åˆ°äº† `iconv-lite` ï¼Œæ˜¯ä¸€ä¸ªè½¬ç¼–ç çš„å·¥å…·ï¼Œ`iconv.decode` æ¥å—åˆ°ç¬¬ä¸€ä¸ªå‚æ•°å¿…é¡»æ˜¯ `buffer`, è€Œ `request` è·å–åˆ°çš„ä¿¡æ¯è¿”å›çš„ä¹Ÿæ˜¯ `buffer` æˆ‘å°±æ„Ÿè§‰å†¥å†¥ä¹‹ä¸­æ”¾ä½›é¢„ç¤ºç€ä»€ä¹ˆ\n\n```js\nrequest({\n        url,\n        encoding : null\n    }, function(err, response, body) {\n        res.setHeader('Content-Type', 'application/json; charset=utf-8')\n        res.end(iconv.decode(body, 'gbk'))\n    })\n```\n\nå› æ­¤å°†å“åº”å¤´è®¾ç½®ä¸º utf-8 å¹¶å°†å…¶ gbk ç¼–ç è½¬æ¢ä¸º utf-8 åæˆåŠŸçš„è·å¾—åˆ°äº†éœ€è¦çš„ä¿¡æ¯, ä¸‹é¢å°±æ˜¯å°†æ­¤ api éƒ¨ç½²åˆ°æˆ‘è‡ªå·±çš„æœåŠ¡å™¨ä¸Šï¼Œå…³äºéƒ¨ç½²ç¢°åˆ°çš„ä¸€äº›é—®é¢˜åŸºæœ¬éƒ½åœ¨æˆ‘å¦ä¸€ç¯‡æ–‡ç« ä¸­æœ‰è°ˆåˆ° [è®°ä¸€æ¬¡oneinstacké…ç½®æœåŠ¡å™¨](https://github.com/MLuminary/Blog/issues/15)\n\n[é˜…è¯»åŸæ–‡](https://github.com/MLuminary/Blog/issues/16)\n\n","tags":["Node"],"categories":["Fun"]},{"title":"è®©æœåŠ¡å™¨å¸¦ç‚¹ç»¿","url":"%2F2018%2F07%2F28%2F%E8%AE%A9%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%B8%A6%E7%82%B9%E7%BB%BF%2F","content":"\n> è¿™æ®µæ—¶é—´ç»ˆäºæ„Ÿè§‰è‡ªå·±æ­¥å…¥æ­£è½¨ï¼Œä¹Ÿç›¸å¯¹ç¨³å®šäº†ä¸‹æ¥ã€‚ä¾¿æƒ³æç‚¹äº‹æƒ…ï¼Œæƒ³åšä¸€ä¸ªç½‘ç«™ï¼ŒåŒ…å«è‡ªå·±ä¸€äº›å¹³æ—¶æƒ³è¦çš„å·¥å…·å’Œä¸€äº›è‡ªå·±æƒ³å…³æ³¨çš„å’¨è¯¢ã€‚ç„¶åå‘ç°è‡ªå·±çš„æœåŠ¡å™¨ç«Ÿç„¶ä¸€ç‚¹éƒ½ä¸ç»¿ï¼Œæ‰€ä»¥å°±èŠ±äº†ä¸€äº›æ—¶é—´ç»¿åŒ–äº†è‡ªå·±çš„æœåŠ¡å™¨ã€‚\n\n<!--more-->\n\n## nginx ä¸Š https\n\n### ç”³è¯·è¯ä¹¦\n\næˆ‘è‡ªå·±ç”¨çš„æ˜¯è…¾è®¯äº‘æœåŠ¡å™¨ï¼Œå› æ­¤è¯ä¹¦å°±å»è…¾è®¯äº‘å®˜æ–¹ç½‘ç«™å»ç”³è¯·ï¼Œå½“ç„¶ä¸æ˜¯è…¾è®¯äº‘çš„è¯è¿˜æœ‰å‡ ä¸ªæ¯”è¾ƒæƒå¨çš„é¢å‘è¯ä¹¦çš„ç½‘ç«™ï¼Œä¾‹å¦‚ [StartSSL](https://www.startcomca.com),å½“ç„¶å¦‚æœä½ çš„æœåŠ¡å™¨æ˜¯ Linux çš„è¯ï¼Œä½ ä¹Ÿå¯ä»¥ç”¨é»˜è®¤å®‰è£…çš„ OpenSSL\n\nä½†æ˜¯ OpenSSL çš„æ–¹æ³•æˆ‘æ²¡æœ‰è¯•è¿‡ï¼Œå…·ä½“å¯ä»¥å‚è€ƒ \n\nhttps://www.cnblogs.com/chjbbs/p/5748369.html\n\nè…¾è®¯äº‘çš„ç”³è¯·è¯ä¹¦è¿˜æ˜¯æ¯”è¾ƒç®€å•ï¼Œæ‰“å¼€ä¸‹è¿°é“¾æ¥\n\nhttps://console.cloud.tencent.com/ssl\n\nç‚¹å‡»ç”³è¯·è¯ä¹¦ï¼Œç„¶åæ ¹æ®å…¶æç¤ºä¸€æ­¥æ­¥å¡«å†™ï¼Œå®¡æ ¸æˆåŠŸåä¸‹è½½è¯ä¹¦ï¼Œä¸‹è½½è¯ä¹¦åé‡Œé¢çš„æ–‡ä»¶å¦‚ä¸‹\n\n![pg1](è®©æœåŠ¡å™¨å¸¦ç‚¹ç»¿/pg1.png)\n\næ‰“å¼€ Nginxï¼Œé‡Œé¢åŒ…å«ç€ä¸€ä¸ªè¯ä¹¦æ–‡ä»¶å’Œä¸€ä¸ª .key æ–‡ä»¶ã€‚\n\n### é…ç½® nginx\n\næ‰“å¼€æœåŠ¡å™¨ä¸­çš„ nginx/conf æ–‡ä»¶å¤¹ï¼Œåœ¨å…¶ä¸­åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ä¸º sslï¼Œå†åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ä¸ºåŸŸåï¼Œè¿™ä¸ªå®Œå…¨çœ‹è‡ªå·±çš„ä¹ æƒ¯ï¼Œåœ¨åé¢çš„é…ç½®é¡¹ä¸­åªè¦è·¯å¾„å¯¹å°±å¯ä»¥ã€‚æˆ‘çš„è¯ä¹¦å’Œ .key æ–‡ä»¶çš„ä½ç½®å°±åœ¨ nginx/conf/ssl/www.haoqinzz.cn/ ä¸‹\n\nç„¶åæ‰¾åˆ° nginx.conf æ–‡ä»¶ï¼Œå°†å…¶ä¸­å¦‚ä¸‹ä»£ç è§£å¼€å°å°å¹¶ä¿®æ”¹ä¸ºå¦‚ä¸‹ä»£ç \n\n```conf\n# HTTPS server\n    \n    server {\n       listen       443;\n       server_name  localhost;\n\n       ssl                  on;\n       ssl_certificate      ssl/www.haoqinzz.cn/1_www.haoqinzz.cn_bundle.crt;\n       ssl_certificate_key  ssl/www.haoqinzz.cn/2_www.haoqinzz.cn.key;\n\n       ssl_session_timeout  5m;\n\n       ssl_protocols  SSLv2 SSLv3 TLSv1;\n       ssl_prefer_server_ciphers   on;\n       \n       ssl_dhparam ssl/certs/dhparam.pem;\n       ssl_ciphers \"EECDH+ECDSA+AESGCM EECDH+aRSA+AESGCM EECDH+ECDSA+SHA384 EECDH+ECDSA+SHA256 EECDH+aRSA+SHA384 EECDH+aRSA+SHA256 EECDH+aRSA+RC4 EECDH EDH+aRSA !aNULL !eNULL !LOW !3DES !MD5 !EXP !PSK !SRP !DSS !RC4\";\n       keepalive_timeout 70;\n       ssl_session_cache shared:SSL:10m;\n\n       add_header Strict-Transport-Security max-age=63072000;\n       add_header X-Frame-Options DENY;\n       add_header X-Content-Type-Options nosniff;\n\n\n       location / {\n           root   html;\n           index  index.html index.htm;\n       }\n    }\n```\n\nç„¶åå†é‡å¯ä¸€ä¸‹ nginx æœåŠ¡å³å¯ï¼Œç„¶åè¾“å…¥ https://haoqinzz.cn å°±å¯ä»¥çœ‹åˆ° nginx çš„æ¬¢è¿é¡µï¼Œä½†æ­¤æ—¶ä½ è¾“å…¥ http://haoqinzz.cn è¿˜æ˜¯å¯ä»¥è®¿é—®çš„ï¼Œæ‰€ä»¥å¦‚æœæƒ³è¦å…¨ç«™éƒ½ä¸Š https ï¼Œè¿˜éœ€è¦ä¿®æ”¹ http çš„æœåŠ¡ï¼Œå°† http é‡å®šå‘åˆ° https ä¸­\n\n```conf\nserver {\n    listen       80;\n    server_name  haoqinzz.cn www.haoqinzz.cn;\n    return 301 https://haoqinzz.cn$request_uri;\n}\n```\n\nè¿™æ ·ä½ è¾“å…¥ http://haoqinzz.cn ä¼šè·³åˆ° https://haoqinzz.cn ä¸­ï¼Œä½†æ˜¯ç°åœ¨è¿˜å­˜åœ¨ä¸€ä¸ªå¾ˆå¤§çš„é—®é¢˜ï¼Œå°±æ˜¯æˆ‘ä»¥å‰çš„é¡¹ç›®ä¹Ÿæ— æ³•è®¿é—®åˆ°äº†ã€‚ã€‚\n\n## è®©æœåŠ¡å™¨ä¸­çš„é¡¹ç›®é‡æ–°è¿è¡Œ\n\n### åŸºæœ¬é¡¹ç›®\n\næœåŠ¡å™¨ä¸Š https åï¼Œé¦–é¡µæ”¹å˜äº†ï¼Œæ‰€æœ‰é¡¹ç›®éƒ½æ²¡äº†ï¼Œæˆ‘å°±å»çœ‹äº†ä¸€ä¸‹ nginx çš„é…ç½®æ–‡ä»¶\n\n```conf\n# HTTPS server\n    \n    server {\n       listen       443;\n       server_name  localhost;\n\n       ssl                  on;\n       ssl_certificate      ssl/www.haoqinzz.cn/1_www.haoqinzz.cn_bundle.crt;\n       ssl_certificate_key  ssl/www.haoqinzz.cn/2_www.haoqinzz.cn.key;\n\n       ssl_session_timeout  5m;\n\n       ssl_protocols  SSLv2 SSLv3 TLSv1;\n       ssl_prefer_server_ciphers   on;\n       \n       ssl_dhparam ssl/certs/dhparam.pem;\n       ssl_ciphers \"EECDH+ECDSA+AESGCM EECDH+aRSA+AESGCM EECDH+ECDSA+SHA384 EECDH+ECDSA+SHA256 EECDH+aRSA+SHA384 EECDH+aRSA+SHA256 EECDH+aRSA+RC4 EECDH EDH+aRSA !aNULL !eNULL !LOW !3DES !MD5 !EXP !PSK !SRP !DSS !RC4\";\n       keepalive_timeout 70;\n       ssl_session_cache shared:SSL:10m;\n\n       add_header Strict-Transport-Security max-age=63072000;\n       add_header X-Frame-Options DENY;\n       add_header X-Content-Type-Options nosniff;\n\n\n       location / {\n           root   html;\n           index  index.html index.htm;\n       }\n    }\n```\n\nå‘ç° https çš„ root æ–‡ä»¶å¤¹ä¸º htmlï¼Œå› æ­¤æˆ‘å°†åŸæœ¬çš„æ–‡ä»¶è¿è¿‡æ¥å°±å¯ä»¥è®¿é—®äº†ã€‚:fist:\n\n### nginx åå‘ä»£ç†é¡¹ç›®\n\nåœ¨æœåŠ¡å™¨ä¸Šæˆ‘è¿˜æœ‰è¿‡ä¸€ä¸ªç”¨ nginx å®ç°åå‘ä»£ç†çš„é¡¹ç›®ï¼Œå‡ https åæ¯«æ— ç–‘é—® api å…¨éƒ¨éƒ½æ˜¯ 404 äº†\n\næ‰¾åˆ° nginx åå‘ä»£ç†çš„é…ç½®æ–‡ä»¶ï¼Œå°† Listen ç«¯å£ 80 æ”¹ä¸º 443 ï¼Œå¹¶å°†ä»¥å‰çš„ http åè®®éƒ½æ”¹ä¸º httpsï¼Œç„¶åæ­¤æ—¶å†æ‰“å¼€å°±å¯ä»¥æ‰¾åˆ° url ï¼Œä½†æ˜¯ä¼šæŠ¥ 502 é”™è¯¯ï¼Œç»è¿‡ä»”ç»†æ’æŸ¥åå‘ç°è¿™æ˜¯å› ä¸ºæˆ‘å½“æ—¶ç”¨ http èµ·çš„æœåŠ¡ï¼Œè¦æ”¹ä¸º https å¹¶é…ç½®è¯ä¹¦æ–‡ä»¶\n\n```js\nvar https = require('https');\nconst fs = require('fs');\n\nconst options = {\n  key: fs.readFileSync('keyæ–‡ä»¶'),\n  cert: fs.readFileSync('crtæ–‡ä»¶')\n};\n\nvar server = https.createServer(options,app);\n```\n\nè¿™æ ·æ•°æ®ä¾¿åˆå¯ä»¥è·å–åˆ°äº†\n\n### oneinstack ä¸€é”®é…ç½®\n\nä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ Oneinstack å‚»ç“œå¼ä¸Š https ï¼Œ\b\bä¹Ÿå°±æ˜¯ `~/oneinstack/vhost.sh`, å…·ä½“å¯ä»¥çœ‹ oneinstack å®˜ç½‘çš„[æ•™ç¨‹](https://oneinstack.com/install/)","tags":["Server"],"categories":["Explore"]},{"title":"è®°ä¸€æ¬¡ oneinstack é…ç½®æœåŠ¡å™¨","url":"%2F2018%2F06%2F25%2F%E8%AE%B0%E4%B8%80%E6%AC%A1oneinstack%E9%85%8D%E7%BD%AE%E6%9C%8D%E5%8A%A1%E5%99%A8%2F","content":"\n> å› ä¸ºè‡ªå·±æ˜¯å¤§å­¦ç”Ÿï¼Œæ‰€ä»¥ä¸€ç›´éƒ½æ˜¯ç”¨çš„è…¾è®¯äº‘å­¦ç”Ÿæœºï¼Œä½†æ˜¯å‰å‡ å¤©è…¾è®¯çªç„¶å‘Šè¯‰æˆ‘è…¾è®¯äº‘å­¦ç”Ÿè®¤è¯åˆ°æœŸäº†ï¼Œå¯èƒ½æ˜¯å½“æ—¶å¡«é”™äº†ï¼Œæ²¡åŠæ³•æˆ‘å°±åˆç”³è¯·äº†å­¦ç”Ÿè®¤è¯ğŸ˜‚ï¼Œè°è®©æˆ‘è¿˜æ˜¯å­¦ç”Ÿå‘¢ï¼Œä½†æ˜¯ä»¥å‰è€çš„å­¦ç”Ÿä¼˜æƒ çš„å­¦ç”Ÿæœºå°±ä¸èƒ½å†æŒ‰ç…§å­¦ç”Ÿä¼˜æƒ çš„æ–¹å¼ç»­è´¹äº†ï¼Œæ‰€ä»¥æˆ‘åˆä¹°äº†ä¸€ä¸ªæ–°çš„æœåŠ¡å™¨ã€‚ä¹°å®ŒæœåŠ¡å™¨å‡†å¤‡æ‰‹åŠ¨å¼€å§‹å„ç§é…ç½®çš„æ—¶å€™ä¾¿å‘ç°äº†ä¸€ä¸ªç¥å™¨ï¼Œä¹Ÿå°±æ˜¯æ¥ä¸‹æ¥è¦ä»‹ç»ç»™å¤§å®¶çš„ã€‚å°±æ˜¯ [oneinstack](https://oneinstack.com/) ,å¯ä»¥å‚»ç“œå¼ã€Œä¸€é”®ã€å®‰è£…ï¼Œæƒ³çœ‹ç¢°åˆ°çš„ bug åŠä¸€äº›è§£å†³æ–¹æ¡ˆå¯ä»¥ç›´æ¥è·³è¿‡é…ç½®æœåŠ¡å™¨éƒ¨åˆ†ã€‚<a href=\"#é‡åˆ°çš„é—®é¢˜\">jump</a>\n\n<!--more-->\n\n## é…ç½®æœåŠ¡å™¨ç¯å¢ƒ\n\næˆ‘å†™æ­¤åšå®¢æ—¶ oneinstack çš„ç‰ˆæœ¬ä¸º 2018-04-24, å…¶ä½¿ç”¨æ–¹å¼å¦‚ä¸‹\n\n### åŸºæœ¬å®‰è£…\n\n```shell\nyum -y install wget screen curl python #for CentOS/Redhat\n# apt-get -y install wget screen curl python #for Debian/Ubuntu\n\n# ä¸‹è½½æºç ä¸è„šæœ¬\nwget http://mirrors.linuxeye.com/oneinstack-full.tar.gz #åŒ…å«æºç ï¼Œå›½å†…å¤–å‡å¯ä¸‹è½½\n\n# è§£å‹\ntar xzf oneinstack-full.tar.gz\n\n# å¦‚æœéœ€è¦ä¿®æ”¹ç›®å½•(å®‰è£…ã€æ•°æ®å­˜å‚¨ã€Nginxæ—¥å¿—)ï¼Œè¯·ä¿®æ”¹options.confæ–‡ä»¶\ncd oneinstack \n\n# å¦‚æœç½‘è·¯å‡ºç°ä¸­æ–­ï¼Œå¯ä»¥æ‰§è¡Œå‘½ä»¤`screen -R oneinstack`é‡æ–°è¿æ¥å®‰è£…çª—å£\nscreen -S oneinstack \n\n# æ³¨ï¼šè¯·å‹¿sh install.shæˆ–è€…bash install.shè¿™æ ·æ‰§è¡Œ\n./install.sh \n\n# æ¥ä¸‹æ¥æ ¹æ®å…¶æŒ‡ç¤ºå’Œè‡ªå·±å–œå¥½å®‰è£…éœ€è¦çš„è½¯ä»¶å³å¯\n```\n\n### node å®‰è£…\n\noneinstack ä¸æ”¯æŒ node ç¯å¢ƒçš„å®‰è£…ï¼Œä½œä¸ºä¸€ä¸ªå‰ç«¯er, node è¿˜æ˜¯ä¸å¯è·å–çš„ï¼Œä»¥å‰æˆ‘é…ç½® node éƒ½æ˜¯å»å®˜ç½‘ä¸‹è½½ç„¶åè§£å‹ç„¶åå»ºç«‹å…¨å±€è½¯é“¾æ¥çš„å½¢å¼ï¼Œè¿™æ¬¡ä¹Ÿæ˜¯æ¢äº†ä¸€ä¸ªæ›´ç®€å•çš„æ–¹å¼\n\n#### node.js v.8x å®‰è£…å‘½ä»¤\n\n```shell\n#curl --silent --location https://rpm.nodesource.com/setup_8.x | bash -\n```\n\n#### å®‰è£…node\n\n```shell\nyum install -y nodejs\n```\n\n#### æŸ¥çœ‹ nodejs å®‰è£…ç‰ˆæœ¬\n\n```shell\nnode -v\n```\n\nè‡³æ­¤ node å°±å·²ç»å®‰è£…å®Œæˆï¼Œä¹Ÿæ˜¯å…¨å±€å˜é‡ï¼Œç›¸æ¯”ä»¥å‰ä¹Ÿçœäº†å¾ˆå¤šæ—¶é—´å’ŒåŠ›æ°”ï¼Œå¦‚æœéœ€è¦ä¹Ÿå¯ä»¥å®‰è£… nodejs çš„ç‰ˆæœ¬ç®¡ç†å·¥å…·ï¼Œä½†æ˜¯åœ¨è¿™é‡Œæˆ‘æ²¡æœ‰å®‰è£…ï¼Œæ­£ç¡®ä¸å¦æˆ‘æ²¡æœ‰å°è¯•\n\n### node.jsç‰ˆæœ¬ç®¡ç†å™¨n\n\n#### å®‰è£…n\n\n```\nnpm install -g n1\n```\n\n#### å®‰è£…æŒ‡å®šç‰ˆæœ¬\n\n```\n#n <version>1\n```\n\n#### å®‰è£…æœ€æ–°ç‰ˆæœ¬\n\n```\n# n latest1\n```\n\n#### å®‰è£…ç¨³å®šç‰ˆæœ¬\n\n```\n#n stable1\n```\n\n#### åˆ é™¤æŸä¸ªç‰ˆæœ¬\n\n```\n#n rm <version> 1\n```\n\n#### æŸ¥çœ‹æ‰€æœ‰ç‰ˆæœ¬\n\n```\n#n list\n```\n\n## å…¶ä»–é…ç½®\n\n### æ·»åŠ é™„åŠ ç»„ä»¶\n\n```shell\n./addons.sh\n```\n\n### åˆ›å»º FTP è™šæ‹Ÿç”¨æˆ·è´¦æˆ·\n\n```shell\n./pureftpd_vhost.sh\n```\n\n### å¢åˆ è™šæ‹Ÿä¸»æœº\n\n```shell\n# å¢åŠ è™šæ‹Ÿä¸»æœº./vhost.sh# åˆ é™¤è™šæ‹Ÿä¸»æœº\n./vhost.sh\n```\n\n### å¤‡ä»½å’Œè‡ªåŠ¨å¤‡ä»½\n\n```shell\n# Set backup options ./backup_setup.sh # Start backup, You can add cron jobs./backup.sh # crontab -l # Examples 0 1 * * * cd ~/oneinstack;./backup.sh  > /dev/null 2>&1 &\n```\n\n### æ›´æ–°ç‰ˆæœ¬\n\n```shell\n./upgrade.sh\n```\n\n### å¸è½½\n\n```shell\n./uninstall.sh\n```\n\n## ç®¡ç†æœåŠ¡\n\nNginx/Tengine/OpenResty:\n\n```\nservice nginx {start|stop|status|restart|reload|configtest}\n```\n\nMySQL/MariaDB/Percona:\n\n```\nservice mysqld {start|stop|restart|reload|status}\n```\n\nPostgreSQL:\n\n```\nservice postgresql {start|stop|restart|status}\n```\n\nMongoDB:\n\n```\nservice mongod {start|stop|status|restart|reload}\n```\n\nPHP:\n\n```\nservice php-fpm {start|stop|restart|reload|status}\n```\n\nHHVM:\n\n```\nservice supervisord {start|stop|status|restart|reload}\n```\n\n**æ³¨**ï¼šhhvmè¿›ç¨‹äº¤ç»™supervisordç®¡ç†ï¼Œäº†è§£æ›´å¤šè¯·è®¿é—®ã€Š[Supervisorç®¡ç†hhvmè¿›ç¨‹](https://blog.linuxeye.com/408.html)ã€‹\nApache:\n\n```\nservice httpd {start|restart|stop}\n```\n\nTomcat:\n\n```\nservice tomcat {start|stop|status|restart}\n```\n\nPure-Ftpd:\n\n```\nservice pureftpd {start|stop|restart|status}\n```\n\nRedis:\n\n```\nservice redis-server {start|stop|status|restart}\n```\n\nMemcached:\n\n```\nservice memcached {start|stop|status|restart|reload}\n```\n\n## å¯ç”¨ mysql æœåŠ¡\n\noneinstack é»˜è®¤ä»…å…è®¸ä¸»æœºæœ¬æœºé“¾æ¥æ•°æ®åº“ï¼Œéœ€è¦è¿œç¨‹è¿æ¥æ•°æ®åº“çš„è¯ï¼Œéœ€è¦æ‰“å¼€å¯¹åº”ç«¯å£\n\n### æ‰“å¼€ 3306 ç«¯å£\n\nCentOS ç³»ç»Ÿ\n\n```shell\niptables -I INPUT 4 -p tcp -m state --state NEW -m tcp --dport 3306 -j ACCEPT # å…è®¸è®¿é—® 3306\nservice iptables save #ä¿å­˜ iptables è§„åˆ™\niptables -nvl # æŸ¥çœ‹ iptables è§„åˆ™\n```\n\nUbuntu/Debian \n\n```shell\niptables -I INPUT 4 -p tcp -m state --state NEW -m tcp --dport 3306 -j ACCEPT # å…è®¸è®¿é—® 3306\niptables-save > /etc/iptables.up.rules #ä¿å­˜ iptables è§„åˆ™\n```\n\n### æ•°æ®åº“æˆæƒ\n\n#### MySQL8.0ç‰ˆæœ¬\n\n```shell\n# mysql -uroot -p\n MySQL [(none)]> create user db_user@'%' identified by 'db_pass'; #åˆ›å»ºç”¨æˆ·\n MySQL [(none)]> grant all privileges on db_name.* to db_user@'%' with grant option; #æˆæƒ\n MySQL [(none)]> exit; #é€€å‡ºæ•°æ®åº“æ§åˆ¶å°ï¼Œç‰¹åˆ«æ³¨æ„æœ‰åˆ†å·\n```\n\n#### å…¶ä½™MySQLç‰ˆæœ¬\n\n```shell\n# mysql -uroot -p\n MySQL [(none)]> grant all privileges on db_name.* to db_user@'%' identified by 'db_pass'; #æˆæƒè¯­å¥ï¼Œç‰¹åˆ«æ³¨æ„æœ‰åˆ†å·\n MySQL [(none)]> flush privileges;\n MySQL [(none)]> exit; #é€€å‡ºæ•°æ®åº“æ§åˆ¶å°ï¼Œç‰¹åˆ«æ³¨æ„æœ‰åˆ†å·\n```\n\n## æœåŠ¡å™¨https\n\nä»¥å‰çš„æœåŠ¡å™¨ https éƒ½æ˜¯è‡ªå·±ä¸Šçš„ï¼Œä½¿ç”¨ oneinstack å¯ä»¥ä¸€é”®è®©è‡ªå·±çš„æœåŠ¡å™¨å¸¦ç‚¹ç»¿ :green_apple: \n\nè¿è¡Œ`./vhost.sh` å°±ä¼šè·³åˆ°é…ç½®è™šæ‹Ÿç¯å¢ƒç•Œé¢ï¼Œoneinstack é‡‡ç”¨ Let's Encrypt https è¯ä¹¦ï¼Œå…è´¹ä½¿ç”¨ä¸º 90 å¤©ï¼Œåˆ°æœŸå oneinstack ä¼šè‡ªåŠ¨å¸®ä½ ç»­è´¹ï¼Œé…ç½®å®Œæ¯•ååœ¨é»˜è®¤æ–‡ä»¶å¤¹é‡Œæ·»åŠ é¡¹ç›®å°±å¯ä»¥è¾“å…¥ç½‘å€ä»¥ https çš„æ–¹å¼è®¿é—®\n\n## é‡åˆ°çš„é—®é¢˜\n\n### æ— æ³•è®¿é—®å¸¦ç«¯å£åŸŸå\n\næˆ‘è‡ªå·±åˆ›å»ºäº†ä¸€ä¸ªäºŒçº§åŸŸå api.Ã—Ã—Ã—Ã— æ¥ä½œä¸ºæˆ‘ä¸€äº› api æ¥å£çš„æä¾›ç½‘å€ï¼Œç„¶åæƒ³ç”¨ oneinstack ä¸ºå…¶ä¸Šhttpsï¼Œå‘æœåŠ¡å™¨ä¸­ä¸Šä¼  node æ–‡ä»¶ç”¨ pm2 è·‘èµ·æ¥åï¼Œæœ¬æ¥åœ¨æœ¬åœ° localhost:3000 å¯ä»¥è®¿é—®çš„æ–‡ä»¶ï¼Œåˆ°äº†æœåŠ¡å™¨åæ— æ³•é€šè¿‡ api.Ã—Ã—Ã—Ã—:3000 æ¥è®¿é—®ï¼Œæœ€å¼€å§‹æƒ³åˆ°äº†ç±»ä¼¼é˜¿é‡Œäº‘å®‰å…¨ç»„çš„é—®é¢˜ï¼Œç„¶åæˆ‘å»åå°çœ‹äº†ä¸‹æˆ‘çš„æœåŠ¡å™¨çš„å®‰å…¨ç»„ï¼Œå¹¶æ²¡æœ‰ç¦ç”¨ 3000 ç«¯å£ã€‚åæ¥è„‘å­é‡Œè‡ªå·±å†’å‡ºæ¥äº†ä¸€ä¸ªæƒ³æ³•ï¼Œç”¨ nginx åå‘ä»£ç†ï¼Œåœ¨è¿™é‡Œæˆ‘å°±ä¸å…·ä½“ç»™å‡ºåå‘ä»£ç†çš„ä»£ç äº†ï¼Œæ ¼å¼å¾ˆç®€å•ï¼Œå°±æ˜¯è®¿é—® api.Ã—Ã—Ã—Ã—/getApi ç›¸å½“äºè®¿é—® api.Ã—Ã—Ã—Ã—:3000/getApi ,ç„¶åç«Ÿç„¶å°±æˆåŠŸè®¿é—®åˆ°äº† :zap:\n\n2018/9/10: oneinstack é»˜è®¤ç«¯å£éƒ½æ˜¯ä¸å¼€æ”¾çš„ï¼Œå› æ­¤æˆ‘æ„Ÿè§‰æ˜¯æœªå°† 3000 ç«¯å£å¼€æ”¾çš„åŸå› \n\n### å¼•ç”¨ api ç¢°åˆ°çš„è·¨åŸŸé—®é¢˜\n\nä¸»åŸŸåä¸‹çš„é¡¹ç›®å¼•ç”¨ api.Ã—Ã—Ã—Ã— ä¸‹çš„ api æ˜¯è¦è·¨åŸŸçš„ï¼Œè°·æ­Œæœç´¢åˆ°çš„è§£å†³æ–¹æ¡ˆåŸºæœ¬æ˜¯å¦‚ä¸‹ä»£ç \n\n```js\napp.all('*', function(req, res, next) {\n    res.header(\"Access-Control-Allow-Origin\", \"*\")\n    res.header(\"Access-Control-Allow-Headers\", \"Content-Type,Content-Length, Authorization, Accept,X-Requested-With\")\n    res.header(\"Access-Control-Allow-Methods\",\"PUT,POST,GET,DELETE,OPTIONS\")\n    res.header(\"X-Powered-By\",' 3.2.1')\n    if(req.method==\"OPTIONS\") res.send(200)/*è®©optionsè¯·æ±‚å¿«é€Ÿè¿”å›*/\n    else  next()\n})\n```\n\nä½†æ˜¯å¹¶æ²¡æœ‰è§£å†³æˆ‘çš„è·¨åŸŸé—®é¢˜ï¼Œæˆ‘æ˜¯åœ¨ nginx åå‘ä»£ç†æ—¶åŠ å…¥å¦‚ä¸‹ä»£ç å®ç°çš„\n\n```conf\nlocation / {  \n    add_header Access-Control-Allow-Origin *;\n\t...\n} \n```\n\n### https å¼•ç”¨ http ä¸‹çš„æ¥å£æŠ¥é”™\n\næˆ‘çš„ api.Ã—Ã—Ã—Ã— åŸŸååœ¨å¼€å§‹çš„æ—¶å€™ä¸Š https å¹¶æ²¡æœ‰æˆåŠŸï¼Œæˆ‘å°±ä½¿ç”¨çš„æ˜¯ http åè®®ï¼Œä½†æ˜¯è§£å†³äº†è·¨åŸŸé—®é¢˜ååˆæŠ¥é”™ï¼ŒæŠ¥é”™çš„å†…å®¹å¤§è‡´å°±æ˜¯ https ä¸‹æ— æ³•å¼•ç”¨ http ä¸­çš„æ¥å£ï¼Œæœ€åæˆ‘å…¶å®æ¢äº†ä¸€ä¸ªåŸŸååˆä¸Šäº† https ... :joy_cat:\n\n## æœ€å\n\næœ€ååŸºæœ¬é¡¹ç›®éƒ½å·²éƒ¨ç½²åˆ°äº†æœåŠ¡å™¨ä¸Šï¼Œè®¿é—®é¡¹ç›®ä¹Ÿæœ‰è€€çœ¼çš„å°ç»¿æ ‡ï¼Œè¿˜æ˜¯ hin å¼€å¿ƒçš„","tags":["Oneinstack"],"categories":["Explore"]},{"title":"å‰ç«¯å®‰å…¨","url":"%2F2018%2F05%2F30%2F%E5%89%8D%E7%AB%AF%E5%AE%89%E5%85%A8%2F","content":"\n> æœ€è¿‘ä¸€ç›´åœ¨å‡†å¤‡é¢è¯•ï¼Œè¢«é—®åˆ°äº†è§£ XSS æ—¶ç­”å‡ºä¸äº†è§£è¿˜æ˜¯å¾ˆæƒ­æ„§çš„ï¼Œä½œä¸ºå‰ç«¯å¼€å‘äººå‘˜ï¼Œå®‰å…¨è¿™æ–¹é¢æ˜¯å¿…é¡»è¦éå¸¸é‡è§†çš„ï¼Œå› æ­¤å†³å®šæ‹¿å‡ºäº†ä¸€æ®µæ—¶é—´æ¥é‡ç‚¹äº†è§£ä¸€ä¸‹å…³äºå‰ç«¯çš„å®‰å…¨é—®é¢˜ï¼Œåœ¨è¿™é‡Œä»¥ XSS å’Œ CSRF ä¸ºä¸»\n\n<!--more-->\n\n## XSS\n\nXSS(Cross-site script)å› ä¸ºä¸ CSS ç®€å†™é‡åˆæ‰€ä»¥æ”¹ä¸º XSS\n\nå…¶åŸç†æ˜¯**å‘ç½‘ç«™ä¸­æ’å…¥æ¶æ„çš„ HTML ä»£ç **ã€‚å½“å…¶ä»–ç”¨æˆ·æµè§ˆè¯¥ç½‘ç«™çš„æ—¶å€™ï¼Œè¯¥æ®µ HTML ä»£ç ä¼šè‡ªåŠ¨æ‰§è¡Œï¼Œä»è€Œè¾¾åˆ°æ”»å‡»çš„ç›®çš„ã€‚å¦‚ç›—å–ç”¨æˆ·çš„ Cookieï¼Œé¡µé¢é‡å®šå‘ï¼Œç ´åé¡µé¢ç»“æ„\n\n**ä¸¾ä¸ª**:chestnut:\n\nç½‘ç«™çš„è¯„è®ºç³»ç»Ÿæ²¡æœ‰è¿‡æ»¤ XSS æ”»å‡»ï¼Œå½“æœ‰ç”¨æˆ·æ·»åŠ è¯„è®ºä¸º\n\n```js\n<script>\n  while(true) {\n    alert(\"1\")\n  }\n</script>\n```\n\nè¿™æ®µä»£ç å°±ä¼šæ’å…¥åˆ°æ­¤ç½‘ç«™çš„ DOM ç»“æ„ä¸­ï¼Œå› ä¸ºæ²¡æœ‰è¿‡æ»¤æ‰æˆ–è¿›è¡Œå¤„ç†ï¼Œæ­¤æ®µä»£ç ä¹Ÿä¼šæ‰§è¡Œã€‚\n\n### XSS åˆ†ç±»\n\nXSS åˆ†ä¸ºä¸¤ç§ç±»å‹ï¼šã€ŒæŒä¹…å‹ XSSã€ å’Œ ã€ŒéæŒä¹…å‹ XSSã€\n\n**æŒä¹…å‹ XSS**ã€Œå­˜å‚¨å‹ã€\n\næŒä¹…å‹ XSS å°±æ˜¯å¯¹å®¢æˆ·ç«¯æ”»å‡»çš„è„šæœ¬ç›´æ¥æ¤å…¥åˆ°æœåŠ¡å™¨ä¸Šï¼Œä»è€Œå¯¼è‡´æ¯ä¸ªç”¨æˆ·è®¿é—®æ­¤ç½‘ç«™éƒ½ä¼šé­åˆ° XSS çš„æ”»å‡»\n\n**éæŒä¹…å‹ XSS**ã€Œåå°„å‹ã€\n\néæŒä¹…å‹ XSS æ˜¯å¯¹ä¸€ä¸ªé¡µé¢çš„æŸä¸ªå‚æ•°åšæ–‡ç« ï¼ŒæŠŠç²¾å¿ƒæ„é€ å¥½çš„æ¶æ„è„šæœ¬åŒ…è£…åœ¨ URL å‚æ•°ä¸­ï¼Œå†è®² URL å‘å¸ƒåˆ°ç½‘ä¸Šï¼Œéª—å–ç”¨æˆ·è®¿é—®\n\næ‰‹æ®µä¸»è¦æœ‰\n\n* HTML èŠ‚ç‚¹å†…å®¹çš„æ³¨å…¥ ä¾‹å¦‚ æ·»åŠ è¯„è®º\n* HTML å±æ€§ ä¾‹å¦‚ é€šè¿‡ url ä¼ å€¼åŠ¨æ€ä¿®æ”¹ `img` çš„ `src`\n* javascript ä»£ç  ä¾‹å¦‚ ä¼ é€’çš„å˜é‡æ·»åŠ åŒå¼•å·å¹¶åœ¨åŒå¼•å·åé¢æ·»åŠ è¦æ³¨å…¥çš„è„šæœ¬\n\n### é˜²å¾¡ XSS\n\nå¯¹äºéæŒä¹…å‹ XSS\n\n* ç°ä»£æµè§ˆå™¨éƒ½å¯¹ xss æœ‰äº†ä¸€å®šçš„é˜²èŒƒä½œç”¨ï¼Œä½†ä¹Ÿä»…é™äº html èŠ‚ç‚¹å’Œå±æ€§çš„æ³¨å…¥ã€‚\n* Web é¡µé¢æ¸²æŸ“çš„æ‰€æœ‰å†…å®¹å’Œæ•°æ®å¿…é¡»æ¥è‡ªäºæœåŠ¡å™¨\n* å°½é‡ä¸ä½¿ç”¨ `eval`, `new Function()`,`window.setTimeout()`,`innerHTML`ç­‰å¯æ‰§è¡Œå­—ç¬¦ä¸²çš„æ–¹æ³•\n* å‰ç«¯æ¸²æŸ“çš„æ—¶å€™è¦å¯¹ä»»ä½•å­—æ®µéƒ½éœ€è¦åšè½¬ä¹‰\n* å¯¹äºç”¨æˆ·è¾“å…¥çš„è¦æ·»åŠ é™åˆ¶ï¼Œæ¯”å¦‚ç”¨æˆ·åå’Œå¯†ç åªå…è®¸å­—ç¬¦å’Œæ•°å­—ï¼Œemail å¿…é¡»ä¸º email æ ¼å¼\n* å¯¹äºå¯Œæ–‡æœ¬é‡‡ç”¨**è¿‡æ»¤**ï¼Œå¯ä»¥é€šè¿‡å›½äººå†™çš„ [xss](https://github.com/leizongmin/js-xss)\n\nå¯¹äºæŒä¹…å‹ XSS\n\n* åç«¯åœ¨å…¥åº“çš„æ—¶å€™ä¸ç›¸ä¿¡ä»»ä½•å‰ç«¯çš„æ•°æ®ï¼Œå°†æ‰€æœ‰çš„å­—æ®µç»Ÿä¸€è¿›è¡Œè½¬ä¹‰å¤„ç†\n* åç«¯åœ¨ä¼ é€’ç»™å‰ç«¯æ•°æ®çš„æ—¶å€™ç»Ÿä¸€åšè½¬ä¹‰å¤„ç†\n* å‰ç«¯ä¸ç›¸ä¿¡åç«¯ä¼ æ¥çš„æ•°æ®ï¼Œä»»ä½•å­—æ®µä¹Ÿéƒ½éœ€è¦åšè½¬ä¹‰å¤„ç†\n\n**ä¸¾ä¸ªæ —å­**:chestnut:\n\nå…ˆçœ‹ä¸€ä¸‹åå°çš„ä»£ç ã€Œnode.jsã€\n\n```js\napp.get('/api/xss', function(req, res) {\n  res.setHeader('X-XSS-Protection', 0) //å…³é—­æµè§ˆå™¨ XSS\n\n  res.json('hutchins <script>console.log(1)</script>') //æ¨¡æ‹ŸXSSæ”»å‡»ï¼Œåå°è¿”å›äº†å¸¦è„šæœ¬çš„å­—ç¬¦ä¸²\n})\n```\n\nå‰å°ä»£ç \n\n```js\n$.ajax({\n  type:'get',\n  url:\"http://localhost:3003/api/xss\",\n  dataType:'json',\n  success:function(data){\n    $('#uname').html(data) //è¿™æ ·åœ¨å‰å°å°±ä¼šæ’å…¥ script æ ‡ç­¾\n  }\n})\n```\n\nè¿™æ ·ä¾¿ä¼šåœ¨å‰å°æ’å…¥è„šæœ¬ä»£ç å¹¶åœ¨æ§åˆ¶å°æ‰“å° `1`ï¼Œé‚£ä¹ˆå¯¹äºæ­¤ç±»ä»£ç å°±éœ€è¦å°†å…¶è½¬ä¹‰ï¼Œè®©å…¶æ— æ³•è¿è¡Œï¼Œåœ¨ `success` æ–¹æ³•ä¸­æ”¹ä¸ºå¦‚ä¸‹ä»£ç \n\n```js\n//è¿›è¡ŒHTMLè½¬ä¹‰åä¾¿ä¼šæ’å…¥æ­£å¸¸çš„å†…å®¹\nvar str = data\nstr = str.replace(/</g,'&lt')\nstr = str.replace(/>/g,'&gt')\n$('#uname').html(str)\n\n//ä½†å…¶å®è¿™æ ·ä¹Ÿå¯ä»¥å®Œç¾æ’å…¥\n$('#uname').text(data) \n```\n\n## CSRF\n\nCSRF ã€ŒCross-site request forgeryã€ä¸­æ–‡åç§°ä¸ºè·¨ç«™è¯·æ±‚ä¼ªé€ \n\næ”»å‡»è€…ç›—ç”¨äº†ä½ çš„ç™»å½•ä¿¡æ¯ï¼Œä»¥ä½ çš„èº«ä»½æ¨¡æ‹Ÿå‘é€å„ç§è¯·æ±‚ã€‚\n\nå®Œæˆ CSRF æ”»å‡»æœ‰**ä¸‰ä¸ªæ¡ä»¶**\n\n* ç”¨æˆ·å·²ç»ç™»å½•äº†ç«™ç‚¹ Aï¼Œå¹¶ä¸”åœ¨æœ¬åœ°ä¿ç•™äº† cookie\n* åœ¨ç”¨æˆ·æ²¡æœ‰ç™»å‡ºç«™ç‚¹çš„æƒ…å†µä¸‹**ä¹Ÿå°±æ˜¯ cookie è¿˜åœ¨ç”Ÿæ•ˆçš„æƒ…å†µä¸‹**è®¿é—®äº†æ”»å‡»è€…æä¾›çš„å±é™©ç«™ç‚¹ B\n* ç«™ç‚¹ A æ²¡æœ‰ä»»ä½• CSRF é˜²å¾¡\n\n### CSRF æ‰‹æ®µ\n\næ‹¿å‘è¡¨è¯„è®ºä¸ºä¾‹ï¼Œå°±æ˜¯ç”¨æˆ·ç™»å½•åç¼–å†™è¯„è®ºç‚¹å‡»å‘è¡¨è¿™ç§æ“ä½œï¼Œå¦‚æœå‘è¡¨è¯„è®ºæ˜¯ `get` è¯·æ±‚\n\né‚£ CSRF æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è‡ªåˆ¶çš„ B å±é™©ç½‘ç«™ä¸Šé¢å†™ä¸€ä¸ª `a` æ ‡ç­¾ï¼Œç„¶åç”± `a` æ ‡ç­¾æ¨¡æ‹Ÿä½ ç‚¹å‡»è¯„è®ºå‘èµ·çš„ `get` è¯·æ±‚ï¼Œå½“ä½ ç‚¹å‡»æ—¶ï¼Œå°±ä¼šåœ¨ A ç½‘ç«™æ·»åŠ ä¸€ä¸ªè¯„è®ºï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆ CSRF å« ã€Œone click attack ä¸€ç‚¹å°±çˆ†ç‚¸ã€ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ç›´æ¥å†™ä¸€ä¸ªå›¾ç‰‡åœ¨ä½ ä¸çŸ¥æƒ…æ—¶å‘é€ `get` è¯·æ±‚\n\né‚£ä½ æ­¤åˆ»ä¼šæƒ³ï¼Œé‚£æŠŠæ·»åŠ è¯„è®ºæ”¹æˆ `post` è¯·æ±‚åº”è¯¥å°±å®‰å…¨äº†å§\n\næ”¹æˆ `post` è¯·æ±‚ï¼Œæ”»å‡»è€…å¯ä»¥åœ¨ B ç½‘ç«™ç”¨ js åŠ¨æ€ç”Ÿæˆè¡¨å•ï¼Œç„¶åå‘é€ `post` è¯·æ±‚ï¼Œæ›´é«˜çº§ç‚¹å¯ä»¥å†ç”Ÿæˆä¸€ä¸ªéšè—çš„ `iframe` è®©è¡¨å• `target` æŒ‡å‘å…¶ `name`ï¼Œè®©ä½ åœ¨å®Œå…¨æ²¡æœ‰å¯Ÿè§‰çš„æƒ…å†µä¸‹ä»¥ä½ çš„åä¹‰å¹²ä¸€äº›ç¾ç¾çš„äº‹æƒ…\n\n### CSRF é˜²å¾¡\n\n**ä» cookie æ–¹é¢ä¸‹æ‰‹**\n\n* ç¦æ­¢æ­¢ç¬¬ä¸‰æ–¹ç½‘ç«™ä½¿ç”¨ cookieï¼Œä½¿ç”¨ `sameSite:Strict` ç›®å‰ä»…æœ‰ chrome æ”¯æŒ\n\n**ä»ç»•è¿‡å‰ç«¯é¡µé¢ä¸‹æ‰‹**\n\n* åœ¨å‰ç«¯é¡µé¢åŠ å…¥éªŒè¯ä¿¡æ¯ï¼Œå¯ä»¥ä½¿ç”¨ [ccap](https://github.com/DoubleSpout/ccap)\n* åŠ å…¥ tokenï¼Œtoken åœ¨å‰ç«¯é¡µé¢ `cookie` å’Œ åç«¯å¿…é¡»ä¿æŒä¸€è‡´ï¼Œå¦‚æœæ˜¯ `ajax` è¯·æ±‚çš„è¯å¯ä»¥åœ¨å‰ç«¯é¡µé¢ `meta` å¤„æ·»åŠ ä¸€ä¸ª `token` å±æ€§ï¼Œç„¶åç”¨ `js` åŠ¨æ€è·å–\n\n**referer ä¸º B ç½‘ç«™**\n\néªŒè¯ referer `/^åŸŸå/`ï¼Œè¿™é‡Œæ³¨æ„ä¸€ä¸‹ï¼Œå¦‚æœä½ æ˜¯ç”¨æœ¬åœ°æ–‡ä»¶æµ‹è¯•çš„è¯ï¼Œ`file` åè®®æ˜¯æ²¡æœ‰ referer çš„\n","tags":["Safe"],"categories":["Explore"]},{"title":"è·¨åŸŸé—®é¢˜æ€»ç»“","url":"%2F2018%2F05%2F28%2F%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98%E6%80%BB%E7%BB%93%2F","content":"\n> è·¨åŸŸé—®é¢˜æ˜¯æ—¥å¸¸ä¸­å¿…é¡»è¦é¢å¯¹çš„ï¼Œæ¯æ¬¡é¢è¯•å¿…è€ƒè·¨åŸŸä¹Ÿä½“ç°äº†è·¨åŸŸæŠ€æœ¯çš„é‡è¦æ€§ï¼Œè·¨åŸŸçš„æ–‡ç« ä¹Ÿå¤šçš„æ•°ä¸è¿‡æ¥ï¼Œä»Šå¤©è¿™ç¯‡æ–‡ç« ä¸»è¦æ˜¯ç”¨æ¥æ€»ç»“è‡ªå·±æ¯ç§è·¨åŸŸæŠ€æœ¯çš„å°è¯•ï¼Œå¦‚æœæœ‰å¹¸èƒ½å¸®åˆ°åˆ«äººé‚£å°±å†å¥½ä¸è¿‡äº†\n\n<!--more-->\n\n## å¤§æ¦‚\n\nè‡ªå·±ç”¨ node æ­äº†ä¸¤ä¸ªæœåŠ¡å™¨ï¼Œå‰å°è®¾ç½®çš„ç«¯å£ä¸º 3002ï¼Œæ¨¡æ‹Ÿçš„æœåŠ¡ç«¯è®¾ç½®çš„ç«¯å£ä¸º 3001\n\nè·¨åŸŸé—®é¢˜çš„å‡ºç°æ˜¯ç”±äºã€ŒåŒæºç­–ç•¥ã€å¼•èµ·çš„ï¼Œã€ŒåŒæºã€å°±æŒ‡çš„æ˜¯ä¸‰ä¸ªç›¸åŒï¼Œå³ã€Œåè®®ç›¸åŒã€ã€ã€ŒåŸŸåç›¸åŒã€ã€ã€Œç«¯å£ç›¸åŒã€ï¼Œã€ŒåŒæºç­–ç•¥ã€ä½¿å¾—ä»¥ä¸‹ä¸‰ç§è¡Œä¸ºå—åˆ°é™åˆ¶\n\n* Cookieã€LocalStorage å’Œ IndexDB æ— æ³•è·å–\n* DOM æ— æ³•è·å–\n* Ajax è¯·æ±‚æ— æ³•å‘é€\n\nå…·ä½“æƒ…å†µè¿˜è¯·ç§»æ­¥[æµè§ˆå™¨åŒæºæ”¿ç­–åŠå…¶è§„é¿æ–¹æ³•](http://www.ruanyifeng.com/blog/2016/04/same-origin-policy.html)\n\nè‡ªå·±åœ¨è¿™è¿˜æ˜¯ç¨å¾®æ€»(jie)ç»“(jian)ä¸€ä¸‹ï¼Œå†™ä¸€éåŠ æ·±ä¸€ä¸‹å°è±¡\n\n## å¯¹äº Cookie å’Œ iframe\n\nå¯¹äº Cookie å’Œ iframe ï¼Œå¦‚æœä¸¤ä¸ªç½‘é¡µä¸€çº§åŸŸåç›¸åŒï¼Œåªæ˜¯äºŒçº§åŸŸåä¸åŒï¼Œæ¯”å¦‚ `a.hutchins.com` å’Œ `b.hutchins.com` ï¼Œæµè§ˆå™¨å¯é€šè¿‡è®¾ç½®ç›¸åŒçš„ `document.domain`\n\n```js\ndocument.domain = 'hutchins.com'\n```\n\næœåŠ¡å™¨ä¹Ÿå¯ä»¥åœ¨è®¾ç½® Cookie çš„æ—¶å€™ï¼ŒæŒ‡å®š Cookie çš„æ‰€å±åŸŸåä¸ºä¸€çº§åŸŸåï¼Œæ¯”å¦‚\n\n```js\nSet-Cookie: key=value; domain=hutchins.com; path=/\n```\n\nè¿™æ ·çš„è¯äºŒçº§åŸŸåå’Œä¸‰çº§åŸŸåä¸åšä»»ä½•è®¾ç½®å°±å¯ä»¥è¯»å–è¿™ä¸ª Cookie\n\n## window.postMessage\n\nH5 å¼•å…¥äº†å…¨æ–°çš„ API :ã€Œè·¨æ–‡æ¡£é€šä¿¡ APIã€\n\n```js \notherWindow.postMessage(message, tragetOrigin);\n```\n\n* `otherWindow` çª—å£\n* `message` è¦å‘é€çš„ä¿¡æ¯\n* `targetOrigin` æŒ‡å®šå“ªäº›çª—å£å¯ä»¥æ¥å—åˆ°ä¿¡æ¯ï¼Œ`*` è¡¨ç¤ºæ— é™åˆ¶\n\næ¥æ”¶çª—å£é€šè¿‡ `message` æ–¹æ³•æ¥æ”¶\n\n```js\nwindow.addEventListener('message' function(e) {\n\n})\n```\n\n`message` çš„äº‹ä»¶å¯¹è±¡æœ‰ä»¥ä¸‹ä¸‰ä¸ªå±æ€§\n\n* event.source å‘é€æ¶ˆæ¯çš„çª—å£\n* event.origin æ¶ˆæ¯å‘å‘çš„ç½‘å€\n* event.data å‘é€çš„æ¶ˆæ¯\n\n## AJAX è·¨åŸŸ\n\n### jsonp è·¨åŸŸ\n\njsonp çš„åŸç†å°±æ˜¯åŠ¨æ€åˆ›å»º `script` æ ‡ç­¾ï¼Œç„¶åç”¨ `script` çš„ `src` å±æ€§å¼•ç”¨å¤–éƒ¨è·¨åŸŸé“¾æ¥ï¼Œé€šè¿‡**å›è°ƒå‡½æ•°å‚æ•°**æ¥å—åå°ä¼ é€’çš„ä¿¡æ¯\n\n```js\n//åŸç”Ÿjs\nvar script = document.createElement('script')\nscript.type = 'text/javascript'\n\n//ä¼ å‚å¹¶æŒ‡å®šå›è°ƒå‡½æ•°æ‰§è¡Œå‡½æ•°ä¸ºonBack\nscript.src = 'http://localhost:3001/api/jsonp?uname=hutchins&callback=onBack'\ndocument.body.appendChild(script)\n\n//å›è°ƒæ‰§è¡Œå‡½æ•°\nfunction onBack(res) {\n  console.log(JSON.stringify(res))\n}\n```\n\n```js\n//åˆ©ç”¨jquery ajax\n$.ajax({\n  url: 'http://localhost:3001/api/jsonp?uname=hutchins',\n  type: 'get',\n  dataType: 'jsonp', // è¯·æ±‚æ–¹å¼ä¸ºjsonp\n  jsonpCallback: 'onBack', // è‡ªå®šä¹‰å›è°ƒå‡½æ•°å\n  data: {},\n  success: function(data) {\n    console.log(data)\n  }\n})\n```\n\n```js\n//node åå°å¤„ç†å‰ç«¯è¯·æ±‚çš„å‡½æ•°\nmodule.exports = {\n  //jsonp\n  jsonpf: function(req, res) {\n    var params = req.query\n    var fn = req.query.callback\n\n    res.writeHead(200, { 'Content-Type': 'text/javascript' })\n    res.write(fn + '(' + JSON.stringify(params) + ')')\n    res.end()\n  }\n}\n```\n\nä½†æ˜¯ jsonp åªèƒ½æ”¯æŒ Get è¯·æ±‚\n\n### è·¨åŸŸèµ„æºå…±äº« ã€ŒCORSã€\n\nè¯·æ±‚åˆ†ä¸ºã€Œç®€å•è¯·æ±‚ã€å’Œã€Œéç®€å•è¯·æ±‚ã€ï¼Œè€Œå¤„ç†è¿™ä¸¤ç§è¯·æ±‚çš„æ–¹å¼å¾ˆä¸åŒï¼Œè¿™é‡Œåªè¯´ä¸€ä¸‹ã€Œç®€å•è¯·æ±‚ã€\n\nè¯·æ±‚æ–¹å¼ä¸ºä»¥ä¸‹å‡ ç§\n\n* HEAD\n* GET\n* POST\n\nHTTP çš„æ¶ˆæ¯å¤´ä¸è¶…å‡ºä»¥ä¸‹å‡ ç§å­—æ®µ\n\n* Accept\n* Accept-Language\n* Content-Language\n* Last-Event-ID\n* Content-Type åªé™äº application/x-www-form-ulrencodedã€multipart/form-dataã€text/plain\n\n```js\n// åŸç”Ÿjs\nvar xhr\nif (window.XMLHttpRequest) {\n  xhr = new XMLHttpRequest()\n} else {\n  xhr = new XDomainRequest() //å…¼å®¹ IE8/9\n}\n\n//å‰ç«¯è®¾ç½® cookie\nxhr.withCredentials = true\n\nxhr.open('post', 'http://localhost:3001/api/cors', true)\nxhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded')\nxhr.send('uname=hutchins')\n\nxhr.onreadystatechange = function() {\n  if (xhr.readyState == 4 && xhr.status == 200) {\n    console.log(xhr.responseText)\n  }\n}\n```\n\n```js\n//è·¨åŸŸåå°è®¾ç½®\nres.writeHead(200, {\n  'Access-Control-Allow-Credentials': 'true', //åç«¯å…è®¸å‘é€ cookie\n  'Access-Control-Allow-Origin': 'http://localhost:3002'\n  // 'Set-Cookie': 'l=a123456;Path=/;Domain=www.domain2.com;HttpOnly'  // HttpOnlyçš„ä½œç”¨æ˜¯è®©jsæ— æ³•è¯»å–cookie\n})\n\nres.write(JSON.stringify(postData))\nres.end()\n```\n","tags":["CrossDomain"],"categories":["Explore"]},{"title":"FlexDisplayRoom","url":"%2F2018%2F05%2F25%2FFlexDisplayRoom%2F","content":"\n> å‰æ®µæ—¶é—´é¢è¯•å‘ç°æœ‰å¾ˆå¤šéƒ½é—® flex å¸ƒå±€ï¼Œå°±è§‰å¾—ç°å¸¸æœ‰å¿…è¦å»å­¦ä¹ ä¸€ä¸‹ï¼Œæµè§ˆäº†ä¸€é[é˜®ä¸€å³°å¤§ç¥å†™çš„æ•™ç¨‹](http://www.ruanyifeng.com/blog/2015/07/flex-grammar.html?^%$)åæŒæ¡äº†åŸºæœ¬ç†è®ºï¼Œä½†å§‹ç»ˆè§‰å¾—åº”è¯¥å®è·µä¸€ä¸‹ï¼Œå¶ç„¶é—´çœ‹åˆ°ä¸‹é¢è¿™æ ·ä¸€ä¸ªç½‘ç«™\n\n<!--more-->\n\nhttps://demos.scotch.io/visual-guide-to-css3-flexbox-flexbox-playground/demos/ \n\n**åº”è¯¥è¦ç¿»å¢™**æ‰èƒ½è¿›å»ï¼Œè¿™ä¸ªç½‘é¡µåœ¨æ‰‹æœºç«¯éœ€è¦ä¸æ–­çš„ä¸Šä¸‹æ»‘åŠ¨ï¼Œä¸ªäººæ„Ÿè§‰æœ‰å¿…è¦ä¿®æ”¹ä¸€ä¸‹ï¼Œå°±èŒç”Ÿäº†ä¹Ÿåšä¸€ä¸ªç±»ä¼¼çš„æƒ³æ³•ï¼Œå½“ç„¶è‡ªå·±æ‰‹æœºç«¯åšçš„ä¹Ÿä¸æ˜¯é‚£ä¹ˆå¥½ï¼Œä½†æ˜¯åœ¨åšçš„è¿‡ç¨‹ä¸­ä¹Ÿå­¦åˆ°äº†ä¸€äº›é€‚åº”æ‰‹æœºç«¯çš„ä¸€äº›çŸ¥è¯†\n\n[é¡¹ç›®å±•ç¤ºåœ°å€](http://www.haoqinzz.cn/FlexDisplayRoom/)\n\n[é¡¹ç›®æºç åœ°å€](https://github.com/MLuminary/subentry/tree/master/FlexDisplayRoom)\n\n## Flex å¸ƒå±€çš„åŸºç¡€çŸ¥è¯†\n\né‡‡ç”¨ flex å¸ƒå±€çš„å…ƒç´ ï¼Œç§°ä¸º Flex å®¹å™¨ï¼Œå®ƒçš„æ‰€æœ‰å­å…ƒç´ è‡ªåŠ¨æˆä¸ºå®¹å™¨æˆå‘˜ï¼Œæˆä¸º Flex é¡¹ç›®\n\n### å®¹å™¨çš„å±æ€§\n\nä»¥ä¸‹å±æ€§ç¬¬ä¸€ä¸ªå–å€¼ä¸ºé»˜è®¤å€¼\n\n**flex-direction**\n\n- row : ä¸»è½´ä¸ºæ°´å¹³æ–¹å‘ï¼Œèµ·ç‚¹åœ¨å·¦ç«¯\n- row-reverse : ä¸»è½´ä¸ºæ°´å¹³æ–¹å‘ï¼Œèµ·ç‚¹åœ¨å³ä¾§\n- column : ä¸»è½´ä¸ºå‚ç›´æ–¹å‘ï¼Œèµ·ç‚¹åœ¨ä¸Šæ²¿\n- column-reverse : ä¸»è½´ä¸ºå‚ç›´æ–¹å‘ï¼Œèµ·ç‚¹åœ¨ä¸‹æ²¿\n\n**flex-wrap**\n\n- nowrap : ä¸æ¢è¡Œ\n- wrap : æ¢è¡Œï¼Œç¬¬ä¸€è¡Œåœ¨ä¸Šæ–¹\n- wrap-reverse: æ¢è¡Œï¼Œç¬¬ä¸€è¡Œåœ¨ä¸‹æ–¹\n\n**flex-flow**\n\n`flex-flow` æ˜¯ `flex-direction` å’Œ `flex-wrap` çš„ç®€å†™å½¢å¼ï¼Œé»˜è®¤å€¼ä¸º `row nowrap`\n\n**justify-content**\n\n- flex-start :  å·¦å¯¹é½\n- flex-end : å³å¯¹é½\n- center : å±…ä¸­\n- space-between : ä¸¤ç«¯å¯¹é½ï¼Œé¡¹ç›®ä¹‹é—´é—´éš”éƒ½ç›¸ç­‰\n- space-around : æ¯ä¸ªé¡¹ç›®ä¸¤ä¾§çš„é—´éš”ç›¸ç­‰\n\n**align-items**\n\n- stretch : å¦‚æœé¡¹ç›®æœªè®¾ç½®é«˜åº¦æˆ–è®¾ä¸º auto ï¼Œå°†å æ»¡æ•´ä¸ªå®¹å™¨çš„é«˜åº¦\n- flex-start : äº¤å‰è½´çš„èµ·ç‚¹å¯¹é½\n- flex-end : äº¤å‰è½´çš„ç»ˆç‚¹å¯¹é½\n- center : äº¤å‰è½´çš„ä¸­ç‚¹å¯¹é½\n- baseline : é¡¹ç›®çš„ç¬¬ä¸€è¡Œæ–‡å­—çš„åŸºçº¿å¯¹é½\n\n**align-content**\n\n- stretch : è½´çº¿å æ»¡æ•´ä¸ªäº¤å‰è½´\n- flex-start : ä¸äº¤å‰è½´çš„èµ·ç‚¹å¯¹é½ã€‚\n- flex-end : ä¸äº¤å‰è½´çš„ç»ˆç‚¹å¯¹é½ã€‚\n- center : ä¸äº¤å‰è½´çš„ä¸­ç‚¹å¯¹é½ã€‚\n- space-between : ä¸äº¤å‰è½´ä¸¤ç«¯å¯¹é½ï¼Œè½´çº¿ä¹‹é—´çš„é—´éš”å¹³å‡åˆ†å¸ƒã€‚\n- space-around : æ¯æ ¹è½´çº¿ä¸¤ä¾§çš„é—´éš”éƒ½ç›¸ç­‰ã€‚æ‰€ä»¥ï¼Œè½´çº¿ä¹‹é—´çš„é—´éš”æ¯”è½´çº¿ä¸è¾¹æ¡†çš„é—´éš”å¤§ä¸€å€ã€‚\n\n### é¡¹ç›®çš„å±æ€§\n\n**order**\n\nå®šä¹‰é¡¹ç›®çš„æ’åˆ—é¡ºåºï¼Œå±æ€§å€¼è¶Šå°ï¼Œæ’åˆ—è¶Šé å‰ï¼Œé»˜è®¤ä¸º 0\n\n**flex-grow**\n\nå®šä¹‰é¡¹ç›®çš„æ”¾å¤§æ¯”ä¾‹ï¼Œé»˜è®¤ä¸º 0 ï¼Œå³å¦‚æœå­˜åœ¨å‰©ä½™ç©ºé—´ä¹Ÿä¸æ”¾å¤§\n\n**flex-shrink**\n\nå®šä¹‰é¡¹ç›®çš„ç¼©å°æ¯”ä¾‹ï¼Œé»˜è®¤ä¸º 1 ï¼Œå³å¦‚æœç©ºé—´ä¸è¶³ï¼Œé¡¹ç›®å°†è‡ªåŠ¨ç¼©å°ï¼Œè´Ÿå€¼å¯¹è¯¥å±æ€§æ— æ•ˆ\n\n**flex-basis**\n\nå®šä¹‰äº†åœ¨åˆ†é…å¤šä½™ç©ºé—´ä¹‹å‰ï¼Œé¡¹ç›®å æ®çš„ä¸»è½´ç©ºé—´ã€‚é»˜è®¤å€¼ä¸º `auto` å³é¡¹ç›®æœ¬æ¥çš„å¤§å°\n\n**flex**\n\n`flex` æ˜¯ `flex-grow`ã€`flex-shrink` å’Œ `flex-basis` çš„ç®€å†™ï¼Œé»˜è®¤å€¼ä¸º `0 1 auto` \n\nè¯¥å±æ€§æœ‰ä¸¤ä¸ªå¿«æ·å€¼ : `auto`(`1 1 auto`) å’Œ `none`(`0 0 auto`)\n\n**align-self**\n\n`align-self` å…è®¸å•ä¸ªé¡¹ç›®ä¸å…¶å®ƒé¡¹ç›®æœ‰ä¸ä¸€æ ·çš„å¯¹å…¶æ–¹å¼ï¼Œå¯è¦†ç›– `align-items`ã€‚é»˜è®¤å€¼ä¸º `auto`ï¼Œè¡¨ç¤ºç»§æ‰¿çˆ¶å…ƒç´ çš„ `align-items` å±æ€§\n","tags":["Css"],"categories":["Fun"]},{"title":"æ€§æ„Ÿæ…•è¯¾-åœ¨çº¿è¢«çˆ¬","url":"%2F2018%2F05%2F20%2F%E6%80%A7%E6%84%9F%E6%85%95%E8%AF%BE-%E5%9C%A8%E7%BA%BF%E8%A2%AB%E7%88%AC%2F","content":"\n> åœ¨å­¦ä¹ äº† alsotang å¤§ç¥çš„ ã€ŠNode.jsåŒ…æ•™ä¸åŒ…ä¼šã€‹åçš„ä¸€ä¸ªçˆ¬è™«å°ç»ƒä¹ ï¼ŒæœŸé—´ä¹Ÿç¢°åˆ°æŒºå¤šå°é—®é¢˜ï¼Œä¹Ÿå­¦åˆ°äº†å¾ˆå¤šå°ä¸œè¥¿ã€‚ã€Œ å•æŠ¼Ã—3 ã€:trollface: <br> è¿™é‡Œæ˜¯å¤§ç¥çš„æ•™ç¨‹åœ°å€ https://github.com/alsotang/node-lessonsï¼Œ\n\n<!--more-->\n\nä¸‹é¢æ˜¯è‡ªå·±çš„çˆ¬å–æ•ˆæœå›¾\n\n![spider2](æ€§æ„Ÿæ…•è¯¾-åœ¨çº¿è¢«çˆ¬/spider2.png)\n\n[imoocSpiderç»ƒä¹ æºç ](https://github.com/MLuminary/subentry/blob/master/easySpider/imoocSpider/app.js)\n\n\n## æ­å»ºæœåŠ¡å™¨\n\né¦–å…ˆï¼Œæ­å»ºä¸€ä¸ª http æœåŠ¡\n\n```js\nvar http = require('http')\nvar express = require('express')\n\nvar app = express()\n\nhttp.createServer(app).listen(8080)\n\napp.get('/', function(req, res) {\n  //code here...\n})\n```\n\nç”¨çš„æ˜¯ `express` æ­å»ºçš„ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ç”¨åŸç”Ÿçš„ï¼Œåœ¨è¿™é‡Œè‡ªå·±æ¯”è¾ƒä¹ æƒ¯ç”¨ [express](http://www.expressjs.com.cn/)\n\n## åœ¨çº¿çˆ¬è™«\n\nåœ¨è¿™é‡Œç”¨åˆ°çš„æ˜¯ `superagent` å’Œ `cheerio` æ¥çˆ¬å–é¡µé¢ï¼Œè¿™é‡Œæœ‰ç›¸å…³æ–‡æ¡£å¯ä»¥å‚è€ƒ: [superagentä¸­æ–‡æ–‡æ¡£](https://cnodejs.org/topic/5378720ed6e2d16149fa16bd)ã€[cheerio](https://cnodejs.org/topic/5203a71844e76d216a727d2e)ï¼Œéƒ½æ˜¯æ¥è‡ª cnode ç¤¾åŒºï¼Œå½“ç„¶è‹±è¯­èƒ½åŠ›è¾ƒå¥½çš„ä¹Ÿå¯ä»¥å‚è€ƒåŸæ–‡æ¡£ã€‚åœ¨è¿™é‡Œå°±åªè´´å‡ºè¿™ä¸¤ä¸ª\n\nçˆ¬å–é¡µé¢é“¾æ¥ https://www.imooc.com/course/list?c=fe\n\næˆ‘ä»¬æ˜¯è¦çˆ¬å–æ…•è¯¾ç½‘å‰ç«¯å¼€å‘å…«ä¸ªé¡µé¢çš„è¯¾ç¨‹ä¸­çš„ä¸€äº›ä¿¡æ¯ï¼Œä½†æ˜¯æ‰“å¼€æ­¤é“¾æ¥å‘ç°æ¯ä¸ªé¡µé¢åªæœ‰è¯¾ç¨‹çš„åç§°ï¼Œå¹¶æ²¡æœ‰è€å¸ˆçš„åç§°å’Œä¸€äº›è¯¾ç¨‹çš„ä¸»è¦ä¿¡æ¯ã€‚å› æ­¤æˆ‘ä»¬è¿˜éœ€è¦è·å–å¹¶æ ¹æ®æ¯ä¸ªè¯¾ç¨‹çš„ url è¿›è¡Œçˆ¬å–ã€‚\n\n**è·å–è¯¾ç¨‹è¯¦æƒ…é¡µé“¾æ¥**\n\né‚£æˆ‘ä»¬å…ˆæ¥çˆ¬å–å…«ä¸ªé¡µé¢çš„æ‰€æœ‰è¯¾ç¨‹è¯¦æƒ…é¡µçš„ `url`\n\né€šè¿‡ç‚¹å‡»å¯¹åº”é¡µé¢çš„æŒ‰é’®ï¼Œå‘ç°æ¯æ¬¡éƒ½ä¼šå‘é€ä¸€ä¸ªæ–°çš„ get è¯·æ±‚ï¼Œè¯·æ±‚çš„é“¾æ¥å°±æ˜¯å¯¹åº”çš„é¡µé¢ï¼Œè€Œè¿™é‡Œçš„é“¾æ¥åªæœ‰ `page` å±æ€§æ˜¯ä¸åŒçš„ï¼Œå› æ­¤æˆ‘ä»¬é€šè¿‡åŠ¨æ€æ”¹å˜ `page` å°±å¯ä»¥æ¨¡æ‹Ÿç‚¹å‡»å¯¹åº”é¡µæ¥è·å–å¯¹åº”é¡µçš„ä¿¡æ¯\n\n```js\nvar pages = 1\nvar baseUrl = 'https://www.imooc.com/course/list/'\n\nvar params = {\n  c: 'fe',\n  page: page\n}\n\nsuperagent\n  .get(baseUrl)\n  .query(params)\n  .end(function(err, content) {\n    var topicUrls = []\n    var $ = cheerio.load(content.text)\n    var courseCard = $('.course-card-container')\n    courseCard.each(function(index, element) {\n      var $element = $(element)\n      var href = url.resolve(\n        homeUrl,\n        $element.find('.course-card').attr('href')\n      )\n\n      topicUrls.push(href)\n    })\n    console.log(topicUrls)\n  })\n```\n\nè¿™æ ·å°±å¯ä»¥è·å–åˆ°äº†ç¬¬ä¸€ä¸ªé¡µé¢çš„ 25 ä¸ªè¯¾ç¨‹çš„è¯¦æƒ…é¡µçš„ urlï¼Œé‚£è¦å¦‚ä½•è·å–å…«ä¸ªé¡µé¢å‘¢ã€‚\n\n**async**\n\nå› ä¸ºæœ‰äº›ç½‘ç«™é€šå¸¸éƒ½ä¼šæœ‰å®‰å…¨é™åˆ¶ï¼Œä¸ä¼šå…è®¸åŒä¸€ä¸ªåŸŸåæœ‰è¿‡å¤§çš„é«˜å¹¶å‘æ•°ï¼Œå› æ­¤éœ€è¦é™åˆ¶å¹¶å‘æ•°ï¼Œåœ¨è¿™é‡Œç”¨æˆ‘ä»¬ç”¨åˆ°äº† `async` è¿™ä¸ªåº“ã€‚è¿™é‡Œæ˜¯å…¶ [github](https://github.com/caolan/async)\n\næˆ‘ä»¬é¦–å…ˆæŠŠå‰é¢ä»£ç å°è£…æˆä¸€ä¸ªå‡½æ•°\n\n```js\nvar baseUrl = 'https://www.imooc.com/course/list/'\nvar fetchUrl = function(page, callback) {\n    count++\n    console.log('å½“å‰å¹¶å‘æ•°', count)\n\n    var params = {\n      c: 'fe',\n      page: page\n    }\n\n    superagent\n      .get(baseUrl)\n      .query(params)\n      .end(function(err, content) {\n        var topicUrls = []\n        var $ = cheerio.load(content.text)\n        var courseCard = $('.course-card-container')\n        courseCard.each(function(index, element) {\n          var $element = $(element)\n          var href = url.resolve(\n            homeUrl,\n            $element.find('.course-card').attr('href')\n          )\n\n          topicUrls.push(href)\n        })\n\n        callback(err, topicUrls)\n        count--\n        console.log('é‡Šæ”¾å¹¶å‘æ•°åå½“å‰å¹¶å‘æ•°', count)\n        \n      })\n  }\n```\n\nç„¶åç”¨ `async` æ§åˆ¶å¹¶å‘æ•°å’Œå…«ä¸ªé¡µé¢çš„æŠ“å–\n\n```js\nvar pages = [1, 2, 3, 4, 5, 6, 7, 8]\nasync.mapLimit(\n    pages, \n    5,\n    function(page, callback) {\n      fetchUrl(page, callback)\n    },\n    function(err, result) {\n      if (err) console.log(err)\n\n      console.log(result)\n    }\n  )\n})\n```\n\nè¿™æ ·æ‰€æœ‰çš„ url å°±è¢«æ‰“å°å‡ºæ¥ï¼Œè¿™é‡Œè¦æ³¨æ„ä¸€ä¸‹ï¼Œ`async` ä¼šè‡ªåŠ¨æŠŠç¬¬ä¸‰ä¸ªå‡½æ•°å‚æ•°çš„è¿”å›å€¼åˆå¹¶æˆä¸€ä¸ªæ•°ç»„ç»™ç¬¬å››ä¸ªå‡½æ•°å‚æ•°çš„ `result` å‚æ•°ã€‚åˆšå¼€å§‹å†™çš„æ—¶å€™æˆ‘æŠŠ `topicUrls` å£°æ˜åœ¨äº†å…¨å±€ï¼Œä»¥è‡³äºè¿”å›æˆä¸‹é¢è¿™ç»„æ•°æ®\n\n![spider1](æ€§æ„Ÿæ…•è¯¾-åœ¨çº¿è¢«çˆ¬/spider1.png)\n\n**çˆ¬å–è¯¾ç¨‹è¯¦æƒ…é¡µçš„ä¿¡æ¯**\n\nåœ¨æˆ‘ä»¬æœ‰äº†æ‰€æœ‰è¯¾ç¨‹è¯¦æƒ…é¡µçš„ url åï¼Œæˆ‘ä»¬å¼€å§‹çˆ¬å–é‡Œé¢çš„å†…å®¹ã€‚é¦–å…ˆå®šä¹‰ä¸€ä¸ªå‡½æ•°\n\n```js\nvar fetchMsg = function(topicUrl, callback) {\n    console.log('å¼€å¯æ–°ä¸€è½®æŠ“å–')\n    superagent\n      .get(topicUrl)\n      .end(function(err, content){\n        var Item = []\n        var $ = cheerio.load(content.text)\n        var title = $('.hd .l').text().trim()//è¯¾ç¨‹åå­—\n        var teacher = $('.tit a').text().trim()//è€å¸ˆåå­—\n        var level = $('.meta-value').eq(0).text().trim()//éš¾åº¦\n        var time = $('.meta-value').eq(1).text().trim()//æ—¶é•¿\n        var number = $('.meta-value').eq(2).text().trim()//å­¦ä¹ äººæ•°\n        var grade = $('.meta-value').eq(3).text().trim()//è¯„åˆ†\n\n        Item.push({\n          title: title,\n          teacher: teacher,\n          level: level,\n          time: time,\n          number: number,\n          grade: grade,\n          href: topicUrl\n        })\n\n\n        callback(null, Item)\n      })\n  }\n```\n\nç„¶åç”¨ `async` æ§åˆ¶å¹¶å‘çˆ¬å–\n\n```js\n//result ä¸ºä¸Šæ–‡ä¸­çš„ resultï¼Œä¸‹é¢çš„ä»£ç ä¹Ÿéƒ½æ˜¯åœ¨ä¸Šæ–‡ä¸­çš„ç¬¬å››ä¸ªå‚æ•°ä¸­\n\nvar topicUrls = result //è·å–æ‰€æœ‰ url ï¼Œä½†æ˜¯å¤§æ•°ç»„é‡Œé¢æœ‰ 8 ä¸ªå°æ•°ç»„\n\nvar Urls = []\n//å°†å¤§æ•°ç»„åˆå¹¶\nfor(let i=0,l=topicUrls.lengthi<li++){\n  Urls = Urls.concat(topicUrls[i])\n}\n\nasync.mapLimit(\n  Urls,\n  5,\n  function(url,callback){\n    fetchMsg(url, callback)\n  },\n  function(err, result) {\n    //é¿å…ä¹±ç \n    res.writeHead(200, {'Content-Type': 'text/plaincharset=utf8'})\n    res.end(JSON.stringify(result))\n  }\n```\n\nè¿™é‡Œè¦æ³¨æ„ä¸€ä¸ªå°é—®é¢˜ï¼Œå°±æ˜¯ `result` è·å–åˆ°çš„ url ç»“æ„æ˜¯ä¸€ä¸ªå¤§æ•°ç»„é‡Œé¢åŒ…å«å…«ä¸ªå°æ•°ç»„ï¼Œå› æ­¤éœ€è¦å°†å…¶å°æ•°ç»„å…ˆåˆå¹¶æˆä¸€ä¸ªå¤§æ•°ç»„ã€‚\n\n## æœ€å\n\né™„ä¸Š[é¡¹ç›®æºç ](https://github.com/MLuminary/subentry/blob/master/easySpider/imoocSpider/app.js)\n","tags":["Node"],"categories":["Fun"]},{"title":"ä»Šå¤©è¿™ä¸ªä»‡å…ˆè®°ä¸‹æ¥äº†","url":"%2F2018%2F05%2F17%2F%E4%BB%8A%E5%A4%A9%E8%BF%99%E4%B8%AA%E4%BB%87%E5%85%88%E8%AE%B0%E4%B8%8B%E6%9D%A5%2F","content":"\n![jichou](ä»Šå¤©è¿™ä¸ªä»‡å…ˆè®°ä¸‹æ¥/jichou.jpg)\n\n<!--more-->\n\næœ€è¿‘è¿™ä¸ªè®°ä»‡å›¾ç‰‡åœ¨æˆ‘çš„ä¸€äº›ç¾¤é‡Œå‡ºç°æ¬¡æ•°ç›¸å½“é«˜ï¼Œæœ‹å‹ä»¬éƒ½ä¼šå»ç”¨ä¿®å›¾è½¯ä»¶å»æ”¹ä¸‹é¢çš„æ–‡å­—ï¼Œä½œä¸ºä¸€ä¸ªå‰ç«¯å…šå°±åœ¨æƒ³èƒ½ä¸èƒ½æ›´åŠ ä¾¿åˆ©ä¸€ç‚¹ï¼Œä¸€å¼€å§‹æƒ³ç”¨ `canvas` å»ç”»æ–‡å­—ï¼Œåæ¥å°±å¶ç„¶æœåˆ°äº† [html2canvas](http://html2canvas.hertzen.com/)ï¼Œæ˜¯ä¸€æ¬¾æˆªå›¾å·¥å…·ï¼Œé‚£è¿™æ ·å°±æ–¹ä¾¿å¤šäº†ã€‚\n\n## å®ç°\n\n![anpai](ä»Šå¤©è¿™ä¸ªä»‡å…ˆè®°ä¸‹æ¥/anpai.jpg)\n\nå…·ä½“å®ç°æ–¹å¼å°±æ˜¯åˆ©ç”¨ html2canvas å¯¹ä¸€ä¸ª Div è¿›è¡Œæˆªå›¾ï¼Œåœ¨è¿™ä¸ª Div é‡Œæœ‰è®°ä»‡çš„å›¾ç‰‡å’Œå¯ç¼–è¾‘çš„æ–‡æœ¬æ¡†ï¼Œç„¶åå†åœ¨ä¸‹é¢å±•ç¤ºå¹¶ä¸‹è½½ä¸‹æ¥å°±é˜”ä»¥äº†ï¼Œè¿™éƒ¨åˆ†æ¶‰åŠåˆ°äº† base64 å›¾ç‰‡çš„ä¸‹è½½ï¼Œä¹Ÿæ˜¯å€Ÿç”¨äº† segmentFault ä¸Š[å¤§ç¥çš„ä»£ç ](https://segmentfault.com/q/1010000005816241) \n\n[ä½“éªŒåœ°å€](http://www.haoqinzz.cn/jichou/)\n[é¡¹ç›®åœ°å€](https://github.com/MLuminary/subentry/tree/master/%E4%BB%8A%E5%A4%A9%E8%BF%99%E4%B8%AA%E4%BB%87%E5%85%88%E8%AE%B0%E4%B8%8B%E6%9D%A5)\n[æ›´å¤š](https://www.v2ex.com/t/455984#reply42)","tags":["Canvas"],"categories":["Fun"]},{"title":"è®¾ç½® babel","url":"%2F2018%2F02%2F18%2F%E8%AE%BE%E7%BD%AEbabel%2F","content":"\n> é…ç½® babel æ¥å…¼å®¹ es6\n\n<!--more-->\n\n### é…ç½® .babelrc\n\nBabel çš„é…ç½®æ–‡ä»¶æ˜¯ `.babelrc` ï¼Œå­˜æ”¾åœ¨æ ¹ç›®å½•ä¸‹ã€‚ä½¿ç”¨ babel å¿…é¡»è¦é…ç½®æ­¤æ–‡ä»¶\n\nè¯¥æ–‡ä»¶ç”¨æ¥è®¾ç½®è½¬ç è§„åˆ™å’Œæ’ä»¶\n\n```js\n{\n  \"presets\":[],\n  \"plugins\":[]\n}\n```\n\n`presets` ä¸ºç¼–ç è§„åˆ™ ï¼Œå®˜æ–¹æ¨è\n\n```shell\n$ npm install --save-dev babel-preset-env\n```\n\nåœ¨æ²¡æœ‰ä»»ä½•é…ç½®é€‰é¡¹çš„æƒ…å†µä¸‹ï¼Œ`babel-preset-env` ä¸ `babel-preset-latest`ï¼ˆæˆ–è€… `babel-preset-es2015`ï¼Œ`babel-preset-es2016` å’Œ `babel-preset-es2017` ä¸€èµ·ï¼‰çš„è¡Œä¸ºå®Œå…¨ç›¸åŒã€‚\n\nç„¶åå°† `babel-preset-env` åŠ å…¥è§„åˆ™\n\n```js\n{\n  \"presets\":[\"env\"]\n}\n```\n\n### babel-cli\n\nå®‰è£…å‘½ä»¤å¦‚ä¸‹\n\n```shell\n$ npm install --save-dev babel-cli\n```\n\nå¸¸ç”¨å‘½ä»¤\n\n```shell\n# è½¬ç ç»“æœè¾“å‡ºåˆ°æ ‡å‡†è¾“å‡º\n$ babel example.js\n\n# è½¬ç ç»“æœå†™å…¥ä¸€ä¸ªæ–‡ä»¶\n# --out-file æˆ– -o å‚æ•°æŒ‡å®šè¾“å‡ºæ–‡ä»¶\n$ babel example.js --out-file compiled.js\n# æˆ–è€…\n$ babel example.js -o compiled.js\n\n# æ•´ä¸ªç›®å½•è½¬ç \n# --out-dir æˆ– -d å‚æ•°æŒ‡å®šè¾“å‡ºç›®å½•\n$ babel src --out-dir lib\n# æˆ–è€…\n$ babel src -d lib\n\n# -s å‚æ•°ç”Ÿæˆsource mapæ–‡ä»¶\n$ babel src -d lib -s\n```\n\næ–¹é¢ä½¿ç”¨çš„è¯å¯ä»¥æ”¹å†™ `package.json` çš„æ–‡ä»¶\n\n```js\n{\n  //...\n  \"devDependencies\": {\n    \"babel-cli\": \"^6.0.0\"\n  },\n  \"scripts\": {\n    \"build\": \"babel src -d lib\"\n  }\n}\n```\n\nè¿è¡Œä¸€ä¸‹ä»£ç \n\n```shell\n$ npm run build\n```\n\nå³å¯å°† `src` ç›®å½•ä¸‹çš„æ–‡ä»¶è½¬æ¢ï¼Œç”Ÿæˆäº `lib` ç›®å½•ä¸­çš„åŒåæ–‡ä»¶\n\n### babel-node\n\n`babel-cli` æä¾›ä¸€ä¸ª `babel-node` å‘½ä»¤ï¼Œæä¾›ä¸€ä¸ªæ”¯æŒ ES6 çš„ REPL ç¯å¢ƒã€‚\n\n> REPL(Read-eval-print-loop)ï¼šäº¤äº’å¼è§£æå™¨ï¼Œåœ¨REPLç¯å¢ƒä¸‹ï¼Œå¯ä»¥å®šä¹‰å’Œè¿è¡Œå˜é‡ã€å‡½æ•°ã€å¯¹è±¡ã€‚è¿›å…¥ node å³è¿›å…¥REPL\n\næ‰§è¡Œ `babel-node` å³è¿›å…¥ç¯å¢ƒï¼Œæ‰§è¡Œ `babel-node ES6.js` å¯ä»¥ç›´æ¥è¿è¡Œ `ES6.js` è¿™ä¸ª ES6 è„šæœ¬\n\n### babel-register\n\n`babel-register` æ¨¡å—æ”¹å†™ `require` å‘½ä»¤ï¼Œä¸ºå®ƒåŠ ä¸Šä¸€ä¸ªé’©å­ã€‚æ­¤åï¼Œæ¯å½“ä½¿ç”¨ `require` åŠ è½½ `.js`ã€`.jsx`ã€`.es` å’Œ `.es6` åç¼€åçš„æ–‡ä»¶ï¼Œå°±ä¼šå…ˆç”¨ Babel è¿›è¡Œè½¬ç ã€‚\n\n```shell\n$ npm install --save-dev babel-register\n```\n\nä½¿ç”¨æ—¶å¿…é¡»å…ˆåŠ è½½ `babel-register`\n\n```js\nrequire(\"babel-register\");\nrequire(\"./index.js\");\n```\n\nç”±äºå®ƒæ˜¯å®æ—¶è½¬ç ï¼Œæ‰€ä»¥åªé€‚åˆåœ¨å¼€å‘ç¯å¢ƒä½¿ç”¨ã€‚\n\n### babel-core\n\nå¦‚æœæŸäº›ä»£ç éœ€è¦è°ƒç”¨ Babel çš„ API è¿›è¡Œè½¬ç ï¼Œå°±è¦ä½¿ç”¨ `babel-core` æ¨¡å—ã€‚\n\n```shell\n$ npm install babel-core --save\n```\n\nå…·ä½“è°ƒç”¨æœ‰å®˜æ–¹æ–‡æ¡£çš„ä»‹ç» http://babeljs.io/docs/usage/api/\n\n**ä¸¾ä¸ªæ —å­**\n\n```js\nvar es6Code = 'let x = n => n + 1';\nvar es5Code = require('babel-core')\n  .transform(es6Code, {\n    presets: ['es2015']\n  })\n  .code;\n// '\"use strict\";\\n\\nvar x = function x(n) {\\n  return n + 1;\\n};'\n```\n\n### babel-polyfill\n\nBabelé»˜è®¤åªè½¬æ¢æ–°çš„JavaScriptå¥æ³•ï¼ˆsyntaxï¼‰ï¼Œè€Œä¸è½¬æ¢æ–°çš„APIï¼Œæ¯”å¦‚Iteratorã€Generatorã€Setã€Mapsã€Proxyã€Reflectã€Symbolã€Promiseç­‰å…¨å±€å¯¹è±¡ï¼Œä»¥åŠä¸€äº›å®šä¹‰åœ¨å…¨å±€å¯¹è±¡ä¸Šçš„æ–¹æ³•ï¼ˆæ¯”å¦‚Object.assignï¼‰éƒ½ä¸ä¼šè½¬ç ã€‚\n\nä¸¾ä¾‹æ¥è¯´ï¼ŒES6åœ¨Arrayå¯¹è±¡ä¸Šæ–°å¢äº† `Array.from` æ–¹æ³•ã€‚Babelå°±ä¸ä¼šè½¬ç è¿™ä¸ªæ–¹æ³•ã€‚å¦‚æœæƒ³è®©è¿™ä¸ªæ–¹æ³•è¿è¡Œï¼Œå¿…é¡»ä½¿ç”¨ `babel-polyfill` ï¼Œä¸ºå½“å‰ç¯å¢ƒæä¾›ä¸€ä¸ªå«ç‰‡ã€‚\n\n```shell\n$ npm install --save babel-polyfill\n```\n\nç„¶åï¼Œåœ¨è„šæœ¬å¤´éƒ¨ï¼ŒåŠ å…¥å¦‚ä¸‹ä¸€è¡Œä»£ç ã€‚\n\n```js\nimport 'babel-polyfill';\n// æˆ–è€…\nrequire('babel-polyfill');\n```\n\nBabelé»˜è®¤ä¸è½¬ç çš„APIéå¸¸å¤šï¼Œè¯¦ç»†æ¸…å•å¯ä»¥æŸ¥çœ‹ `babel-plugin-transform-runtime` æ¨¡å—çš„definitions.jsæ–‡ä»¶ã€‚\n\n### åœ¨çº¿è½¬æ¢\n\nhttps://babeljs.io/repl/","tags":["ES6"],"categories":["Note"]},{"title":"LeanJsã€Œ ES6 ã€-- Module çš„åŠ è½½å®ç°","url":"%2F2018%2F02%2F17%2FLeanJSModule%E7%9A%84%E5%8A%A0%E8%BD%BD%E5%AE%9E%E7%8E%B0%2F","content":"\n![Js](LeanJSModuleçš„åŠ è½½å®ç°/js.png)\n\n<!--more-->\n\n## æµè§ˆå™¨åŠ è½½\n\n### ä¼ ç»Ÿæ–¹æ³•\n\n```html\n<!-- é¡µé¢å†…åµŒçš„è„šæœ¬ -->\n<script type=\"application/javascript\">\n  // module code\n</script>\n\n<!-- å¤–éƒ¨è„šæœ¬ -->\n<script type=\"application/javascript\" src=\"path/to/myModule.js\">\n</script>\n```\n\né»˜è®¤æƒ…å†µä¸‹ï¼Œæµè§ˆå™¨æ˜¯åŒæ­¥åŠ è½½ JavaScript è„šæœ¬ï¼Œå½“ç¢°åˆ°è„šæœ¬ä½“ç§¯è¿‡å¤§ï¼Œå°±ä¼šé€ æˆæµè§ˆå™¨å µå¡ã€‚\n\nå½“ç„¶ï¼Œæµè§ˆå™¨å…è®¸è„šæœ¬å¼‚æ­¥åŠ è½½\n\n```js\n<script src=\"path/to/myModule.js\" defer></script>\n<script src=\"path/to/myModule.js\" async></script>\n```\n\n`<script>` æ ‡ç­¾æ‰“å¼€ `defer` æˆ– `async` å±æ€§ï¼Œè„šæœ¬å°±ä¼šå¼‚æ­¥åŠ è½½ã€‚æ¸²æŸ“å¼•æ“é‡åˆ°è¿™ä¸€è¡Œå‘½ä»¤ï¼Œå°±ä¼šå¼€å§‹ä¸‹è½½å¤–éƒ¨è„šæœ¬ï¼Œä½†ä¸ä¼šç­‰å®ƒä¸‹è½½å’Œæ‰§è¡Œï¼Œè€Œæ˜¯ç›´æ¥æ‰§è¡Œåé¢çš„å‘½ä»¤ã€‚\n\n`defer` æ˜¯ã€Œæ¸²æŸ“å®Œå†æ‰§è¡Œã€ï¼Œ`async` æ˜¯ã€Œä¸‹è½½å®Œå°±æ‰§è¡Œã€\n\n### åŠ è½½è§„åˆ™\n\næµè§ˆå™¨åŠ è½½ ES6 æ¨¡å—ï¼Œä¹Ÿä½¿ç”¨ `<script>` æ ‡ç­¾ï¼Œä½†æ˜¯è¦åŠ å…¥ `type=\"module\"` å±æ€§\n\n```js\n<script type=\"module\" src=\"./foo.js\"></script>\n```\n\næµè§ˆå™¨å¯¹äºæœ‰ `type=\"module\"` çš„ `<script>` éƒ½ä¼šå¼‚æ­¥åŠ è½½ï¼Œç›¸å½“äºæ·»åŠ äº† `defer` å±æ€§\n\nå¯¹äºå¤–éƒ¨çš„æ¨¡å—è„šæœ¬ï¼Œæœ‰å‡ ç‚¹éœ€è¦æ³¨æ„ã€‚\n\n- ä»£ç æ˜¯åœ¨æ¨¡å—ä½œç”¨åŸŸä¹‹ä¸­è¿è¡Œï¼Œè€Œä¸æ˜¯åœ¨å…¨å±€ä½œç”¨åŸŸè¿è¡Œã€‚æ¨¡å—å†…éƒ¨çš„é¡¶å±‚å˜é‡ï¼Œå¤–éƒ¨ä¸å¯è§ã€‚\n- æ¨¡å—è„šæœ¬è‡ªåŠ¨é‡‡ç”¨ä¸¥æ ¼æ¨¡å¼ï¼Œä¸ç®¡æœ‰æ²¡æœ‰å£°æ˜ `use strict`ã€‚\n- æ¨¡å—ä¹‹ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ `import` å‘½ä»¤åŠ è½½å…¶ä»–æ¨¡å—ï¼ˆ`.js`åç¼€ä¸å¯çœç•¥ï¼Œéœ€è¦æä¾›ç»å¯¹ URL æˆ–ç›¸å¯¹ URLï¼‰ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ `export` å‘½ä»¤è¾“å‡ºå¯¹å¤–æ¥å£ã€‚\n- æ¨¡å—ä¹‹ä¸­ï¼Œé¡¶å±‚çš„ `this` å…³é”®å­—è¿”å› `undefined`ï¼Œè€Œä¸æ˜¯æŒ‡å‘ `window`ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨æ¨¡å—é¡¶å±‚ä½¿ç”¨ `this` å…³é”®å­—ï¼Œæ˜¯æ— æ„ä¹‰çš„ã€‚\n- åŒä¸€ä¸ªæ¨¡å—å¦‚æœåŠ è½½å¤šæ¬¡ï¼Œå°†åªæ‰§è¡Œä¸€æ¬¡ã€‚\n\n## ES6 æ¨¡å—ä¸ CommonJs æ¨¡å—çš„å·®å¼‚\n\n**CommonJS æ¨¡å—è¾“å‡ºçš„æ˜¯ä¸€ä¸ªå€¼çš„æ‹·è´ï¼ŒES6 æ¨¡å—è¾“å‡ºçš„æ˜¯å€¼çš„å¼•ç”¨**ã€‚\n\n**CommonJS æ¨¡å—æ˜¯è¿è¡Œæ—¶åŠ è½½ï¼ŒES6 æ¨¡å—æ˜¯ç¼–è¯‘æ—¶è¾“å‡ºæ¥å£ã€‚**\n\nCommonJS æ¨¡å—è¾“å‡ºçš„æ˜¯å€¼çš„æ‹·è´ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€æ—¦è¾“å‡ºä¸€ä¸ªå€¼ï¼Œæ¨¡å—å†…éƒ¨çš„å˜åŒ–å°±å½±å“ä¸åˆ°è¿™ä¸ªå€¼ã€‚è¯·çœ‹ä¸‹é¢è¿™ä¸ªæ¨¡å—æ–‡ä»¶ `lib.js` çš„ä¾‹å­ã€‚\n\n```js\n// lib.js\nvar counter = 3;\nfunction incCounter() {\n  counter++;\n}\nmodule.exports = {\n  counter: counter,\n  incCounter: incCounter,\n};\n```\n\nä¸Šé¢ä»£ç è¾“å‡ºå†…éƒ¨å˜é‡ `counter` å’Œæ”¹å†™è¿™ä¸ªå˜é‡çš„å†…éƒ¨æ–¹æ³• `incCounter`ã€‚ç„¶åï¼Œåœ¨ `main.js`  é‡Œé¢åŠ è½½è¿™ä¸ªæ¨¡å—ã€‚\n\n```js\n// main.js\nvar mod = require('./lib');\n\nconsole.log(mod.counter);  // 3\nmod.incCounter();\nconsole.log(mod.counter); // 3\n```\n\nä¸Šé¢ä»£ç è¯´æ˜ï¼Œ`lib.js` æ¨¡å—åŠ è½½ä»¥åï¼Œå®ƒçš„å†…éƒ¨å˜åŒ–å°±å½±å“ä¸åˆ°è¾“å‡ºçš„ `mod.counter` äº†ã€‚è¿™æ˜¯å› ä¸º `mod.counter` æ˜¯ä¸€ä¸ªåŸå§‹ç±»å‹çš„å€¼ï¼Œä¼šè¢«ç¼“å­˜ã€‚é™¤éå†™æˆä¸€ä¸ªå‡½æ•°ï¼Œæ‰èƒ½å¾—åˆ°å†…éƒ¨å˜åŠ¨åçš„å€¼ã€‚\n\nES6 æ¨¡å—è¿è¡Œæœºåˆ¶ä¸ CommomJs ä¸ä¸€æ ·.ES6 çš„æ¨¡å—æ˜¯åŠ¨æ€å¼•ç”¨ï¼Œå¹¶ä¸”ä¸ä¼šç¼“å­˜\n\n```js\n// lib.js\nexport let counter = 3;\nexport function incCounter() {\n  counter++;\n}\n\n// main.js\nimport { counter, incCounter } from './lib';\nconsole.log(counter); // 3\nincCounter();\nconsole.log(counter); // 4\n```\n\n## Node åŠ è½½\n\n### æ¦‚è¿°\n\nNode å¯¹ ES6 æ¨¡å—çš„å¤„ç†æ¯”è¾ƒéº»çƒ¦ï¼Œå› ä¸ºå®ƒæœ‰è‡ªå·±çš„ CommonJS æ¨¡å—æ ¼å¼ï¼Œä¸ ES6 æ¨¡å—æ ¼å¼æ˜¯ä¸å…¼å®¹çš„ã€‚ç›®å‰è§£å†³æ–¹æ¡ˆæ˜¯å°†ä¸¤è€…åˆ†å¼€\n\nNode è¦æ±‚ ES6 æ¨¡å—é‡‡ç”¨ `.mjs` åç¼€æ–‡ä»¶åã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåªè¦è„šæœ¬æ–‡ä»¶é‡Œé¢ä½¿ç”¨ `import` æˆ–è€… `export` å‘½ä»¤ï¼Œé‚£ä¹ˆå°±å¿…é¡»é‡‡ç”¨ `.mjs` åç¼€åã€‚`require` å‘½ä»¤ä¸èƒ½åŠ è½½ `.mjs` æ–‡ä»¶ï¼Œä¼šæŠ¥é”™ï¼Œåªæœ‰ `import` å‘½ä»¤æ‰å¯ä»¥åŠ è½½ `.mjs` æ–‡ä»¶ã€‚åè¿‡æ¥ï¼Œ`.mjs` æ–‡ä»¶é‡Œé¢ä¹Ÿä¸èƒ½ä½¿ç”¨ `require` å‘½ä»¤ï¼Œå¿…é¡»ä½¿ç”¨ `import`ã€‚\n\nç›®å‰ï¼Œè¿™é¡¹åŠŸèƒ½è¿˜åœ¨è¯•éªŒé˜¶æ®µã€‚å®‰è£… `Node v8.5.0` æˆ–ä»¥ä¸Šç‰ˆæœ¬ï¼Œè¦ç”¨ `--experimental-modules` å‚æ•°æ‰èƒ½æ‰“å¼€è¯¥åŠŸèƒ½ã€‚\n\n```shell\n$ node --experimental-modules my-app.mjs \n```\n\nå¦‚æœæ¨¡å—åä¸å«è·¯å¾„ï¼Œé‚£ä¹ˆ `import` å‘½ä»¤ä¼šå» `node_modules` ç›®å½•å¯»æ‰¾è¿™ä¸ªæ¨¡å—ã€‚\n\n```js\nimport 'baz';\nimport 'abc/123';\n```\n\nå¦‚æœæ¨¡å—ååŒ…å«è·¯å¾„ï¼Œé‚£ä¹ˆ `import` å‘½ä»¤ä¼šæŒ‰ç…§è·¯å¾„å»å¯»æ‰¾è¿™ä¸ªåå­—çš„è„šæœ¬æ–‡ä»¶ã€‚\n\n```js\nimport 'file:///etc/config/app.json';\nimport './foo';\nimport './foo?search';\nimport '../bar';\nimport '/baz';\n```\n\nå¦‚æœè„šæœ¬æ–‡ä»¶çœç•¥äº†åç¼€åï¼Œæ¯”å¦‚ `import './foo'`ï¼ŒNode ä¼šä¾æ¬¡å°è¯•å››ä¸ªåç¼€åï¼š`./foo.mjs`ã€`./foo.js`ã€`./foo.json`ã€`./foo.node`ã€‚å¦‚æœè¿™äº›è„šæœ¬æ–‡ä»¶éƒ½ä¸å­˜åœ¨ï¼ŒNode å°±ä¼šå»åŠ è½½ `./foo/package.json` çš„ `main` å­—æ®µæŒ‡å®šçš„è„šæœ¬ã€‚å¦‚æœ `./foo/package.json` ä¸å­˜åœ¨æˆ–è€…æ²¡æœ‰ `main` å­—æ®µï¼Œé‚£ä¹ˆå°±ä¼šä¾æ¬¡åŠ è½½ `./foo/index.mjs`ã€`./foo/index.js`ã€`./foo/index.json` ã€ `./foo/index.node` ã€‚å¦‚æœä»¥ä¸Šå››ä¸ªæ–‡ä»¶è¿˜æ˜¯éƒ½ä¸å­˜åœ¨ï¼Œå°±ä¼šæŠ›å‡ºé”™è¯¯ã€‚\n\n\næœ€åï¼ŒNode çš„ `import` å‘½ä»¤æ˜¯å¼‚æ­¥åŠ è½½ï¼Œè¿™ä¸€ç‚¹ä¸æµè§ˆå™¨çš„å¤„ç†æ–¹æ³•ç›¸åŒã€‚\n\n### ES6 æ¨¡å—åŠ è½½ CommonJS æ¨¡å—\n\nCommonJS æ¨¡å—çš„è¾“å‡ºéƒ½å®šä¹‰åœ¨ `module.exports` è¿™ä¸ªå±æ€§ä¸Šé¢ã€‚Node çš„ `import` å‘½ä»¤åŠ è½½ CommonJS æ¨¡å—ï¼ŒNode ä¼šè‡ªåŠ¨å°† `module.exports` å±æ€§ï¼Œå½“ä½œæ¨¡å—çš„é»˜è®¤è¾“å‡ºï¼Œå³ç­‰åŒäº `export default xxx`ã€‚\n\n```js\n// a.js\nmodule.exports = {\n  foo: 'hello',\n  bar: 'world'\n};\n\n// ç­‰åŒäº\nexport default {\n  foo: 'hello',\n  bar: 'world'\n};\n```\n\næ‰€ä»¥ï¼Œä¸€å…±æœ‰ä¸‰ç§å†™æ³•ï¼Œå¯ä»¥æ‹¿åˆ° CommonJS æ¨¡å—çš„ `module.exports`ã€‚\n\n```js\n// å†™æ³•ä¸€\nimport baz from './a';\n// baz = {foo: 'hello', bar: 'world'};\n\n// å†™æ³•äºŒ\nimport {default as baz} from './a';\n// baz = {foo: 'hello', bar: 'world'};\n\n// å†™æ³•ä¸‰\nimport * as baz from './a';\n// baz = {\n//   get default() {return module.exports;},\n//   get foo() {return this.default.foo}.bind(baz),\n//   get bar() {return this.default.bar}.bind(baz)\n```\n\n## CommonJS æ¨¡å—åŠ è½½ ES6 æ¨¡å—\n\nCommonJS æ¨¡å—åŠ è½½ ES6 æ¨¡å—ï¼Œä¸èƒ½ä½¿ç”¨ `require` å‘½ä»¤ï¼Œè€Œè¦ä½¿ç”¨ `import()` å‡½æ•°ã€‚ES6 æ¨¡å—çš„æ‰€æœ‰è¾“å‡ºæ¥å£ï¼Œä¼šæˆä¸ºè¾“å…¥å¯¹è±¡çš„å±æ€§ã€‚\n\n```js\n// es.mjs\nlet foo = { bar: 'my-default' };\nexport default foo;\nfoo = null;\n\n// cjs.js\nconst es_namespace = await import('./es');\n// es_namespace = {\n//   get default() {\n//     ...\n//   }\n// }\nconsole.log(es_namespace.default);\n// { bar:'my-default' }\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œ`default` æ¥å£å˜æˆäº† `es_namespace.default` å±æ€§ã€‚å¦å¤–ï¼Œç”±äºå­˜åœ¨ç¼“å­˜æœºåˆ¶ï¼Œ`es.mjs` å¯¹ `foo` çš„é‡æ–°èµ‹å€¼æ²¡æœ‰åœ¨æ¨¡å—å¤–éƒ¨åæ˜ å‡ºæ¥ã€‚\n\n## å¾ªç¯åŠ è½½\n\nã€Œå¾ªç¯åŠ è½½ã€æŒ‡çš„æ˜¯ï¼Œ`a` è„šæœ¬çš„æ‰§è¡Œä¾èµ– `b` è„šæœ¬ï¼Œè€Œ `b` è„šæœ¬çš„æ‰§è¡Œåˆä¾èµ– `a` è„šæœ¬\n\n### CommonJS æ¨¡å—çš„åŠ è½½åŸç†\n\nCommonJS çš„ä¸€ä¸ªæ¨¡å—ï¼Œå°±æ˜¯ä¸€ä¸ªè„šæœ¬æ–‡ä»¶ã€‚`require` å‘½ä»¤ç¬¬ä¸€æ¬¡åŠ è½½è¯¥è„šæœ¬ï¼Œå°±ä¼šæ‰§è¡Œæ•´ä¸ªè„šæœ¬ï¼Œç„¶ååœ¨å†…å­˜ç”Ÿæˆä¸€ä¸ªå¯¹è±¡ã€‚\n\n```js\n{\n  id: '...',\n  exports: { ... },\n  loaded: true,\n  ...\n}\n```\n\nä¸Šé¢ä»£ç å°±æ˜¯ Node å†…éƒ¨åŠ è½½æ¨¡å—åç”Ÿæˆçš„ä¸€ä¸ªå¯¹è±¡ã€‚è¯¥å¯¹è±¡çš„ `id` å±æ€§æ˜¯æ¨¡å—åï¼Œ`exports` å±æ€§æ˜¯æ¨¡å—è¾“å‡ºçš„å„ä¸ªæ¥å£ï¼Œ`loaded` å±æ€§æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºè¯¥æ¨¡å—çš„è„šæœ¬æ˜¯å¦æ‰§è¡Œå®Œæ¯•ã€‚å…¶ä»–è¿˜æœ‰å¾ˆå¤šå±æ€§ï¼Œè¿™é‡Œéƒ½çœç•¥äº†ã€‚\n\nä»¥åéœ€è¦ç”¨åˆ°è¿™ä¸ªæ¨¡å—çš„æ—¶å€™ï¼Œå°±ä¼šåˆ° `exports` å±æ€§ä¸Šé¢å–å€¼ã€‚å³ä½¿å†æ¬¡æ‰§è¡Œ `require` å‘½ä»¤ï¼Œä¹Ÿä¸ä¼šå†æ¬¡æ‰§è¡Œè¯¥æ¨¡å—ï¼Œè€Œæ˜¯åˆ°ç¼“å­˜ä¹‹ä¸­å–å€¼\n\n### CommonJS æ¨¡å—çš„å¾ªç¯åŠ è½½\n\n```js\n//a.js\nexports.done = false;\nvar b = require('./b.js');\nconsole.log('åœ¨ a.js ä¹‹ä¸­ï¼Œb.done = %j', b.done);\nexports.done = true;\nconsole.log('a.js æ‰§è¡Œå®Œæ¯•');\n```\n\n`a.js` è¾“å‡ºä¸€ä¸ª `done` å˜é‡ï¼Œç„¶ååŠ è½½å¦ä¸€ä¸ªè„šæœ¬æ–‡ä»¶ `b.js`ï¼Œæ­¤æ—¶ `a.js` ä»£ç å°±åœåœ¨äº†è¿™é‡Œï¼Œè¦ç­‰å¾… `b.js` æ‰§è¡Œå®Œæ¯•åæ‰èƒ½ç»§ç»­æ‰§è¡Œ\n\n```js\n//b.js\nexports.done = false;\nvar a = require('./a.js');\nconsole.log('åœ¨ b.js ä¹‹ä¸­ï¼Œa.done = %j', a.done);\nexports.done = true;\nconsole.log('b.js æ‰§è¡Œå®Œæ¯•');\n```\n\n`b.js` å¦‚ä¸Šæ‰€ç¤ºï¼Œæ‰§è¡Œåˆ°ç¬¬äºŒè¡Œå°±ä¼šå»åŠ è½½ `a.js`ï¼Œä½†æ­¤æ—¶ `a.js` å¹¶æ²¡æœ‰æ‰§è¡Œå®Œæ¯•ï¼Œåªä¼šè¿”å›å·²ç»æ‰§è¡Œçš„éƒ¨åˆ†ï¼Œç›¸å½“äºå°±è¿è¡Œäº† `exports.done = false`ï¼Œç„¶å `b.js` æ¥ç€å¾€ä¸‹æ‰§è¡Œï¼Œç­‰åˆ° `b.js` æ‰§è¡Œå®Œæ¯•ï¼Œå†æ‰§è¡Œ `a.js` ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ `main.js` æ¥éªŒè¯è¿™ä¸ªè¿‡ç¨‹\n\n```js\nvar a = require('./a.js');\nvar b = require('./b.js');\nconsole.log('åœ¨ main.js ä¹‹ä¸­, a.done=%j, b.done=%j', a.done, b.done);\n```\n\nè¿è¡Œç»“æœå¦‚ä¸‹\n\n```shell\n$ node main.js\n\nåœ¨ b.js ä¹‹ä¸­ï¼Œa.done = false\nb.js æ‰§è¡Œå®Œæ¯•\nåœ¨ a.js ä¹‹ä¸­ï¼Œb.done = true\na.js æ‰§è¡Œå®Œæ¯•\nåœ¨ main.js ä¹‹ä¸­, a.done=true, b.done=true\n```\n\n## ES6 æ¨¡å—çš„å¾ªç¯åŠ è½½\n\nES6 æ¨¡å—æ˜¯åŠ¨æ€å¼•ç”¨ï¼Œå› æ­¤å’Œ CommonJS æœ‰å¾ˆå¤§çš„ä¸åŒ\n\n```js\n// a.mjs\nimport {bar} from './b';\nconsole.log('a.mjs');\nconsole.log(bar);\nexport let foo = 'foo';\n\n// b.mjs\nimport {foo} from './a';\nconsole.log('b.mjs');\nconsole.log(foo);\nexport let bar = 'bar';\n```\n\næ‰§è¡Œ `a.mjs` è¿è¡Œç»“æœå¦‚ä¸‹\n\n```shell\n$ node --experimental-modules a.mjs\nb.mjs\nReferenceError: foo is not defined\n```\n\nè¿è¡Œ `a.mjs` ï¼Œå½“æ‰§è¡Œåˆ°ç¬¬ä¸€è¡Œä»£ç çš„æ—¶å€™ï¼Œå‘ç°å¼•å…¥äº† `b.mjs`ï¼Œå¼•æ“ä¼šå…ˆå»æ‰§è¡Œ `b.mjs` åœ¨å›å»æ‰§è¡Œ `a.mjs` ï¼Œå½“æ‰§è¡Œ `b.mjs` æ—¶ï¼Œå‘ç°å¯¼å…¥äº† `a.mjs` ï¼Œæ­¤æ—¶å¼•æ“ä¼šå½“ä½œ `a.mjs` å·²ç»è¢«å¯¼å…¥äº†ã€‚å½“æ‰§è¡Œåˆ°ç¬¬ä¸‰è¡Œæ—¶ï¼Œå‘ç° `foo` æ ¹æœ¬æ²¡æœ‰å®šä¹‰ï¼Œå°±æŠ¥å‡ºé”™è¯¯ã€‚è§£å†³è¿™ä¸ªé—®é¢˜çš„æ–¹æ³•ï¼Œå°±æ˜¯è®© `b.mjs` è¿è¡Œçš„æ—¶å€™ï¼Œ`foo` å·²ç»æœ‰å®šä¹‰äº†\n\n```js\n// a.mjs\nimport {bar} from './b';\nconsole.log('a.mjs');\nconsole.log(bar());\nfunction foo() { return 'foo' }\nexport {foo};\n\n// b.mjs\nimport {foo} from './a';\nconsole.log('b.mjs');\nconsole.log(foo());\nfunction bar() { return 'bar' }\nexport {bar};\n```\n\nå› ä¸ºå‡½æ•°æœ‰æå‡çš„ç‰¹ç‚¹ï¼Œå› æ­¤åœ¨ `import` æ‰§è¡Œå‰ï¼Œ`foo` å°±å·²ç»è¢«å®šä¹‰äº†ã€‚\n\n## è½¬ç \n\nå› ä¸º ES6 æ¨¡å—ç°åœ¨æµè§ˆå™¨è¿˜ä¸æ”¯æŒï¼Œå› æ­¤éœ€è¦å°†å…¶è½¬ä¸º ES5 çš„å†™æ³•ï¼Œå¯ä»¥ä½¿ç”¨ [babel](http://babeljs.io/)ã€ [ES6 module transpiler](https://github.com/esnext/es6-module-transpiler)ã€[Systemjs](https://github.com/systemjs/systemjs) ç­‰è½¬ç å·¥å…·\n","tags":["ES6"],"categories":["Note"]},{"title":"LeanJsã€Œ ES6 ã€-- Module çš„è¯­æ³•","url":"%2F2018%2F02%2F16%2FLeanJSModule%E7%9A%84%E8%AF%AD%E6%B3%95%2F","content":"\n![Js](LeanJSModuleçš„è¯­æ³•/js.png)\n\n<!--more-->\n\n## æ¦‚è¿°\n\nES6 æ¨¡å—ä¸æ˜¯å¯¹è±¡ï¼Œè€Œæ˜¯é€šè¿‡ `export` å‘½ä»¤æ˜¾å¼æŒ‡å®šè¾“å‡ºçš„ä»£ç ï¼Œå†é€šè¿‡ `import` å‘½ä»¤è¾“å…¥ã€‚\n\n```js\n// ES6æ¨¡å—\nimport { stat, exists, readFile } from 'fs';\n```\n\nä¸Šé¢ä»£ç çš„å®è´¨æ˜¯ä» `fs` æ¨¡å—åŠ è½½ 3 ä¸ªæ–¹æ³•ï¼Œå…¶ä»–æ–¹æ³•ä¸åŠ è½½ã€‚è¿™ç§åŠ è½½ç§°ä¸º ã€Œç¼–è¯‘æ—¶åŠ è½½ã€æˆ–è€… ã€Œé™æ€åŠ è½½ã€ï¼Œå³ ES6 å¯ä»¥åœ¨ç¼–è¯‘æ—¶å°±å®Œæˆæ¨¡å—åŠ è½½ï¼Œæ•ˆç‡è¦æ¯” CommonJS æ¨¡å—çš„åŠ è½½æ–¹å¼é«˜ã€‚å½“ç„¶ï¼Œè¿™ä¹Ÿå¯¼è‡´äº†æ²¡æ³•å¼•ç”¨ ES6 æ¨¡å—æœ¬èº«ï¼Œå› ä¸ºå®ƒä¸æ˜¯å¯¹è±¡ã€‚\n\n## ä¸¥æ ¼æ¨¡å¼\n\nES6 çš„æ¨¡å—è‡ªåŠ¨é‡‡ç”¨ä¸¥æ ¼æ¨¡å¼ï¼Œä¸ç®¡ä½ æœ‰æ²¡æœ‰åœ¨æ¨¡å—å¤´éƒ¨åŠ ä¸Š `\"use strict\"`;ã€‚\n\nä¸¥æ ¼æ¨¡å¼ä¸»è¦æœ‰ä»¥ä¸‹é™åˆ¶ã€‚\n\n- å˜é‡å¿…é¡»å£°æ˜åå†ä½¿ç”¨\n- å‡½æ•°çš„å‚æ•°ä¸èƒ½æœ‰åŒåå±æ€§ï¼Œå¦åˆ™æŠ¥é”™\n- ä¸èƒ½ä½¿ç”¨ `with` è¯­å¥\n- ä¸èƒ½å¯¹åªè¯»å±æ€§èµ‹å€¼ï¼Œå¦åˆ™æŠ¥é”™\n- ä¸èƒ½ä½¿ç”¨å‰ç¼€ `0` è¡¨ç¤ºå…«è¿›åˆ¶æ•°ï¼Œå¦åˆ™æŠ¥é”™\n- ä¸èƒ½åˆ é™¤ä¸å¯åˆ é™¤çš„å±æ€§ï¼Œå¦åˆ™æŠ¥é”™\n- ä¸èƒ½åˆ é™¤å˜é‡ `delete prop`ï¼Œä¼šæŠ¥é”™ï¼Œåªèƒ½åˆ é™¤å±æ€§ `delete global[prop]`\n- `eval` ä¸ä¼šåœ¨å®ƒçš„å¤–å±‚ä½œç”¨åŸŸå¼•å…¥å˜é‡\n- `eval` å’Œ `arguments` ä¸èƒ½è¢«é‡æ–°èµ‹å€¼\n- `arguments`ä¸ä¼šè‡ªåŠ¨åæ˜ å‡½æ•°å‚æ•°çš„å˜åŒ–\n- ä¸èƒ½ä½¿ç”¨ `arguments.callee`\n- ä¸èƒ½ä½¿ç”¨ `arguments.caller`\n- ç¦æ­¢ `this` æŒ‡å‘å…¨å±€å¯¹è±¡\n- ä¸èƒ½ä½¿ç”¨ `fn.caller` å’Œ `fn.arguments`  è·å–å‡½æ•°è°ƒç”¨çš„å †æ ˆ\n- å¢åŠ äº†ä¿ç•™å­—ï¼ˆæ¯”å¦‚ `protected`ã€`static` å’Œ `interface`ï¼‰\n\n## export å‘½ä»¤\n\næ¨¡å—åŠŸèƒ½ä¸»è¦æœ‰ä¸¤ä¸ªå‘½ä»¤æ„æˆï¼š `export` å’Œ `import` ã€‚ `export` å‘½ä»¤ç”¨äºè§„å®šæ¨¡å—çš„å¯¹å¤–æ¥å£ï¼Œ`import` ç”¨äºè¾“å…¥å…¶å®ƒæ¨¡å—æä¾›çš„åŠŸèƒ½\n\nä¸€ä¸ªæ¨¡å—å°±æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶å†…éƒ¨çš„æ‰€æœ‰å˜é‡ï¼Œ å¤–éƒ¨æ— æ³•è·å–ã€‚å¦‚æœéœ€è¦è®©å¤–éƒ¨è·å–åˆ°çš„è¯ï¼Œå°±éœ€è¦ä½¿ç”¨ `export`\n\nä¸ºäº†é…åˆä¸‹é¢çš„ `import` å‘½ä»¤ï¼Œä¸‹é¢è¿™æ®µä»£ç å°±å½“å†™åœ¨ `profile.js` ä¸­\n\n```js\n//æ–¹æ³•ä¸€\nexport var Name = 'Hutchins';\nexport var age = '21';\nexport var sex = '1';\n\n//æ–¹æ³•äºŒ\nvar Name = 'Hutchins';\nvar age = '21';\nvar sex = '1';\n\nexport {Name,age,sex};\n```\n\nä»¥ä¸Šä¸¤ç§æ–¹æ³•éƒ½å¯ä»¥å¯¼å‡ºæ¨¡å—å†…éƒ¨çš„å˜é‡ï¼Œä¼˜å…ˆæ¨èä½¿ç”¨ç¬¬äºŒç§æ–¹æ³•ï¼Œå› ä¸ºä¸€çœ¼å¯ä»¥çœ‹å‡ºå¯¼å‡ºçš„å˜é‡å†…å®¹\n\n`export` è¿˜å¯ä»¥å¯¼å‡ºå‡½æ•°\n\n```js\n//æ–¹æ³•ä¸€\nexport function multiply(x, y) {\n  return x * y;\n};\n\n//æ–¹æ³•äºŒ\nfunction multiply(x, y) {\n  return x * y;\n};\n\nexport {multiply}\n```\n\nåŒæ ·ä¹Ÿæœ‰ä»¥ä¸Šä¸¤ç§å¯¼å‡ºå‡½æ•°çš„æ–¹æ³•\n\nå¦‚æœæƒ³æ”¹åå­—çš„è¯ä¹Ÿå¯ä»¥ç”¨ `as` å…³é”®å­—é‡å‘½å\n\n```js\nfunction v1() { ... }\nfunction v2() { ... }\n\nexport {\n  v1 as streamV1,\n  v2 as streamV2,\n  v2 as streamLatestVersion\n};\n```\n\nä¸Šé¢ä»£ç ä½¿ç”¨ `as` å…³é”®å­—ï¼Œé‡å‘½åäº†å‡½æ•° `v1` å’Œ `v2` çš„å¯¹å¤–æ¥å£ã€‚é‡å‘½ååï¼Œ`v2` å¯ä»¥ç”¨ä¸åŒçš„åå­—è¾“å‡ºä¸¤æ¬¡ã€‚\n\néœ€è¦ç‰¹åˆ«æ³¨æ„ï¼Œ`export` å‘½ä»¤è§„å®šçš„æ˜¯å¯¹å¤–çš„æ¥å£ï¼Œå¿…é¡»ä¸æ¨¡å—å†…éƒ¨çš„å˜é‡å»ºç«‹ä¸€ä¸€å¯¹åº”çš„å…³ç³»\n\n```js\n// æŠ¥é”™\nexport 1;\n\n// æŠ¥é”™\nvar m = 1;\nexport m;\n```\n\nä»¥ä¸Šä¸¤ç§æ–¹æ³•éƒ½æ²¡æœ‰æä¾›å¯¹å¤–çš„æ¥å£ï¼Œéƒ½æ˜¯é”™è¯¯çš„\n\n```js\n// å†™æ³•ä¸€\nexport var m = 1;\n\n// å†™æ³•äºŒ\nvar m = 1;\nexport {m};\n\n// å†™æ³•ä¸‰\nvar n = 1;\nexport {n as m};\n```\n\nåŒæ ·çš„ï¼Œ`function` å’Œ `class` çš„è¾“å‡ºï¼Œä¹Ÿå¿…é¡»éµå®ˆè¿™æ ·çš„å†™æ³•ã€‚\n\n```js\n// æŠ¥é”™\nfunction f() {}\nexport f;\n\n// æ­£ç¡®\nexport function f() {};\n\n// æ­£ç¡®\nfunction f() {}\nexport {f};\n```\n\n## import å‘½ä»¤\n\n`import` å‘½ä»¤ç”¨äºåŠ è½½æ¨¡å—\n\n```js\n// main.js\nimport {firstName, lastName, year} from './profile.js';\n\nfunction setName(element) {\n  element.textContent = firstName + ' ' + lastName;\n}\n```\n\nä¸Šé¢ä»£ç çš„ `import` å‘½ä»¤ï¼Œç”¨äºåŠ è½½ `profile.js` æ–‡ä»¶ï¼Œå¹¶ä»ä¸­è¾“å…¥å˜é‡ã€‚`import` å‘½ä»¤æ¥å—ä¸€å¯¹å¤§æ‹¬å·ï¼Œé‡Œé¢æŒ‡å®šè¦ä»å…¶ä»–æ¨¡å—å¯¼å…¥çš„å˜é‡åã€‚å¤§æ‹¬å·é‡Œé¢çš„å˜é‡åï¼Œå¿…é¡»ä¸è¢«å¯¼å…¥æ¨¡å— `profile.js` å¯¹å¤–æ¥å£çš„åç§°ç›¸åŒã€‚\n\nå¦‚æœæƒ³è¦å°†è½½å…¥çš„æ¨¡å—çš„å˜é‡é‡å‘½åï¼Œå¯ä»¥ä½¿ç”¨ `as` å…³é”®å­—\n\n```js\nimport {lastName as surname} from './profile.js'\n```\n\n`import` å¯¼å…¥çš„å˜é‡éƒ½æ˜¯åªè¯»çš„ï¼Œä¸å…è®¸åœ¨åŠ è½½æ¨¡å—è„šæœ¬é‡Œé¢æ”¹å†™æ¥å£ï¼Œä½†æ˜¯å¦‚æœå¯¼å…¥çš„æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä¸ºå…¶èµ‹å€¼æ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯å»ºè®®**å°†å¯¼å…¥çš„å˜é‡å®Œå…¨å½“ä½œåªè¯»ï¼Œå› ä¸ºå¦‚æœåˆ«çš„æ¨¡å—æ”¹å†™çš„è¯å‡ºé”™å¾ˆéš¾æŸ¥é”™**\n\n```js\nimport {a} from './xxx.js'\n\na = {}; // Syntax Error : 'a' is read-only;\n```\n\nç”±äº `import` æ˜¯é™æ€æ‰§è¡Œï¼Œæ‰€ä»¥ä¸èƒ½ä½¿ç”¨è¡¨è¾¾å¼\n\n```js\n// æŠ¥é”™\nimport { 'f' + 'oo' } from 'my_module';\n\n// æŠ¥é”™\nlet module = 'my_module';\nimport { foo } from module;\n\n// æŠ¥é”™\nif (x === 1) {\n  import { foo } from 'module1';\n} else {\n  import { foo } from 'module2';\n}\n```\n\n`import` æœ‰æå‡æ•ˆæœï¼Œæ‰€ä»¥æ¨èå†™åœ¨å‰é¢\n\n## æ¨¡å—çš„æ•´ä½“åŠ è½½\n\né™¤äº†æŒ‡å®šåŠ è½½æŸä¸ªè¾“å‡ºå€¼ï¼Œè¿˜å¯ä»¥ä½¿ç”¨æ•´ä½“åŠ è½½ï¼Œå³ç”¨æ˜Ÿå· `*` æŒ‡å®šä¸€ä¸ªå¯¹è±¡ï¼Œæ‰€æœ‰è¾“å‡ºå€¼éƒ½åŠ è½½åœ¨è¿™ä¸ªå¯¹è±¡ä¸Šé¢ã€‚\n\n```js\n//circle.js\nfunction area(radius) {\n  return Math.PI * radius * radius;\n}\n\nfunction circumference(radius) {\n  return 2 * Math.PI * radius;\n}\n\nexport { area, circumference }\n```\n\nåŠ è½½æ¨¡å—\n\n```js\nimport {area, circumference} from './circle'\n\nconsole.log('åœ†é¢ç§¯ï¼š' + area(4));\nconsole.log('åœ†å‘¨é•¿ï¼š' + circumference(14));\n```\n\nä¸Šé¢æ˜¯é€ä¸€åŠ è½½ï¼Œæ•´ä½“åŠ è½½çš„å†™æ³•å¦‚ä¸‹\n\n```js\nimport * as circle from './circle'\n\nconsole.log('åœ†é¢ç§¯ï¼š' + circle.area(4));\nconsole.log('åœ†å‘¨é•¿ï¼š' + circle.circumference(14));\n```\n\næ³¨æ„ï¼Œæ¨¡å—æ•´ä½“åŠ è½½æ‰€åœ¨çš„é‚£ä¸ªå¯¹è±¡ï¼Œåº”è¯¥æ˜¯å¯ä»¥é™æ€åˆ†æçš„ï¼Œæ‰€ä»¥ä¸å…è®¸è¿è¡Œæ—¶æ”¹å˜ã€‚ä¸‹é¢çš„å†™æ³•éƒ½æ˜¯ä¸å…è®¸çš„ã€‚\n\n```js\nimport * as circle from './circle';\n\n// ä¸‹é¢ä¸¤è¡Œéƒ½æ˜¯ä¸å…è®¸çš„\ncircle.foo = 'hello';\ncircle.area = function () {};\n```\n\n## export default\n\nå¯¼å‡ºå˜é‡å’Œå‡½æ•°å¯¼å…¥æ—¶ä¸éœ€è¦çŸ¥é“å®ƒçš„åå­—\n\n```js\n// export-default.js\nexport default function () {\n  console.log('foo');\n}\n```\n\nå…¶å®ƒæ¨¡å—åŠ è½½è¯¥æ¨¡å—æ—¶ï¼Œ`import` å¯ä»¥ä¸ºè¯¥åŒ¿åå‡½æ•°æŒ‡å®šä»»æ„åå­—\n\n```js\n// import-default.js\nimport customName from './export-default';\ncustomName(); // 'foo'\n```\n\nè€Œä¸”å¯¹åº”çš„ `import` è¯­å¥ä¸éœ€è¦ä½¿ç”¨å¤§æ‹¬å·ã€‚ä¹Ÿå¯ä»¥åŠ è½½æœ‰åå­—çš„å‡½æ•°ï¼Œä½†æ˜¯ä¹Ÿä¼šè§†ä¸ºåŒ¿åå‡½æ•°\n\nå…¶å® `export default` å‘½ä»¤å…¶å®åªæ˜¯è¾“å‡ºä¸€ä¸ªå«åš `default` çš„å˜é‡ï¼Œæ‰€ä»¥ä»–åé¢ä¸èƒ½è·Ÿå˜é‡å£°æ˜è¯­å¥\n\n```js\n// æ­£ç¡®\nvar a = 1;\nexport default a;\n\n// é”™è¯¯\nexport default var a = 1;\n``` \n\nä¸Šé¢ä»£ç ä¸­ï¼Œ`export default a` çš„å«ä¹‰æ˜¯å°†å˜é‡ `a` çš„å€¼èµ‹ç»™å˜é‡ `default`ï¼Œå› æ­¤åé¢ç›´æ¥è·Ÿä¸€ä¸ªå€¼ä¹Ÿæ˜¯å¯ä»¥çš„\n\n## export ä¸ import çš„å¤åˆå†™æ³•\n\nå¦‚æœåœ¨ä¸€ä¸ªæ¨¡å—ä¸­ï¼Œå…ˆè¾“å…¥ä¸€ä¸ªæ¨¡å—å†å°†å…¶è¾“å‡ºï¼Œå¯ä»¥å†™åœ¨ä¸€è¡Œ\n\n```js\nexport { foo, bar } from 'my_module';\n\n// å¯ä»¥ç®€å•ç†è§£ä¸º\nimport { foo, bar } from 'my_module';\nexport { foo, bar }; \n```\n\nåœ¨è¿™é‡Œè¦æ³¨æ„çš„æ˜¯ï¼Œå†™æˆä¸€è¡Œçš„è¯åªæ˜¯ç›¸å½“äºè½¬å‘ï¼Œ `foo` å’Œ `bar` å®é™…ä¸Šæ ¹æœ¬æ²¡æœ‰å¯¼å…¥å½“å‰çš„æ¨¡å—\n\nå¯ä»¥åˆ©ç”¨è¿™ç§å†™æ³•å°†å…¶æ›´åï¼Œæˆ–è€…æ”¹ä¸ºé»˜è®¤æ¥å£\n\n```js\n// æ¥å£æ”¹å\nexport { foo as myFoo } from 'my_module';\n\n// æ•´ä½“è¾“å‡º\nexport * from 'my_module';\n\n// é»˜è®¤æ¥å£\nexport { default } from 'foo';\n```\n\n## è·¨æ¨¡å—å¸¸é‡\n\nè®¾ç½®å¸¸é‡èƒ½è¢«å¤šä¸ªæ¨¡å—å…±äº«\n\n```js\n// constants.js æ¨¡å—\nexport const A = 1;\nexport const B = 3;\nexport const C = 4;\n\n// test1.js æ¨¡å—\nimport * as constants from './constants';\nconsole.log(constants.A); // 1\nconsole.log(constants.B); // 3\n\n// test2.js æ¨¡å—\nimport {A, B} from './constants';\nconsole.log(A); // 1\nconsole.log(B); // 3\n```\n\nå¦‚æœè¦ä½¿ç”¨çš„å¸¸é‡éå¸¸å¤šï¼Œå¯ä»¥å»ºä¸€ä¸ªä¸“é—¨çš„ `constants` ç›®å½•ï¼Œå°†å„ç§å¸¸é‡å†™åœ¨ä¸åŒçš„æ–‡ä»¶é‡Œé¢ï¼Œä¿å­˜åœ¨è¯¥ç›®å½•ä¸‹ã€‚\n\n## import()\n\nå› ä¸º `export` å’Œ `import` éƒ½æ˜¯é™æ€åŠ è½½ï¼Œè¿™å°±å¯¼è‡´æ— æ³•åœ¨è¿è¡Œæ—¶åŠ è½½æ¨¡å—\n\n```js\n// æŠ¥é”™\nif (x === 2) {\n  import MyModual from './myModual';\n}\n```\n\nä¸èƒ½åƒ `node` çš„ `require` é‚£æ ·è¿è¡Œæ—¶åŠ è½½æ¨¡å—\n\n```js\nconst path = './' + fileName;\nconst myModual = require(path);\n```\n\nä¸Šé¢åˆ°åº•åŠ è½½å“ªä¸ªæ¨¡å—ï¼Œè¦è¿è¡Œæ—¶æ‰çŸ¥é“ï¼Œå› æ­¤æœ‰ä¸€ä¸ªææ¡ˆï¼Œç”¨ `import()` å®ç°åŠ¨æ€åŠ è½½\n\n```js\nconst path = './' + fileName;\nconst myModual = import(path);\n``` \n\n`import` ç±»ä¼¼äº `require` ï¼ŒåŒºåˆ«æ˜¯å‰è€…æ˜¯å¼‚æ­¥åŠ è½½ï¼Œåè€…æ˜¯åŒæ­¥åŠ è½½\n","tags":["ES6"],"categories":["Note"]},{"title":"LeanJsã€Œ ES6 ã€-- Decorator","url":"%2F2018%2F02%2F15%2FLeanJSDecorator%2F","content":"\n![Js](LeanJSDecorator/js.png)\n\n<!--more-->\n\n## ç±»çš„ä¿®é¥°\n\nåŸºæœ¬ä¸Šï¼Œä¿®é¥°å™¨çš„è¡Œä¸ºå°±æ˜¯ä¸‹é¢è¿™æ ·ã€‚\n\n```js\n@decorator\nclass A {}\n\n// ç­‰åŒäº\n\nclass A {}\nA = decorator(A) || A;\n```\n\nä¹Ÿå°±æ˜¯è¯´ï¼Œä¿®é¥°å™¨æ˜¯ä¸€ä¸ªå¯¹ç±»è¿›è¡Œå¤„ç†çš„å‡½æ•°ã€‚ä¿®é¥°å™¨å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå°±æ˜¯æ‰€è¦ä¿®é¥°çš„ç›®æ ‡ç±»ã€‚\n\n## æ–¹æ³•çš„ä¿®é¥°\n\nä¿®é¥°å™¨ä¸ä»…å¯ä»¥ä¿®é¥°ç±»ï¼Œè¿˜å¯ä»¥ä¿®é¥°ç±»çš„å±æ€§ã€‚\n\n```js\nclass Person {\n  @readonly\n  name() { return `${this.first} ${this.last}` }\n}\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œä¿®é¥°å™¨ `readonly` ç”¨æ¥ä¿®é¥°ã€Œç±»ã€çš„ `name` æ–¹æ³•ã€‚\n\nä¿®é¥°å™¨å‡½æ•° `readonly` ä¸€å…±å¯ä»¥æ¥å—ä¸‰ä¸ªå‚æ•°ã€‚\n\n```js\nfunction readonly(target, name, descriptor){\n  // descriptorå¯¹è±¡åŸæ¥çš„å€¼å¦‚ä¸‹\n  // {\n  //   value: specifiedFunction,\n  //   enumerable: false,\n  //   configurable: true,\n  //   writable: true\n  // };\n  descriptor.writable = false;\n  return descriptor;\n}\n\nreadonly(Person.prototype, 'name', descriptor);\n// ç±»ä¼¼äº\nObject.defineProperty(Person.prototype, 'name', descriptor);\n```\n\nä¿®é¥°å™¨ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç±»çš„åŸå‹å¯¹è±¡ï¼Œä¸Šä¾‹æ˜¯ `Person.prototype`ï¼Œä¿®é¥°å™¨çš„æœ¬æ„æ˜¯è¦ã€Œä¿®é¥°ã€ç±»çš„å®ä¾‹ï¼Œä½†æ˜¯è¿™ä¸ªæ—¶å€™å®ä¾‹è¿˜æ²¡ç”Ÿæˆï¼Œæ‰€ä»¥åªèƒ½å»ä¿®é¥°åŸå‹ï¼ˆè¿™ä¸åŒäºç±»çš„ä¿®é¥°ï¼Œé‚£ç§æƒ…å†µæ—¶ `target` å‚æ•°æŒ‡çš„æ˜¯ç±»æœ¬èº«ï¼‰ï¼›ç¬¬äºŒä¸ªå‚æ•°æ˜¯æ‰€è¦ä¿®é¥°çš„å±æ€§åï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯è¯¥å±æ€§çš„æè¿°å¯¹è±¡ã€‚\n\n## Mixin\n\næ‰€è°“ `Mixin` æ¨¡å¼ï¼Œå°±æ˜¯å¯¹è±¡ç»§æ‰¿çš„ä¸€ç§æ›¿ä»£æ–¹æ¡ˆï¼Œä¸­æ–‡è¯‘ä¸ºã€Œæ··å…¥ã€ï¼ˆmix inï¼‰ï¼Œæ„ä¸ºåœ¨ä¸€ä¸ªå¯¹è±¡ä¹‹ä¸­æ··å…¥å¦å¤–ä¸€ä¸ªå¯¹è±¡çš„æ–¹æ³•ã€‚\n\n```js\nconst Foo = {\n  foo() { console.log('foo') }\n};\n\nclass MyClass {}\n\nObject.assign(MyClass.prototype, Foo);\n\nlet obj = new MyClass();\nobj.foo() // 'foo'\n```\n\nä¸Šé¢ä»£ç ä¹‹ä¸­ï¼Œå¯¹è±¡ `Foo` æœ‰ä¸€ä¸ª `foo` æ–¹æ³•ï¼Œé€šè¿‡ `Object.assign` æ–¹æ³•ï¼Œå¯ä»¥å°† `foo` æ–¹æ³•ã€Œæ··å…¥ã€`MyClass` ç±»ï¼Œå¯¼è‡´ `MyClass` çš„å®ä¾‹ `obj` å¯¹è±¡éƒ½å…·æœ‰ `foo` æ–¹æ³•ã€‚è¿™å°±æ˜¯ã€Œæ··å…¥ã€æ¨¡å¼çš„ä¸€ä¸ªç®€å•å®ç°ã€‚","tags":["ES6"],"categories":["Note"]},{"title":"LeanJsã€Œ ES6 ã€-- Class çš„ç»§æ‰¿","url":"%2F2018%2F02%2F14%2FLeanJSClass%E7%9A%84%E7%BB%A7%E6%89%BF%2F","content":"\n![Js](LeanJSClassçš„ç»§æ‰¿/js.png)\n\n<!--more-->\n\n## ç®€ä»‹\n\nClass å¯ä»¥é€šè¿‡ `extends`å…³é”®å­—å®ç°ç»§æ‰¿\n\n```js\nclass Point {\n\n}\n\nclass ColorPoint extends Point {\n\n}\n```\n\n`ColorPoint` è¯¥ç±»å°±ç»§æ‰¿äº† `Point` ç±»çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•\n\nå­ç±»å¿…é¡»åœ¨ `constructor` æ–¹æ³•ä¸­è°ƒç”¨ `super` æ–¹æ³•ï¼Œå¦åˆ™æ–°å»ºå®ä¾‹æ—¶ä¼šæŠ¥é”™ã€‚è¿™æ˜¯å› ä¸ºå­ç±»æ²¡æœ‰è‡ªå·±çš„ `this` å¯¹è±¡ï¼Œè€Œæ˜¯ç»§æ‰¿çˆ¶ç±»çš„ `this` å¯¹è±¡ï¼Œç„¶åå¯¹å…¶åŠ å·¥ã€‚å¦‚æœä¸è°ƒç”¨ `super` æ–¹æ³•ï¼Œå­ç±»å°±å¾—ä¸åˆ° `this`\n\n```js\nclass Point { /* ... */ }\n\nclass ColorPoint extends Point {\n  constructor() {\n  }\n}\n\nlet cp = new ColorPoint(); // Must call super constructor in derived class before accessing 'this' or returning from derived constructor\n```\n\nES5 çš„ç»§æ‰¿ï¼Œå®è´¨æ˜¯å…ˆåˆ›é€ å­ç±»çš„å®ä¾‹å¯¹è±¡ `this` ï¼Œç„¶åå†å°†çˆ¶ç±»çš„æ–¹æ³• æ·»åŠ åˆ°æ­¤ `this` ä¸Šé¢ã€‚ ES6 çš„ç»§æ‰¿æœºåˆ¶å®Œå…¨ä¸åŒï¼Œå®è´¨æ˜¯å…ˆåˆ›é€ çˆ¶ç±»çš„å®ä¾‹å¯¹è±¡ `this`ï¼Œç„¶åå†ç”¨å­ç±»çš„æ„é€ å‡½æ•°ä¿®æ”¹ `this` \n\nå¦‚æœå­ç±»æ²¡æœ‰å®šä¹‰çš„ `constructor` ï¼Œè¿™ä¸ªä¼šè¢«é»˜è®¤æ·»åŠ \n\n```js\nclass ColorPoint extends Point {\n}\n\n// ç­‰åŒäº\nclass ColorPoint extends Point {\n  constructor(...args) {\n    super(...args);\n  }\n}\n```\n\nå¦‚æœä¸è°ƒç”¨ `super`ï¼Œæ— æ³•ä½¿ç”¨ `this` å…³é”®å­—\n\n```js\nclass Point {\n  constructor(x, y) {\n    this.x = x;\n    this.y = y;\n  }\n}\n\nclass ColorPoint extends Point {\n  constructor(x, y, color) {\n    this.color = color; // ReferenceError\n    super(x, y);\n    this.color = color; // æ­£ç¡®\n  }\n}\n```\n\n## super å…³é”®å­—\n\næ—¢å¯ä»¥å½“ä½œå‡½æ•°ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥å½“ä½œå¯¹è±¡ä½¿ç”¨\n\n`super` ä½œä¸ºå‡½æ•°è°ƒç”¨æ—¶ï¼Œä»£è¡¨çˆ¶ç±»æ„é€ å‡½æ•°ï¼Œè™½ç„¶ä»£è¡¨çš„æ˜¯çˆ¶ç±»æ„é€ å‡½æ•°ï¼Œä½†æ˜¯è¿”å›çš„æ˜¯å­ç±»çš„å®ä¾‹\n\n```js\nclass A {\n  constructor() {\n    console.log(new.target.name);\n  }\n}\n\nclass B extends A {\n  constructor() {\n    super();\n  }\n}\n\nnew A() // A\nnew B() // B\n```\n\n`super()` ç›¸å½“äº `A.prototype.constructor.call(this)`\n\nä½œä¸ºå‡½æ•°æ—¶ï¼Œ`super` åªèƒ½ç”¨åœ¨å­ç±»çš„ `constructor` ä¸­\n\n```js\nclass A {}\n\nclass B extends A {\n  m() {\n    super(); // æŠ¥é”™\n  }\n}\n```\n\nå½“ `super` ç”¨åšå¯¹è±¡æ—¶ï¼ŒæŒ‡å‘çˆ¶ç±»çš„åŸå‹å¯¹è±¡ï¼›åœ¨é™æ€æ–¹æ³•ä¸­ï¼ŒæŒ‡å‘çˆ¶ç±»\n\n```js\nclass A {\n  p() {\n    return 2;\n  }\n}\n\nclass B extends A {\n  constructor() {\n    super();\n    console.log(super.p()); // 2\n  }\n}\n\nlet b = new B();\n```\n\n`super.p()` è°ƒç”¨äº†çˆ¶ç±»åŸå‹å¯¹è±¡ä¸Šçš„æ–¹æ³• `p`\n\nç”±äº `super` è°ƒç”¨çš„æ˜¯çˆ¶ç±»åŸå‹å¯¹è±¡ä¸Šçš„æ–¹æ³•ï¼Œå› æ­¤çˆ¶ç±»å®ä¾‹ä¸Šçš„æ–¹æ³•å’Œå±æ€§æ˜¯æ— æ³•è¢«è°ƒç”¨çš„\n\n```js\nclass A {\n  constructor() {\n    this.p = 2;\n  }\n}\n\nclass B extends A {\n  get m() {\n    return super.p;\n  }\n}\n\nlet b = new B();\nb.m // undefined\n```\n\nES6 è§„å®šï¼Œé€šè¿‡ `super` è°ƒç”¨çˆ¶ç±»åŸå‹å¯¹è±¡ä¸Šçš„æ–¹æ³•ï¼Œå…¶ `this` æŒ‡å‘å­ç±»\n\n```js\nlass A {\n  constructor() {\n    this.x = 1;\n  }\n  print() {\n    console.log(this.x);\n  }\n}\n\nclass B extends A {\n  constructor() {\n    super();\n    this.x = 2;\n  }\n  m() {\n    super.print();\n  }\n}\n\nlet b = new B();\nb.m() // 2\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œ`super.print()` è™½ç„¶è°ƒç”¨çš„æ˜¯ `A.prototype.print()`ï¼Œä½†æ˜¯ `A.prototype.print()` å†…éƒ¨çš„ `this` æŒ‡å‘å­ç±» `B`ï¼Œå¯¼è‡´è¾“å‡ºçš„æ˜¯ `2`ï¼Œè€Œä¸æ˜¯ `1`ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®é™…ä¸Šæ‰§è¡Œçš„æ˜¯ `super.print.call(this)`ã€‚\n\n## ç±»çš„ prototype å±æ€§å’Œ `__proto__` å±æ€§ \n\nå­ç±»çš„ `__proto__` å±æ€§ï¼Œè¡¨ç¤ºæ„é€ å‡½æ•°çš„ç»§æ‰¿ï¼Œæ€»æ˜¯æŒ‡å‘çˆ¶ç±»ã€‚\n\nå­ç±» `prototype` å±æ€§çš„ `__proto__` å±æ€§ï¼Œè¡¨ç¤ºæ–¹æ³•çš„ç»§æ‰¿ï¼Œæ€»æ˜¯æŒ‡å‘çˆ¶ç±»çš„ `prototype` å±æ€§ã€‚\n \n```js\nclass A {\n}\n\nclass B extends A {\n}\n\nB.__proto__ === A // true\nB.prototype.__proto__ === A.prototype // true\n```\n\n## extends çš„ç»§æ‰¿ç›®æ ‡\n\n`extends` å…³é”®å­—åé¢å¯ä»¥è·Ÿå¤šç§ç±»å‹çš„å€¼ã€‚\n\n```js\nclass B extends A {\n}\n```\n\nä¸Šé¢ä»£ç çš„ `A` ï¼Œåªè¦æ˜¯ä¸€ä¸ªæœ‰ `prototype` å±æ€§çš„å‡½æ•°ï¼Œå°±èƒ½è¢« `B` ç»§æ‰¿ã€‚ç”±äºå‡½æ•°éƒ½æœ‰ `prototype` å±æ€§ï¼ˆé™¤äº† `Function.prototype` å‡½æ•°ï¼‰ï¼Œå› æ­¤ `A` å¯ä»¥æ˜¯ä»»æ„å‡½æ•°ã€‚\n\n","tags":["ES6"],"categories":["Note"]},{"title":"LeanJsã€Œ ES6 ã€-- Class çš„åŸºæœ¬è¯­æ³•","url":"%2F2018%2F02%2F14%2FLeanJSClass%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95%2F","content":"\n![Js](LeanJSClassåŸºæœ¬è¯­æ³•/js.png)\n\n<!--more-->\n\n## ç®€ä»‹\n\nES5 ä¸­ç”Ÿæˆå®ä¾‹å¯¹è±¡\n\n```js\nfunction Point(x,y){\n  this.x = x;\n  this.y = y;\n}\n\nPoint.prototype.toString = function () {\n  return '(' + this.x + ', ' + this.y + ')';\n};\n\nvar p = new Point(1, 2);\n```\n\nES6 æä¾›äº†æ›´æ¥è¿‘ä¼ ç»Ÿè¯­è¨€çš„å†™æ³•ï¼Œå¼•å…¥äº† Class è¿™ä¸ªæ¦‚å¿µï¼Œä½œä¸ºå¯¹è±¡çš„æ¨¡æ¿ã€‚é€šè¿‡ `class` å…³é”®å­—ï¼Œå¯ä»¥å®šä¹‰ç±»\n\n```js\n//å®šä¹‰ç±»\nclass Point {\n  constructor(x, y) {\n    this.x = x;\n    this.y = y;\n  }\n\n  toString() {\n    return '(' + this.x + ', ' + this.y + ')';\n  }\n}\n```\n\nåœ¨ `Class` ä¸­å®šä¹‰æ–¹æ³•ä¸éœ€è¦ç”¨é€—å·ï¼Œæ·»åŠ é€—å·åè€Œä¼šæŠ¥é”™\n\n```js\nclass Point {\n  constructor() {\n    // ...\n  }\n\n  toString() {\n    // ...\n  }\n\n  toValue() {\n    // ...\n  }\n}\n\n// ç­‰åŒäº\n\nPoint.prototype = {\n  constructor() {},\n  toString() {},\n  toValue() {},\n};\n```\n\nç±»çš„å±æ€§åï¼Œå¯ä»¥é‡‡ç”¨è¡¨è¾¾å¼\n\n```js\nlet methodName = 'getArea';\n\nclass Square{\n  constructor(length){\n    //...\n  }\n\n  [methodName](){\n    //...\n  }\n}\n```\n\n## constructor æ–¹æ³•\n\n`constructor` æ–¹æ³•æ˜¯ç±»çš„é»˜è®¤æ–¹æ³•ï¼Œé€šè¿‡ `new` å‘½ä»¤ç”Ÿæˆå¯¹è±¡çš„å®ä¾‹æ—¶ï¼Œè‡ªåŠ¨ç”Ÿæˆè¯¥æ–¹æ³•ã€‚ç”Ÿæˆå¯¹è±¡æ—¶ä¹Ÿå¿…é¡»ä½¿ç”¨ `new` æ¥ç”Ÿæˆï¼›ä¸€ä¸ªç±»å¿…é¡»è¦æœ‰ `constructor` ï¼Œå¦‚æœæ²¡æœ‰æ˜¾å¼å®šä¹‰ï¼Œä¸€ä¸ªç©ºçš„ `constructor` ä¹Ÿä¼šè¢«é»˜è®¤æ·»åŠ \n\n## Class è¡¨è¾¾å¼\n\nä¸å‡½æ•°ä¸€æ ·ï¼Œç±»ä¹Ÿå¯ä»¥ä½¿ç”¨è¡¨è¾¾å¼çš„å½¢å¼å®šä¹‰ã€‚\n\n```js\nconst MyClass = class Me{\n  getClassName(){\n    return Me.name;\n  }\n}\n```\n\nè¿™ä¸ªç±»çš„åå­—æ˜¯ `MyClass` è€Œä¸æ˜¯ `Me`ï¼Œ`Me` åªåœ¨ Class çš„å†…éƒ¨ä»£ç å¯ç”¨ï¼ŒæŒ‡ä»£å½“å‰ç±»\n\n```js\nlet inst = new MyClass();\ninst.getClassName() //Me\nMe.name // ReferenceError: Me is not defined\n```\n\nå¦‚æœå†…éƒ¨æ²¡æœ‰ç”¨åˆ° `Me` ï¼Œå®Œå…¨å¯ä»¥çœç•¥\n\n```js\nconst MyClass = class { /* ... */ };\n```\n\né‡‡ç”¨ Class è¡¨è¾¾å¼ï¼Œå¯ä»¥å†™å‡ºç«‹å³æ‰§è¡Œçš„ Class\n\n```js\nlet person = new class {\n  constructor(name) {\n    this.name = name;\n  }\n\n  sayName() {\n    console.log(this.name);\n  }\n}('å¼ ä¸‰');\n\nperson.sayName(); // \"å¼ ä¸‰\"\n```\n\n## ä¸å­˜åœ¨å˜é‡æå‡\n\nç±»ä¸å­˜åœ¨å˜é‡æå‡ (hoist) \n\n```js\nnew Foo(); // ReferenceError\nclass Foo {}\n```\n\n## ç§æœ‰çš„æ–¹æ³•\n\nå°†ç§æœ‰æ–¹æ³•ç§»å‡ºæ¨¡å—\n\n```js\nclass Widget {\n  foo (baz) {\n    bar.call(this, baz);\n  }\n\n  // ...\n}\n\nfunction bar(baz) {\n  return this.snaf = baz;\n}\n```\n\nåˆ©ç”¨ `Symbol` å€¼çš„å”¯ä¸€æ€§ï¼Œå°†ç§æœ‰æ–¹æ³•çš„åå­—å‘½åä¸ºä¸€ä¸ª `Symbol` å€¼\n\n```js\nconst bar = Symbol('bar');\nconst snaf = Symbol('snaf');\n\nexport default class myClass{\n\n  // å…¬æœ‰æ–¹æ³•\n  foo(baz) {\n    this[bar](baz);\n  }\n\n  // ç§æœ‰æ–¹æ³•\n  [bar](baz) {\n    return this[snaf] = baz;\n  }\n\n  // ...\n};\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œ`bar` å’Œ `snaf` éƒ½æ˜¯ `Symbol` å€¼ï¼Œå¯¼è‡´ç¬¬ä¸‰æ–¹æ— æ³•è·å–åˆ°å®ƒä»¬ï¼Œå› æ­¤è¾¾åˆ°äº†ç§æœ‰æ–¹æ³•å’Œç§æœ‰å±æ€§çš„æ•ˆæœã€‚\n\n## ç§æœ‰å±æ€§çš„ææ¡ˆ\n\nä¸ç§æœ‰æ–¹æ³•ä¸€æ ·ï¼ŒES6 ä¸æ”¯æŒç§æœ‰å±æ€§ã€‚ç›®å‰ï¼Œæœ‰ä¸€ä¸ªææ¡ˆï¼Œä¸º `class` åŠ äº†ç§æœ‰å±æ€§ã€‚æ–¹æ³•æ˜¯åœ¨å±æ€§åä¹‹å‰ï¼Œä½¿ç”¨ `#` è¡¨ç¤ºã€‚\n\n```js\nclass Point {\n  #x;\n\n  constructor(x = 0) {\n    #x = +x; // å†™æˆ this.#x äº¦å¯\n  }\n\n  get x() { return #x }\n  set x(value) { #x = +value }\n}\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œ`#x` å°±è¡¨ç¤ºç§æœ‰å±æ€§ `x`ï¼Œåœ¨ `Point` ç±»ä¹‹å¤–æ˜¯è¯»å–ä¸åˆ°è¿™ä¸ªå±æ€§çš„ã€‚è¿˜å¯ä»¥çœ‹åˆ°ï¼Œç§æœ‰å±æ€§ä¸å®ä¾‹çš„å±æ€§æ˜¯å¯ä»¥åŒåçš„ï¼ˆæ¯”å¦‚ï¼Œ`#x` ä¸ `get x()` ï¼‰ã€‚\n\n## this çš„æŒ‡å‘\n\nç±»çš„æ–¹æ³•å†…éƒ¨å¦‚æœå«æœ‰ `this` ï¼Œå®ƒé»˜è®¤æŒ‡å‘ç±»çš„å®ä¾‹ã€‚ä½†æ˜¯ï¼Œå¿…é¡»éå¸¸å°å¿ƒï¼Œä¸€æ—¦å•ç‹¬ä½¿ç”¨è¯¥æ–¹æ³•ï¼Œå¾ˆå¯èƒ½ä¼šæŠ¥é”™\n\n```js\nclass Logger {\n  printName(name = 'there') {\n    this.print(`Hello ${name}`);\n  }\n\n  print(text) {\n    console.log(text);\n  }\n}\n\nconst logger = new Logger();\nconst { printName } = logger;\nprintName(); // TypeError: Cannot read property 'print' of undefined\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œ`printName` æ–¹æ³•ä¸­çš„ `this`ï¼Œé»˜è®¤æŒ‡å‘ Logger ç±»çš„å®ä¾‹ã€‚ä½†æ˜¯ï¼Œå¦‚æœå°†è¿™ä¸ªæ–¹æ³•æå–å‡ºæ¥å•ç‹¬ä½¿ç”¨ï¼Œ`this` ä¼šæŒ‡å‘è¯¥æ–¹æ³•è¿è¡Œæ—¶æ‰€åœ¨çš„ç¯å¢ƒï¼Œå› ä¸ºæ‰¾ä¸åˆ° `print` æ–¹æ³•è€Œå¯¼è‡´æŠ¥é”™ã€‚\n\nä¸€ä¸ªæ¯”è¾ƒç®€å•çš„è§£å†³æ–¹æ³•æ˜¯ï¼Œåœ¨æ„é€ æ–¹æ³•ä¸­ç»‘å®š `this` ï¼Œè¿™æ ·å°±ä¸ä¼šæ‰¾ä¸åˆ° `print` æ–¹æ³•äº†ã€‚\n\n```js\nclass Logger {\n  constructor() {\n    this.printName = this.printName.bind(this);\n  }\n\n  // ...\n}\n```\n\nå¦ä¸€ç§è§£å†³æ–¹æ³•æ˜¯ä½¿ç”¨ç®­å¤´å‡½æ•°ã€‚\n\n```js\nclass Logger {\n  constructor() {\n    this.printName = (name = 'there') => {\n      this.print(`Hello ${name}`);\n    };\n  }\n\n  // ...\n}\n```\n\n## Class çš„å–å€¼å‡½æ•°ï¼ˆgetterï¼‰å’Œå­˜å€¼å‡½æ•°ï¼ˆsetterï¼‰\n\nä¸ ES5 ä¸€æ ·ï¼Œåœ¨ã€Œç±»ã€çš„å†…éƒ¨å¯ä»¥ä½¿ç”¨ `get` å’Œ `set` å…³é”®å­—ï¼Œå¯¹æŸä¸ªå±æ€§è®¾ç½®å­˜å€¼å‡½æ•°å’Œå–å€¼å‡½æ•°ï¼Œæ‹¦æˆªè¯¥å±æ€§çš„å­˜å–è¡Œä¸ºã€‚\n\n```js\nclass MyClass {\n  constructor() {\n    // ...\n  }\n  get prop() {\n    return 'getter';\n  }\n  set prop(value) {\n    console.log('setter: '+value);\n  }\n}\n\nlet inst = new MyClass();\n\ninst.prop = 123;\n// setter: 123\n\ninst.prop\n// 'getter'\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œ`prop` å±æ€§æœ‰å¯¹åº”çš„å­˜å€¼å‡½æ•°å’Œå–å€¼å‡½æ•°ï¼Œå› æ­¤èµ‹å€¼å’Œè¯»å–è¡Œä¸ºéƒ½è¢«è‡ªå®šä¹‰äº†ã€‚\n\n##Class çš„ Generator æ–¹æ³•\n\nå¦‚æœæŸä¸ªæ–¹æ³•ä¹‹å‰åŠ ä¸Šæ˜Ÿå· `*`ï¼Œå°±è¡¨ç¤ºè¯¥æ–¹æ³•æ˜¯ä¸€ä¸ª Generator å‡½æ•°ã€‚\n\n```js\nclass Foo {\n  constructor(...args) {\n    this.args = args;\n  }\n  * [Symbol.iterator]() {\n    for (let arg of this.args) {\n      yield arg;\n    }\n  }\n}\n\nfor (let x of new Foo('hello', 'world')) {\n  console.log(x);\n}\n// hello\n// world\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œ`Foo` ç±»çš„ `Symbol.iterator` æ–¹æ³•å‰æœ‰ä¸€ä¸ªæ˜Ÿå·ï¼Œè¡¨ç¤ºè¯¥æ–¹æ³•æ˜¯ä¸€ä¸ª Generator å‡½æ•°ã€‚`Symbol.iterator` æ–¹æ³•è¿”å›ä¸€ä¸ª `Foo` ç±»çš„é»˜è®¤éå†å™¨ï¼Œ`for...of` å¾ªç¯ä¼šè‡ªåŠ¨è°ƒç”¨è¿™ä¸ªéå†å™¨ã€‚\n\n## Class çš„é™æ€æ–¹æ³•\n\nç±»ç›¸å½“äºå®ä¾‹çš„åŸå‹ï¼Œæ‰€æœ‰åœ¨ç±»ä¸­å®šä¹‰çš„æ–¹æ³•ï¼Œéƒ½ä¼šè¢«å®ä¾‹ç»§æ‰¿ã€‚å¦‚æœåœ¨ä¸€ä¸ªæ–¹æ³•å‰ï¼ŒåŠ ä¸Š `static` å…³é”®å­—ï¼Œå°±è¡¨ç¤ºè¯¥æ–¹æ³•ä¸ä¼šè¢«å®ä¾‹ç»§æ‰¿ï¼Œè€Œæ˜¯ç›´æ¥é€šè¿‡ç±»æ¥è°ƒç”¨ï¼Œè¿™å°±ç§°ä¸ºã€Œé™æ€æ–¹æ³•ã€ã€‚\n\n```js\nclass Foo {\n  static classMethod() {\n    return 'hello';\n  }\n}\n\nFoo.classMethod() // 'hello'\n\nvar foo = new Foo();\nfoo.classMethod()\n// TypeError: foo.classMethod is not a function\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œ`Foo` ç±»çš„ `classMethod` æ–¹æ³•å‰æœ‰ `static` å…³é”®å­—ï¼Œè¡¨æ˜è¯¥æ–¹æ³•æ˜¯ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œå¯ä»¥ç›´æ¥åœ¨ `Foo` ç±»ä¸Šè°ƒç”¨ `Foo.classMethod()`ï¼Œè€Œä¸æ˜¯åœ¨ `Foo` ç±»çš„å®ä¾‹ä¸Šè°ƒç”¨ã€‚å¦‚æœåœ¨å®ä¾‹ä¸Šè°ƒç”¨é™æ€æ–¹æ³•ï¼Œä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼Œè¡¨ç¤ºä¸å­˜åœ¨è¯¥æ–¹æ³•ã€‚\n\n## Class çš„é™æ€å±æ€§å’Œå®ä¾‹å±æ€§\n\né™æ€å±æ€§æŒ‡çš„æ˜¯ Class æœ¬èº«çš„å±æ€§ï¼Œå³ `Class.propName`ï¼Œè€Œä¸æ˜¯å®šä¹‰åœ¨å®ä¾‹å¯¹è±¡ `this` ä¸Šçš„å±æ€§ã€‚\n\n```js\nclass Foo {\n}\n\nFoo.prop = 1;\nFoo.prop // 1\n```\n\nä¸Šé¢çš„å†™æ³•ä¸º `Foo` ç±»å®šä¹‰äº†ä¸€ä¸ªé™æ€å±æ€§ `prop`ã€‚\n\nç›®å‰ï¼Œåªæœ‰è¿™ç§å†™æ³•å¯è¡Œï¼Œå› ä¸º ES6 æ˜ç¡®è§„å®šï¼ŒClass å†…éƒ¨åªæœ‰é™æ€æ–¹æ³•ï¼Œæ²¡æœ‰é™æ€å±æ€§ã€‚\n\n```js\n// ä»¥ä¸‹ä¸¤ç§å†™æ³•éƒ½æ— æ•ˆ\nclass Foo {\n  // å†™æ³•ä¸€\n  prop: 2\n\n  // å†™æ³•äºŒ\n  static prop: 2\n}\n\nFoo.prop // undefined\n```\n\nç›®å‰æœ‰ä¸€ä¸ªé™æ€å±æ€§çš„ææ¡ˆï¼Œç±»çš„é™æ€å±æ€§åªè¦åœ¨ä¸Šé¢çš„å®ä¾‹å±æ€§å†™æ³•å‰é¢ï¼ŒåŠ ä¸Š `static` å…³é”®å­—å°±å¯ä»¥äº†ã€‚\n\n```js\nclass MyClass {\n  static myStaticProp = 42;\n\n  constructor() {\n    console.log(MyClass.myStaticProp); // 42\n  }\n}\n```","tags":["ES6"],"categories":["Note"]},{"title":"LeanJsã€Œ ES6 ã€-- Async","url":"%2F2018%2F02%2F13%2FLeanJSAsync%2F","content":"\n![Js](LeanJSAsync/js.png)\n\n<!--more-->\n\n## å«ä¹‰\n\nå°±æ˜¯ Generator å‡½æ•°çš„è¯­æ³•ç³–ã€‚\n\n>è¯­æ³•ç³–ï¼ˆSyntactic sugarï¼‰ï¼Œä¹Ÿè¯‘ä¸ºç³–è¡£è¯­æ³•ï¼Œæ˜¯ç”±è‹±å›½è®¡ç®—æœºç§‘å­¦å®¶å½¼å¾—Â·çº¦ç¿°Â·å…°è¾¾ï¼ˆPeter J. Landinï¼‰å‘æ˜çš„ä¸€ä¸ªæœ¯è¯­ï¼ŒæŒ‡è®¡ç®—æœºè¯­è¨€ä¸­æ·»åŠ çš„æŸç§è¯­æ³•ï¼Œè¿™ç§è¯­æ³•å¯¹è¯­è¨€çš„åŠŸèƒ½å¹¶æ²¡æœ‰å½±å“ï¼Œä½†æ˜¯æ›´æ–¹ä¾¿ç¨‹åºå‘˜ä½¿ç”¨ã€‚é€šå¸¸æ¥è¯´ä½¿ç”¨è¯­æ³•ç³–èƒ½å¤Ÿå¢åŠ ç¨‹åºçš„å¯è¯»æ€§ï¼Œä»è€Œå‡å°‘ç¨‹åºä»£ç å‡ºé”™çš„æœºä¼šã€‚  --ç™¾åº¦ç™¾ç§‘\n\nGenerator å‡½æ•°ä¾æ¬¡è¯»å–ä¸¤ä¸ªæ–‡ä»¶çš„å‡½æ•°å¦‚ä¸‹\n\n```js\nconst fs = require('fs');\n\nconst readFile = function (fileName) {\n  return new Promise(function (resolve, reject) {\n    fs.readFile(fileName, function(error, data) {\n      if (error) return reject(error);\n      resolve(data);\n    });\n  });\n};\n\nconst gen = function* () {\n  const f1 = yield readFile('/etc/fstab');\n  const f2 = yield readFile('/etc/shells');\n  console.log(f1.toString());\n  console.log(f2.toString());\n};\n```\n\nå†™æˆ `async` å‡½æ•°ï¼Œå°±æ˜¯ä¸‹é¢è¿™æ ·\n\n```js\nconst asyncReadFile = async function () {\n  const f1 = await readFile('/etc/fstab');\n  const f2 = await readFile('/etc/shells');\n  console.log(f1.toString());\n  console.log(f2.toString());\n};\n```\n\n`async` å‡½æ•°å°±æ˜¯å°† Generator å‡½æ•°çš„ `*` æ›¿æ¢æˆ `async` ï¼Œå°† `yield` æ›¿æ¢æˆ `await` ï¼Œä»…æ­¤è€Œå·²\n\n`async` å‡½æ•°å¯¹ Generator å‡½æ•°çš„æ”¹è¿›ä½“ç°åœ¨å››ç‚¹\n\n**å†…ç½®æ‰§è¡Œå™¨** \n\n`async` å‡½æ•°è‡ªå¸¦æ‰§è¡Œå™¨ï¼Œä¸æ™®é€šå‡½æ•°ä¸€æ ·ï¼Œå¯ä»¥è‡ªåŠ¨æ‰§è¡Œ\n\n```js\nasyncReadFile()\n```\n\nä¸éœ€è¦è°ƒç”¨ `next` æ–¹æ³•\n\n**æ›´å¥½çš„è¯­ä¹‰**\n\n`async` å’Œ `await` æ¯”èµ· `*` å’Œ `yield` è¯­ä¹‰æ›´æ¸…æ¥š\n\n**æ›´å¹¿çš„é€‚ç”¨æ€§**\n\n`yield` å‘½ä»¤åé¢åªèƒ½æ˜¯ Thunk å‡½æ•°æˆ– Promise å¯¹è±¡ï¼Œè€Œ `async` å‡½æ•°çš„ `await` å‘½ä»¤åé¢ï¼Œå¯ä»¥æ˜¯ Promise å¯¹è±¡å’ŒåŸå§‹ç±»å‹çš„å€¼\n\n**è¿”å›å€¼æ˜¯ Promise**\n\n`async` å‡½æ•°çš„è¿”å›å€¼æ˜¯ Promise å¯¹è±¡ï¼Œè¿™æ¯” Generator å‡½æ•°çš„è¿”å›å€¼æ˜¯ Iterator å¯¹è±¡æ–¹ä¾¿\n\n## åŸºæœ¬ç”¨æ³•\n\nä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼ŒæŒ‡å®šå¤šå°‘æ¯«ç§’åè¾“å‡ºä¸€ä¸ªå€¼\n\n```js\nfunction timeout(ms) {\n  return new Promise((resolve) => {\n    setTimeout(resolve, ms);\n  });\n}\n\nasync function asyncPrint(value, ms) {\n  await timeout(ms);\n  console.log(value);\n}\n\nasyncPrint('hello world', 50);\n```\n\n## è¯­æ³•\n\n### è¿”å› Promise å¯¹è±¡\n\n`async` å‡½æ•°è¿”å›ä¸€ä¸ª Promise å¯¹è±¡\n\n`async` å‡½æ•°å†…éƒ¨ `return` è¯­å¥è¿”å›çš„å€¼ï¼Œä¼šæˆä¸º `then` æ–¹æ³•å›è°ƒå‡½æ•°çš„å‚æ•°\n\n```js\nasync function f() {\n  return 'hello world';\n}\n\nf().then(v => console.log(v))\n// \"hello world\"\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œå‡½æ•° `f` å†…éƒ¨ `return` å‘½ä»¤è¿”å›çš„å€¼ï¼Œä¼šè¢« `then` æ–¹æ³•å›è°ƒå‡½æ•°æ¥æ”¶åˆ°\n\n`async` å‡½æ•°å†…éƒ¨æŠ›å‡ºé”™è¯¯ï¼Œä¼šå¯¼è‡´è¿”å›çš„ Promise å¯¹è±¡å˜ä¸º `reject` çŠ¶æ€ï¼ŒæŠ›å‡ºçš„é”™è¯¯å¯¹è±¡ä¼šè¢« `catch` æ–¹æ³•å›è°ƒå‡½æ•°æ¥æ”¶åˆ°\n\n```js\nasync function f() {\n  throw new Error('å‡ºé”™äº†');\n}\n\nf().then(\n  v => console.log(v),\n  e => console.log(e)\n)\n// Error: å‡ºé”™äº†\n```\n\nPromise å¯¹è±¡çš„çŠ¶æ€å˜åŒ–\n\n## await å‘½ä»¤  \n\n`await` å‘½ä»¤åé¢æ˜¯ä¸€ä¸ª Promise å¯¹è±¡ã€‚å¦‚æœä¸æ˜¯ï¼Œä¼šè¢«è½¬æˆä¸€ä¸ªç«‹å³ `resolve` çš„ Promise å¯¹è±¡\n\n```js\nasync function f() {\n  return await 123;\n}\n\nf().then(v => console.log(v))\n// 123\n```       \n\n`await` å‘½ä»¤åé¢çš„ Promise å¯¹è±¡å¦‚æœå˜æˆ `reject` çŠ¶æ€ï¼Œåˆ™ `reject` çš„å‚æ•°ä¼šè¢« `catch` æ–¹æ³•çš„å›è°ƒå‡½æ•°æ¥æ”¶åˆ°\n\n```js\nasync function f() {\n  await Promise.reject('å‡ºé”™äº†');\n}\n\nf()\n.then(v => console.log(v))\n.catch(e => console.log(e))\n// å‡ºé”™äº†\n```\n\næ³¨æ„ï¼Œä¸Šé¢ä»£ç ä¸­ï¼Œ`await` è¯­å¥å‰é¢æ²¡æœ‰ `return`ï¼Œä½†æ˜¯ `reject` æ–¹æ³•çš„å‚æ•°ä¾ç„¶ä¼ å…¥äº† `catch` æ–¹æ³•çš„å›è°ƒå‡½æ•°ã€‚è¿™é‡Œå¦‚æœåœ¨ `await` å‰é¢åŠ ä¸Š `return`ï¼Œæ•ˆæœæ˜¯ä¸€æ ·çš„\n\nåªè¦æœ‰ä¸€ä¸ª `await` è¯­å¥åé¢çš„ Promise å˜ä¸º `reject` ï¼Œé‚£ä¹ˆæ•´ä¸ª `async` å‡½æ•°éƒ½ä¼šä¸­æ–­æ‰§è¡Œ\n\n```js\nasync function f() {\n  await Promise.reject('å‡ºé”™äº†');\n  await Promise.resolve('hello world'); // ä¸ä¼šæ‰§è¡Œ\n}\n```\n\nç¬¬äºŒä¸ª `await` è¯­å¥æ˜¯ä¸ä¼šæ‰§è¡Œçš„ï¼Œå› ä¸ºç¬¬ä¸€ä¸ª `await` è¯­å¥çŠ¶æ€å˜æˆäº† `reject`ã€‚ä½†æ˜¯æœ‰çš„æ—¶å€™æˆ‘ä»¬å¸Œæœ›å³ä½¿ç¬¬ä¸€ä¸ªæ“ä½œå¤±è´¥ï¼Œä¹Ÿä¸è¦ä¸­æ–­åé¢çš„å¼‚æ­¥æ“ä½œï¼Œä½†ä¹ˆæˆ‘ä»¬å°±éœ€è¦ç”¨åˆ°ä»¥ä¸‹ä¸¤ç§æ–¹æ³•\n\n```js\n//ç¬¬ä¸€ç§\nasync function f() {\n  try {\n    await Promise.reject('å‡ºé”™äº†');\n  } catch(e) {\n  }\n  return await Promise.resolve('hello world');\n}\n\nf()\n.then(v => console.log(v))\n// hello world\n\n//ç¬¬äºŒç§\nasync function f() {\n  await Promise.reject('å‡ºé”™äº†')\n    .catch(e => console.log(e));\n  return await Promise.resolve('hello world');\n}\n\nf()\n.then(v => console.log(v))\n// å‡ºé”™äº†\n// hello world\n```","tags":["ES6"],"categories":["Note"]},{"title":"LeanJsã€Œ ES6 ã€-- Generator å‡½æ•°çš„å¼‚æ­¥åº”ç”¨","url":"%2F2018%2F02%2F12%2FLeanJSGenerator%E5%87%BD%E6%95%B0%E7%9A%84%E5%BC%82%E6%AD%A5%E5%BA%94%E7%94%A8%2F","content":"\n![Js](LeanJSGeneratorå‡½æ•°çš„å¼‚æ­¥åº”ç”¨/js.png)\n\n<!--more-->\n\n## Generator å‡½æ•°\n\n### åç¨‹\n\nä¼ ç»Ÿçš„ç¼–ç¨‹è¯­è¨€ï¼Œæ—©æœ‰å¼‚æ­¥ç¼–ç¨‹çš„è§£å†³æ–¹æ¡ˆï¼ˆå…¶å®æ˜¯å¤šä»»åŠ¡çš„è§£å†³æ–¹æ¡ˆï¼‰ã€‚å…¶ä¸­æœ‰ä¸€ç§å«åšã€Œåç¨‹ã€ï¼ˆcoroutineï¼‰ï¼Œæ„æ€æ˜¯å¤šä¸ªçº¿ç¨‹äº’ç›¸åä½œï¼Œå®Œæˆå¼‚æ­¥ä»»åŠ¡ã€‚\n\nåç¨‹æœ‰ç‚¹åƒå‡½æ•°ï¼Œåˆæœ‰ç‚¹åƒçº¿ç¨‹ã€‚å®ƒçš„è¿è¡Œæµç¨‹å¤§è‡´å¦‚ä¸‹ã€‚\n\nç¬¬ä¸€æ­¥ï¼Œåç¨‹ `A` å¼€å§‹æ‰§è¡Œã€‚\nç¬¬äºŒæ­¥ï¼Œåç¨‹ `A` æ‰§è¡Œåˆ°ä¸€åŠï¼Œè¿›å…¥æš‚åœï¼Œæ‰§è¡Œæƒè½¬ç§»åˆ°åç¨‹ `B`ã€‚\nç¬¬ä¸‰æ­¥ï¼Œï¼ˆä¸€æ®µæ—¶é—´åï¼‰åç¨‹ `B` äº¤è¿˜æ‰§è¡Œæƒã€‚\nç¬¬å››æ­¥ï¼Œåç¨‹ `A` æ¢å¤æ‰§è¡Œã€‚\nä¸Šé¢æµç¨‹çš„åç¨‹ `A`ï¼Œå°±æ˜¯å¼‚æ­¥ä»»åŠ¡ï¼Œå› ä¸ºå®ƒåˆ†æˆä¸¤æ®µï¼ˆæˆ–å¤šæ®µï¼‰æ‰§è¡Œã€‚\n\nä¸¾ä¾‹æ¥è¯´ï¼Œè¯»å–æ–‡ä»¶çš„åç¨‹å†™æ³•å¦‚ä¸‹ã€‚\n\n```js\nfunction* asyncJob() {\n  // ...å…¶ä»–ä»£ç \n  var f = yield readFile(fileA);\n  // ...å…¶ä»–ä»£ç \n}\n```\n\nä¸Šé¢ä»£ç çš„å‡½æ•° `asyncJob` æ˜¯ä¸€ä¸ªåç¨‹ï¼Œå®ƒçš„å¥¥å¦™å°±åœ¨å…¶ä¸­çš„ `yield` å‘½ä»¤ã€‚å®ƒè¡¨ç¤ºæ‰§è¡Œåˆ°æ­¤å¤„ï¼Œæ‰§è¡Œæƒå°†äº¤ç»™å…¶ä»–åç¨‹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ`yield` å‘½ä»¤æ˜¯å¼‚æ­¥ä¸¤ä¸ªé˜¶æ®µçš„åˆ†ç•Œçº¿ã€‚\n\nåç¨‹é‡åˆ° `yield` å‘½ä»¤å°±æš‚åœï¼Œç­‰åˆ°æ‰§è¡Œæƒè¿”å›ï¼Œå†ä»æš‚åœçš„åœ°æ–¹ç»§ç»­å¾€åæ‰§è¡Œã€‚å®ƒçš„æœ€å¤§ä¼˜ç‚¹ï¼Œå°±æ˜¯ä»£ç çš„å†™æ³•éå¸¸åƒåŒæ­¥æ“ä½œï¼Œå¦‚æœå»é™¤ `yield` å‘½ä»¤ï¼Œç®€ç›´ä¸€æ¨¡ä¸€æ ·ã€‚\n\n### å¼‚æ­¥ä»»åŠ¡çš„å°è£…\n\nä¸‹é¢çœ‹çœ‹å¦‚ä½•ä½¿ç”¨ Generator å‡½æ•°ï¼Œæ‰§è¡Œä¸€ä¸ªçœŸå®çš„å¼‚æ­¥ä»»åŠ¡ã€‚\n\n```js\nvar fetch = require('node-fetch');\n\nfunction* gen(){\n  var url = 'https://api.github.com/users/github';\n  var result = yield fetch(url);\n  console.log(result.bio);\n}\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼ŒGenerator å‡½æ•°å°è£…äº†ä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼Œè¯¥æ“ä½œå…ˆè¯»å–ä¸€ä¸ªè¿œç¨‹æ¥å£ï¼Œç„¶åä» JSON æ ¼å¼çš„æ•°æ®è§£æä¿¡æ¯ã€‚å°±åƒå‰é¢è¯´è¿‡çš„ï¼Œè¿™æ®µä»£ç éå¸¸åƒåŒæ­¥æ“ä½œï¼Œé™¤äº†åŠ ä¸Šäº† `yield` å‘½ä»¤ã€‚\n\næ‰§è¡Œè¿™æ®µä»£ç çš„æ–¹æ³•å¦‚ä¸‹ã€‚\n\n```js\nvar g = gen();\nvar result = g.next();\n\nresult.value.then(function(data){\n  return data.json();\n}).then(function(data){\n  g.next(data);\n});\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œé¦–å…ˆæ‰§è¡Œ Generator å‡½æ•°ï¼Œè·å–éå†å™¨å¯¹è±¡ï¼Œç„¶åä½¿ç”¨ `next` æ–¹æ³•ï¼ˆç¬¬äºŒè¡Œï¼‰ï¼Œæ‰§è¡Œå¼‚æ­¥ä»»åŠ¡çš„ç¬¬ä¸€é˜¶æ®µã€‚ç”±äº `Fetch` æ¨¡å—è¿”å›çš„æ˜¯ä¸€ä¸ª Promise å¯¹è±¡ï¼Œå› æ­¤è¦ç”¨ `then` æ–¹æ³•è°ƒç”¨ä¸‹ä¸€ä¸ª `next` æ–¹æ³•ã€‚\n\nå¯ä»¥çœ‹åˆ°ï¼Œè™½ç„¶ Generator å‡½æ•°å°†å¼‚æ­¥æ“ä½œè¡¨ç¤ºå¾—å¾ˆç®€æ´ï¼Œä½†æ˜¯æµç¨‹ç®¡ç†å´ä¸æ–¹ä¾¿ï¼ˆå³ä½•æ—¶æ‰§è¡Œç¬¬ä¸€é˜¶æ®µã€ä½•æ—¶æ‰§è¡Œç¬¬äºŒé˜¶æ®µï¼‰ã€‚","tags":["ES6"],"categories":["Note"]},{"title":"LeanJsã€Œ ES6 ã€-- Generator å‡½æ•°çš„è¯­æ³•","url":"%2F2018%2F02%2F11%2FLeanJSGenerator%E5%87%BD%E6%95%B0%E7%9A%84%E8%AF%AD%E6%B3%95%2F","content":"\n![Js](LeanJSGeneratorå‡½æ•°çš„è¯­æ³•/js.png)\n\n<!--more-->\n\n## ç®€ä»‹\n\nGenerator è‹±æ–‡ä¸º ã€Œç”Ÿäº§æœºã€çš„æ„æ€ï¼Œå†…éƒ¨å°è£…äº†å¤šä¸ªçŠ¶æ€ã€‚\n\næ‰§è¡Œ Generator å‡½æ•°ä¼šè¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒGenerator å‡½æ•°é™¤äº†çŠ¶æ€æœºï¼Œè¿˜æ˜¯ä¸€ä¸ªéå†å™¨å¯¹è±¡ç”Ÿæˆå‡½æ•°ã€‚è¿”å›çš„éå†å™¨å¯¹è±¡ï¼Œå¯ä»¥ä¾æ¬¡éå† Generator å‡½æ•°å†…éƒ¨çš„æ¯ä¸€ä¸ªçŠ¶æ€\n\nGenerator å‡½æ•°æœ‰ä¸¤ä¸ªç‰¹å¾\n\n- `function` å…³é”®å­ä¸å‡½æ•°åä¹‹é—´æœ‰ä¸€ä¸ªæ˜Ÿå·\n- å‡½æ•°ä½“å†…éƒ¨ä½¿ç”¨ `yield` è¡¨è¾¾å¼ï¼Œè¡¨ç¤ºä¸åŒçš„å†…éƒ¨çŠ¶æ€\n\n```js\nfunction* helloWorldGenerator() {\n  yield 'hello';\n  yield 'world';\n  return 'ending';\n}\n\nvar hw = helloWorldGenerator();\n```\n\nåœ¨å‡½æ•°ååé¢åŠ ä¸Šä¸€å¯¹åœ†æ‹¬å·åï¼ŒGenerator å‡½æ•°å¹¶ä¸æ‰§è¡Œï¼Œè¿”å›çš„ä¹Ÿä¸æ˜¯å‡½æ•°è¿è¡Œçš„ç»“æœï¼Œè€Œæ˜¯ä¸€ä¸ªæŒ‡å‘å†…éƒ¨çŠ¶æ€çš„æŒ‡é’ˆå¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯ Iterator Object\n\nå¿…é¡»è°ƒç”¨éå†å™¨å¯¹è±¡çš„ `next` æ–¹æ³•ï¼Œä½¿å¾—æŒ‡é’ˆç§»å‘ä¸‹ä¸€ä¸ªçŠ¶æ€ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯æ¬¡è°ƒç”¨ `next` å†…éƒ¨æŒ‡é’ˆå°±ä»å‡½æ•°å¤´éƒ¨æˆ–ä¸Šä¸€æ¬¡åœä¸‹æ¥çš„åœ°æ–¹å¼€å§‹æ‰§è¡Œï¼Œç›´åˆ°é‡åˆ°ä¸‹ä¸€ä¸ª `yield` è¡¨è¾¾å¼ï¼ˆæˆ– `return` è¯­å¥ï¼‰ä¸ºæ­¢ã€‚æ¢è¨€ä¹‹ï¼ŒGenerator å‡½æ•°æ˜¯åˆ†æ®µæ‰§è¡Œçš„ï¼Œ`yield` è¡¨è¾¾å¼æ˜¯æš‚åœæ‰§è¡Œçš„æ ‡è®°ï¼Œè€Œ `next` æ–¹æ³•å¯ä»¥æ¢å¤æ‰§è¡Œã€‚\n\n```js\nhw.next()\n// { value: 'hello', done: false }\n\nhw.next()\n// { value: 'world', done: false }\n\nhw.next()\n// { value: 'ending', done: true }\n\nhw.next()\n// { value: undefined, done: true }\n```\n\nç¬¬ä¸€æ¬¡è°ƒç”¨ï¼ŒGenerator å‡½æ•°å¼€å§‹æ‰§è¡Œï¼Œç›´åˆ°é‡åˆ°ç¬¬ä¸€ä¸ª `yield` è¡¨è¾¾å¼ä¸ºæ­¢ã€‚`next` æ–¹æ³•è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒçš„ `value` å±æ€§å°±æ˜¯å½“å‰ `yield` è¡¨è¾¾å¼çš„å€¼ `hello`ï¼Œ`done` å±æ€§çš„å€¼ `false`ï¼Œè¡¨ç¤ºéå†è¿˜æ²¡æœ‰ç»“æŸã€‚\n\nç¬¬äºŒæ¬¡è°ƒç”¨ï¼ŒGenerator å‡½æ•°ä»ä¸Šæ¬¡ `yield` è¡¨è¾¾å¼åœä¸‹çš„åœ°æ–¹ï¼Œä¸€ç›´æ‰§è¡Œåˆ°ä¸‹ä¸€ä¸ª `yield` è¡¨è¾¾å¼ã€‚`next` æ–¹æ³•è¿”å›çš„å¯¹è±¡çš„ `value` å±æ€§å°±æ˜¯å½“å‰ `yield` è¡¨è¾¾å¼çš„å€¼ `world`ï¼Œ`done` å±æ€§çš„å€¼ `false` ï¼Œè¡¨ç¤ºéå†è¿˜æ²¡æœ‰ç»“æŸã€‚\n\nç¬¬ä¸‰æ¬¡è°ƒç”¨ï¼ŒGenerator å‡½æ•°ä»ä¸Šæ¬¡ `yield` è¡¨è¾¾å¼åœä¸‹çš„åœ°æ–¹ï¼Œä¸€ç›´æ‰§è¡Œåˆ° `return` è¯­å¥ï¼ˆå¦‚æœæ²¡æœ‰ `return` è¯­å¥ï¼Œå°±æ‰§è¡Œåˆ°å‡½æ•°ç»“æŸï¼‰ã€‚`next` æ–¹æ³•è¿”å›çš„å¯¹è±¡çš„ `value` å±æ€§ï¼Œå°±æ˜¯ç´§è·Ÿåœ¨ `return` è¯­å¥åé¢çš„è¡¨è¾¾å¼çš„å€¼ï¼ˆå¦‚æœæ²¡æœ‰ `return` è¯­å¥ï¼Œåˆ™ `value` å±æ€§çš„å€¼ä¸º `undefined` ï¼‰ï¼Œ`done` å±æ€§çš„å€¼ `true`ï¼Œè¡¨ç¤ºéå†å·²ç»ç»“æŸã€‚\n\nç¬¬å››æ¬¡è°ƒç”¨ï¼Œæ­¤æ—¶ Generator å‡½æ•°å·²ç»è¿è¡Œå®Œæ¯•ï¼Œ`next` æ–¹æ³•è¿”å›å¯¹è±¡çš„ `value` å±æ€§ä¸º `undefined`ï¼Œ`done` å±æ€§ä¸º `true` ã€‚ä»¥åå†è°ƒç”¨ `next` æ–¹æ³•ï¼Œè¿”å›çš„éƒ½æ˜¯è¿™ä¸ªå€¼ã€‚\n\næ€»ç»“ä¸€ä¸‹ï¼Œè°ƒç”¨ Generator å‡½æ•°ï¼Œè¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œä»£è¡¨ Generator å‡½æ•°çš„å†…éƒ¨æŒ‡é’ˆã€‚ä»¥åï¼Œæ¯æ¬¡è°ƒç”¨éå†å™¨å¯¹è±¡çš„ `next` æ–¹æ³•ï¼Œå°±ä¼šè¿”å›ä¸€ä¸ªæœ‰ç€ `value` å’Œ `done` ä¸¤ä¸ªå±æ€§çš„å¯¹è±¡ã€‚`value` å±æ€§è¡¨ç¤ºå½“å‰çš„å†…éƒ¨çŠ¶æ€çš„å€¼ï¼Œæ˜¯ `yield` è¡¨è¾¾å¼åé¢é‚£ä¸ªè¡¨è¾¾å¼çš„å€¼ï¼›`done` å±æ€§æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦éå†ç»“æŸã€‚\n\nES6 æ²¡æœ‰è§„å®šï¼Œ`function` å…³é”®å­—ä¸å‡½æ•°åä¹‹é—´çš„æ˜Ÿå·ï¼Œå†™åœ¨å“ªä¸ªä½ç½®ã€‚è¿™å¯¼è‡´ä¸‹é¢çš„å†™æ³•éƒ½èƒ½é€šè¿‡ã€‚\n\n```js\nfunction * foo(x, y) { Â·Â·Â· }\nfunction *foo(x, y) { Â·Â·Â· }\nfunction* foo(x, y) { Â·Â·Â· } //å¸¸ç”¨\nfunction*foo(x, y) { Â·Â·Â· }\n```\n\n## yield è¡¨è¾¾å¼\n\nGenerator å‡½æ•°è¿”å›çš„éå†å™¨å¯¹è±¡ï¼Œåªæœ‰è°ƒç”¨ `next` æ–¹æ³•æ‰ä¼šéå†ä¸‹ä¸€ä¸ªå†…éƒ¨çŠ¶æ€ï¼Œæ‰€ä»¥å…¶å®æä¾›äº†ä¸€ç§å¯ä»¥æš‚åœæ‰§è¡Œçš„å‡½æ•°ã€‚`yield` è¡¨è¾¾å¼å°±æ˜¯ã€Œæš‚åœæ ‡å¿—ã€\n\n1 é‡åˆ° `yield` è¡¨è¾¾å¼ï¼Œå°±æš‚åœæ‰§è¡Œåé¢çš„æ“ä½œï¼Œå¹¶å°†ç´§è·Ÿåœ¨ `yield` åé¢çš„é‚£ä¸ªè¡¨è¾¾å¼çš„å€¼ï¼Œä½œä¸ºè¿”å›çš„å¯¹è±¡çš„ `value` å±æ€§å€¼\n\n2 ä¸‹ä¸€æ¬¡è°ƒç”¨ `next` æ–¹æ³•æ—¶ï¼Œå†ç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼Œç›´åˆ°é‡åˆ°ä¸‹ä¸€ä¸ª `yield` è¡¨è¾¾å¼\n\n3 å¦‚æœæ²¡æœ‰å†é‡åˆ°æ–°çš„ `yield` è¡¨è¾¾å¼ï¼Œå°±ä¸€ç›´è¿è¡Œåˆ°å‡½æ•°ç»“æŸï¼ŒçŸ¥é“ `return` è¯­å¥ä¸ºæ­¢ï¼Œå¹¶å°† `return` è¯­å¥åé¢çš„è¡¨è¾¾å¼çš„å€¼ï¼Œä½œä¸ºè¿”å›çš„å¯¹è±¡çš„ `value` å±æ€§å€¼\n\néœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ`yield` è¡¨è¾¾å¼åé¢çš„è¡¨è¾¾å¼ï¼Œåªæœ‰å½“è°ƒç”¨ `next` æ–¹æ³•ã€å†…éƒ¨æŒ‡é’ˆæŒ‡å‘è¯¥è¯­å¥æ—¶æ‰ä¼šæ‰§è¡Œï¼Œå› æ­¤ç­‰äºä¸º JavaScript æä¾›äº†æ‰‹åŠ¨çš„ã€Œæƒ°æ€§æ±‚å€¼ã€ï¼ˆLazy Evaluationï¼‰çš„è¯­æ³•åŠŸèƒ½ã€‚\n\n```js\nfunction* gen() {\n  yield  123 + 456;\n}\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œ`yield` åé¢çš„è¡¨è¾¾å¼ `123 + 456`ï¼Œä¸ä¼šç«‹å³æ±‚å€¼ï¼Œåªä¼šåœ¨ `next` æ–¹æ³•å°†æŒ‡é’ˆç§»åˆ°è¿™ä¸€å¥æ—¶ï¼Œæ‰ä¼šæ±‚å€¼ã€‚\n\n`yield` åªèƒ½ç”¨åœ¨ Generator å‡½æ•°é‡Œé¢ï¼Œç”¨åœ¨å…¶ä»–åœ°æ–¹æŠ¥é”™\n\n```js\n(function (){\n  yield 1;\n})()\n// SyntaxError: Unexpected number\n```\n\nå¦å¤–ï¼Œ`yield` è¡¨è¾¾å¼å¦‚æœç”¨åœ¨å¦ä¸€ä¸ªè¡¨è¾¾å¼ä¹‹ä¸­ï¼Œå¿…é¡»æ”¾åœ¨åœ†æ‹¬å·é‡Œé¢ã€‚\n\n```js\nfunction* demo() {\n  console.log('Hello' + yield); // SyntaxError\n  console.log('Hello' + yield 123); // SyntaxError\n\n  console.log('Hello' + (yield)); // OK\n  console.log('Hello' + (yield 123)); // OK\n}\n```\n\n`yield` è¡¨è¾¾å¼ç”¨ä½œå‡½æ•°å‚æ•°æˆ–æ”¾åœ¨èµ‹å€¼è¡¨è¾¾å¼çš„å³è¾¹ï¼Œå¯ä»¥ä¸åŠ æ‹¬å·ã€‚\n\n```js\nfunction* demo() {\n  foo(yield 'a', yield 'b'); // OK\n  let input = yield; // OK\n}\n```\n\n\n## ä¸  Iterator æ¥å£çš„å…³ç³»\n\nç”±äº Generator å‡½æ•°å°±æ˜¯éå†å™¨ç”Ÿæˆå‡½æ•°ï¼Œå› æ­¤å¯ä»¥æŠŠ Generator èµ‹å€¼ç»™å¯¹è±¡çš„ `Symbol.iterator` å±æ€§ï¼Œä»è€Œä½¿å¾—è¯¥å¯¹è±¡å…·æœ‰ Iterator æ¥å£ã€‚\n\n```js\nvar myIterable = {};\nmyIterable[Symbol.iterator] = function* () {\n  yield 1;\n  yield 2;\n  yield 3;\n};\n\n[...myIterable] // [1, 2, 3]\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼ŒGenerator å‡½æ•°èµ‹å€¼ç»™ `Symbol.iterator` å±æ€§ï¼Œä»è€Œä½¿å¾— `myIterable` å¯¹è±¡å…·æœ‰äº† Iterator æ¥å£ï¼Œå¯ä»¥è¢« `...` è¿ç®—ç¬¦éå†äº†ã€‚\n\n## next æ–¹æ³•çš„å‚æ•°\n\n`yield` è¡¨è¾¾å¼æœ¬èº«æ²¡æœ‰è¿”å›å€¼ï¼Œæˆ–è€…è¯´æ€»æ˜¯è¿”å› `undefined`ã€‚`next` æ–¹æ³•å¯ä»¥å¸¦ä¸€ä¸ªå‚æ•°ï¼Œè¯¥å‚æ•°å°±ä¼šè¢«å½“ä½œä¸Šä¸€ä¸ª `yield` è¡¨è¾¾å¼çš„è¿”å›å€¼\n\n```js\nfunction* f() {\n  for(var i = 0; true; i++) {\n    var reset = yield i;\n    if(reset) { i = -1; }\n  }\n}\n\nvar g = f();\n\ng.next() // { value: 0, done: false }\ng.next() // { value: 1, done: false }\ng.next(true) // { value: 0, done: false }\n```\n\nä¸Šé¢ä»£ç å®šä¹‰äº†ä¸€ä¸ªå¯ä»¥æ— é™å¾ªç¯çš„ Generator å‡½æ•° `f`ï¼Œå› ä¸º `yield` æœ¬èº«æ²¡æœ‰è¿”å›å€¼ï¼Œæ‰€ä»¥æ¯æ¬¡ç¨‹åºè¿è¡Œåˆ° `yield` è¡¨è¾¾å¼æ—¶ï¼Œ`yield i` è¿”å›çš„éƒ½æ˜¯ `undefined`ï¼Œä¹Ÿæ˜¯å°±è¯´ï¼Œå½“ `next()` ä¸ä¼ ä»»ä½•å‚æ•°çš„æ—¶å€™ï¼Œ`reset` çš„å€¼å§‹ç»ˆä¸º `undefined`ã€‚å½“ä¼ å…¥ `true` æ—¶ï¼Œ`true` å°±ä¼šä»£æ›¿ `yield i` ä¼ é€’ç»™ `reset` ï¼Œç„¶åæ‰§è¡Œ `i = -1`ï¼Œæœ€åè¿”å› `value:0`ã€‚\n\n```js\nfunction* foo(x) {\n  var y = 2 * (yield (x + 1));\n  var z = yield (y / 3);\n  return (x + y + z);\n}\n\nvar a = foo(5);\na.next() // Object{value:6, done:false}\na.next() // Object{value:NaN, done:false}\na.next() // Object{value:NaN, done:true}\n\nvar b = foo(5);\nb.next() // { value:6, done:false }\nb.next(12) // { value:8, done:false }\nb.next(13) // { value:42, done:true }\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œç¬¬äºŒæ¬¡è¿è¡Œ `next` æ–¹æ³•çš„æ—¶å€™ä¸å¸¦å‚æ•°ï¼Œå¯¼è‡´ `y` çš„å€¼ç­‰äº `2 * undefined` ï¼ˆå³ `NaN`ï¼‰ï¼Œé™¤ä»¥ `3` ä»¥åè¿˜æ˜¯ `NaN`ï¼Œå› æ­¤è¿”å›å¯¹è±¡çš„ `value` å±æ€§ä¹Ÿç­‰äº `NaN`ã€‚ç¬¬ä¸‰æ¬¡è¿è¡Œ `Next` æ–¹æ³•çš„æ—¶å€™ä¸å¸¦å‚æ•°ï¼Œæ‰€ä»¥ `z` ç­‰äº `undefined`ï¼Œè¿”å›å¯¹è±¡çš„ `value` å±æ€§ç­‰äº `5 + NaN + undefined`ï¼Œå³ `NaN`ã€‚\n\nå¦‚æœå‘ `next` æ–¹æ³•æä¾›å‚æ•°ï¼Œè¿”å›ç»“æœå°±å®Œå…¨ä¸ä¸€æ ·äº†ã€‚ä¸Šé¢ä»£ç ç¬¬ä¸€æ¬¡è°ƒç”¨ `b` çš„ `next` æ–¹æ³•æ—¶ï¼Œè¿”å› `x+1` çš„å€¼ `6` ï¼›ç¬¬äºŒæ¬¡è°ƒç”¨ `next` æ–¹æ³•ï¼Œå°†ä¸Šä¸€æ¬¡ `yield` è¡¨è¾¾å¼çš„å€¼è®¾ä¸º `12`ï¼Œå› æ­¤ `y` ç­‰äº `24`ï¼Œè¿”å› `y / 3` çš„å€¼ `8` ï¼›ç¬¬ä¸‰æ¬¡è°ƒç”¨ `next` æ–¹æ³•ï¼Œå°†ä¸Šä¸€æ¬¡ `yield` è¡¨è¾¾å¼çš„å€¼è®¾ä¸º `13` ï¼Œå› æ­¤ `z` ç­‰äº `13`ï¼Œè¿™æ—¶ `x` ç­‰äº `5`ï¼Œ`y` ç­‰äº `24`ï¼Œæ‰€ä»¥ `return` è¯­å¥çš„å€¼ç­‰äº `42`ã€‚\n\næ³¨æ„ï¼Œ**ç”±äº `next` æ–¹æ³•çš„å‚æ•°è¡¨ç¤ºä¸Šä¸€ä¸ª `yield` è¡¨è¾¾å¼çš„è¿”å›å€¼ï¼Œæ‰€ä»¥åœ¨ç¬¬ä¸€æ¬¡ä½¿ç”¨ `next` æ–¹æ³•æ—¶ï¼Œä¼ é€’å‚æ•°æ˜¯æ— æ•ˆçš„**ã€‚V8 å¼•æ“ç›´æ¥å¿½ç•¥ç¬¬ä¸€æ¬¡ä½¿ç”¨ `next` æ–¹æ³•æ—¶çš„å‚æ•°ï¼Œåªæœ‰ä»ç¬¬äºŒæ¬¡ä½¿ç”¨ `next` æ–¹æ³•å¼€å§‹ï¼Œå‚æ•°æ‰æ˜¯æœ‰æ•ˆçš„ã€‚ä»è¯­ä¹‰ä¸Šè®²ï¼Œç¬¬ä¸€ä¸ª `next` æ–¹æ³•ç”¨æ¥å¯åŠ¨éå†å™¨å¯¹è±¡ï¼Œæ‰€ä»¥ä¸ç”¨å¸¦æœ‰å‚æ•°ã€‚\n\n```js\nfunction* gen() {\n   var val =100;\n   while(true) {\n      val = yield val;  // i=0 æ—¶ä¼ å…¥å‚æ•°(0)å¹¶è°ƒç”¨yield valï¼Œå‚æ•°(0)è¢«ä¸¢å¼ƒ\n                        // ç¬¬ä¸€æ¬¡yield val è¿”å›å¾ªç¯å‰çš„val = 100\n      console.log(val); // i=1 æ—¶ä¼ å…¥å‚æ•°(1)å¹¶è°ƒç”¨yieldï¼Œå°†å‚æ•°1èµ‹ç»™ä¸Šä¸€å¥\n   }                    // yieldçš„è¿”å›èµ‹å€¼ï¼Œç„¶åyield valï¼Œè¿”å›val = 1\n}\n\nvar g = gen();\nfor(let i =0;i<5;i++){\n   console.log(i,g.next(i).value);\n}\n\n/* è¿”å›ï¼š\n 0 100\n 1   .......è¿™ä¸ª\"1\"æ˜¯ç¬¬äºŒæ¬¡è°ƒç”¨yieldï¼Œç”±whileå†…éƒ¨console.log(val)äº§ç”Ÿçš„\n 1 1 .......è¿™ä¸ª\"1 1 \"æ˜¯yieldè¿”å›ï¼Œconsole.log(i,g.next(i).value)äº§ç”Ÿçš„\n 2\n 2 2\n 3\n 3 3\n 4\n 4 4\n*/\n```\n\n## yield* è¡¨è¾¾å¼\n\nå¦‚æœåœ¨ Generator å‡½æ•°å†…éƒ¨ï¼Œè°ƒç”¨å¦ä¸€ä¸ª Generator å‡½æ•°ï¼Œé»˜è®¤æƒ…å†µä¸‹æ˜¯æ²¡æœ‰æ•ˆæœçš„ã€‚è¿™æ—¶å°±éœ€è¦ç”¨åˆ° `yield*`\n\n```js\nfunction* foo() {\n  yield 'a';\n  yield 'b';\n}\n\nfunction* bar() {\n  yield 'x';\n  yield* foo();\n  yield 'y';\n}\n\n// ç­‰åŒäº\nfunction* bar() {\n  yield 'x';\n  yield 'a';\n  yield 'b';\n  yield 'y';\n}\n\n// ç­‰åŒäº\nfunction* bar() {\n  yield 'x';\n  for (let v of foo()) {\n    yield v;\n  }\n  yield 'y';\n}\n\nfor (let v of bar()){\n  console.log(v);\n}\n// \"x\"\n// \"a\"\n// \"b\"\n// \"y\"\n```\n\n`yield*` åé¢çš„ Generator å‡½æ•°ï¼ˆæ²¡æœ‰ `return` è¯­å¥æ—¶ï¼‰ï¼Œç­‰åŒäºåœ¨ Generator å‡½æ•°å†…éƒ¨ï¼Œéƒ¨ç½²ä¸€ä¸ª `for...of` å¾ªç¯ã€‚\n\n```js\nfunction* concat(iter1, iter2) {\n  yield* iter1;\n  yield* iter2;\n}\n\n// ç­‰åŒäº\n\nfunction* concat(iter1, iter2) {\n  for (var value of iter1) {\n    yield value;\n  }\n  for (var value of iter2) {\n    yield value;\n  }\n}\n```\nä¸Šé¢ä»£ç è¯´æ˜ï¼Œ `yield*` åé¢çš„ Generator å‡½æ•°ï¼ˆæ²¡æœ‰ `return` è¯­å¥æ—¶ï¼‰ï¼Œä¸è¿‡æ˜¯ `for...of` çš„ä¸€ç§ç®€å†™å½¢å¼ï¼Œå®Œå…¨å¯ä»¥ç”¨åè€…æ›¿ä»£å‰è€…ã€‚åä¹‹ï¼Œåœ¨æœ‰ `return` è¯­å¥æ—¶ï¼Œåˆ™éœ€è¦ç”¨ `var value = yield* iterator` çš„å½¢å¼è·å– `return` è¯­å¥çš„å€¼ã€‚","tags":["ES6"],"categories":["Note"]},{"title":"LeanJsã€Œ ES6 ã€-- Promise","url":"%2F2018%2F02%2F10%2FLeanJSIterator%E5%92%8CforIn%2F","content":"\n![Js](LeanJSIteratorå’ŒforIn/js.png)\n\n<!--more-->\n\n## Iterator çš„æ¦‚å¿µ\n\nJavaScript åŸæœ‰çš„è¡¨ç¤ºã€Œé›†åˆã€çš„æ•°æ®ç»“æ„ï¼Œä¸»è¦æ˜¯æ•°ç»„ `Array` å’Œå¯¹è±¡ `Object`ï¼ŒES6 åˆæ·»åŠ äº† `Map` å’Œ `Set`ã€‚è¿™æ ·å°±æœ‰äº†å››ç§æ•°æ®é›†åˆï¼Œç”¨æˆ·è¿˜å¯ä»¥ç»„åˆä½¿ç”¨å®ƒä»¬ï¼Œå®šä¹‰è‡ªå·±çš„æ•°æ®ç»“æ„ï¼Œæ¯”å¦‚æ•°ç»„çš„æˆå‘˜æ˜¯ `Map`ï¼Œ`Map` çš„æˆå‘˜æ˜¯å¯¹è±¡ã€‚è¿™æ ·å°±éœ€è¦ä¸€ç§ç»Ÿä¸€çš„æ¥å£æœºåˆ¶ï¼Œæ¥å¤„ç†æ‰€æœ‰ä¸åŒçš„æ•°æ®ç»“æ„ã€‚\n\néå†å™¨ï¼ˆIteratorï¼‰å°±æ˜¯è¿™æ ·ä¸€ç§æœºåˆ¶ã€‚å®ƒæ˜¯ä¸€ç§æ¥å£ï¼Œä¸ºå„ç§ä¸åŒçš„æ•°æ®ç»“æ„æä¾›**ç»Ÿä¸€**çš„è®¿é—®æœºåˆ¶ã€‚ä»»ä½•æ•°æ®ç»“æ„åªè¦éƒ¨ç½² Iterator æ¥å£ï¼Œå°±å¯ä»¥å®Œæˆéå†æ“ä½œï¼ˆå³ä¾æ¬¡å¤„ç†è¯¥æ•°æ®ç»“æ„çš„æ‰€æœ‰æˆå‘˜ï¼‰ã€‚\n\nIterator çš„éå†è¿‡ç¨‹æ˜¯è¿™æ ·çš„\n\n1 åˆ›å»ºä¸€ä¸ªæŒ‡é’ˆå¯¹è±¡ï¼ŒæŒ‡å‘å½“å‰æ•°æ®ç»“æ„çš„èµ·å§‹ä½ç½®ã€‚éå†å™¨æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªæŒ‡é’ˆå¯¹è±¡\n\n2 ç¬¬ä¸€æ¬¡è°ƒç”¨æŒ‡é’ˆå¯¹è±¡çš„ `next` æ–¹æ³•ï¼Œå¯ä»¥å°†æŒ‡é’ˆæŒ‡å‘æ•°æ®ç»“æ„çš„ç¬¬ä¸€ä¸ªæˆå‘˜\n\n3 ç¬¬äºŒæ¬¡è°ƒç”¨æŒ‡é’ˆå¯¹è±¡çš„ `next`æ–¹æ³•ï¼ŒæŒ‡é’ˆå°±æŒ‡å‘æ•°æ®ç»“æ„çš„ç¬¬äºŒä¸ªæˆå‘˜ã€‚\n\n4 ä¸æ–­è°ƒç”¨æŒ‡é’ˆå¯¹è±¡çš„ `next` æ–¹æ³•ï¼Œç›´åˆ°å®ƒæŒ‡å‘æ•°æ®ç»“æ„çš„ç»“æŸä½ç½®ã€‚\n\næ¯ä¸€æ¬¡è°ƒç”¨ `next` æ–¹æ³•ï¼Œéƒ½ä¼šè¿”å›æ•°æ®ç»“æ„çš„å½“å‰æˆå‘˜çš„ä¿¡æ¯ã€‚å…·ä½“æ¥è¯´ï¼Œå°±æ˜¯è¿”å›ä¸€ä¸ªåŒ…å« `value` å’Œ `done` ä¸¤ä¸ªå±æ€§çš„å¯¹è±¡ã€‚å…¶ä¸­ï¼Œ`value` å±æ€§æ˜¯å½“å‰æˆå‘˜çš„å€¼ï¼Œ`done` å±æ€§æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºéå†æ˜¯å¦ç»“æŸã€‚\n\nä¸‹é¢æˆ‘ä»¬æ¨¡æ‹Ÿä¸€ä¸‹ Iterator çš„éå†è¿‡ç¨‹\n\n```js\nfunction makeIterator(array){\n  var nextIndex = 0;\n  return {\n    next:function(){\n      return nextIndex < array.length ? \n      {value:array[nextIndex++]} :\n      {done:true}\n    }\n  }\n}\n```\n\n## é»˜è®¤ Iterator æ¥å£\n\nIterator æ¥å£æ˜¯ä¸ºæ‰€æœ‰æ•°æ®ç»“æ„æä¾›ä¸€ç§ç»Ÿä¸€çš„è®¿é—®æœºåˆ¶ï¼Œå³ `for...of` å¾ªç¯ã€‚ä¸€ä¸ªæ•°æ®ç»“æ„åªè¦éƒ¨ç½²äº† `Iterator` æ¥å£ï¼Œæˆ‘ä»¬å°±ç§°è¿™ç§æ•°æ®ç»“æ„æ˜¯ã€Œå¯éå†çš„ã€\n\né»˜è®¤çš„ Iterator æ¥å£éƒ¨ç½²åœ¨æ•°æ®ç»“æ„çš„ `Symbol.iterator` å±æ€§ï¼Œå®ƒæœ¬èº«æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæ‰§è¡Œè¿™ä¸ªå‡½æ•°ï¼Œå°±ä¼šè¿”å›ä¸€ä¸ªéå†å™¨ã€‚å…·å¤‡åŸç”Ÿ Iterator çš„æ•°æ®æ— éœ€å¤„ç†å°±å¯ä»¥è¢« `for...of` å¾ªç¯éå†.\n\nåŸç”Ÿå…·å¤‡ Iterator æ¥å£çš„æ•°æ®ç»“æ„å¦‚ä¸‹\n\n- Array \n- Map\n- Set\n- String\n- TypedArray\n- arguments\n- NodeList\n\næ•°ç»„çš„ `Symbol.iterator` å±æ€§å¯ä»¥åƒä¸‹é¢è¿™æ ·ä½¿ç”¨\n\n```js\nlet arr = ['a', 'b', 'c'];\nlet iter = arr[Symbol.iterator]();\n\niter.next() // { value: 'a', done: false }\niter.next() // { value: 'b', done: false }\niter.next() // { value: 'c', done: false }\niter.next() // { value: undefined, done: true }\n```\n\nå¯¹äºæ²¡æœ‰ Iterator æ¥å£çš„æ•°æ®ç»“æ„ï¼Œå°±éœ€è¦è‡ªå·±åœ¨ `Symbol.iterator` å±æ€§ä¸Šé¢éƒ¨ç½²ï¼Œè¿™æ ·æ‰ä¼šè¢« `for...of` å¾ªç¯éå†ï¼Œå…¶å®ä¸»è¦é’ˆå¯¹çš„å°±æ˜¯å¯¹è±¡\n\n```js\nvar a = {a:1,b:2,c:3}\nfor(var key of a){\n\tconsole.log(key);\n}\n// a is not iterable\n```\n\nå› ä¸º Iteartor æ¥å£æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªçº¿æ€§éå†ï¼Œä½†æ˜¯å¯¹è±¡æœ‰æ—¶å¹¶ä¸çŸ¥é“éœ€è¦å…ˆéå†å“ªä¸ªã€‚ä¸è¿‡ï¼Œä¸¥æ ¼åœ°è¯´ï¼Œå¯¹è±¡éƒ¨ç½²éå†å™¨æ¥å£å¹¶ä¸æ˜¯å¾ˆå¿…è¦ï¼Œå› ä¸ºè¿™æ—¶å¯¹è±¡å®é™…ä¸Šè¢«å½“ä½œ `Map` ç»“æ„ä½¿ç”¨ï¼ŒES5 æ²¡æœ‰ `Map` ç»“æ„ï¼Œè€Œ ES6 åŸç”Ÿæä¾›äº†ã€‚\n\nä¸€ä¸ªå¯¹è±¡å¦‚æœè¦å…·å¤‡å¯è¢« `for...of` å¾ªç¯è°ƒç”¨çš„ Iterator æ¥å£ï¼Œå°±å¿…é¡»åœ¨ `Symbol.iterator` çš„å±æ€§ä¸Šéƒ¨ç½²éå†å™¨ç”Ÿæˆæ–¹æ³•ï¼ˆåŸå‹é“¾ä¸Šçš„å¯¹è±¡å…·æœ‰è¯¥æ–¹æ³•ä¹Ÿå¯ï¼‰ã€‚\n\n```js\nclass RangeIterator {\n  constructor(start, stop) {\n    this.value = start;\n    this.stop = stop;\n  }\n\n  [Symbol.iterator]() { return this; }\n\n  next() {\n    var value = this.value;\n    if (value < this.stop) {\n      this.value++;\n      return {done: false, value: value};\n    }\n    return {done: true, value: undefined};\n  }\n}\n\nfunction range(start, stop) {\n  return new RangeIterator(start, stop);\n}\n\nfor (var value of range(0, 3)) {\n  console.log(value); // 0, 1, 2\n}\n```\n\nä¸Šé¢ä»£ç æ˜¯ä¸€ä¸ªç±»éƒ¨ç½² Iterator æ¥å£çš„å†™æ³•ã€‚`Symbol.iterator` å±æ€§å¯¹åº”ä¸€ä¸ªå‡½æ•°ï¼Œæ‰§è¡Œåè¿”å›å½“å‰å¯¹è±¡çš„éå†å™¨å¯¹è±¡ã€‚\n\nå¯¹äºç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼ˆå­˜åœ¨æ•°å€¼é”®åå’Œ `length` å±æ€§ï¼‰ï¼Œéƒ¨ç½² Iterator æ¥å£ï¼Œæœ‰ä¸€ä¸ªç®€ä¾¿æ–¹æ³•ï¼Œå°±æ˜¯ `Symbol.iterator` æ–¹æ³•ç›´æ¥å¼•ç”¨æ•°ç»„çš„ Iterator æ¥å£ã€‚\n\n```js\nlet iterable = {\n  0: 'a',\n  1: 'b',\n  2: 'c',\n  length: 3,\n  [Symbol.iterator]: Array.prototype[Symbol.iterator]\n};\nfor (let item of iterable) {\n  console.log(item); // 'a', 'b', 'c'\n}\n```\n\nå¯¹äºå¯¹è±¡ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ `for...in` éå†å±æ€§\n\n```js\nlet es6 = {\n  edition: 6,\n  committee: \"TC39\",\n  standard: \"ECMA-262\"\n};\n\nfor (let e in es6) {\n  console.log(e);\n}\n// edition\n// committee\n// standard\n```\n","tags":["ES6"],"categories":["Note"]},{"title":"LeanJsã€Œ ES6 ã€-- Promise","url":"%2F2018%2F02%2F09%2FLeanJSPromise%2F","content":"\n![Js](LeanJSPromise/js.png)\n\n<!--more-->\n\n## å«ä¹‰\n\nPromise æ˜¯ã€Œå¼‚æ­¥ç¼–ç¨‹ã€çš„ä¸€ç§è§£å†³æ–¹æ¡ˆï¼Œæ¯”ä¼ ç»Ÿçš„è§£å†³æ–¹æ¡ˆã€Œå›è°ƒå‡½æ•°å’Œäº‹ä»¶ã€æ›´åˆç†å’Œæ›´å¼ºå¤§ã€‚å®ƒç”±ç¤¾åŒºæœ€æ—©æå‡ºå’Œå®ç°ã€‚\n\n`Promise` æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒå¯ä»¥è·å–å¼‚æ­¥æ“ä½œçš„æ¶ˆæ¯ï¼Œå°±åƒä¸€ä¸ªå®¹å™¨ã€‚å®ƒå…è®¸ä½ ä¸ºå¼‚æ­¥æ“ä½œçš„æˆåŠŸå’Œå¤±è´¥åˆ†åˆ«ç»‘å®šç›¸åº”çš„å¤„ç†æ–¹æ³•ã€‚\n\nä¸€ä¸ª `Promise` æœ‰ä¸‰ç§çŠ¶æ€\n\n- `pending` : åˆå§‹çŠ¶æ€ï¼Œæ—¢ä¸æ˜¯æˆåŠŸï¼Œä¹Ÿä¸æ˜¯å¤±è´¥\n- `fulfilled` : æ„å‘³ç€æ“ä½œæˆåŠŸå®Œæˆ\n- `rejected` : æ„å‘³ç€æ“ä½œå¤±è´¥\n\n`Promise` å¯¹è±¡çŠ¶æ€çš„æ”¹å˜åªæœ‰ä¸¤ç§å¯èƒ½ ä» `pending` å˜ä¸º `fulfilled` å’Œä» `pending` å˜ä¸º `rejected`ã€‚è€Œä¸”ä¸€æ—¦çŠ¶æ€æ”¹å˜å°±ä¸ä¼šå†å˜äº†ï¼Œè¿™ä¸ªå®¹å™¨åªæœ‰è¿™ä¸¤ä¸ªå‡ºå£ï¼Œè€Œå®¹å™¨ä¸­å‘ç”Ÿä»»ä½•å†…éƒ¨é”™è¯¯ä¸ä¼šååº”åˆ°å¤–éƒ¨ã€‚\n\n## è¯­æ³•\n\nä¸‹é¢ä»£ç åˆ›é€ äº†ä¸€ä¸ª `Promise`å®ä¾‹ã€‚\n\n```js\nconst promise = new Promise(function(resolve, reject) {\n  // ... some code\n\n  if (/* å¼‚æ­¥æ“ä½œæˆåŠŸ */){\n    resolve(value);\n  } else {\n    reject(error);\n  }\n});\n```\n\n`resolve()` åœ¨æˆåŠŸæ—¶è°ƒç”¨ï¼Œ`reject()` åœ¨å‡ºé”™æ—¶è°ƒç”¨ï¼Œç”¨æ¥ä¼ é€’ç»™å¤–éƒ¨\n\n`Promise` å®ä¾‹ç”Ÿæˆä»¥åï¼Œå¯ä»¥ç”¨ `then` æ–¹æ³•åˆ†åˆ«æŒ‡å®š `resolved` çŠ¶æ€å’Œ `rejected` çŠ¶æ€çš„å›è°ƒå‡½æ•°ã€‚\n\n```js\npromise.then(function(value) {\n  // success\n}, function(error) {\n  // failure\n});\n```\n\n`then` æ–¹æ³•å¯ä»¥æ¥å—ä¸¤ä¸ªå›è°ƒå‡½æ•°ä½œä¸ºå‚æ•°ã€‚ç¬¬ä¸€ä¸ªå›è°ƒå‡½æ•°æ˜¯ `Promise` å¯¹è±¡çš„çŠ¶æ€å˜ä¸º `resolved` æ—¶è°ƒç”¨ï¼Œç¬¬äºŒä¸ªå›è°ƒå‡½æ•°æ˜¯ `Promise` å¯¹è±¡çš„çŠ¶æ€å˜ä¸º `rejected` æ—¶è°ƒç”¨ã€‚å…¶ä¸­ï¼Œç¬¬äºŒä¸ªå‡½æ•°æ˜¯å¯é€‰çš„ï¼Œä¸ä¸€å®šè¦æä¾›ã€‚è¿™ä¸¤ä¸ªå‡½æ•°éƒ½æ¥å— `Promise` å¯¹è±¡ä¼ å‡ºçš„å€¼ä½œä¸ºå‚æ•°ã€‚\n\næ³¨æ„ï¼Œè°ƒç”¨ `resolve` æˆ– `reject` å¹¶ä¸ä¼šç»ˆç»“ Promise çš„å‚æ•°å‡½æ•°çš„æ‰§è¡Œã€‚\n\n```js\nnew Promise((resolve, reject) => {\n  resolve(1);\n  console.log(2);\n}).then(r => {\n  console.log(r);\n});\n// 2\n// 1\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œè°ƒç”¨ `resolve(1)` ä»¥åï¼Œåé¢çš„ `console.log(2)` è¿˜æ˜¯ä¼šæ‰§è¡Œï¼Œå¹¶ä¸”ä¼šé¦–å…ˆæ‰“å°å‡ºæ¥ã€‚è¿™æ˜¯å› ä¸ºç«‹å³ `resolved` çš„ Promise æ˜¯åœ¨æœ¬è½®äº‹ä»¶å¾ªç¯çš„æœ«å°¾æ‰§è¡Œï¼Œæ€»æ˜¯æ™šäºæœ¬è½®å¾ªç¯çš„åŒæ­¥ä»»åŠ¡ã€‚\n\nä¸€èˆ¬æ¥è¯´ï¼Œè°ƒç”¨ `resolve` æˆ– `reject` ä»¥åï¼ŒPromise çš„ä½¿å‘½å°±å®Œæˆäº†ï¼Œåç»§æ“ä½œåº”è¯¥æ”¾åˆ° `then` æ–¹æ³•é‡Œé¢ï¼Œè€Œä¸åº”è¯¥ç›´æ¥å†™åœ¨ `resolve` æˆ– `reject` çš„åé¢ã€‚æ‰€ä»¥ï¼Œæœ€å¥½åœ¨å®ƒä»¬å‰é¢åŠ ä¸Š `return` è¯­å¥ï¼Œè¿™æ ·å°±ä¸ä¼šæœ‰æ„å¤–ã€‚\n\n## Promise.prototype.then()\n\n`then` æ–¹æ³•è¿”å›çš„æ˜¯ä¸€ä¸ªæ–°çš„å®ä¾‹ï¼Œå› æ­¤å¯ä»¥é‡‡ç”¨é“¾å¼å†™æ³•ã€‚ç¬¬ä¸€ä¸ªå‚æ•°ä¸º `resolved` çŠ¶æ€çš„å›è°ƒå‡½æ•°ï¼Œç¬¬äºŒä¸ªå‚æ•°ï¼ˆå¯é€‰ï¼‰ä¸º `rejected` çŠ¶æ€çš„å›è°ƒå‚æ•°\n\n```js\ngetJSON(\"/posts.json\").then(function(json) {\n  return json.post;\n}).then(function(post) {\n  // ...\n});\n```\n\nä¸Šé¢çš„ä»£ç ä½¿ç”¨ `then` æ–¹æ³•ï¼Œä¾æ¬¡æŒ‡å®šäº†ä¸¤ä¸ªå›è°ƒå‡½æ•°ã€‚ç¬¬ä¸€ä¸ªå›è°ƒå‡½æ•°å®Œæˆä»¥åï¼Œä¼šå°†è¿”å›ç»“æœä½œä¸ºå‚æ•°ï¼Œä¼ å…¥ç¬¬äºŒä¸ªå›è°ƒå‡½æ•°ã€‚\n\n## Promise.prototype.catch()\n\n`Promsie.prototype.catch()` æ–¹æ³•æ˜¯ `.then(null,rejection)` çš„åˆ«åï¼Œç”¨äºæŒ‡å®šå‘ç”Ÿé”™è¯¯çš„å›è°ƒå‡½æ•°\n\nä¸€èˆ¬æ¥è¯´ï¼Œä¸è¦åœ¨ `then` æ–¹æ³•é‡Œé¢å®šä¹‰ `Reject` çŠ¶æ€çš„å›è°ƒå‡½æ•°ï¼ˆå³thençš„ç¬¬äºŒä¸ªå‚æ•°ï¼‰ï¼Œæ€»æ˜¯ä½¿ç”¨ `catch` æ–¹æ³•ã€‚\n\n```js\n// bad\npromise\n  .then(function(data) {\n    // success\n  }, function(err) {\n    // error\n  });\n\n// good\npromise\n  .then(function(data) { //cb\n    // success\n  })\n  .catch(function(err) {\n    // error\n  });\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œç¬¬äºŒç§å†™æ³•è¦å¥½äºç¬¬ä¸€ç§å†™æ³•ï¼Œç†ç”±æ˜¯ç¬¬äºŒç§å†™æ³•å¯ä»¥æ•è·å‰é¢ `then` æ–¹æ³•æ‰§è¡Œä¸­çš„é”™è¯¯ï¼Œä¹Ÿæ›´æ¥è¿‘åŒæ­¥çš„å†™æ³•ï¼ˆ`try/catch`ï¼‰ã€‚å› æ­¤ï¼Œå»ºè®®æ€»æ˜¯ä½¿ç”¨ `catch` æ–¹æ³•ï¼Œè€Œä¸ä½¿ç”¨ `then` æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°ã€‚\n\nä¸€èˆ¬æ€»æ˜¯å»ºè®®ï¼ŒPromise å¯¹è±¡åé¢è¦è·Ÿ `catchæ–¹` æ³•ï¼Œè¿™æ ·å¯ä»¥å¤„ç† Promise å†…éƒ¨å‘ç”Ÿçš„é”™è¯¯ã€‚ `catch` æ–¹æ³•è¿”å›çš„è¿˜æ˜¯ä¸€ä¸ª Promise å¯¹è±¡ï¼Œå› æ­¤åé¢è¿˜å¯ä»¥æ¥ç€è°ƒç”¨ `then` æ–¹æ³•ã€‚\n\n```js\nconst someAsyncThing = function() {\n  return new Promise(function(resolve, reject) {\n    // ä¸‹é¢ä¸€è¡Œä¼šæŠ¥é”™ï¼Œå› ä¸ºxæ²¡æœ‰å£°æ˜\n    resolve(x + 2);\n  });\n};\n\nsomeAsyncThing()\n.catch(function(error) {\n  console.log('oh no', error);\n})\n.then(function() {\n  console.log('carry on');\n});\n// oh no [ReferenceError: x is not defined]\n// carry on\n```\n\nä¸Šé¢ä»£ç è¿è¡Œå®Œ `catch` æ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°ï¼Œä¼šæ¥ç€è¿è¡Œåé¢é‚£ä¸ª `then` æ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°s\n\n## Promise.prototype.finally\n\n`finally` æ–¹æ³•ç”¨äºæŒ‡å®šä¸ç®¡ Promise å¯¹è±¡æœ€åçŠ¶æ€å¦‚ä½•ï¼Œéƒ½ä¼šæ‰§è¡Œçš„æ“ä½œã€‚è¯¥æ–¹æ³•æ˜¯ ES2018 å¼•å…¥æ ‡å‡†çš„ã€‚ \n\n```js\n promise\n.then(result => {Â·Â·Â·})\n.catch(error => {Â·Â·Â·})\n.finally(() => {Â·Â·Â·});\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œä¸ç®¡ `promise` æœ€åçš„çŠ¶æ€ï¼Œåœ¨æ‰§è¡Œå®Œ `then` æˆ– `catch` æŒ‡å®šçš„å›è°ƒå‡½æ•°ä»¥åï¼Œéƒ½ä¼šæ‰§è¡Œ `finally` æ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°ã€‚\n\n## Promise.all\n\n`Promise.all` æ–¹æ³•ç”¨äºå°†å¤šä¸ª Promise å®ä¾‹ï¼ŒåŒ…è£…æˆä¸€ä¸ªæ–°çš„ Promise å®ä¾‹ã€‚\n\n```js\nconst p = Promise.all([p1,p2,p3]);\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œ`Promise.all()` æ¥å—äº†ä¸€ä¸ªæ•°ç»„ä½œä¸ºå‚æ•°ï¼Œ`p1`ã€`p2` ã€`p3` éƒ½æ˜¯ Promise å®ä¾‹ï¼Œå¦‚æœä¸æ˜¯ï¼Œå°±ä¼šå…ˆè°ƒç”¨ä¸‹é¢è®²åˆ°çš„ `Promise.resolve` æ–¹æ³•ï¼Œå°†å‚æ•°è½¬ä¸º Promise å®ä¾‹ï¼Œå†è¿›ä¸€æ­¥å¤„ç†ã€‚ï¼ˆ `Promise.all` æ–¹æ³•çš„å‚æ•°å¯ä»¥ä¸æ˜¯æ•°ç»„ï¼Œä½†å¿…é¡»å…·æœ‰ Iterator æ¥å£ï¼Œä¸”è¿”å›çš„æ¯ä¸ªæˆå‘˜éƒ½æ˜¯ Promise å®ä¾‹ã€‚ï¼‰\n\n`p` çš„çŠ¶æ€ç”± `p1`ã€`p2`ã€`p3` å…±åŒå†³å®šï¼Œå½“å…¶ä¸‰ä¸ªå…¨ä¸º `fulfilled` æ—¶ï¼Œ`p` çš„çŠ¶æ€ä¸º `fulfilled` ï¼Œå½“è¿™ä¸‰ä¸ªå…¶ä¸­æœ‰ä¸€ä¸ªæ˜¯ `rejected` æ—¶ï¼Œ`p` çš„çŠ¶æ€ä¸º `rejected`\n\n```js\n// ç”Ÿæˆä¸€ä¸ªPromiseå¯¹è±¡çš„æ•°ç»„\nconst promises = [2, 3, 5, 7, 11, 13].map(function (id) {\n  return getJSON('/post/' + id + \".json\");\n});\n\nPromise.all(promises).then(function (posts) {\n  // ...\n}).catch(function(reason){\n  // ...\n});\n```\n\næ³¨æ„ï¼Œå¦‚æœä½œä¸ºå‚æ•°çš„ Promise å®ä¾‹ï¼Œè‡ªå·±å®šä¹‰äº† `catch` æ–¹æ³•ï¼Œé‚£ä¹ˆå®ƒä¸€æ—¦è¢« `rejected`ï¼Œå¹¶ä¸ä¼šè§¦å‘ `Promise.all()` çš„ `catch` æ–¹æ³•ã€‚\n\n```js\nconst p1 = new Promise((resolve, reject) => {\n  resolve('hello');\n})\n.then(result => result)\n.catch(e => e);\n\nconst p2 = new Promise((resolve, reject) => {\n  throw new Error('æŠ¥é”™äº†');\n})\n.then(result => result)\n.catch(e => e);\n\nPromise.all([p1, p2])\n.then(result => console.log(result))\n.catch(e => console.log(e));\n// [\"hello\", Error: æŠ¥é”™äº†]\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œ`p1` ä¼š `resolved`ï¼Œ`p2` é¦–å…ˆä¼š `rejected`ï¼Œä½†æ˜¯ `p2` æœ‰è‡ªå·±çš„ `catch` æ–¹æ³•ï¼Œè¯¥æ–¹æ³•è¿”å›çš„æ˜¯ä¸€ä¸ªæ–°çš„ Promise å®ä¾‹ï¼Œ`p2` æŒ‡å‘çš„å®é™…ä¸Šæ˜¯è¿™ä¸ªå®ä¾‹ã€‚**è¯¥å®ä¾‹æ‰§è¡Œå®Œ `catch` æ–¹æ³•åï¼Œä¹Ÿä¼šå˜æˆ `resolved`**ï¼Œå¯¼è‡´ `Promise.all()` æ–¹æ³•å‚æ•°é‡Œé¢çš„ä¸¤ä¸ªå®ä¾‹éƒ½ä¼š `resolved` ï¼Œå› æ­¤ä¼šè°ƒç”¨ `then` æ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°ï¼Œè€Œä¸ä¼šè°ƒç”¨ `catch` æ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°ã€‚\n\n## Promise.race()\n\n`Promise.race` æ–¹æ³•åŒæ ·æ˜¯å°†å¤šä¸ª Promise å®ä¾‹ï¼ŒåŒ…è£…æˆä¸€ä¸ªæ–°çš„ Promise å®ä¾‹ã€‚\n\n```js\nconst p = Promise.race([p1, p2, p3]);\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œåªè¦ `p1`ã€`p2`ã€`p3` ä¹‹ä¸­æœ‰ä¸€ä¸ªå®ä¾‹ç‡å…ˆæ”¹å˜çŠ¶æ€ï¼Œ`p` çš„çŠ¶æ€å°±è·Ÿç€æ”¹å˜ã€‚é‚£ä¸ªç‡å…ˆæ”¹å˜çš„ Promise å®ä¾‹çš„è¿”å›å€¼ï¼Œå°±ä¼ é€’ç»™ `p` çš„å›è°ƒå‡½æ•°ã€‚\n\n## Promise.resolve()\n\nå°†ç°æœ‰å¯¹è±¡è½¬æ¢ä¸º Promise å¯¹è±¡\n\n`Promise.resolve` ç­‰ä»·äºä¸‹é¢çš„å†™æ³•ã€‚\n\n```js\nPromise.resolve('foo')\n// ç­‰ä»·äº\nnew Promise(resolve => resolve('foo'))\n```\n\n`Promise.resolve` æ–¹æ³•çš„å‚æ•°åˆ†æˆå››ç§æƒ…å†µã€‚\n\n### å‚æ•°æ˜¯ä¸€ä¸ª Promise å®ä¾‹\n\nå¦‚æœå‚æ•°æ˜¯ Promise å®ä¾‹ï¼Œé‚£ä¹ˆ `Promise.resolve` å°†ä¸åšä»»ä½•ä¿®æ”¹ã€åŸå°ä¸åŠ¨åœ°è¿”å›è¿™ä¸ªå®ä¾‹ã€‚\n\n### å‚æ•°æ˜¯ä¸€ä¸ªthenableå¯¹è±¡\n\n`thenable `å¯¹è±¡æŒ‡çš„æ˜¯å…·æœ‰ `then` æ–¹æ³•çš„å¯¹è±¡ï¼Œæ¯”å¦‚ä¸‹é¢è¿™ä¸ªå¯¹è±¡ã€‚\n\n```js\nlet thenable = {\n  then: function(resolve, reject) {\n    resolve(42);\n  }\n};\n```\n\n`Promise.resolve` æ–¹æ³•ä¼šå°†è¿™ä¸ªå¯¹è±¡è½¬ä¸º Promise å¯¹è±¡ï¼Œç„¶åå°±ç«‹å³æ‰§è¡Œ `thenable` å¯¹è±¡çš„ `then`æ–¹æ³•ã€‚\n\n```js\nlet thenable = {\n  then: function(resolve, reject) {\n    resolve(42);\n  }\n};\n\nlet p1 = Promise.resolve(thenable);\np1.then(function(value) {\n  console.log(value);  // 42\n});\n```\n\n### å‚æ•°ä¸æ˜¯å…·æœ‰thenæ–¹æ³•çš„å¯¹è±¡ï¼Œæˆ–æ ¹æœ¬å°±ä¸æ˜¯å¯¹è±¡\n\nå¦‚æœå‚æ•°æ˜¯ä¸€ä¸ªåŸå§‹å€¼ï¼Œæˆ–è€…æ˜¯ä¸€ä¸ªä¸å…·æœ‰ `then` æ–¹æ³•çš„å¯¹è±¡ï¼Œåˆ™ `Promise.resolve` æ–¹æ³•è¿”å›ä¸€ä¸ªæ–°çš„ Promise å¯¹è±¡ï¼ŒçŠ¶æ€ä¸º `resolved`ã€‚\n\n```js\nconst p = Promise.resolve('Hello');\n\np.then(function (s){\n  console.log(s)\n});\n// Hello\n```\n\n### ä¸å¸¦æœ‰ä»»ä½•å‚æ•°\n\n`Promise.resolve` æ–¹æ³•å…è®¸è°ƒç”¨æ—¶ä¸å¸¦å‚æ•°ï¼Œç›´æ¥è¿”å›ä¸€ä¸ª `resolved` çŠ¶æ€çš„ Promise å¯¹è±¡ã€‚\n\n```js\nconst p = Promise.resolve();\n\np.then(function () {\n  // ...\n});\n```\n\nä¸Šé¢ä»£ç çš„å˜é‡ `p` å°±æ˜¯ä¸€ä¸ª Promise å¯¹è±¡ã€‚\n\néœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç«‹å³ `resolve` çš„ Promise å¯¹è±¡ï¼Œæ˜¯åœ¨æœ¬è½®ã€Œäº‹ä»¶å¾ªç¯ã€ï¼ˆevent loopï¼‰çš„ç»“æŸæ—¶ï¼Œè€Œä¸æ˜¯åœ¨ä¸‹ä¸€è½®ã€Œäº‹ä»¶å¾ªç¯ã€çš„å¼€å§‹æ—¶ã€‚\n\n```js\nsetTimeout(function () {\n  console.log('three');\n}, 0);\n\nPromise.resolve().then(function () {\n  console.log('two');\n});\n\nconsole.log('one');\n\n// one\n// two\n// three\n```\n\n## Promise.reject()\n\n`Promise.reject(reason)` æ–¹æ³•ä¹Ÿä¼šè¿”å›ä¸€ä¸ªæ–°çš„ Promise å®ä¾‹ï¼Œè¯¥å®ä¾‹çš„çŠ¶æ€ä¸º `rejected`ã€‚\n\n```js\nconst p = Promise.reject('å‡ºé”™äº†');\n// ç­‰åŒäº\nconst p = new Promise((resolve, reject) => reject('å‡ºé”™äº†'))\n\np.then(null, function (s) {\n  console.log(s)\n});\n// å‡ºé”™äº†\n```\n\nä¸Šé¢ä»£ç ç”Ÿæˆä¸€ä¸ª Promise å¯¹è±¡çš„å®ä¾‹ `p` ï¼ŒçŠ¶æ€ä¸º `rejected`ï¼Œå›è°ƒå‡½æ•°ä¼šç«‹å³æ‰§è¡Œã€‚\n\n## Promise.try()\n\nè®©åŒæ­¥å‡½æ•°åŒæ­¥æ‰§è¡Œï¼Œå¼‚æ­¥å‡½æ•°å¼‚æ­¥æ‰§è¡Œ\n\n```js\nPromise.try(database.users.get({id: userId}))\n  .then(...)\n  .catch(...)\n```","tags":["ES6"],"categories":["Note"]},{"title":"LeanJsã€Œ ES6 ã€-- Reflect","url":"%2F2018%2F02%2F08%2FLeanJSReflect%2F","content":"\n![Js](LeanJSReflect/js.png)\n\n<!--more-->\n\n## è®¾è®¡ç›®çš„\n\n1 å°† `Object` å¯¹è±¡çš„ä¸€äº›æ˜æ˜¾å±äºè¯­è¨€å†…éƒ¨çš„æ–¹æ³•ï¼Œæ”¾åˆ° `Reflect` å¯¹è±¡ä¸Šã€‚ç°é˜¶æ®µï¼ŒæŸäº›æ–¹æ³•åŒæ—¶åœ¨ `Object` å’Œ `Reclect` å¯¹è±¡ä¸Šéƒ¨ç½²ï¼Œæœªæ¥çš„æ–°æ–¹æ³•å°†åªéƒ¨ç½²åœ¨ `Reflect` å¯¹è±¡ä¸Šã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä» `Reflect` å¯¹è±¡ä¸Šå¯ä»¥æ‹¿åˆ°è¯­è¨€å†…éƒ¨çš„æ–¹æ³•\n\n2 ä¿®æ”¹æŸäº› `Object` æ–¹æ³•çš„è¿”å›ç»“æœï¼Œè®©å…¶å˜å¾—æ›´åˆç†ã€‚æ¯”å¦‚ï¼Œ`Object,defineProperty(obj,name,desc)` åœ¨æ— æ³•å®šä¹‰å±æ€§æ—¶ï¼Œä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼Œè€Œ `Reflect.defineProperty(obj, name, desc)` åˆ™ä¼šè¿”å› `false`\n\n```js\n// è€å†™æ³•\ntry {\n  Object.defineProperty(target, property, attributes);\n  // success\n} catch (e) {\n  // failure\n}\n\n// æ–°å†™æ³•\nif (Reflect.defineProperty(target, property, attributes)) {\n  // success\n} else {\n  // failure\n}\n```\n\n3 è®© `Object` æ“ä½œéƒ½å˜æˆå‡½æ•°è¡Œä¸ºã€‚æŸäº› `Object` æ“ä½œæ˜¯å‘½ä»¤å¼ï¼Œæ¯”å¦‚ `name in obj` å’Œ `delete obj[name]`,è€Œ`Reflect.has(obj,name)` å’Œ `Reflect.deteProperty(obj,name)` è®©ä»–ä»¬å˜æˆäº†å‡½æ•°è¡Œä¸º\n\n4 `Reflect` å¯¹è±¡çš„æ–¹æ³•ä¸ `Proxy` å¯¹è±¡çš„æ–¹æ³•ä¸€ä¸€å¯¹åº”ï¼Œåªè¦æ˜¯ `Proxy` å¯¹è±¡çš„æ–¹æ³•ï¼Œå°±èƒ½åœ¨ `Reflect`å¯¹è±¡ä¸Šæ‰¾åˆ°å¯¹åº”çš„æ–¹æ³•ã€‚è¿™å°±è®© `Proxy` å¯¹è±¡å¯ä»¥æ–¹ä¾¿çš„è°ƒç”¨å¯¹åº”çš„ `Reflect` æ–¹æ³•ï¼Œå®Œæˆé»˜è®¤è¡Œä¸ºã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸ç®¡ `Proxy` æ€ä¹ˆä¿®æ”¹é»˜è®¤è¡Œä¸ºï¼Œä½ æ€»å¯ä»¥åœ¨ `Reflect` ä¸Šè·å–é»˜è®¤è¡Œä¸º\n\n```js\nProxy(target, {\n  set: function(target, name, value, receiver) {\n    var success = Reflect.set(target,name, value, receiver);\n    if (success) {\n      log('property ' + name + ' on ' + target + ' set to ' + value);\n    }\n    return success;\n  }\n});\n```\n\nä¸Šé¢çš„ `proxy` å…ˆæ˜¯å®šä¹‰äº† `set` ï¼Œç„¶åè°ƒç”¨ `Reflect.set` æ–¹æ³•å°†å€¼å¤åˆ¶ç»™å¯¹è±¡çš„å±æ€§ï¼Œä¿æŒäº† `set` åŸæœ‰çš„è¡Œä¸º.\n\n## é™æ€æ–¹æ³•\n\n`Reflect` å¯¹è±¡ä¸€å…±æœ‰ 13 ä¸ªé™æ€æ–¹æ³•\n \n- `Reflect.apply(target, thisArg, args)` : ç­‰åŒäº `Function.prototype.apply.call(func, thisArg, args)`ï¼Œç”¨äºç»‘å®š `this` å¯¹è±¡åæ‰§è¡Œç»™å®šå‡½æ•°ã€‚\n- `Reflect.construct(target, args)` : ç­‰åŒäº `new target(...args)`ï¼Œè¿™æä¾›äº†ä¸€ç§ä¸ä½¿ç”¨ `new`ï¼Œæ¥è°ƒç”¨æ„é€ å‡½æ•°çš„æ–¹æ³•ã€‚\n- `Reflect.get(target, name, receiver)` : æ–¹æ³•æŸ¥æ‰¾å¹¶è¿”å› `target` å¯¹è±¡çš„ `name` å±æ€§ã€‚\n- `Reflect.set(target, name, value, receiver)` : è®¾ç½® `target` å¯¹è±¡çš„ `name` å±æ€§ç­‰äº`value`ã€‚\n- `Reflect.defineProperty(target, name, desc)` :  åŸºæœ¬ç­‰åŒäº `Object.defineProperty`ï¼Œç”¨æ¥ä¸ºå¯¹è±¡å®šä¹‰å±æ€§ã€‚æœªæ¥ï¼Œåè€…ä¼šè¢«é€æ¸åºŸé™¤ï¼Œè¯·ä»ç°åœ¨å¼€å§‹å°±ä½¿ç”¨ `Reflect.defineProperty` ä»£æ›¿å®ƒã€‚\n- `Reflect.deleteProperty(target, name)` : ç­‰åŒäº `delete obj[name]`ï¼Œç”¨äºåˆ é™¤å¯¹è±¡çš„å±æ€§ã€‚\n- `Reflect.has(target, name)` : `Reflect.has`æ–¹æ³•å¯¹åº” `name in obj` é‡Œé¢çš„ `in` è¿ç®—ç¬¦ã€‚\n- `Reflect.ownKeys(target)` : ç”¨äºè¿”å›å¯¹è±¡çš„æ‰€æœ‰å±æ€§ï¼ŒåŸºæœ¬ç­‰åŒäº `Object.getOwnPropertyNames` ä¸`Object.getOwnPropertySymbols` ä¹‹å’Œã€‚\n- `Reflect.isExtensible(target)` : å¯¹åº” `Object.isExtensible`ï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºå½“å‰å¯¹è±¡æ˜¯å¦å¯æ‰©å±•ã€‚\n- `Reflect.preventExtensions(target)` : å¯¹åº” `Object.preventExtensions` æ–¹æ³•ï¼Œç”¨äºè®©ä¸€ä¸ªå¯¹è±¡å˜ä¸ºä¸å¯æ‰©å±•ã€‚å®ƒè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦æ“ä½œæˆåŠŸã€‚\n- `Reflect.getOwnPropertyDescriptor(target, name)` : åŸºæœ¬ç­‰åŒäº `Object.getOwnPropertyDescriptor`ï¼Œç”¨äºå¾—åˆ°æŒ‡å®šå±æ€§çš„æè¿°å¯¹è±¡ï¼Œå°†æ¥ä¼šæ›¿ä»£æ‰åè€…ã€‚\n- `Reflect.getPrototypeOf(target)` : ç”¨äºè¯»å–å¯¹è±¡çš„ `__proto__` å±æ€§ï¼Œå¯¹åº” `Object.getPrototypeOf(obj)`ã€‚\n- `Reflect.setPrototypeOf(target, prototype)` : ç”¨äºè®¾ç½®å¯¹è±¡çš„ `__proto__` å±æ€§ï¼Œè¿”å›ç¬¬ä¸€ä¸ªå‚æ•°å¯¹è±¡ï¼Œå¯¹åº”`Object.setPrototypeOf(obj, newProto)`ã€‚\n\nä¸Šé¢è¿™äº›æ–¹æ³•çš„ä½œç”¨ï¼Œå¤§éƒ¨åˆ†ä¸ `Object` å¯¹è±¡çš„åŒåæ–¹æ³•çš„ä½œç”¨éƒ½æ˜¯ç›¸åŒçš„ï¼Œè€Œä¸”å®ƒä¸ `Proxy` å¯¹è±¡çš„æ–¹æ³•æ˜¯ä¸€ä¸€å¯¹åº”çš„ã€‚\n\n### get \n\n`Reflect.get` æ–¹æ³•æŸ¥æ‰¾å¹¶è¿”å› `target` å¯¹è±¡çš„ `name` å±æ€§ï¼Œå¦‚æœæ²¡æœ‰è¯¥å±æ€§ï¼Œåˆ™è¿”å› `undefined`ã€‚\n\n```js\nvar myObject = {\n  foo: 1,\n  bar: 2,\n  get baz() {\n    return this.foo + this.bar;\n  },\n}\n\nReflect.get(myObject, 'foo') // 1\nReflect.get(myObject, 'bar') // 2\nReflect.get(myObject, 'baz') // 3\n```\n\nå¦‚æœ `name` å±æ€§éƒ¨ç½²äº†è¯»å–å‡½æ•°ï¼ˆ`getter`ï¼‰ï¼Œåˆ™è¯»å–å‡½æ•°çš„ `this` ç»‘å®š `receiver`ã€‚\n\n```js\nvar myObject = {\n  foo: 1,\n  bar: 2,\n  get baz() {\n    return this.foo + this.bar;\n  },\n};\n\nvar myReceiverObject = {\n  foo: 4,\n  bar: 4,\n};\n\nReflect.get(myObject, 'baz', myReceiverObject) // 8\n```\n\nå¦‚æœç¬¬ä¸€ä¸ªå‚æ•°ä¸æ˜¯å¯¹è±¡ï¼Œ`Reflect.get` æ–¹æ³•ä¼šæŠ¥é”™ã€‚\n\n```js\nReflect.get(1, 'foo') // æŠ¥é”™\nReflect.get(false, 'foo') // æŠ¥é”™\n```\n","tags":["ES6"],"categories":["Note"]},{"title":"LeanJsã€Œ ES6 ã€-- Proxy","url":"%2F2018%2F02%2F07%2FLeanJSProxy%2F","content":"\n![Js](LeanJSProxy/js.png)\n\n<!--more-->\n\n## æ¦‚è¿°\n\nProxy ç”¨äºä¿®æ”¹æŸäº›æ“ä½œçš„é»˜è®¤è¡Œä¸ºï¼Œç­‰åŒäºåœ¨è¯­è¨€å±‚é¢åšå‡ºä¿®æ”¹ï¼Œæ‰€ä»¥å±äºä¸€ç§ã€Œå…ƒç¼–ç¨‹ã€ï¼Œå³å¯¹ç¨‹åºè¯­è¨€è¿›è¡Œç¼–ç¨‹\n\nProxy å¯ä»¥ç†è§£æˆï¼Œåœ¨ç›®æ ‡å¯¹è±¡ä¹‹å‰æ¶è®¾ä¸€å±‚ã€Œæ‹¦æˆªã€ï¼Œå¤–ç•Œå¯¹è¯¥å¯¹è±¡è¿›è¡Œè®¿é—®ï¼Œéƒ½å¿…é¡»å…ˆé€šè¿‡è¿™ä¸ªæ‹¦æˆªï¼Œå› æ­¤æä¾›äº†ä¸€ç§æœºåˆ¶ï¼Œå¯ä»¥å¯¹å¤–é¢è®¿é—®è¿›è¡Œè¿‡æ»¤å’Œæ”¹å†™ã€‚Proxy è¿™ä¸ªè¯çš„åŸæ„æ˜¯ä»£ç†ï¼Œç”¨åœ¨è¿™é‡Œè¡¨ç¤ºç”±ä»–æ¥ã€Œä»£ç†ã€æŸäº›æ“ä½œï¼Œå¯ä»¥è¯‘ä¸ºã€Œä»£ç†å™¨ã€\n\n## è¯­æ³•\n\n```js\nlet p = new Proxy(target, handler);\n```\n\n- `target` : ç”¨ proxy åŒ…è£…çš„ç›®æ ‡å¯¹è±¡ï¼ˆå¯ä»¥æ˜¯ä»»ä½•ç±»å‹çš„å¯¹è±¡ï¼ŒåŒ…æ‹¬åŸç”Ÿæ•°ç»„ï¼Œå‡½æ•°ï¼Œç”šè‡³æ˜¯ä¸€ä¸ªä»£ç†ï¼‰\n- `handler` : ä¸€ä¸ªå¯¹è±¡ï¼Œå…¶å±æ€§æ˜¯å½“æ‰§è¡Œä¸€ä¸ªæ“ä½œæ—¶å®šä¹‰ä»£ç†çš„è¡Œä¸ºçš„å‡½æ•°ï¼Œç”¨æ¥å®šåˆ¶æ‹¦æˆªçš„è¡Œä¸ºã€‚\n\nå¦‚æœ `handler` æ²¡æœ‰è®¾ç½®ä»»ä½•æ‹¦æˆªï¼Œé‚£å°±ç­‰åŒäºç›´æ¥é€šå‘åŸå¯¹è±¡ã€‚\n\n```js\nvar target = {};\nvar handler = {};\nvar proxy = new Proxy(target, handler);\nproxy.a = 'b';\ntarget.a // \"b\"\n```\n\n## æ–¹æ³•\n\nproxy ä¸€å…±æ”¯æŒåä¸‰ç§æ“ä½œæ–¹æ³•\n\n- `get(target, propKey, receiver)` ï¼šæ‹¦æˆªå¯¹è±¡å±æ€§çš„è¯»å–ï¼Œæ¯”å¦‚ `proxy.foo` å’Œ `proxy['foo']`ã€‚\n- `set(target, propKey, value, receiver)` ï¼šæ‹¦æˆªå¯¹è±¡å±æ€§çš„è®¾ç½®ï¼Œæ¯”å¦‚ `proxy.foo = v` æˆ– `proxy['foo'] = v`ï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ã€‚\n- `has(target, propKey)` ï¼šæ‹¦æˆª `propKey in proxy`çš„æ“ä½œï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ã€‚\n- `deleteProperty(target, propKey)` ï¼šæ‹¦æˆª `delete proxy[propKey]` çš„æ“ä½œï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ã€‚\n- `ownKeys(target)`ï¼šæ‹¦æˆª `Object.getOwnPropertyNames(proxy)`ã€`Object.getOwnPropertySymbols(proxy)`ã€`Object.keys(proxy)`ï¼Œè¿”å›ä¸€ä¸ªæ•°ç»„ã€‚è¯¥æ–¹æ³•è¿”å›ç›®æ ‡å¯¹è±¡æ‰€æœ‰è‡ªèº«çš„å±æ€§çš„å±æ€§åï¼Œè€Œ `Object.keys()` çš„è¿”å›ç»“æœä»…åŒ…æ‹¬ç›®æ ‡å¯¹è±¡è‡ªèº«çš„å¯éå†å±æ€§ã€‚\n- `getOwnPropertyDescriptor(target, propKey)` ï¼šæ‹¦æˆª `Object.getOwnPropertyDescriptor(proxy, propKey)`ï¼Œè¿”å›å±æ€§çš„æè¿°å¯¹è±¡ã€‚\n-  `defineProperty(target, propKey, propDesc)` ï¼šæ‹¦æˆª `Object.defineProperty(proxy, propKey, propDescï¼‰`ã€`Object.defineProperties(proxy, propDescs)`ï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ã€‚\n- `preventExtensions(target)`ï¼šæ‹¦æˆª `Object.preventExtensions(proxy)`ï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ã€‚\n- `getPrototypeOf(target)` ï¼šæ‹¦æˆª `Object.getPrototypeOf(proxy)`ï¼Œè¿”å›ä¸€ä¸ªå¯¹è±¡ã€‚\n- `isExtensible(target)`ï¼šæ‹¦æˆª `Object.isExtensible(proxy)`ï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ã€‚\n- `setPrototypeOf(target, proto)` ï¼šæ‹¦æˆª `Object.setPrototypeOf(proxy, proto)` ï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ã€‚å¦‚æœç›®æ ‡å¯¹è±¡æ˜¯å‡½æ•°ï¼Œé‚£ä¹ˆè¿˜æœ‰ä¸¤ç§é¢å¤–æ“ä½œå¯ä»¥æ‹¦æˆªã€‚\n- `apply(target, object, args)` ï¼šæ‹¦æˆª Proxy å®ä¾‹ä½œä¸ºå‡½æ•°è°ƒç”¨çš„æ“ä½œï¼Œæ¯”å¦‚ `proxy(...args)`ã€`proxy.call(object, ...args)`ã€`proxy.apply(...)`ã€‚\n- `construct(target, args)`ï¼šæ‹¦æˆª Proxy å®ä¾‹ä½œä¸ºæ„é€ å‡½æ•°è°ƒç”¨çš„æ“ä½œï¼Œæ¯”å¦‚ `new proxy(...args)`ã€‚\n\nä¸ºäº†æ–¹ä¾¿ç†è§£ï¼Œæ‹¿å‡º `get` æ–¹æ³•å…·ä½“è¯´ä¸€ä¸‹\n\n`get` æ–¹æ³•ç”¨äºæ‹¦æˆªæŸä¸ªå±æ€§çš„è¯»å–æ“ä½œï¼Œå¯ä»¥æ¥å—ä¸‰ä¸ªå‚æ•°ï¼Œä¾æ¬¡æ˜¯ç›®æ ‡å¯¹è±¡ï¼Œå±æ€§åå’Œ proxy å®ä¾‹æœ¬èº« ï¼ˆå³ `this` å…³é”®å­—æŒ‡å‘çš„é‚£ä¸ªå¯¹è±¡ï¼‰ï¼Œå…¶ä¸­æœ€åä¸€ä¸ªå¯é€‰\n\nä¸¾ä¸€ä¸ªå…·ä½“çš„ä¾‹å­\n\n```js\nvar person = {\n  name: \"å¼ ä¸‰\"\n};\n\nvar proxy = new Proxy(person, {\n  get: function(target, property) {\n    if (property in target) {\n      return target[property];\n    } else {\n      throw new ReferenceError(\"Property \\\"\" + property + \"\\\" does not exist.\");\n    }\n  }\n});\n\nproxy.name // \"å¼ ä¸‰\"\nproxy.age // æŠ›å‡ºä¸€ä¸ªé”™è¯¯\n```\n\nä¸Šé¢ä»£ç è¡¨ç¤ºï¼Œå¦‚æœè®¿é—®ç›®æ ‡å¯¹è±¡ä¸å­˜åœ¨çš„å±æ€§ï¼Œä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚å¦‚æœæ²¡æœ‰è¿™ä¸ªæ‹¦æˆªå‡½æ•°ï¼Œè®¿é—®ä¸å­˜åœ¨çš„å±æ€§ï¼Œåªä¼šè¿”å› `undefined`ã€‚\n\nä¸‹é¢æ˜¯ä¸€ä¸ª `get` æ–¹æ³•çš„ç¬¬ä¸‰ä¸ªå‚æ•°çš„ä¾‹å­ã€‚\n\n```js\nconst proxy = new Proxy({}, {\n  get: function(target, property, receiver) {\n    return receiver;\n  }\n});\nproxy.getReceiver === proxy // true\n```\n\n## this é—®é¢˜\n\nç”±ä¸Šé¢å¯çŸ¥ï¼Œåœ¨ proxy ä»£ç†çš„æƒ…å†µä¸‹ï¼Œç›®æ ‡å¯¹è±¡å†…éƒ¨çš„ `this` å…³é”®å­—ä¼šæŒ‡å‘ proxy\n\n```js\nconst target = new Date();\nconst handler = {};\nconst proxy = new Proxy(target, handler);\n\nproxy.getDate();\n// TypeError: this is not a Date object.\n``` \n\nä¸Šé¢ä»£ç ä¸­ï¼Œ`getDate` æ–¹æ³•åªèƒ½åœ¨ `Date` å¯¹è±¡å®ä¾‹ä¸Šé¢æ‹¿åˆ°ï¼Œå¦‚æœ `this` ä¸æ˜¯ `Date` å¯¹è±¡å®ä¾‹å°±ä¼šæŠ¥é”™ã€‚è¿™æ—¶ï¼Œ`this` ç»‘å®šåŸå§‹å¯¹è±¡ï¼Œå°±å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚\n\n```js\nconst target = new Date('2015-01-01');\nconst handler = {\n  get(target, prop) {\n    if (prop === 'getDate') {\n      return target.getDate.bind(target);\n    }\n    return Reflect.get(target, prop);\n  }\n};\nconst proxy = new Proxy(target, handler);\n\nproxy.getDate() // 1\n```\n\n","tags":["ES6"],"categories":["Note"]},{"title":"LeanJsã€Œ ES6 ã€-- SET å’Œ MAP æ•°æ®ç»“æ„","url":"%2F2018%2F02%2F06%2FLeanJSSET%E5%92%8CMAP%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%2F","content":"\n![Js](LeanJSSETå’ŒMAPæ•°æ®ç»“æ„/js.png)\n\n<!--more-->\n\n## Set\n\n### åŸºæœ¬ç”¨æ³•\n\nES6 æä¾›äº†æ–°çš„æ•°æ®è§£æ„ Setï¼Œå®ƒç±»ä¼¼ä¸æ•°ç»„ï¼Œä½†æ˜¯æˆå‘˜å€¼éƒ½æ˜¯å”¯ä¸€çš„ï¼Œæ²¡æœ‰é‡å¤å€¼ï¼Œå› æ­¤ä¹Ÿæœ‰ä¸€ä¸ªæ•°ç»„å»é‡çš„åŠæ³•\n\n```js\n[...new Set(array)]\n```\n\nå‘ Set æ·»å…¥å€¼çš„æ—¶å€™ï¼Œ`5` å’Œ `'5'` æ˜¯ä¸¤ä¸ªä¸åŒçš„å€¼ï¼ŒSet å†…éƒ¨åˆ¤æ–­ä¸¤ä¸ªå€¼æ˜¯å¦ç›¸ç­‰ç±»ä¼¼äº `===`ï¼Œä½†æ˜¯ä»–ä¼šæ­£ç¡®åˆ¤æ–­ `NaN`ã€‚å¦å¤–ï¼Œä¸¤ä¸ªå¯¹è±¡æ€»æ˜¯ä¸æƒ³ç­‰çš„\n\n```js\nlet set = new Set();\n\nset.add({});\nset.size // 1\n\nset.add({});\nset.size // 2\n```\n\n### Set å®ä¾‹çš„å±æ€§å’Œæ–¹æ³•\n\nSet ç»“æ„çš„å±æ€§\n\n- `Set.prototype.constructor` æ„é€ å‡½æ•°ï¼Œé»˜è®¤å°±æ˜¯ `Set` å‡½æ•° \n- `Set.prototype.size` è¿”å› `Set` å®ä¾‹çš„æˆå‘˜æ€»æ•°\n\nSet ç»“æ„çš„æ–¹æ³•ï¼Œåˆ†ä¸ºä¸¤å¤§ç±»ï¼Œæ“ä½œæ–¹æ³•å’Œéå†æ–¹æ³•ï¼Œä¸‹é¢æ˜¯æ“ä½œæ–¹æ³•\n\n- `add(value)` æ·»åŠ æŸä¸ªå€¼ï¼Œè¿”å› Set ç»“æ„æœ¬èº«\n- `delete(value)` åˆ é™¤æŸä¸ªå€¼ï¼Œè¿”å›å¸ƒå°”å€¼ï¼Œè¡¨ç¤ºåˆ é™¤æ˜¯å¦æˆåŠŸ\n- `has(value)` è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºè¯¥å€¼æ˜¯å¦ä¸º `Set` çš„æˆå‘˜\n- `clear()` æ¸…é™¤æ‰€æœ‰æˆå‘˜\n\nSet ç»“æ„çš„éå†æ–¹æ³•\n\n- `keys()` è¿”å›é”®å\n- `values()` è¿”å›é”®å€¼\n- `entries()` è¿”å›é”®å€¼å¯¹\n- `forEach()` ä½¿ç”¨å›è°ƒå‡½æ•°éå†æ¯ä¸ªæˆå‘˜\n\nå› ä¸º Set ç»“æ„æ²¡æœ‰é”®åï¼Œæ‰€ä»¥ `keys()` å’Œ `values()` è¿”å›çš„éƒ½æ˜¯é”®å€¼\n\n```js\nlet set = new Set(['red', 'green', 'blue']);\n\nfor (let item of set.keys()) {\n  console.log(item);\n}\n// red\n// green\n// blue\n\nfor (let item of set.values()) {\n  console.log(item);\n}\n// red\n// green\n// blue\n\nfor (let item of set.entries()) {\n  console.log(item);\n}\n// [\"red\", \"red\"]\n// [\"green\", \"green\"]\n// [\"blue\", \"blue\"]\n```\n\n## WeakSet\n\n### å«ä¹‰\n\nWeakSet å’Œ Set ç»“æ„ç±»ä¼¼ï¼Œä¹Ÿæ˜¯ä¸é‡å¤çš„å€¼çš„é›†åˆã€‚ä½†æ˜¯ WeakSet ä¸­çš„å€¼å¿…é¡»æ˜¯å¯¹è±¡ï¼Œè€Œä¸”éƒ½æ˜¯å¼±å¼•ç”¨ï¼Œåƒåœ¾å›æ”¶ä¸è€ƒè™‘ï¼Œå› æ­¤é€‚åˆä¸´æ—¶å­˜æ”¾ä¸€ç»„å¯¹è±¡ã€‚ç”±äºä¸Šé¢è¿™ä¸ªç‰¹ç‚¹ï¼ŒWeakSet çš„æˆå‘˜æ˜¯ä¸é€‚åˆå¼•ç”¨çš„ï¼Œå› ä¸ºå®ƒä¼šéšæ—¶æ¶ˆå¤±ã€‚å¦å¤–ï¼Œç”±äº WeakSet å†…éƒ¨æœ‰å¤šå°‘ä¸ªæˆå‘˜ï¼Œå–å†³äºåƒåœ¾å›æ”¶æœºåˆ¶æœ‰æ²¡æœ‰è¿è¡Œï¼Œè¿è¡Œå‰åå¾ˆå¯èƒ½æˆå‘˜ä¸ªæ•°æ˜¯ä¸ä¸€æ ·çš„ï¼Œè€Œåƒåœ¾å›æ”¶æœºåˆ¶ä½•æ—¶è¿è¡Œæ˜¯ä¸å¯é¢„æµ‹çš„ï¼Œå› æ­¤ ES6 è§„å®š WeakSet ä¸å¯éå†ã€‚\n\n### è¯­æ³•\n\n```js\nconst a = [[1, 2], [3, 4]];\nconst ws = new WeakSet(a);\n// WeakSet {[1, 2], [3, 4]}\n```\n\nä¸Šé¢ä¸­ï¼Œæ˜¯æ•°ç»„ `a` ä¸­çš„æˆå‘˜æˆä¸ºäº† WeakSet çš„æˆå‘˜ï¼Œå¹¶ä¸æ˜¯ `a` æ•°ç»„æœ¬èº«ã€‚è¿™æ„å‘³ç€ï¼Œæ•°ç»„çš„æˆå‘˜åªèƒ½æ˜¯å¯¹è±¡\n\n```js\nconst b = [3, 4];\nconst ws = new WeakSet(b);\n// Uncaught TypeError: Invalid value used in weak set(â€¦)\n```\n\nWeakSet ç»“æ„æœ‰ä»¥ä¸‹ä¸‰ä¸ªæ–¹æ³•\n\n- `WeakSet.prototype.add(value)` å‘ WeakSet æ·»åŠ ä¸€ä¸ªæˆå‘˜\n- `WeakSet.prototype.delete(value)` æ¸…é™¤ WeakSet çš„æŒ‡å®šæˆå‘˜\n- `WeakSet.prototype.has(value)` è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºè¿™ä¸ªå€¼æ˜¯å¦åœ¨ WeakSet ä¸­ \n\nWeakSet ä¸èƒ½éå†ä¹Ÿæ²¡æœ‰ `size` å’Œ `forEach` å±æ€§\n\n## Map\n\n### å«ä¹‰å’ŒåŸºæœ¬ç”¨æ³•\n\nå…¶ç»“æ„çš„é”®åä¸æ­¢å±€é™ä¸å­—ç¬¦ä¸²ï¼Œå„ç§ç±»å‹çš„å€¼éƒ½å¯ä»¥å½“ä½œé”®å\n\n```js\nconst m = new Map();\nconst o = {p: 'Hello World'};\n\nm.set(o, 'content')\nm.get(o) // \"content\"\n\nm.has(o) // true\nm.delete(o) // true\nm.has(o) // false\n```\n\nä¸Šé¢ä¸­ç”¨ `set` æ–¹æ³•å°†å¯¹è±¡ `o` å½“ä½œ `m` çš„ä¸€ä¸ªé”®ï¼Œç„¶ååˆç”¨ `get` æ–¹æ³•è¯»å–è¿™ä¸ªé”®ã€‚\n\nå¦‚æœå¯¹åŒä¸€ä¸ªé”®å¤šæ¬¡èµ‹å€¼ï¼Œåé¢çš„å€¼å°†è¦†ç›–å‰é¢çš„å€¼ã€‚\n\n```js\nconst map = new Map();\n\nmap\n.set(1, 'aaa')\n.set(1, 'bbb');\n\nmap.get(1) // \"bbb\"\n```\n\nä¸Šé¢ä»£ç å¯¹é”®1è¿ç»­èµ‹å€¼ä¸¤æ¬¡ï¼Œåä¸€æ¬¡çš„å€¼è¦†ç›–å‰ä¸€æ¬¡çš„å€¼ã€‚\n\næ³¨æ„ï¼Œåªæœ‰å¯¹åŒä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨ï¼ŒMap ç»“æ„æ‰å°†å…¶è§†ä¸ºåŒä¸€ä¸ªé”®ã€‚è¿™ä¸€ç‚¹è¦éå¸¸å°å¿ƒã€‚\n\n```js\nconst map = new Map();\n\nmap.set(['a'], 555);\nmap.get(['a']) // undefined\n```\n\nä¸Šé¢ä»£ç çš„ `set` å’Œ `get` æ–¹æ³•ï¼Œè¡¨é¢æ˜¯é’ˆå¯¹åŒä¸€ä¸ªé”®ï¼Œä½†å®é™…ä¸Šè¿™æ˜¯ä¸¤ä¸ªå€¼ï¼Œå†…å­˜åœ°å€æ˜¯ä¸ä¸€æ ·çš„ï¼Œå› æ­¤ `get` æ–¹æ³•æ— æ³•è¯»å–è¯¥é”®ï¼Œè¿”å› `undefined`ã€‚Map çš„é”®æ˜¯æ ¹æ®å…¶å†…å­˜åœ°å€åˆ¤æ–­æ˜¯å¦ä¸ºç›¸åŒçš„å€¼\n\n### å®ä¾‹çš„å±æ€§å’Œæ“ä½œæ–¹æ³•\n\n#### size å±æ€§\n\n`size` å±æ€§è¿”å› Map ç»“æ„çš„æˆå‘˜æ€»æ•°ã€‚\n\n```js\nconst map = new Map();\nmap.set('foo', true);\nmap.set('bar', false);\n\nmap.size // 2\n```\n\n#### set(key,value)\n\n`set` æ–¹æ³•è®¾ç½®é”®å `key` å¯¹åº”çš„é”®å€¼ä¸º `value`ï¼Œç„¶åè¿”å›æ•´ä¸ª Map ç»“æ„ã€‚å¦‚æœ `key` å·²ç»æœ‰å€¼ï¼Œåˆ™é”®å€¼ä¼šè¢«æ›´æ–°ï¼Œå¦åˆ™å°±æ–°ç”Ÿæˆè¯¥é”®ã€‚\n\n```js\nconst m = new Map();\n\nm.set('edition', 6)        // é”®æ˜¯å­—ç¬¦ä¸²\nm.set(262, 'standard')     // é”®æ˜¯æ•°å€¼\nm.set(undefined, 'nah')    // é”®æ˜¯ undefined\n```\n\n`set` æ–¹æ³•è¿”å›çš„æ˜¯å½“å‰çš„ Map å¯¹è±¡ï¼Œå› æ­¤å¯ä»¥é‡‡ç”¨é“¾å¼å†™æ³•ã€‚\n\n```js\nlet map = new Map()\n  .set(1, 'a')\n  .set(2, 'b')\n  .set(3, 'c');\n```\n\n#### get(key)\n\n`get` æ–¹æ³•è¯»å– `key` å¯¹åº”çš„é”®å€¼ï¼Œå¦‚æœæ‰¾ä¸åˆ° `key`ï¼Œè¿”å› `undefined`ã€‚\n\n```js\nconst m = new Map();\n\nconst hello = function() {console.log('hello');};\nm.set(hello, 'Hello ES6!') // é”®æ˜¯å‡½æ•°\n\nm.get(hello)  // Hello ES6!\n```\n\n#### has(key)\n\n`has` æ–¹æ³•è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæŸä¸ªé”®æ˜¯å¦åœ¨å½“å‰ Map å¯¹è±¡ä¹‹ä¸­ã€‚\n\n```js\nconst m = new Map();\n\nm.set('edition', 6);\nm.set(262, 'standard');\nm.set(undefined, 'nah');\n\nm.has('edition')     // true\nm.has('years')       // false\nm.has(262)           // true\nm.has(undefined)     // true\n```\n\n#### delete(key)\n\n`delete` æ–¹æ³•åˆ é™¤æŸä¸ªé”®ï¼Œè¿”å› `true`ã€‚å¦‚æœåˆ é™¤å¤±è´¥ï¼Œè¿”å› `false`ã€‚\n\n```js\nconst m = new Map();\nm.set(undefined, 'nah');\nm.has(undefined)     // true\n\nm.delete(undefined)\nm.has(undefined)       // false\n```\n#### clear()\n\n`clear` æ–¹æ³•æ¸…é™¤æ‰€æœ‰æˆå‘˜ï¼Œæ²¡æœ‰è¿”å›å€¼ã€‚\n\n```js\nlet map = new Map();\nmap.set('foo', true);\nmap.set('bar', false);\n\nmap.size // 2\nmap.clear()\nmap.size // 0\n```\n\n### éå†æ–¹æ³•\n\n- `keys()` ï¼šè¿”å›é”®åçš„éå†å™¨ã€‚\n- `values()` ï¼šè¿”å›é”®å€¼çš„éå†å™¨ã€‚\n- `entries()` ï¼šè¿”å›æ‰€æœ‰æˆå‘˜çš„éå†å™¨ã€‚\n- `forEach()` ï¼šéå† Map çš„æ‰€æœ‰æˆå‘˜ã€‚\n\n## WeakMap\n\n### å«ä¹‰\n\n`WeakMap` å’Œ `Map` çš„ç»“æ„ç±»ä¼¼ï¼Œä¹Ÿæ˜¯ç”¨äºç”Ÿæˆé”®å€¼å¯¹çš„é›†åˆ\n\n`WeakMap` åªæ¥å—å¯¹è±¡ä½œä¸ºé”®å.\n\n```js\nconst map = new WeakMap();\nmap.set(1, 2)\n// TypeError: 1 is not an object!\nmap.set(Symbol(), 2)\n// TypeError: Invalid value used as weak map key\nmap.set(null, 2)\n// TypeError: Invalid value used as weak map key\n```\n\nWeakMapçš„è®¾è®¡ç›®çš„åœ¨äºï¼Œæœ‰æ—¶æˆ‘ä»¬æƒ³åœ¨æŸä¸ªå¯¹è±¡ä¸Šé¢å­˜æ”¾ä¸€äº›æ•°æ®ï¼Œä½†æ˜¯è¿™ä¼šå½¢æˆå¯¹äºè¿™ä¸ªå¯¹è±¡çš„å¼•ç”¨ã€‚è¯·çœ‹ä¸‹é¢çš„ä¾‹å­ã€‚\n\n```js\nconst e1 = document.getElementById('foo');\nconst e2 = document.getElementById('bar');\nconst arr = [\n  [e1, 'foo å…ƒç´ '],\n  [e2, 'bar å…ƒç´ '],\n];\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œ`e1` å’Œ `e2` æ˜¯ä¸¤ä¸ªå¯¹è±¡ï¼Œæˆ‘ä»¬é€šè¿‡ `arr` æ•°ç»„å¯¹è¿™ä¸¤ä¸ªå¯¹è±¡æ·»åŠ ä¸€äº›æ–‡å­—è¯´æ˜ã€‚è¿™å°±å½¢æˆäº† `arr` å¯¹ `e1` å’Œ `e2` çš„å¼•ç”¨ã€‚\n\nä¸€æ—¦ä¸å†éœ€è¦è¿™ä¸¤ä¸ªå¯¹è±¡ï¼Œæˆ‘ä»¬å°±å¿…é¡»æ‰‹åŠ¨åˆ é™¤è¿™ä¸ªå¼•ç”¨ï¼Œå¦åˆ™åƒåœ¾å›æ”¶æœºåˆ¶å°±ä¸ä¼šé‡Šæ”¾ `e1` å’Œ `e2` å ç”¨çš„å†…å­˜ã€‚\n\n```js\n// ä¸éœ€è¦ e1 å’Œ e2 çš„æ—¶å€™\n// å¿…é¡»æ‰‹åŠ¨åˆ é™¤å¼•ç”¨\narr [0] = null;\narr [1] = null;\n```\n\nä¸Šé¢è¿™æ ·çš„å†™æ³•æ˜¾ç„¶å¾ˆä¸æ–¹ä¾¿ã€‚ä¸€æ—¦å¿˜äº†å†™ï¼Œå°±ä¼šé€ æˆå†…å­˜æ³„éœ²ã€‚\n\n### WeakMap è¯­æ³•\n\n`WeakMap` å’Œ `WeakSet` ç›¸ä¼¼ï¼Œæ²¡æœ‰éå†æ“ä½œï¼Œä¹Ÿæ²¡æœ‰ `size` å±æ€§ï¼Œä¹Ÿæ— æ³•ç”¨ `clear` æ¸…ç©º\n\n","tags":["ES6"],"categories":["Note"]},{"title":"LeanJsã€Œ ES6 ã€-- Symbol","url":"%2F2018%2F02%2F05%2FLeanJSSymbol%2F","content":"\n![Js](LeanJSSymbol/js.png)\n\n<!--more-->\n\n## æ¦‚è¿°\n\nES5 çš„å¯¹è±¡å±æ€§åéƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œè¿™å®¹æ˜“é€ æˆå±æ€§åçš„å†²çªã€‚å¦‚æœæœ‰ä¸€ç§æœºåˆ¶ï¼Œä¿è¯æ¯ä¸ªå±æ€§çš„åå­—éƒ½æ˜¯ç‹¬ä¸€æ— äºŒçš„ï¼Œè¿™æ ·å°±ä»æ ¹æœ¬ä¸Šé˜²æ­¢äº†å±æ€§åçš„å†²çªï¼Œè¿™å°±æ˜¯ ES6 å¼•å…¥ `Symbol` çš„åŸå› \n\n```js\nlet s = Symbol()\n\ntypeof s //'symbol'\n```\n\nå£°æ˜ä¸èƒ½åŠ  `new` å‘½ä»¤ï¼Œå› ä¸º `symbol` ç”Ÿæˆçš„æ˜¯åŸå§‹æ•°æ®ç±»å‹ï¼Œå’Œå­—ç¬¦ä¸²ç›¸ä¼¼ï¼Œæ¯ä¸ª `symbol` éƒ½æ˜¯ç‹¬ä¸€æ— äºŒçš„ã€‚\n\n```js\nlet s = Symbol('foo')\n\ns//'Symbol(foo)'\n```\n\n`symbol` å¯ä»¥æ¥å—ä¸€ä¸ªå‚æ•°ï¼Œè¡¨ç¤ºå¯¹å½“å‰ `symbol` çš„æè¿°ï¼Œä¼ å…¥å¯¹è±¡çš„è¯ä¹Ÿä¼šè°ƒç”¨ `toString` å¼ºåˆ¶è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œä¼ å…¥çš„å‚æ•°å¯ä»¥é‡å¤ï¼Œä»…ä»…æ˜¯æè¿°ç›¸åŒï¼Œä½†å®é™…ä¸Šä¸¤ä¸ª `symbol` æ˜¯ä¸åŒçš„\n\n```js\nlet s1 = Symbol('foo');\nlet s2 = Symbol('foo');\n\ns1 === s2 // false\n```\n\n`symbol` çš„å€¼ä¸èƒ½è¿›è¡Œè¿ç®—ï¼Œå¯ä»¥è½¬æ¢ä¸ºå­—ç¬¦ä¸²å’Œå¸ƒå°”å€¼ï¼Œä½†ä¸èƒ½è½¬æ¢ä¸ºæ•°å€¼\n\n```js\nlet sym = Symbol();\nsym.toString() // 'Symbol(My symbol)'\nBoolean(sym) // true\nNumber(sym) // TypeError\n```\n\n## ä½œä¸ºå±æ€§åçš„ Symbol\n\n`Symbol` ä½œä¸ºå±æ€§åæ—¶ï¼Œä¸èƒ½ç”¨ `.` è¿ç®—ç¬¦\n\n```js\nconst mySymbol = Symbol();\nconst a = {};\n\na.mySymbol = 'Hello!';\na[mySymbol] // undefined\na['mySymbol'] // \"Hello!\"\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œå› ä¸ºç‚¹è¿ç®—ç¬¦åé¢æ€»æ˜¯å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥ä¸ä¼šè¯»å– `mySymbol` ä½œä¸ºæ ‡è¯†åæ‰€æŒ‡ä»£çš„é‚£ä¸ªå€¼ï¼Œå¯¼è‡´ `a` çš„å±æ€§åå®é™…ä¸Šæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè€Œä¸æ˜¯ä¸€ä¸ª `Symbol` å€¼ã€‚\n\nç”¨ `symbol` å®šä¹‰æ–¹æ³•çš„æ—¶å€™ä¹ŸåŒæ ·\n\n```js\nlet s = Symbol();\n\nlet obj = {\n  [s]: function (arg) { ... }\n};\n\nobj[s](123);\n\n//alse\nlet obj = {\n  [s](arg){\n    ...\n  }\n}\n```\n\n## å±æ€§åçš„éå†\n\nSymbol ä½œä¸ºå±æ€§åï¼Œè¯¥å±æ€§ä¸ä¼šå‡ºç°åœ¨ `for..in`ã€`for..of` å¾ªç¯ä¸­ï¼Œä¹Ÿä¸ä¼šè¢« `Object.keys()`,`Object.getOwnPropertyNames()`,`JSON.stringify()` è¿”å›ï¼Œä½†æ˜¯ä»–ä¸æ˜¯ç§æœ‰å±æ€§ï¼Œç”¨ `Object.getOwnPropertySymbols` æ–¹æ³•ï¼Œå¯ä»¥è·å–æŒ‡å®šå¯¹è±¡çš„æ‰€æœ‰ Symbolã€‚\n\n```js\nconst obj = {};\n\nlet foo = Symbol(\"foo\");\n\nObject.defineProperty(obj, foo, {\n  value: \"foobar\",\n});\n\nfor (let i in obj) {\n  console.log(i); // æ— è¾“å‡º\n}\n\nObject.getOwnPropertyNames(obj)\n// []\n\nObject.getOwnPropertySymbols(obj)\n// [Symbol(foo)]\n```\n\n`Reflect.ownKeys` å¯ä»¥è¿”å›æ‰€æœ‰ç±»å‹çš„é”®åï¼ŒåŒ…æ‹¬å¸¸è§„é”®åå’Œ Symbol é”®å\n\n```js\nlet obj = {\n  [Symbol('my_key')]: 1,\n  enum: 2,\n  nonEnum: 3\n};\n\nReflect.ownKeys(obj)\n//  [\"enum\", \"nonEnum\", Symbol(my_key)]\n```\n\n## Symbol.for()ï¼ŒSymbol.keyFor()\n\nå®ƒæ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ï¼Œç„¶åæœç´¢æœ‰æ²¡æœ‰ä»¥è¯¥å‚æ•°ä½œä¸ºåç§°çš„ Symbol å€¼ã€‚å¦‚æœæœ‰ï¼Œå°±è¿”å›è¿™ä¸ª Symbol å€¼ï¼Œå¦åˆ™å°±æ–°å»ºå¹¶è¿”å›ä¸€ä¸ªä»¥è¯¥å­—ç¬¦ä¸²ä¸ºåç§°çš„ Symbol å€¼ã€‚\n\n`Symbol.for()` ä¸ `Symbol()` è¿™ä¸¤ç§å†™æ³•ï¼Œéƒ½ä¼šç”Ÿæˆæ–°çš„ Symbolã€‚å®ƒä»¬çš„åŒºåˆ«æ˜¯ï¼Œ**å‰è€…ä¼šè¢«ç™»è®°åœ¨å…¨å±€ç¯å¢ƒä¸­ä¾›æœç´¢ï¼Œåè€…ä¸ä¼š**ã€‚`Symbol.for()` ä¸ä¼šæ¯æ¬¡è°ƒç”¨å°±è¿”å›ä¸€ä¸ªæ–°çš„ Symbol ç±»å‹çš„å€¼ï¼Œè€Œæ˜¯ä¼šå…ˆæ£€æŸ¥ç»™å®šçš„ `key` æ˜¯å¦å·²ç»å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨æ‰ä¼šæ–°å»ºä¸€ä¸ªå€¼ã€‚æ¯”å¦‚ï¼Œå¦‚æœä½ è°ƒç”¨ `Symbol.for(\"cat\")30` æ¬¡ï¼Œæ¯æ¬¡éƒ½ä¼šè¿”å›åŒä¸€ä¸ª Symbol å€¼ï¼Œä½†æ˜¯è°ƒç”¨ `Symbol(\"cat\")` 30 æ¬¡ï¼Œä¼šè¿”å› 30 ä¸ªä¸åŒçš„ Symbol å€¼ã€‚\n\n```js\nSymbol.for(\"bar\") === Symbol.for(\"bar\")\n// true\n\nSymbol(\"bar\") === Symbol(\"bar\")\n// false\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œç”±äº `Symbol()` å†™æ³•æ²¡æœ‰ç™»è®°æœºåˆ¶ï¼Œæ‰€ä»¥æ¯æ¬¡è°ƒç”¨éƒ½ä¼šè¿”å›ä¸€ä¸ªä¸åŒçš„å€¼ã€‚\n\n`Symbol.keyFor` æ–¹æ³•è¿”å›ä¸€ä¸ªå·²ç™»è®°çš„ Symbol ç±»å‹å€¼çš„ `key`ã€‚\n\n```js\nlet s1 = Symbol.for(\"foo\");\nSymbol.keyFor(s1) // \"foo\"\n\nlet s2 = Symbol(\"foo\");\nSymbol.keyFor(s2) // undefined\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œå˜é‡ `s2` å±äºæœªç™»è®°çš„ Symbol å€¼ï¼Œæ‰€ä»¥è¿”å› `undefined`ã€‚","tags":["ES6"],"categories":["Note"]},{"title":"LeanJsã€Œ ES6 ã€-- å¯¹è±¡çš„æ‰©å±•","url":"%2F2018%2F02%2F04%2FLeanJS%E5%AF%B9%E8%B1%A1%E7%9A%84%E6%89%A9%E5%B1%95%2F","content":"\n![Js](LeanJSå¯¹è±¡çš„æ‰©å±•/js.png)\n\n<!--more-->\n\n## å±æ€§çš„ç®€æ´è¡¨ç¤ºæ³•\n\nES6 å…è®¸ç›´æ¥å†™å…¥å˜é‡å’Œå‡½æ•°ï¼Œä½œä¸ºå¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•ã€‚è¿™æ ·çš„ä¹¦å†™æ›´åŠ ç®€æ´ã€‚\n\n```js\nconst foo = 'bar';\nconst baz = {foo};\nbaz // {foo: \"bar\"}\n\n// ç­‰åŒäº\nconst baz = {foo: foo};\n```\n\nå‡½æ•°ä¹Ÿå¯ä»¥ç®€å†™\n\n```js\nconst o = {\n  method() {\n    return \"Hello!\";\n  }\n};\n\n// ç­‰åŒäº\n\nconst o = {\n  method: function() {\n    return \"Hello!\";\n  }\n};\n```\n\næ³¨æ„ï¼Œç®€æ´å†™æ³•çš„å±æ€§åæ€»æ˜¯å­—ç¬¦ä¸²ï¼Œè¿™ä¼šå¯¼è‡´ä¸€äº›çœ‹ä¸Šå»æ¯”è¾ƒå¥‡æ€ªçš„ç»“æœã€‚\n\n```js\nconst obj = {\n  class () {}\n};\n\n// ç­‰åŒäº\n\nvar obj = {\n  'class': function() {}\n};\n```\n\n## å±æ€§åè¡¨è¾¾å¼\n\nJavaScript å®šä¹‰å¯¹è±¡çš„å±æ€§ï¼Œæœ‰ä¸¤ç§æ–¹æ³•\n\n```js\n//æ–¹æ³•ä¸€\nobj.foo = true;\n\n//æ–¹æ³•äºŒ\nobj['a'+'bc'] = 123\n```\n\nä½†æ˜¯å¦‚æœåœ¨å¤§æ‹¬å·ä¸­ï¼ŒES5 åªå…è®¸ç¬¬ä¸€ç§æ–¹æ³•ï¼ŒES6 ä¸­å¯ä»¥å…è®¸ä»¥ä¸Šä¸¤ç§æ–¹æ³•\n\n```js\n// ES5 \nvar obj = {\n  foo: true,\n  abc: 123\n};\n\n// ES6 \nlet propKey = 'foo';\n\nlet obj = {\n  [propKey]: true,\n  ['a' + 'bc']: 123\n};\n```\n\nè¡¨è¾¾å¼è¿˜å¯ä»¥ç”¨äºå®šä¹‰æ–¹æ³•åã€‚\n\n```js\nlet obj = {\n  ['h' + 'ello']() {\n    return 'hi';\n  }\n};\n\nobj.hello() // hi\n```\n\nå¦‚æœå±æ€§åæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œé»˜è®¤æƒ…å†µä¸‹ä¼šè‡ªåŠ¨å°†å¯¹è±¡è½¬ä¸ºå­—ç¬¦ä¸²`[object Object]`\n\n```js\nconst keyA = {a: 1};\nconst keyB = {b: 2};\n\nconst myObject = {\n  [keyA]: 'valueA',\n  [keyB]: 'valueB'\n};\n\nmyObject // Object {[object Object]: \"valueB\"}\n```\n\n## æ–¹æ³•çš„ name å±æ€§\n\nè¿”å›å‡½æ•°çš„åå­—ï¼Œå¦‚æœå¯¹è±¡çš„æ–¹æ³•ä½¿ç”¨äº†å–å€¼å‡½æ•° `getter` å’Œå­˜å€¼å‡½æ•° `setter`ï¼Œåˆ™ `name` å±æ€§ä¸æ˜¯åœ¨è¯¥æ–¹æ³•ä¸Šé¢ï¼Œè€Œæ˜¯è¯¥æ–¹æ³•çš„å±æ€§çš„æè¿°å¯¹è±¡çš„ `get` å’Œ `set` å±æ€§ä¸Šé¢ï¼Œè¿”å›å€¼æ˜¯æ–¹æ³•åå‰åŠ ä¸Š `get` å’Œ `set`ã€‚\n\næœ‰ä¸¤ç§ç‰¹æ®Šæƒ…å†µï¼š`bind` æ–¹æ³•åˆ›é€ çš„å‡½æ•°ï¼Œ`name` å±æ€§è¿”å› `bound` åŠ ä¸ŠåŸå‡½æ•°çš„åå­—ï¼›`Function` æ„é€ å‡½æ•°åˆ›é€ çš„å‡½æ•°ï¼Œ`name` å±æ€§è¿”å› `anonymous`ã€‚\n\n## Object.is()\n\nES5 ä¸­ï¼Œæ¯”è¾ƒä¸¤ä¸ªå€¼ç›¸ç­‰ï¼Œåªæœ‰ä¸¤ä¸ªè¿ç®—ç¬¦ï¼Œ`==` å’Œ `===`ï¼Œä½†è¿™ä¸¤ä¸ªæ— æ³•åˆ¤æ–­ä¸¤ä¸ªæ•°å€¼ä¸¥æ ¼æ„ä¹‰ä¸Šçš„ç›¸ç­‰ï¼Œ`==` ä¼šå¼ºåˆ¶è½¬æ¢ï¼Œ`===` ä¸­ `NaN` ä¸è‡ªå·±æœ¬èº«ä¹Ÿä¸æƒ³ç­‰ã€‚\n\n`Object.is()` å°±æ˜¯æ¥å®ç°æ¯”è¾ƒä¸¤ä¸ªå€¼æ˜¯å¦å®Œå…¨ç›¸ç­‰ï¼Œå…¶è¡Œä¸ºä¸ `===` å‡ ä¹ä¸€è‡´ï¼Œä¸åŒä¹‹å¤„åªæœ‰ä¸¤ä¸ªï¼šä¸€æ˜¯ `+0` ä¸ç­‰äº `-0` ï¼ŒäºŒæ˜¯ `NaN` ç­‰äºè‡ªèº«ã€‚\n\n```js\n+0 === -0 //true\nNaN === NaN // false\n\nObject.is(+0, -0) // false\nObject.is(NaN, NaN) // true\n```\n\n## Object.assign()\n\n### åŸºæœ¬ç”¨æ³•\n\n`Object.assign` æ–¹æ³•ç”¨äºå¯¹è±¡çš„åˆå¹¶ï¼Œå°†æºå¯¹è±¡ `source` çš„æ‰€æœ‰å¯æšä¸¾å±æ€§ï¼Œå¤åˆ¶åˆ°ç›®æ ‡å¯¹è±¡ `target`ã€‚\n\n```js\nconst target = { a: 1 };\n\nconst source1 = { b: 2 };\nconst source2 = { c: 3 };\n\nObject.assign(target, source1, source2);\ntarget // {a:1, b:2, c:3}\n```\n\n`Object.assign` æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ã€Œç›®æ ‡å¯¹è±¡ã€ï¼Œåé¢çš„å‚æ•°éƒ½æ˜¯ã€Œæºå¯¹è±¡ã€ã€‚\n\næ³¨æ„ï¼Œå¦‚æœç›®æ ‡å¯¹è±¡ä¸æºå¯¹è±¡æœ‰åŒåå±æ€§ï¼Œæˆ–å¤šä¸ªæºå¯¹è±¡æœ‰åŒåå±æ€§ï¼Œåˆ™åé¢çš„å±æ€§ä¼šè¦†ç›–å‰é¢çš„å±æ€§ã€‚\n\nå¯¹äºç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå¦‚æœè¯¥å‚æ•°ä¸æ˜¯å¯¹è±¡ï¼Œåˆ™ä¼šå…ˆè½¬æˆå¯¹è±¡ï¼Œç„¶åè¿”å›ã€‚å¦‚æœè½¬æ¢ä¸äº†ï¼Œåˆ™æŠ¥é”™\n\n```js\nObject.assign(undefined) // æŠ¥é”™\nObject.assign(null) // æŠ¥é”™\n```\n\nå¦‚æœéå¯¹è±¡å‚æ•°å‡ºç°åœ¨æºå¯¹è±¡çš„ä½ç½®ï¼ˆå³éé¦–å‚æ•°ï¼‰ï¼Œé‚£ä¹ˆå¤„ç†è§„åˆ™æœ‰æ‰€ä¸åŒã€‚é¦–å…ˆï¼Œè¿™äº›å‚æ•°éƒ½ä¼šè½¬æˆå¯¹è±¡ï¼Œå¦‚æœæ— æ³•è½¬æˆå¯¹è±¡ï¼Œå°±ä¼šè·³è¿‡ã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æœ `undefined` å’Œ `null` ä¸åœ¨é¦–å‚æ•°ï¼Œå°±ä¸ä¼šæŠ¥é”™ã€‚\n\n```js\nlet obj = {a: 1};\nObject.assign(obj, undefined) === obj // true\nObject.assign(obj, null) === obj // true\n```\n\nå…¶ä»–ç±»å‹çš„å€¼ï¼ˆå³æ•°å€¼ã€å­—ç¬¦ä¸²å’Œå¸ƒå°”å€¼ï¼‰ä¸åœ¨é¦–å‚æ•°ï¼Œä¹Ÿä¸ä¼šæŠ¥é”™ã€‚ä½†æ˜¯ï¼Œé™¤äº†å­—ç¬¦ä¸²ä¼šä»¥æ•°ç»„å½¢å¼ï¼Œæ‹·è´å…¥ç›®æ ‡å¯¹è±¡ï¼Œå…¶ä»–å€¼éƒ½ä¸ä¼šäº§ç”Ÿæ•ˆæœã€‚\n\n```js\nconst v1 = 'abc';\nconst v2 = true;\nconst v3 = 10;\n\nconst obj = Object.assign({}, v1, v2, v3);\nconsole.log(obj); // { \"0\": \"a\", \"1\": \"b\", \"2\": \"c\" }\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œ`v1`ã€`v2`ã€`v3` åˆ†åˆ«æ˜¯å­—ç¬¦ä¸²ã€å¸ƒå°”å€¼å’Œæ•°å€¼ï¼Œç»“æœåªæœ‰å­—ç¬¦ä¸²åˆå…¥ç›®æ ‡å¯¹è±¡ï¼ˆä»¥å­—ç¬¦æ•°ç»„çš„å½¢å¼ï¼‰ï¼Œæ•°å€¼å’Œå¸ƒå°”å€¼éƒ½ä¼šè¢«å¿½ç•¥ã€‚è¿™æ˜¯å› ä¸ºåªæœ‰å­—ç¬¦ä¸²çš„åŒ…è£…å¯¹è±¡ï¼Œä¼šäº§ç”Ÿå¯æšä¸¾å±æ€§ã€‚\n\n`Object.assign` æ‹·è´çš„å±æ€§æ˜¯æœ‰é™åˆ¶çš„ï¼Œåªæ‹·è´æºå¯¹è±¡çš„è‡ªèº«å±æ€§ï¼ˆä¸æ‹·è´ç»§æ‰¿å±æ€§ï¼‰ï¼Œä¹Ÿä¸æ‹·è´ä¸å¯æšä¸¾çš„å±æ€§ `enumerable: false`ã€‚\n\n### æ³¨æ„ç‚¹\n\n#### æµ…æ‹·è´\n\n`Object.assign()` æ˜¯æµ…æ‹·è´ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæºå¯¹è±¡æŸä¸ªå±æ€§å€¼æ˜¯å¯¹è±¡ï¼Œé‚£ä¹ˆç›®æ ‡å¯¹è±¡æ‹·è´å¾—åˆ°çš„æ˜¯è¿™ä¸ªå¯¹è±¡çš„å¼•ç”¨\n\n```js\nconst obj1 = {a: {b: 1}};\nconst obj2 = Object.assign({}, obj1);\n\nobj1.a.b = 2;\nobj2.a.b // 2\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œæºå¯¹è±¡ `obj1` çš„ `a` å±æ€§çš„å€¼æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œ`Object.assign` æ‹·è´å¾—åˆ°çš„æ˜¯è¿™ä¸ªå¯¹è±¡çš„å¼•ç”¨ã€‚è¿™ä¸ªå¯¹è±¡çš„ä»»ä½•å˜åŒ–ï¼Œéƒ½ä¼šåæ˜ åˆ°ç›®æ ‡å¯¹è±¡ä¸Šé¢ã€‚\n\n### åŒåå±æ€§çš„æ›¿æ¢\n\nå¯¹äºè¿™ç§åµŒå¥—çš„å¯¹è±¡ï¼Œä¸€æ—¦é‡åˆ°åŒåå±æ€§ï¼Œ`Object.assign` çš„å¤„ç†æ–¹æ³•æ˜¯æ›¿æ¢ï¼Œè€Œä¸æ˜¯æ·»åŠ ã€‚\n\n```js\nconst target = { a: { b: 'c', d: 'e' } }\nconst source = { a: { b: 'hello' } }\nObject.assign(target, source)\n// { a: { b: 'hello' } }\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œ`target` å¯¹è±¡çš„ `a`å±æ€§è¢« `source`å¯¹è±¡çš„aå±æ€§æ•´ä¸ªæ›¿æ¢æ‰äº†ï¼Œè€Œä¸ä¼šå¾—åˆ° `{ a: { b: 'hello', d: 'e' } }` çš„ç»“æœã€‚è¿™é€šå¸¸ä¸æ˜¯å¼€å‘è€…æƒ³è¦çš„ï¼Œéœ€è¦ç‰¹åˆ«å°å¿ƒã€‚\n\n### æ•°ç»„çš„å¤„ç†\n\n`Object.assign` å¯ä»¥ç”¨æ¥å¤„ç†æ•°ç»„ï¼Œä½†æ˜¯ä¼šæŠŠæ•°ç»„è§†ä¸ºå¯¹è±¡ã€‚\n\n```js\nObject.assign([1, 2, 3], [4, 5])\n// [4, 5, 3]\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œ`Object.assign` æŠŠæ•°ç»„è§†ä¸ºå±æ€§åä¸º `0`ã€`1`ã€`2` çš„å¯¹è±¡ï¼Œå› æ­¤æºæ•°ç»„çš„ `0` å·å±æ€§ `4` è¦†ç›–äº†ç›®æ ‡æ•°ç»„çš„ `0` å·å±æ€§ `1`ã€‚\n\n### å–å€¼å‡½æ•°çš„å¤„ç†\n\n`Object.assign` åªèƒ½è¿›è¡Œå€¼çš„å¤åˆ¶ï¼Œå¦‚æœè¦å¤åˆ¶çš„å€¼æ˜¯ä¸€ä¸ªå–å€¼å‡½æ•°ï¼Œé‚£ä¹ˆå°†æ±‚å€¼åå†å¤åˆ¶ã€‚\n\n```js\nconst source = {\n  get foo() { return 1 }\n};\nconst target = {};\n\nObject.assign(target, source)\n// { foo: 1 }\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œ`source` å¯¹è±¡çš„ `foo` å±æ€§æ˜¯ä¸€ä¸ªå–å€¼å‡½æ•°ï¼Œ`Object.assign` ä¸ä¼šå¤åˆ¶è¿™ä¸ªå–å€¼å‡½æ•°ï¼Œåªä¼šæ‹¿åˆ°å€¼ä»¥åï¼Œå°†è¿™ä¸ªå€¼å¤åˆ¶è¿‡å»ã€‚\n\n## å±æ€§çš„å¯æšä¸¾å’Œéå†\n\n### å¯æšä¸¾æ€§\n\næè¿°å¯¹è±¡çš„ `enumerable` å±æ€§ï¼Œç§°ä¸ºã€Œå¯æšä¸¾æ€§ã€ï¼Œå¦‚æœè¯¥å±æ€§ä¸º `false`ï¼Œå°±è¡¨ç¤ºæŸäº›æ“ä½œä¼šå¿½ç•¥å½“å‰å±æ€§ã€‚\n\nç›®å‰æœ‰å››ä¸ªæ“ä½œä¼šå¿½ç•¥ `enumerable` ä¸º `false` çš„å±æ€§\n\n- `for...in` å¾ªç¯ï¼šåªéå†å¯¹è±¡è‡ªèº«çš„å’Œç»§æ‰¿çš„å¯æšä¸¾çš„å±æ€§ã€‚\n- `Object.keys()` ï¼šè¿”å›å¯¹è±¡è‡ªèº«çš„æ‰€æœ‰å¯æšä¸¾çš„å±æ€§çš„é”®åã€‚\n- `JSON.stringify()` ï¼šåªä¸²è¡ŒåŒ–å¯¹è±¡è‡ªèº«çš„å¯æšä¸¾çš„å±æ€§ã€‚\n- `Object.assign()` ï¼š å¿½ç•¥ `enumerable` ä¸º `false` çš„å±æ€§ï¼Œåªæ‹·è´å¯¹è±¡è‡ªèº«çš„å¯æšä¸¾çš„å±æ€§ã€‚\n\n### å±æ€§çš„éå†\n\n#### for...in\n\n`for...in` å¾ªç¯éå†å¯¹è±¡è‡ªèº«çš„å’Œç»§æ‰¿çš„å¯æšä¸¾å±æ€§ï¼ˆä¸å« Symbol å±æ€§ï¼‰ã€‚\n\n### Object.keys(obj)\n\n`Object.keys` è¿”å›ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…æ‹¬å¯¹è±¡è‡ªèº«çš„ï¼ˆä¸å«ç»§æ‰¿çš„ï¼‰æ‰€æœ‰å¯æšä¸¾å±æ€§ï¼ˆä¸å« Symbol å±æ€§ï¼‰çš„é”®åã€‚\n\n### Object.getOwnPropertyNames(obj)\n\n`Object.getOwnPropertyNames` è¿”å›ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«å¯¹è±¡è‡ªèº«çš„æ‰€æœ‰å±æ€§ï¼ˆä¸å« Symbol å±æ€§ï¼Œä½†æ˜¯åŒ…æ‹¬ä¸å¯æšä¸¾å±æ€§ï¼‰çš„é”®åã€‚\n\n### Object.getOwnPropertySymbols(obj)\n\n`Object.getOwnPropertySymbols` è¿”å›ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«å¯¹è±¡è‡ªèº«çš„æ‰€æœ‰ Symbol å±æ€§çš„é”®åã€‚\n\n### Reflect.ownKeys(obj)\n\n`Reflect.ownKeys` è¿”å›ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«å¯¹è±¡è‡ªèº«çš„æ‰€æœ‰é”®åï¼Œä¸ç®¡é”®åæ˜¯ Symbol æˆ–å­—ç¬¦ä¸²ï¼Œä¹Ÿä¸ç®¡æ˜¯å¦å¯æšä¸¾ã€‚\n\nä»¥ä¸Šçš„ 5 ç§æ–¹æ³•éå†å¯¹è±¡çš„é”®åï¼Œéƒ½éµå®ˆåŒæ ·çš„å±æ€§éå†çš„æ¬¡åºè§„åˆ™ã€‚\n\n- é¦–å…ˆéå†æ‰€æœ‰æ•°å€¼é”®ï¼ŒæŒ‰ç…§æ•°å€¼å‡åºæ’åˆ—ã€‚\n- å…¶æ¬¡éå†æ‰€æœ‰å­—ç¬¦ä¸²é”®ï¼ŒæŒ‰ç…§åŠ å…¥æ—¶é—´å‡åºæ’åˆ—ã€‚\n- æœ€åéå†æ‰€æœ‰ Symbol é”®ï¼ŒæŒ‰ç…§åŠ å…¥æ—¶é—´å‡åºæ’åˆ—ã€‚\n\n## Object.getOwnPropertyDescriptors() \n\nå‰é¢è¯´è¿‡ï¼Œ`Object.getOwnPropertyDescriptor` æ–¹æ³•ä¼šè¿”å›æŸä¸ªå¯¹è±¡å±æ€§çš„æè¿°å¯¹è±¡ï¼ˆdescriptorï¼‰ã€‚ES2017 å¼•å…¥äº† `Object.getOwnPropertyDescriptors` æ–¹æ³•ï¼Œè¿”å›æŒ‡å®šå¯¹è±¡æ‰€æœ‰è‡ªèº«å±æ€§ï¼ˆéç»§æ‰¿å±æ€§ï¼‰çš„æè¿°å¯¹è±¡ã€‚\n\n```js\nconst obj = {\n  foo: 123,\n  get bar() { return 'abc' }\n};\n\nObject.getOwnPropertyDescriptors(obj)\n// { foo:\n//    { value: 123,\n//      writable: true,\n//      enumerable: true,\n//      configurable: true },\n//   bar:\n//    { get: [Function: get bar],\n//      set: undefined,\n//      enumerable: true,\n//      configurable: true } }\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œ`Object.getOwnPropertyDescriptors` æ–¹æ³•è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œæ‰€æœ‰åŸå¯¹è±¡çš„å±æ€§åéƒ½æ˜¯è¯¥å¯¹è±¡çš„å±æ€§åï¼Œå¯¹åº”çš„å±æ€§å€¼å°±æ˜¯è¯¥å±æ€§çš„æè¿°å¯¹è±¡ã€‚\n\n## `__proto__` å±æ€§ï¼ŒObject.setPrototypeOf()ï¼ŒObject.getPrototypeOf()\n\n### `__proto__` \n\nç”¨æ¥è¯»å–å’Œè®¾ç½®å½“å‰å¯¹è±¡çš„ `prototype`ï¼Œä½†æ˜¯ `__prototype__` æ˜¯ä¸€ä¸ªå†…éƒ¨å±æ€§ï¼Œä½†å®é™…ä¸Š `__proto__` è°ƒç”¨çš„æ˜¯ `Object.prototype.__proto__` å› æ­¤ä¸èƒ½ç”¨å…¶è¿›è¡Œæ“ä½œ\n\n### Object.setPrototypeOf()\n\n```js\n// æ ¼å¼\nObject.setPrototypeOf(object, prototype)\n```\n\nè¯¥æ–¹æ³•ç­‰åŒäºä¸‹é¢çš„å‡½æ•°\n\n```js\nfunction (obj, proto) {\n  obj.__proto__ = proto;\n  return obj;\n}\n```\n\n### Object.getPrototypeOf()\n\nè¯»å–ä¸€ä¸ªå¯¹è±¡çš„åŸå‹å‡½æ•°\n\n## super å…³é”®å­—\n\n`this` æ€»æ˜¯æŒ‡å‘å‡½æ•°æ‰€åœ¨çš„å½“å‰å¯¹è±¡ï¼ŒES6 åˆæ–°å¢äº†å¦ä¸€ä¸ªç±»ä¼¼çš„å…³é”®å­— `super`ï¼ŒæŒ‡å‘å½“å‰çš„åŸå‹å¯¹è±¡\n\n```js\nconst proto = {\n  foo: 'hello'\n};\n\nconst obj = {\n  find() {\n    return super.foo;\n  }\n};\n\nObject.setPrototypeOf(obj, proto);\nobj.find() // \"hello\"\n```\n\næ³¨æ„ï¼Œ`super` å…³é”®å­—è¡¨ç¤ºåŸå‹å¯¹è±¡æ—¶ï¼Œåªèƒ½ç”¨åœ¨å¯¹è±¡çš„æ–¹æ³•ä¹‹ä¸­ï¼Œç”¨åœ¨å…¶ä»–åœ°æ–¹éƒ½ä¼šæŠ¥é”™ã€‚\n\n```js\n// æŠ¥é”™\nconst obj = {\n  foo: super.foo\n}\n\n// æŠ¥é”™\nconst obj = {\n  foo: () => super.foo\n}\n\n// æŠ¥é”™\nconst obj = {\n  foo: function () {\n    return super.foo\n  }\n}\n```\n\nä¸Šé¢ä¸‰ç§ `super` çš„ç”¨æ³•éƒ½ä¼šæŠ¥é”™ï¼Œå› ä¸ºå¯¹äº JavaScript å¼•æ“æ¥è¯´ï¼Œè¿™é‡Œçš„ `super` éƒ½æ²¡æœ‰ç”¨åœ¨å¯¹è±¡çš„æ–¹æ³•ä¹‹ä¸­ã€‚ç¬¬ä¸€ç§å†™æ³•æ˜¯ `super` ç”¨åœ¨å±æ€§é‡Œé¢ï¼Œç¬¬äºŒç§å’Œç¬¬ä¸‰ç§å†™æ³•æ˜¯ `super` ç”¨åœ¨ä¸€ä¸ªå‡½æ•°é‡Œé¢ï¼Œç„¶åèµ‹å€¼ç»™ `foo` å±æ€§ã€‚**ç›®å‰ï¼Œåªæœ‰å¯¹è±¡æ–¹æ³•çš„ç®€å†™æ³•å¯ä»¥è®© JavaScript å¼•æ“ç¡®è®¤ï¼Œå®šä¹‰çš„æ˜¯å¯¹è±¡çš„æ–¹æ³•**ã€‚\n\nJavaScript å¼•æ“å†…éƒ¨ï¼Œ`super.foo` ç­‰åŒäº `Object.getPrototypeOf(this).foo`ï¼ˆå±æ€§ï¼‰æˆ– `Object.getPrototypeOf(this).foo.call(this)`ï¼ˆæ–¹æ³•ï¼‰ã€‚\n\n## Object.keys()ï¼ŒObject.values()ï¼ŒObject.entries() \n\nES5 å¼•å…¥äº† `Object.keys` æ–¹æ³•ï¼Œè¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œæˆå‘˜æ˜¯å‚æ•°å¯¹è±¡è‡ªèº«çš„ï¼ˆä¸å«ç»§æ‰¿çš„ï¼‰æ‰€æœ‰å¯éå†ï¼ˆenumerableï¼‰å±æ€§çš„**é”®å**,`Object.values`æ–¹æ³•ï¼Œè¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œæˆå‘˜ä¸ºæ‰€æœ‰å¯éå†å±æ€§çš„**å€¼**ï¼Œ`Object.entries`æ–¹æ³•è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œæˆå‘˜ä¸ºæ‰€æœ‰å¯éå†çš„**é”®å€¼å¯¹**\n\n```js\nvar obj = { foo: 'bar', baz: 42 };\nObject.keys(obj)\n// [\"foo\", \"baz\"]\n```\n\nES2017 å¼•å…¥äº†è·Ÿ `Object.keys` é…å¥—çš„ `Object.values` å’Œ `Object.entries`ï¼Œä½œä¸ºéå†ä¸€ä¸ªå¯¹è±¡çš„è¡¥å……æ‰‹æ®µï¼Œä¾› `for...of` å¾ªç¯ä½¿ç”¨ã€‚\n\n```js\nlet {keys, values, entries} = Object;\nlet obj = { a: 1, b: 2, c: 3 };\n\nfor (let key of keys(obj)) {\n  console.log(key); // 'a', 'b', 'c'\n}\n\nfor (let value of values(obj)) {\n  console.log(value); // 1, 2, 3\n}\n\nfor (let [key, value] of entries(obj)) {\n  console.log([key, value]); // ['a', 1], ['b', 2], ['c', 3]****\n```\n\n## å¯¹è±¡çš„æ‰©å±•è¿ç®—ç¬¦\n\n### è§£æ„èµ‹å€¼\n\nå¯¹è±¡çš„è§£æ„èµ‹å€¼ç”¨äºä»ä¸€ä¸ªå¯¹è±¡å–å€¼ï¼Œç›¸å½“äºå°†ç›®æ ‡å¯¹è±¡è‡ªèº«çš„æ‰€æœ‰å¯éå†çš„ `enumerable` ã€ä½†å°šæœªè¢«è¯»å–çš„å±æ€§ï¼Œåˆ†é…åˆ°æŒ‡å®šçš„å¯¹è±¡ä¸Šé¢ã€‚æ‰€æœ‰çš„é”®å’Œå®ƒä»¬çš„å€¼ï¼Œéƒ½ä¼šæ‹·è´åˆ°æ–°å¯¹è±¡ä¸Šé¢ã€‚\n\n```js\nlet { x, y, ...z } = { x: 1, y: 2, a: 3, b: 4 };\nx // 1\ny // 2\nz // { a: 3, b: 4 }\n```\n\nè§£æ„èµ‹å€¼å¿…é¡»æ˜¯æœ€åä¸€ä¸ªå‚æ•°ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚\n\n```js\nlet { ...x, y, z } = obj; // å¥æ³•é”™è¯¯\nlet { x, ...y, ...z } = obj; // å¥æ³•é”™è¯¯\n```\n\næ³¨æ„ï¼Œè§£æ„èµ‹å€¼çš„æ‹·è´æ˜¯æµ…æ‹·è´ï¼Œå³å¦‚æœä¸€ä¸ªé”®çš„å€¼æ˜¯å¤åˆç±»å‹çš„å€¼ï¼ˆæ•°ç»„ã€å¯¹è±¡ã€å‡½æ•°ï¼‰ã€é‚£ä¹ˆè§£æ„èµ‹å€¼æ‹·è´çš„æ˜¯è¿™ä¸ªå€¼çš„å¼•ç”¨ï¼Œè€Œä¸æ˜¯è¿™ä¸ªå€¼çš„å‰¯æœ¬ã€‚\n\n```js\nlet obj = { a: { b: 1 } };\nlet { ...x } = obj;\nobj.a.b = 2;\nx.a.b // 2\n```\n\n### æ‰©å±•è¿ç®—ç¬¦\n\nå¯¹è±¡çš„æ‰©å±•è¿ç®—ç¬¦ `...` ç”¨äºå–å‡ºå‚æ•°å¯¹è±¡çš„æ‰€æœ‰å¯éå†å±æ€§ï¼Œæ‹·è´åˆ°å½“å‰å¯¹è±¡ä¹‹ä¸­ã€‚\n\n```js\nlet z = { a: 3, b: 4 };\nlet n = { ...z };\nn // { a: 3, b: 4 }\n```\n\nè¿™ç­‰åŒäºä½¿ç”¨ `Object.assign` æ–¹æ³•ã€‚\n\n```js\nlet aClone = { ...a };\n// ç­‰åŒäº\nlet aClone = Object.assign({}, a);\n```\n\næ‰©å±•è¿ç®—ç¬¦å¯ä»¥ç”¨äºåˆå¹¶ä¸¤ä¸ªå¯¹è±¡ã€‚\n\n```js\nlet ab = { ...a, ...b };\n// ç­‰åŒäº\nlet ab = Object.assign({}, a, b);\n```\n\n\n\n\n\n","tags":["ES6"],"categories":["Note"]},{"title":"LeanJsã€Œ ES6 ã€-- æ•°ç»„çš„æ‰©å±•","url":"%2F2018%2F02%2F03%2FLeanJS%E6%95%B0%E7%BB%84%E7%9A%84%E6%89%A9%E5%B1%95%2F","content":"\n![Js](LeanJSæ•°ç»„çš„æ‰©å±•/js.png)\n\n<!--more-->\n\n## æ‰©å±•çš„è¿ç®—ç¬¦\n\n### å«ä¹‰\n\næ‰©å±•è¿ç®—ç¬¦(spread)æ˜¯ä¸‰ä¸ªç‚¹ `...`ã€‚å®ƒå¥½æ¯” rest å‚æ•°çš„é€†è¿ç®—ã€‚å°†ä¸€ä¸ªæ•°ç»„è½¬ä¸ºç”¨é€—å·åˆ†å‰²çš„å‚æ•°åˆ—è¡¨\n\n```js\nconsole.log(...[1, 2, 3])\n```\n\næ‰©å±•è¿ç®—ç¬¦ä¸æ­£å¸¸çš„å‡½æ•°å‚æ•°å¯ä»¥ç»“åˆä½¿ç”¨ï¼Œéå¸¸çµæ´»ã€‚\n\n```js\nfunction f(v, w, x, y, z) { }\nconst args = [0, 1];\nf(-1, ...args, 2, ...[3]);\n```\n\nå‡½æ•°å®šä¹‰æ—¶å‚æ•°ä¸­çš„ `...values` ä¸º rest å‚æ•°ï¼Œå‡½æ•°è°ƒç”¨æ—¶å‚æ•°ä¸­çš„ `...values` ä¸ºæ‰©å±•è¿ç®—ç¬¦ï¼Œå³å°†æ•°ç»„ `values` åˆ†å‰²å¼€\n\n### æ›¿ä»£å‡½æ•° apply çš„æ–¹æ³•\n\nç”±äºæ‰©å±•è¿ç®—ç¬¦å¯ä»¥å±•å¼€æ•°ç»„ï¼Œæ‰€ä»¥ä¸å†éœ€è¦ `apply` æ–¹æ³•ï¼Œå°†æ•°ç»„è½¬ä¸ºå‡½æ•°çš„å‚æ•°äº†ã€‚\n\n```js\n// ES5 çš„å†™æ³•\nfunction f(x, y, z) {\n  // ...\n}\nvar args = [0, 1, 2];\nf.apply(null, args);\n\n// ES6çš„å†™æ³•\nfunction f(x, y, z) {\n  // ...\n}\nlet args = [0, 1, 2];\nf(...args);\n```\n\nä¸‹é¢æ˜¯æ‰©å±•è¿ç®—ç¬¦å–ä»£ `apply` æ–¹æ³•çš„ä¸€ä¸ªå®é™…çš„ä¾‹å­ï¼Œåº”ç”¨ `Math.max` æ–¹æ³•ï¼Œç®€åŒ–æ±‚å‡ºä¸€ä¸ªæ•°ç»„æœ€å¤§å…ƒç´ çš„å†™æ³•ã€‚\n\n```js\n// ES5 çš„å†™æ³•\nMath.max.apply(null, [14, 3, 77])\n\n// ES6 çš„å†™æ³•\nMath.max(...[14, 3, 77])\n\n// ç­‰åŒäº\nMath.max(14, 3, 77);\n```\n\nå¦ä¸€ä¸ªä¾‹å­æ˜¯é€šè¿‡ `push` å‡½æ•°ï¼Œå°†ä¸€ä¸ªæ•°ç»„æ·»åŠ åˆ°å¦ä¸€ä¸ªæ•°ç»„çš„å°¾éƒ¨ã€‚\n\n```js\n// ES5çš„ å†™æ³•\nvar arr1 = [0, 1, 2];\nvar arr2 = [3, 4, 5];\nArray.prototype.push.apply(arr1, arr2);\n\n// ES6 çš„å†™æ³•\nlet arr1 = [0, 1, 2];\nlet arr2 = [3, 4, 5];\narr1.push(...arr2);\n```\n\nä¸Šé¢ä»£ç çš„ ES5 å†™æ³•ä¸­ï¼Œ`push` æ–¹æ³•çš„å‚æ•°ä¸èƒ½æ˜¯æ•°ç»„ï¼Œæ‰€ä»¥åªå¥½é€šè¿‡ `apply` æ–¹æ³•å˜é€šä½¿ç”¨ `push` æ–¹æ³•ã€‚æœ‰äº†æ‰©å±•è¿ç®—ç¬¦ï¼Œå°±å¯ä»¥ç›´æ¥å°†æ•°ç»„ä¼ å…¥ `push` æ–¹æ³•ã€‚\n\n### æ‰©å±•è¿ç®—ç¬¦çš„åº”ç”¨\n\n#### å¤åˆ¶æ•°ç»„\n\næ•°ç»„æ˜¯å¤åˆç±»å‹ï¼Œç›´æ¥å¤åˆ¶åªæ˜¯å¤åˆ¶äº†æŒ‡å‘åº•å±‚æ•°æ®è§£æ„çš„æŒ‡é’ˆã€‚ES5 ä½¿ç”¨ `concat()` æ¥å…‹éš†æ•°ç»„ï¼ŒES6 ä¸­ç”¨æ‰©å±•è¿ç®—ç¬¦æ›´å®¹æ˜“å®ç°\n\n```js\n//ES5\nconst a1 = [1, 2];\nconst a2 = a1.concat();\n\na2[0] = 2;\na1 // [1, 2]\n\n//ES6\nconst a1 = [1, 2];\n// å†™æ³•ä¸€\nconst a2 = [...a1];\n// å†™æ³•äºŒ\nconst [...a2] = a1;\n```\n\nä»¥ä¸Šå†™æ³• `a2` éƒ½æ˜¯ `a1` çš„å…‹éš†æ•°ç»„\n\n#### åˆå¹¶æ•°ç»„\n\næ‰©å±•è¿ç®—ç¬¦æä¾›äº†æ•°ç»„åˆå¹¶çš„æ–°å†™æ³•ã€‚\n\n```js\n// ES5\n[1, 2].concat(more)\n// ES6\n[1, 2, ...more]\n```\n\n#### ä¸è§£æ„èµ‹å€¼ç»“åˆ\n\næ‰©å±•è¿ç®—ç¬¦å¯ä»¥ä¸è§£æ„èµ‹å€¼ç»“åˆèµ·æ¥\n\n```js\nconst [first, ...rest] = [1, 2, 3, 4, 5];\nfirst // 1\nrest  // [2, 3, 4, 5]\n\nconst [first, ...rest] = [];\nfirst // undefined\nrest  // []\n\nconst [first, ...rest] = [\"foo\"];\nfirst  // \"foo\"\nrest   // []\n```\n\nå¦‚æœå°†æ‰©å±•è¿ç®—ç¬¦ç”¨äºæ•°ç»„èµ‹å€¼ï¼Œåªèƒ½æ”¾åœ¨å‚æ•°çš„æœ€åä¸€ä½ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚\n\n```js\nconst [...butLast, last] = [1, 2, 3, 4, 5];\n// æŠ¥é”™\n\nconst [first, ...middle, last] = [1, 2, 3, 4, 5];\n// æŠ¥é”™\n```\n\n#### å­—ç¬¦ä¸²\n\næ‰©å±•è¿ç®—ç¬¦è¿˜å¯ä»¥å°†å­—ç¬¦ä¸²è½¬ä¸ºçœŸæ­£çš„æ•°ç»„ã€‚\n\n```js\n[...'hello']\n// [ \"h\", \"e\", \"l\", \"l\", \"o\" ]\n```\n\nä¸Šé¢çš„å†™æ³•ï¼Œæœ‰ä¸€ä¸ªé‡è¦çš„å¥½å¤„ï¼Œé‚£å°±æ˜¯èƒ½å¤Ÿæ­£ç¡®è¯†åˆ«å››ä¸ªå­—èŠ‚çš„ Unicode å­—ç¬¦ã€‚\n\n```js\n'x\\uD83D\\uDE80y'.length // 4\n[...'x\\uD83D\\uDE80y'].length // 3\n```\n\n#### å®ç°äº† Iterator æ¥å£çš„å¯¹è±¡\n\nä»»ä½• Iterator æ¥å£çš„å¯¹è±¡ï¼ˆå‚é˜… Iterator ä¸€ç« ï¼‰ï¼Œéƒ½å¯ä»¥ç”¨æ‰©å±•è¿ç®—ç¬¦è½¬ä¸ºçœŸæ­£çš„æ•°ç»„ã€‚\n\n```js\nlet nodeList = document.querySelectorAll('div');\nlet array = [...nodeList];\n```\n\n## Array.from\n\n`Array.from` æ–¹æ³•ç”¨äºå°†ä¸¤ç±»å¯¹è±¡è½¬ä¸ºçœŸæ­£çš„æ•°ç»„ï¼šç±»æ•°ç»„çš„å¯¹è±¡å’Œå¯éå†çš„å¯¹è±¡\n\n```js\net arrayLike = {\n    '0': 'a',\n    '1': 'b',\n    '2': 'c',\n    length: 3\n};\n\n// ES5çš„å†™æ³•\nvar arr1 = [].slice.call(arrayLike); // ['a', 'b', 'c']\n\n// ES6çš„å†™æ³•\nlet arr2 = Array.from(arrayLike); // ['a', 'b', 'c']\n```\n\nå®é™…åº”ç”¨ä¸­ï¼Œå¸¸è§çš„ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡æ˜¯ DOM æ“ä½œè¿”å›çš„ NodeList é›†åˆï¼Œä»¥åŠå‡½æ•°å†…éƒ¨çš„ `arguments` å¯¹è±¡ã€‚`Array.from` éƒ½å¯ä»¥å°†å®ƒä»¬è½¬ä¸ºçœŸæ­£çš„æ•°ç»„ã€‚\n\n```js\n// NodeListå¯¹è±¡\nlet ps = document.querySelectorAll('p');\nArray.from(ps).filter(p => {\n  return p.textContent.length > 100;\n});\n\n// argumentså¯¹è±¡\nfunction foo() {\n  var args = Array.from(arguments);\n  // ...\n}\n```\n\nåªè¦éƒ¨ç½²äº† Iterator æ¥å£çš„æ•°æ®ç»“æ„ï¼Œ `Array.from` éƒ½èƒ½å°†å…¶è½¬ä¸ºæ•°ç»„\n\n`Array.from` è¿˜å¯ä»¥æ¥å—ç¬¬äºŒä¸ªå‚æ•°ï¼Œä½œç”¨ç±»ä¼¼äºæ•°ç»„çš„ `map` æ–¹æ³•ï¼Œç”¨æ¥å¯¹æ¯ä¸ªå…ƒç´ è¿›è¡Œå¤„ç†ï¼Œå°†å¤„ç†åçš„å€¼æ”¾å…¥è¿”å›çš„æ•°ç»„ã€‚\n\n```js\nArray.from(arrayLike, x => x * x);\n// ç­‰åŒäº\nArray.from(arrayLike).map(x => x * x);\n\nArray.from([1, 2, 3], (x) => x * x)\n// [1, 4, 9]\n```\n\n## Array.of()\n\n`Array.of` æ–¹æ³•ç”¨äºå°†ä¸€ç»„å€¼ï¼Œè½¬æ¢ä¸ºæ•°ç»„ã€‚\n\n```js\nArray.of(3, 11, 8) // [3,11,8]\nArray.of(3) // [3]\nArray.of(3).length // 1\n```\n\nè¿™ä¸ªæ–¹æ³•çš„ä¸»è¦ç›®çš„ï¼Œæ˜¯å¼¥è¡¥æ•°ç»„æ„é€ å‡½æ•° `Array()` çš„ä¸è¶³ã€‚å› ä¸ºå‚æ•°ä¸ªæ•°çš„ä¸åŒï¼Œä¼šå¯¼è‡´ `Array()` çš„è¡Œä¸ºæœ‰å·®å¼‚ã€‚\n\n```js\nArray() // []\nArray(3) // [, , ,]\nArray(3, 11, 8) // [3, 11, 8]\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œ`Array` æ–¹æ³•æ²¡æœ‰å‚æ•°ã€ä¸€ä¸ªå‚æ•°ã€ä¸‰ä¸ªå‚æ•°æ—¶ï¼Œè¿”å›ç»“æœéƒ½ä¸ä¸€æ ·ã€‚åªæœ‰å½“å‚æ•°ä¸ªæ•°ä¸å°‘äº 2 ä¸ªæ—¶ï¼Œ`Array()` æ‰ä¼šè¿”å›ç”±å‚æ•°ç»„æˆçš„æ–°æ•°ç»„ã€‚å‚æ•°ä¸ªæ•°åªæœ‰ä¸€ä¸ªæ—¶ï¼Œå®é™…ä¸Šæ˜¯æŒ‡å®šæ•°ç»„çš„é•¿åº¦ã€‚\n\n## æ•°ç»„å®ä¾‹çš„ copyWithin()\n\næ•°ç»„å®ä¾‹çš„ `copyWithin` æ–¹æ³•ï¼Œåœ¨å½“å‰æ•°ç»„å†…éƒ¨ï¼Œå°†æŒ‡å®šä½ç½®çš„æˆå‘˜å¤åˆ¶åˆ°å…¶ä»–ä½ç½®ï¼Œç„¶åè¿”å›å½“å‰æ•°ç»„ã€‚ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œä¼šä¿®æ”¹å½“å‰æ•°ç»„\n\n```js\nArray.prototype.copyWithin(target, start = 0, end = this.length)\n```\n\n- `target`ï¼ˆå¿…éœ€ï¼‰ï¼šä»è¯¥ä½ç½®å¼€å§‹æ›¿æ¢æ•°æ®ã€‚å¦‚æœä¸ºè´Ÿå€¼ï¼Œè¡¨ç¤ºå€’æ•°ã€‚\n- `start`ï¼ˆå¯é€‰ï¼‰ï¼šä»è¯¥ä½ç½®å¼€å§‹è¯»å–æ•°æ®ï¼Œé»˜è®¤ä¸º 0ã€‚å¦‚æœä¸ºè´Ÿå€¼ï¼Œè¡¨ç¤ºå€’æ•°ã€‚\n- `end`ï¼ˆå¯é€‰ï¼‰ï¼šåˆ°è¯¥ä½ç½®**å‰**åœæ­¢è¯»å–æ•°æ®ï¼Œé»˜è®¤ç­‰äºæ•°ç»„é•¿åº¦ã€‚å¦‚æœä¸ºè´Ÿå€¼ï¼Œè¡¨ç¤ºå€’æ•°ã€‚\n\n```js\n// å°†3å·ä½å¤åˆ¶åˆ°0å·ä½\n[1, 2, 3, 4, 5].copyWithin(0, 3, 4)\n// [4, 2, 3, 4, 5]\n\n// -2ç›¸å½“äº3å·ä½ï¼Œ-1ç›¸å½“äº4å·ä½\n[1, 2, 3, 4, 5].copyWithin(0, -2, -1)\n// [4, 2, 3, 4, 5]\n\n// å°†3å·ä½å¤åˆ¶åˆ°0å·ä½\n[].copyWithin.call({length: 5, 3: 1}, 0, 3)\n// {0: 1, 3: 1, length: 5}\n\n// å°†2å·ä½åˆ°æ•°ç»„ç»“æŸï¼Œå¤åˆ¶åˆ°0å·ä½\nlet i32a = new Int32Array([1, 2, 3, 4, 5]);\ni32a.copyWithin(0, 2);\n// Int32Array [3, 4, 5, 4, 5]\n\n// å¯¹äºæ²¡æœ‰éƒ¨ç½² TypedArray çš„ copyWithin æ–¹æ³•çš„å¹³å°\n// éœ€è¦é‡‡ç”¨ä¸‹é¢çš„å†™æ³•\n[].copyWithin.call(new Int32Array([1, 2, 3, 4, 5]), 0, 3, 4);\n// Int32Array [4, 2, 3, 4, 5]\n```\n\n## æ•°ç»„å®ä¾‹çš„ find() å’Œ findIndex() \n\næ•°ç»„å®ä¾‹çš„ `find` æ–¹æ³•ï¼Œç”¨äºæ‰¾å‡ºç¬¬ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„æ•°ç»„æˆå‘˜\n\n```js\n[1, 5, 10, 15].find(function(value, index, arr) {\n  return value > 9;\n}) // 10\n```\n\næ•°ç»„å®ä¾‹çš„ `findIndex` æ–¹æ³•ï¼Œç”¨äºæ‰¾å‡ºç¬¬ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„æ•°ç»„æˆå‘˜çš„ä¸‹æ ‡\n\n```js\n[1, 5, 10, 15].find(function(value, index, arr) {\n  return value > 9;\n}) // 2\n```\n\n## æ•°ç»„å®ä¾‹çš„ fill()\n\nfillæ–¹æ³•ä½¿ç”¨ç»™å®šå€¼ï¼Œå¡«å……ä¸€ä¸ªæ•°ç»„ã€‚\n\n```js\n['a', 'b', 'c'].fill(7)\n// [7, 7, 7]\n\nnew Array(3).fill(7)\n// [7, 7, 7]\n```\n\nä¸Šé¢ä»£ç è¡¨æ˜ï¼Œ`fill` æ–¹æ³•ç”¨äºç©ºæ•°ç»„çš„åˆå§‹åŒ–éå¸¸æ–¹ä¾¿ã€‚æ•°ç»„ä¸­å·²æœ‰çš„å…ƒç´ ï¼Œä¼šè¢«å…¨éƒ¨æŠ¹å»ã€‚\n\n`fill` æ–¹æ³•è¿˜å¯ä»¥æ¥å—ç¬¬äºŒä¸ªå’Œç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œç”¨äºæŒ‡å®šå¡«å……çš„èµ·å§‹ä½ç½®å’Œç»“æŸä½ç½®ã€‚\n\n```js\n['a', 'b', 'c'].fill(7, 1, 2)\n// ['a', 7, 'c']\n```\n\nä¸Šé¢ä»£ç è¡¨ç¤ºï¼Œ`fill` æ–¹æ³•ä» 1 å·ä½å¼€å§‹ï¼Œå‘åŸæ•°ç»„å¡«å…… 7ï¼Œåˆ° 2 å·ä½ä¹‹**å‰**ç»“æŸã€‚\n\n## æ•°ç»„å®ä¾‹çš„ entries()ï¼Œkeys()å’Œvalues()\n\nES6 æä¾›ä¸‰ä¸ªæ–°çš„æ–¹æ³•â€”â€”`entries()`ï¼Œ`keys()` å’Œ `values()` â€”â€”ç”¨äºéå†æ•°ç»„ã€‚å®ƒä»¬éƒ½è¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼ˆè¯¦è§ã€ŠIteratorã€‹ä¸€ç« ï¼‰ï¼Œå¯ä»¥ç”¨ `for...of` å¾ªç¯è¿›è¡Œéå†ï¼Œå”¯ä¸€çš„åŒºåˆ«æ˜¯ `keys()` æ˜¯å¯¹é”®åçš„éå†ã€`values()` æ˜¯å¯¹é”®å€¼çš„éå†ï¼Œ`entries()` æ˜¯å¯¹é”®å€¼å¯¹çš„éå†ã€‚\n\n```js\nfor (let index of ['a', 'b'].keys()) {\n  console.log(index);\n}\n// 0\n// 1\n\nfor (let elem of ['a', 'b'].values()) {\n  console.log(elem);\n}\n// 'a'\n// 'b'\n\nfor (let [index, elem] of ['a', 'b'].entries()) {\n  console.log(index, elem);\n}\n// 0 \"a\"\n// 1 \"b\"\n```\n\n## æ•°ç»„å®ä¾‹çš„ includes()\n\n`Array.prototype.includes` æ–¹æ³•è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæŸä¸ªæ•°ç»„æ˜¯å¦åŒ…å«ç»™å®šçš„å€¼ï¼Œä¸å­—ç¬¦ä¸²çš„ `includes` æ–¹æ³•ç±»ä¼¼ã€‚ES2016 å¼•å…¥äº†è¯¥æ–¹æ³•ã€‚\n\n```js\n[1, 2, 3].includes(2)     // true\n[1, 2, 3].includes(4)     // false\n[1, 2, NaN].includes(NaN) // true\n```\n\nè¯¥æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºæœç´¢çš„èµ·å§‹ä½ç½®ï¼Œé»˜è®¤ä¸º `0`ã€‚å¦‚æœç¬¬äºŒä¸ªå‚æ•°ä¸ºè´Ÿæ•°ï¼Œåˆ™è¡¨ç¤ºå€’æ•°çš„ä½ç½®ï¼Œå¦‚æœè¿™æ—¶å®ƒå¤§äºæ•°ç»„é•¿åº¦ï¼ˆæ¯”å¦‚ç¬¬äºŒä¸ªå‚æ•°ä¸º `-4`ï¼Œä½†æ•°ç»„é•¿åº¦ä¸º `3`ï¼‰ï¼Œåˆ™ä¼šé‡ç½®ä¸ºä» `0` å¼€å§‹ã€‚\n\n```js\n[1, 2, 3].includes(3, 3);  // false\n[1, 2, 3].includes(3, -1); // true\n```\n\n## æ•°ç»„çš„ç©ºä½\n\næ•°ç»„çš„ç©ºä½æŒ‡ï¼Œæ•°ç»„çš„æŸä¸€ä¸ªä½ç½®æ²¡æœ‰ä»»ä½•å€¼ã€‚\n\n```js\nArray(3) // [, , ,]\n```\n\nç©ºä½ä¸æ˜¯ `undefined` ï¼Œä¸€ä¸ªä½ç½®çš„å€¼ç­‰äº `undefined`ï¼Œä¾ç„¶æ˜¯æœ‰å€¼çš„\n\n\nES5 å¯¹ç©ºä½çš„å¤„ç†ï¼Œå·²ç»å¾ˆä¸ä¸€è‡´äº†ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹ä¼šå¿½ç•¥ç©ºä½ã€‚\n\n- `forEach()`, `filter()`,`reduce()`, `every()` å’Œ `some()` éƒ½ä¼šè·³è¿‡ç©ºä½ã€‚\n- `map()` ä¼šè·³è¿‡ç©ºä½ï¼Œä½†ä¼šä¿ç•™è¿™ä¸ªå€¼\n- `join()` å’Œ `toString()` ä¼šå°†ç©ºä½è§†ä¸º `undefined`ï¼Œè€Œ `undefined` å’Œ `null` ä¼šè¢«å¤„ç†æˆç©ºå­—ç¬¦ä¸²ã€‚\n\n\nES6 åˆ™æ˜¯æ˜ç¡®å°†ç©ºä½è½¬ä¸º `undefined`ã€‚ES6 æ–°å¢æ–¹æ³•éƒ½ä¼šå°†ç©ºä½å¤„ç†æˆ `undefined`\n\n","tags":["ES6"],"categories":["Note"]},{"title":"LeanJsã€Œ ES6 ã€-- å‡½æ•°çš„æ‰©å±•","url":"%2F2018%2F02%2F02%2FLeanJS%E5%87%BD%E6%95%B0%E7%9A%84%E6%89%A9%E5%B1%95%2F","content":"\n![Js](LeanJSå‡½æ•°çš„æ‰©å±•/js.png)\n\n<!--more-->\n\n## å‡½æ•°å‚æ•°çš„é»˜è®¤å€¼\n\n### åŸºæœ¬ç”¨æ³•\n\nES6 ä¹‹å‰ï¼Œç»™å‡½æ•°å‚æ•°è®¾å®šé»˜è®¤å€¼è¦ç”¨å¦‚ä¸‹å†™æ³•\n\n```js\nfunction(x){\n  x = x || 'hello'\n}\n```\n\nä½†æ˜¯è¿™æ ·å†™ï¼Œå¦‚æœä¼ å…¥çš„å‚æ•°æ˜¯ç©ºå­—ç¬¦æˆ–è€…ä¸º `false` ï¼Œä¼šå¯ç”¨é»˜è®¤å€¼ï¼Œä½†è¿™æ˜¾ç„¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ç»“æœã€‚å› æ­¤æˆ‘ä»¬è¿˜è¦åˆ¤æ–­å‚æ•°æ˜¯å¦è¢«èµ‹å€¼\n\n```js\nif (typeof x === 'undefined') {\n  x = 'World';\n}\n```\n\nES6 ç»™äº†æˆ‘ä»¬æ›´å¥½çš„ä¸€ç§å®ç°æ–¹æ³•ï¼Œå¯ä»¥æŠŠé»˜è®¤å€¼ç›´æ¥å†™åœ¨å‚æ•°çš„åé¢ï¼Œè€Œä¸”éå¸¸çš„è‡ªç„¶\n\n```js\nfunction log(x, y = 'World') {\n  console.log(x, y);\n}\n\nlog('Hello') // Hello World\nlog('Hello', 'China') // Hello China\nlog('Hello', '') // Hello\n```\n\nä½¿ç”¨å‚æ•°é»˜è®¤å€¼æ—¶ä¸èƒ½æœ‰åŒåçš„å‚æ•°\n\n```js\n// ä¸æŠ¥é”™\nfunction foo(x, x, y) {\n  // ...\n}\n\n// æŠ¥é”™\nfunction foo(x, x, y = 1) {\n  // ...\n}\n// SyntaxError: Duplicate parameter name not allowed in this context\n```\n\nå‚æ•°é»˜è®¤å€¼ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œè€Œä¸”æ¯æ¬¡è°ƒç”¨éƒ½ä¼šé‡æ–°è®¡ç®—\n\n```js\nlet x = 99;\nfunction foo(p = x + 1) {\n  console.log(p);\n}\n\nfoo() // 100\n\nx = 100;\nfoo() // 101\n```\n\n### ä¸è§£æ„èµ‹å€¼é»˜è®¤å€¼ç»“åˆä½¿ç”¨\n\n```js\nfunction foo({x, y = 5}) {\n  console.log(x, y);\n}\n\nfoo({}) // undefined 5\nfoo({x: 1}) // 1 5\nfoo({x: 1, y: 2}) // 1 2\nfoo() // TypeError: Cannot read property 'x' of undefined\n```\n\nä¼ å…¥ç©ºå¯¹è±¡æ—¶ `x` æ— æ³•è§£æ„åˆ°å€¼ï¼Œè¿”å› `undefined` ï¼Œ`y` å› ä¸ºé»˜è®¤å€¼ï¼Œæ‰€ä»¥è¿”å› `5`ï¼Œå½“ä¸ä¼ å…¥ç©ºå¯¹è±¡æ—¶ï¼Œ `x` å’Œ `y` æ— æ³•ç”Ÿæˆï¼Œæ‰€ä»¥æŠ¥é”™ã€‚é€šè¿‡æä¾›æ•´ä¸ªå‚æ•°çš„é»˜è®¤å€¼ï¼Œå¯ä»¥é¿å…æŠ¥é”™\n\n```js\nfunction foo({x, y = 5} = {}) {\n  console.log(x, y);\n}\n\nfoo() // undefined 5\n```\n\nå¦‚æœæ²¡æœ‰ä¼ å‚ï¼Œå°±é»˜è®¤ä¼ å…¥ä¸€ä¸ªç©ºå¯¹è±¡ã€‚\n\n```js\n// å†™æ³•ä¸€\nfunction m1({x = 0, y = 0} = {}) {\n  return [x, y];\n}\n\n// å†™æ³•äºŒ\nfunction m2({x, y} = { x: 0, y: 0 }) {\n  return [x, y];\n}\n```\n\nä»¥ä¸Šä¸¤ç§ä¹Ÿæ˜¯æœ‰å¾ˆå¤§å·®åˆ«\n\n```js\n// å‡½æ•°æ²¡æœ‰å‚æ•°çš„æƒ…å†µ\nm1() // [0, 0]\nm2() // [0, 0]\n\n// x å’Œ y éƒ½æœ‰å€¼çš„æƒ…å†µ\nm1({x: 3, y: 8}) // [3, 8]\nm2({x: 3, y: 8}) // [3, 8]\n\n// x æœ‰å€¼ï¼Œy æ— å€¼çš„æƒ…å†µ\nm1({x: 3}) // [3, 0]\nm2({x: 3}) // [3, undefined]\n\n// x å’Œ y éƒ½æ— å€¼çš„æƒ…å†µ\nm1({}) // [0, 0];\nm2({}) // [undefined, undefined]\n\nm1({z: 3}) // [0, 0]\nm2({z: 3}) // [undefined, undefined]\n```\n\nå†™æ³•ä¸€å‡½æ•°å‚æ•°çš„é»˜è®¤å€¼æ˜¯ç©ºå¯¹è±¡ï¼Œä½†æ˜¯è®¾ç½®äº†å¯¹è±¡è§£æ„èµ‹å€¼çš„é»˜è®¤å€¼ï¼›å†™æ³•äºŒå‡½æ•°å‚æ•°çš„é»˜è®¤å€¼æ˜¯ä¸€ä¸ªæœ‰å…·ä½“å±æ€§çš„å¯¹è±¡ï¼Œä½†æ˜¯æ²¡æœ‰è®¾ç½®å¯¹è±¡è§£æ„èµ‹å€¼çš„é»˜è®¤å€¼ã€‚å½“éƒ½ä¸ä¼ å€¼æ—¶ä¸ä¼šå‡ºç°å·®åˆ«ï¼Œä½†æ˜¯å½“ä¼ ç©ºå¯¹è±¡æ—¶ï¼Œå› ä¸ºå†™æ³•äºŒæ²¡æœ‰è§£æ„èµ‹å€¼çš„é»˜è®¤å€¼ï¼Œå› æ­¤å®ƒå¯¹åº”çš„ä¸ºç©ºå¯¹è±¡ï¼Œè¿”å›çš„å°±æ˜¯ `undefined`\n\n### å‚æ•°é»˜è®¤å€¼çš„ä½ç½®\n\né€šå¸¸æƒ…å†µä¸‹ï¼Œå®šä¹‰äº†é»˜è®¤å€¼çš„å‚æ•°ï¼Œåº”è¯¥æ˜¯å‡½æ•°çš„å°¾å‚æ•°ã€‚å› ä¸ºè¿™æ ·æ¯”è¾ƒå®¹æ˜“çœ‹å‡ºæ¥ï¼Œåˆ°åº•çœç•¥äº†å“ªäº›å‚æ•°ã€‚å¦‚æœéå°¾éƒ¨çš„å‚æ•°è®¾ç½®é»˜è®¤å€¼ï¼Œå®é™…ä¸Šè¿™ä¸ªå‚æ•°æ˜¯æ²¡æ³•çœç•¥çš„ã€‚\n\n```js\n// ä¾‹ä¸€\nfunction f(x = 1, y) {\n  return [x, y];\n}\n\nf() // [1, undefined]\nf(2) // [2, undefined]\nf(, 1) // æŠ¥é”™\nf(undefined, 1) // [1, 1]\n\n// ä¾‹äºŒ\nfunction f(x, y = 5, z) {\n  return [x, y, z];\n}\n\nf() // [undefined, 5, undefined]\nf(1) // [1, 5, undefined]\nf(1, ,2) // æŠ¥é”™\nf(1, undefined, 2) // [1, 5, 2]\n```\n\nå‚æ•°æ˜¯å¯ä»¥çœç•¥ï¼Œä½†æ˜¯æ— æ³•åªçœç•¥è¿™ä¸€ä¸ªå‚æ•°ï¼Œé™¤éæ˜¾ç¤ºçš„è¾“å…¥ `undefined`ã€‚\n\n### å‡½æ•°çš„ length å±æ€§\n\næŒ‡å®šäº†é»˜è®¤å€¼ä»¥åï¼Œå‡½æ•°çš„ `length` å±æ€§ï¼Œå°†è¿”å›æ²¡æœ‰æŒ‡å®šé»˜è®¤å€¼çš„å‚æ•°ä¸ªæ•°ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒæŒ‡å®šäº†é»˜è®¤å€¼åï¼Œ`length` å±æ€§å°†å¤±çœŸã€‚\n\n```js\n(function(a){}).length// 1\n(function(a = 1 ){}).length// 0\n```\n\nå› ä¸º `length` å±æ€§çš„å«ä¹‰ä¸ºè¯¥å‡½æ•°é¢„æœŸä¼ å…¥çš„å‚æ•°ä¸ªæ•°ï¼Œè¿™é‡Œéœ€è¦æ³¨æ„ï¼Œå¦‚æœè®¾ç½®é»˜è®¤å€¼çš„å‚æ•°ä¸æ˜¯å°¾å‚æ•°ï¼Œé‚£ä¹ˆè¯¥å‚æ•°åé¢çš„å‚æ•°ä¹Ÿä¸è®¡å…¥ `length`\n\n```js\n(function (a = 0, b, c) {}).length // 0\n(function (a, b = 1, c) {}).length // 1\n```\n\n### ä½œç”¨åŸŸ\n\nä¸€æ—¦è®¾ç½®äº†å‚æ•°çš„é»˜è®¤å€¼ï¼Œå‡½æ•°è¿›è¡Œå£°æ˜åˆå§‹åŒ–æ—¶ï¼Œå‚æ•°ä¼šå½¢æˆä¸€ä¸ªå•ç‹¬çš„ä½œç”¨åŸŸï¼ˆcontextï¼‰ã€‚ç­‰åˆ°åˆå§‹åŒ–ç»“æŸï¼Œè¿™ä¸ªä½œç”¨åŸŸå°±ä¼šæ¶ˆå¤±ã€‚è¿™ç§è¯­æ³•è¡Œä¸ºï¼Œåœ¨ä¸è®¾ç½®å‚æ•°é»˜è®¤å€¼æ—¶ï¼Œæ˜¯ä¸ä¼šå‡ºç°çš„ã€‚\n\n```js\nvar x = 1;\n\nfunction f(x, y = x) {\n  console.log(y);\n}\n\nf(2) // 2\n```\n\nå‡½æ•°å‚æ•° `y=x` çš„ `x` ä¸ºåŒä¸€ä½œç”¨åŸŸä¸‹çš„å‚æ•° `x` ï¼Œä¸æ˜¯å…¨å±€å˜é‡ `x`\n\nå¦‚æœå‚æ•°çš„é»˜è®¤å€¼æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°çš„ä½œç”¨åŸŸä¹Ÿéµå®ˆè¿™ä¸ªè§„åˆ™\n\n```js\nvar x = 1;\nfunction foo(x, y = function() { x = 2; }) {\n  var x = 3;\n  y();\n  console.log(x);\n}\n\nfoo() // 3\nx // 1\n```\n\nå‡½æ•° `foo` çš„å‚æ•°å½¢æˆäº†ä¸€ä¸ªå•ç‹¬çš„ä½œç”¨åŸŸï¼Œè¿™ä¸ªä½œç”¨åŸŸä¸­ï¼Œé¦–å…ˆå£°æ˜äº†å˜é‡ `x` ï¼Œç„¶åå£°æ˜äº†å˜é‡ `y` ï¼Œ`y` ä¸ºä¸€ä¸ªåŒ¿åå‡½æ•°ï¼Œå‡½æ•°ä¸­è®¾ç½®äº† `x=2` ï¼Œæ­¤ä¸­çš„ `x` ä¸ºå‚æ•° `x`ï¼Œç„¶ååœ¨ `foo` å‡½æ•°ä¸­å£°æ˜äº†ä¸€ä¸ªå†…éƒ¨çš„ `x` ï¼Œè€Œæ­¤ `x` å’Œå‚æ•°ä¸­çš„ `x` ä¸åœ¨åŒä¸€ä½œç”¨åŸŸå†…ï¼Œå› æ­¤ä¸æ˜¯åŒä¸€ä¸ªå˜é‡ã€‚\n\n```js\nvar x = 1;\nfunction foo(x, y = function() { x = 2; }) {\n  x = 3;\n  y();\n  console.log(x);\n}\n\nfoo() // 2\nx // 1\n```\n\nè¿™æ ·å‡½æ•°å†…éƒ¨çš„ `x` å°±æŒ‡å‘äº†å‚æ•°ï¼Œä¸åŒ¿åå‡½æ•°ä¸­çš„ `x` æ˜¯åŒä¸€ä¸ªå˜é‡ï¼Œæœ€å `foo()` è¾“å‡ºçš„æ˜¯ `2`ï¼Œä½†æ˜¯éƒ½æ²¡æœ‰å½±å“å…¨å±€å˜é‡\n\nå†çœ‹ä¸‹é¢çš„ä¾‹å­\n\n```js\nfunction f(y = x) {\n  let x = 2;\n  console.log(y);\n}\n\nf() // ReferenceError: x is not defined\n```\n\nè¿™é‡Œçš„ `x` ä¼šå»æ‰¾å‡½æ•°å¤–çš„å˜é‡ï¼Œå±€éƒ¨å˜é‡æ— æ³•å½±å“åˆ°é»˜è®¤å€¼\n\n## rest å‚æ•°\n\nES6 å¼•å…¥ rest å‚æ•°ï¼Œç”¨äºè·å–å‡½æ•°å¤šä½™çš„å‚æ•°ï¼Œè¿™æ ·å°±ä¸éœ€è¦ç”¨ `arguments` å¯¹è±¡äº†ã€‚rest å‚æ•°æ­é…çš„å˜é‡æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œè¯¥å˜é‡å°†å¤šä½™çš„å‚æ•°æ”¾å…¥æ•°ç»„ï¼Œå½¢ä¸º `...values`\n\n```js\nfunction add(...values) {\n  let sum = 0;\n\n  for (var val of values) {\n    sum += val;\n  }\n\n  return sum;\n}\n\nadd(2, 5, 3) // 10\n```\n\nrest å‚æ•°åé¢ä¸èƒ½æœ‰å…¶å®ƒå‚æ•°ï¼Œå³åªèƒ½ä¸ºæœ€åä¸€ä¸ªå‚æ•°\n\n```js\n// æŠ¥é”™\nfunction f(a, ...b, c) {\n  // ...\n}\n```\n\nå‡½æ•°çš„ `lenth` å±æ€§ï¼Œä¹Ÿä¸åŒ…æ‹¬ rest å‚æ•°\n\n```js\n(function(...a) {}).length  // 0\n```\n\n## ä¸¥æ ¼æ¨¡å¼\n\nä» ES5 å¼€å§‹ï¼Œå…è®¸åœ¨å‡½æ•°å†…éƒ¨å¯ç”¨ä¸¥æ ¼æ¨¡å¼ï¼Œä½†æ˜¯åœ¨ ES6 ä¸­ï¼Œè§„å®šåªè¦å‡½æ•°å‚æ•°ä½¿ç”¨äº†é»˜è®¤å€¼ã€è§£æ„èµ‹å€¼ã€æˆ–è€…æ‰©å±•è¿ç®—ç¬¦ï¼Œé‚£ä¹ˆå‡½æ•°å†…éƒ¨å°±ä¸èƒ½æ˜¾å¼è®¾å®šä¸ºä¸¥æ ¼æ¨¡å¼ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚\n\n```js\n// æŠ¥é”™\nfunction doSomething(a, b = a) {\n  'use strict';\n  // code\n}\n```\n\nå‡½æ•°å†…éƒ¨çš„ä¸¥æ ¼æ¨¡å¼ï¼ŒåŒæ—¶é€‚ç”¨äºå‡½æ•°ä½“å’Œå‡½æ•°å‚æ•°ã€‚ä½†æ˜¯ï¼Œå‡½æ•°æ‰§è¡Œçš„æ—¶å€™ï¼Œå…ˆæ‰§è¡Œå‡½æ•°å‚æ•°ï¼Œç„¶åå†æ‰§è¡Œå‡½æ•°ä½“ã€‚è¿™æ ·å°±æœ‰ä¸€ä¸ªä¸åˆç†çš„åœ°æ–¹ï¼Œåªæœ‰ä»å‡½æ•°ä½“ä¹‹ä¸­ï¼Œæ‰èƒ½çŸ¥é“å‚æ•°æ˜¯å¦åº”è¯¥ä»¥ä¸¥æ ¼æ¨¡å¼æ‰§è¡Œï¼Œä½†æ˜¯å‚æ•°å´åº”è¯¥å…ˆäºå‡½æ•°ä½“æ‰§è¡Œã€‚\n\nè§£å†³æ–¹æ³•å°±æ˜¯å…¨å±€è®¾å®šä¸¥æ ¼æ¨¡å¼ï¼Œæˆ–è€…ç”¨ä¸€ä¸ªç«‹å³æ‰§è¡Œå‡½æ•°åŒ…è£¹æ­¤å‡½æ•°ã€‚\n\n## name å±æ€§\n\nè¿”å›å‡½æ•°çš„åå­—ï¼Œå’Œ ES5 ä¸­æœ‰äº›è®¸çš„å˜åŒ–\n\n```js\nvar f = function () {};\n\n// ES5\nf.name // \"\"\n\n// ES6\nf.name // \"f\"\n\nconst bar = function baz() {};\n\n// ES5\nbar.name // \"baz\"\n\n// ES6\nbar.name // \"baz\"\n```\n\n`Function` æ„é€ å‡½æ•°è¿”å›çš„å‡½æ•°å®ä¾‹ï¼Œ`name` å±æ€§çš„å€¼ä¸º `anonymous`ã€‚\n\n```js\n(new Function).name // \"anonymous\"\n```\n\n`bind` è¿”å›çš„å‡½æ•°ï¼Œ`name` å±æ€§å€¼ä¼šåŠ ä¸Š `bound` å‰ç¼€ã€‚\n\n```js\nfunction foo() {};\nfoo.bind({}).name // \"bound foo\"\n\n(function(){}).bind({}).name // \"bound \"\n```\n\n## ç®­å¤´å‡½æ•°\n\n### åŸºæœ¬ç”¨æ³•\n\n```js\n//ES6\nvar f = v => v;\n\n//ES5\nvar f = function(v) {\n  return v;\n};\n```\n\nå¦‚æœæœ‰å¤šä¸ªå‚æ•°ï¼Œå°±éœ€è¦ç”¨åœ†æ‹¬å·æ‹¬èµ·æ¥\n\n```js\nvar sum = (num1, num2) => num1 + num2;\n\n//ç­‰åŒäº\nvar sum = function(num1, num2) {\n  return num1 + num2;\n};\n```\n\nå¦‚æœç®­å¤´å‡½æ•°æƒ³ç›´æ¥è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œå¿…é¡»åœ¨å¤–é¢åŠ ä¸Šåœ†æ‹¬å·ï¼Œå¦åˆ™ä¼šæŠ¥é”™\n\n```js\n// æŠ¥é”™\nlet getTempItem = id => { id: id, name: \"Temp\" };\n\n// ä¸æŠ¥é”™\nlet getTempItem = id => ({ id: id, name: \"Temp\" });\n```\n\n### ä½¿ç”¨æ³¨æ„ç‚¹\n\n- å‡½æ•°ä½“å†…çš„ `this` å¯¹è±¡ï¼Œå°±æ˜¯å®šä¹‰æ—¶æ‰€åœ¨çš„å¯¹è±¡ï¼Œè€Œä¸æ˜¯ä½¿ç”¨æ—¶æ‰€åœ¨çš„å¯¹è±¡\n- ä¸å¯ä»¥å½“ä½œæ„é€ å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸å¯ä»¥ä½¿ç”¨ `new` å‘½ä»¤ï¼Œå¦åˆ™ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚\n- ä¸å¯ä»¥ä½¿ç”¨ `arguments` å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åœ¨å‡½æ•°ä½“å†…ä¸å­˜åœ¨ã€‚å¦‚æœè¦ç”¨ï¼Œå¯ä»¥ç”¨ rest å‚æ•°ä»£æ›¿ã€‚\n- ä¸å¯ä»¥ä½¿ç”¨ `yield` å‘½ä»¤ï¼Œå› æ­¤ç®­å¤´å‡½æ•°ä¸èƒ½ç”¨ä½œ Generator å‡½æ•°ã€‚\n\nå°¤å…¶æ³¨æ„ç¬¬ä¸€ç‚¹ï¼ŒåŸå› æ˜¯ç®­å¤´å‡½æ•°æ ¹æœ¬æ²¡æœ‰è‡ªå·±çš„ `this` ï¼Œå¯¼è‡´å†…éƒ¨çš„ `this` å…¶å®å°±æ˜¯å¤–å±‚ä»£ç å—çš„ `this` ã€‚åŒæ—¶ä¹Ÿæ­£æ˜¯å› ä¸ºä»–æ²¡æœ‰ `this` ï¼Œæ‰€ä»¥ä»–ä¸èƒ½å½“ä½œæ„é€ å‡½æ•°\n\n```js\n// ES6\nfunction foo() {\n  setTimeout(() => {\n    console.log('id:', this.id);\n  }, 100);\n}\n\n// ES5\nfunction foo() {\n  var _this = this;\n\n  setTimeout(function () {\n    console.log('id:', _this.id);\n  }, 100);\n}\n```\n\nè¿™è¡¨æ˜ç®­å¤´å‡½æ•°æ ¹æœ¬æ²¡æœ‰è‡ªå·±çš„ `this` ï¼Œè€Œæ˜¯å¼•ç”¨äº†å¤–éƒ¨çš„ `this`\n\né™¤äº† `this` ï¼Œä»¥ä¸‹ä¸‰ä¸ªå˜é‡åœ¨ç®­å¤´å‡½æ•°ä¹‹ä¸­ä¹Ÿæ˜¯ä¸å­˜åœ¨çš„ï¼ŒæŒ‡å‘å¤–å±‚å‡½æ•°çš„å¯¹åº”å˜é‡ï¼š`arguments` ã€`super` ã€`new.target` ã€‚\n\n```js\nfunction foo() {\n  setTimeout(() => {\n    console.log('args:', arguments);\n  }, 100);\n}\n\nfoo(2, 4, 6, 8)\n// args: [2, 4, 6, 8]\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œç®­å¤´å‡½æ•°å†…éƒ¨çš„å˜é‡ `arguments`ï¼Œå…¶å®æ˜¯å‡½æ•° `foo` çš„ `arguments` å˜é‡ã€‚\n\nå¦å¤–ï¼Œç”±äºç®­å¤´å‡½æ•°æ²¡æœ‰è‡ªå·±çš„ `this`ï¼Œæ‰€ä»¥å½“ç„¶ä¹Ÿå°±ä¸èƒ½ç”¨ `call()`ã€`apply()`ã€`bind()` è¿™äº›æ–¹æ³•å»æ”¹å˜ `this` çš„æŒ‡å‘ã€‚\n\n### åµŒå¥—çš„ç®­å¤´å‡½æ•°\n\nç®­å¤´å‡½æ•°å†…éƒ¨ï¼Œè¿˜å¯ä»¥å†ä½¿ç”¨ç®­å¤´å‡½æ•°ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ª ES5 è¯­æ³•çš„å¤šé‡åµŒå¥—å‡½æ•°ã€‚\n\n```js\nfunction insert(value) {\n  return {into: function (array) {\n    return {after: function (afterValue) {\n      array.splice(array.indexOf(afterValue) + 1, 0, value);\n      return array;\n    }};\n  }};\n}\n```\n\nä¸Šé¢è¿™ä¸ªå‡½æ•°ï¼Œå¯ä»¥ä½¿ç”¨ç®­å¤´å‡½æ•°æ”¹å†™ã€‚\n\n```js\nlet insert = (value) => ({into: (array) => ({after: (afterValue) => {\n  array.splice(array.indexOf(afterValue) + 1, 0, value);\n  return array;\n}})});\n\ninsert(2).into([1, 3]).after(1); //[1, 2, 3]\n```\n\n## åŒå†’å·è¿ç®—ç¬¦\n\næœ‰ä¸€ä¸ªææ¡ˆï¼Œã€Œå‡½æ•°ç»‘å®šè¿ç®—ç¬¦ã€ï¼Œç”¨æ¥å–ä»£ `call`ã€`bind`ã€`apply`\n\nå‡½æ•°ç»‘å®šè¿ç®—ç¬¦æ˜¯å¹¶æ’çš„ä¸¤ä¸ªå†’å· `::`ï¼ŒåŒå†’å·å·¦è¾¹æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå³è¾¹æ˜¯ä¸€ä¸ªå‡½æ•°ã€‚è¯¥è¿ç®—ç¬¦ä¼šè‡ªåŠ¨å°†å·¦è¾¹çš„å¯¹è±¡ï¼Œä½œä¸ºä¸Šä¸‹æ–‡ç¯å¢ƒï¼ˆå³ `this` å¯¹è±¡ï¼‰ï¼Œç»‘å®šåˆ°å³è¾¹çš„å‡½æ•°ä¸Šé¢ã€‚\n\n```js\nfoo::bar;\n// ç­‰åŒäº\nbar.bind(foo);\n\nfoo::bar(...arguments);\n// ç­‰åŒäº\nbar.apply(foo, arguments);\n```\n\nå¦‚æœåŒå†’å·å·¦è¾¹ä¸ºç©ºï¼Œå³è¾¹æ˜¯ä¸€ä¸ªå¯¹è±¡çš„æ–¹æ³•ï¼Œåˆ™ç­‰äºå°†è¯¥æ–¹æ³•ç»‘å®šåœ¨è¯¥å¯¹è±¡ä¸Šé¢ã€‚\n\n```js\nvar method = obj::obj.foo;\n// ç­‰åŒäº\nvar method = ::obj.foo;\n// ç­‰åŒäº\nvar method = obj.foo.bind(obj);\n```\n\n## å°¾è°ƒç”¨ä¼˜åŒ–\n\n### å°¾è°ƒç”¨\n\nå°¾è°ƒç”¨ï¼ˆTail Callï¼‰æ˜¯å‡½æ•°å¼ç¼–ç¨‹çš„ä¸€ä¸ªé‡è¦æ¦‚å¿µï¼Œæœ¬èº«éå¸¸ç®€å•ï¼Œä¸€å¥è¯å°±èƒ½è¯´æ¸…æ¥šï¼Œå°±æ˜¯æŒ‡æŸä¸ªå‡½æ•°çš„æœ€åä¸€æ­¥æ˜¯è°ƒç”¨å¦ä¸€ä¸ªå‡½æ•°ã€‚\n\n```js\nfunction f(x){\n  return g(x);\n}\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œå‡½æ•° `f` çš„æœ€åä¸€æ­¥æ˜¯è°ƒç”¨å‡½æ•° `g`ï¼Œè¿™å°±å«å°¾è°ƒç”¨ï¼Œå°¾è°ƒç”¨ä¹Ÿä¸ä¸€å®šè¦å‡ºç°åœ¨å‡½æ•°çš„å°¾éƒ¨ï¼Œåªè¦æœ€åä¸€æ­¥æ“ä½œå³å¯\n\nä»¥ä¸‹ä¸‰ç§æƒ…å†µï¼Œéƒ½ä¸å±äºå°¾è°ƒç”¨ã€‚\n\n```js\n// æƒ…å†µä¸€\nfunction f(x){\n  let y = g(x);\n  return y;\n}\n\n// æƒ…å†µäºŒ\nfunction f(x){\n  return g(x) + 1;\n}\n\n// æƒ…å†µä¸‰\nfunction f(x){\n  g(x);\n}\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œæƒ…å†µä¸€æ˜¯è°ƒç”¨å‡½æ•° `g` ä¹‹åï¼Œè¿˜æœ‰èµ‹å€¼æ“ä½œï¼Œæ‰€ä»¥ä¸å±äºå°¾è°ƒç”¨ï¼Œå³ä½¿è¯­ä¹‰å®Œå…¨ä¸€æ ·ã€‚æƒ…å†µäºŒä¹Ÿå±äºè°ƒç”¨åè¿˜æœ‰æ“ä½œï¼Œå³ä½¿å†™åœ¨ä¸€è¡Œå†…ã€‚æƒ…å†µä¸‰ç­‰åŒäºä¸‹é¢çš„ä»£ç ã€‚\n\n```js\nfunction f(x){\n  g(x);\n  return undefined;\n}\n```\n\n### å°¾è°ƒç”¨ä¼˜åŒ–\n\nå‡½æ•°è°ƒç”¨ä¼šåœ¨å†…å­˜å½¢æˆä¸€ä¸ªã€Œè°ƒç”¨è®°å½•ã€ï¼Œåˆç§° ã€Œè°ƒç”¨å¸§ã€ï¼ˆcall frameï¼‰ï¼Œä¿å­˜è°ƒç”¨ä½ç½®å’Œå†…éƒ¨å˜é‡ç­‰ä¿¡æ¯ã€‚å¦‚æœåœ¨å‡½æ•° `A` çš„å†…éƒ¨è°ƒç”¨å‡½æ•° `B`ï¼Œé‚£ä¹ˆåœ¨ `A` çš„è°ƒç”¨å¸§ä¸Šæ–¹ï¼Œè¿˜ä¼šå½¢æˆä¸€ä¸ª `B` çš„è°ƒç”¨å¸§ã€‚ç­‰åˆ° `B` è¿è¡Œç»“æŸï¼Œå°†ç»“æœè¿”å›åˆ° `A`ï¼Œ`B` çš„è°ƒç”¨å¸§æ‰ä¼šæ¶ˆå¤±ã€‚å¦‚æœå‡½æ•° `B` å†…éƒ¨è¿˜è°ƒç”¨å‡½æ•° `C`ï¼Œé‚£å°±è¿˜æœ‰ä¸€ä¸ª `C` çš„è°ƒç”¨å¸§ï¼Œä»¥æ­¤ç±»æ¨ã€‚æ‰€æœ‰çš„è°ƒç”¨å¸§ï¼Œå°±å½¢æˆä¸€ä¸ªã€Œè°ƒç”¨æ ˆã€ï¼ˆcall stackï¼‰\n\nå°¾è°ƒç”¨ç”±äºæ˜¯å‡½æ•°çš„æœ€åä¸€æ­¥æ“ä½œï¼Œæ‰€ä»¥ä¸éœ€è¦ä¿ç•™å¤–å±‚å‡½æ•°çš„è°ƒç”¨å¸§ï¼Œå› ä¸ºè°ƒç”¨ä½ç½®ã€å†…éƒ¨å˜é‡ç­‰ä¿¡æ¯éƒ½ä¸ä¼šå†ç”¨åˆ°äº†ï¼Œåªè¦ç›´æ¥ç”¨å†…å±‚å‡½æ•°çš„è°ƒç”¨å¸§ï¼Œå–ä»£å¤–å±‚å‡½æ•°çš„è°ƒç”¨å¸§å°±å¯ä»¥äº†ã€‚\n\nçœ‹ä¸Šé¢çš„è¯å¾ˆéš¾æ‡‚ï¼Œå…¶å®å°±æ˜¯åªè¦å°¾éƒ¨è°ƒç”¨çš„å‡½æ•°ä¸ç”¨åˆ°å¤–éƒ¨å‡½æ•°ä¸­çš„å†…éƒ¨å˜é‡ï¼Œå°±å¯ä»¥è°ƒç”¨å¸§ï¼Œå‡å°‘ä»£ç \n\n```js\nfunction f() {\n  let m = 1;\n  let n = 2;\n  return g(m + n);\n}\nf();\n\n// ç­‰åŒäº\nfunction f() {\n  return g(3);\n}\nf();\n\n// ç­‰åŒäº\ng(3);\n```\n\nå¦‚æœå†…éƒ¨å‡½æ•°ç”¨åˆ°å¤–éƒ¨å‡½æ•°çš„å†…éƒ¨å˜é‡ï¼Œå°±æ— æ³•è¿›è¡Œå°¾éƒ¨ä¼˜åŒ–\n\n```js\nfunction addOne(a){\n  var one = 1;\n  function inner(b){\n    return b + one;\n  }\n  return inner(a);\n}\n```\n\nä¸Šé¢çš„å‡½æ•°ä¸ä¼šè¿›è¡Œå°¾è°ƒç”¨ä¼˜åŒ–ï¼Œå› ä¸ºå†…å±‚å‡½æ•° `inner` ç”¨åˆ°äº†å¤–å±‚å‡½æ•° `addOne` çš„å†…éƒ¨å˜é‡ `one`ã€‚\n\n### å°¾é€’å½’\n\nå‡½æ•°è°ƒç”¨è‡ªèº«ç§°ä¸ºé€’å½’ï¼Œå¦‚æœå°¾è°ƒç”¨è‡ªèº«ï¼Œå°±ç§°ä¸ºé€’å½’\n\né€’å½’éå¸¸è€—è´¹å†…å­˜ï¼Œå› ä¸ºéœ€è¦åŒæ—¶ä¿å­˜æˆåƒä¸Šç™¾ä¸ªè°ƒç”¨å¸§ï¼Œå¾ˆå®¹æ˜“å‘ç”Ÿã€Œæ ˆæº¢å‡ºã€é”™è¯¯ï¼ˆstack overflowï¼‰ã€‚ä½†å¯¹äºå°¾é€’å½’æ¥è¯´ï¼Œç”±äºåªå­˜åœ¨ä¸€ä¸ªè°ƒç”¨å¸§ï¼Œæ‰€ä»¥æ°¸è¿œä¸ä¼šå‘ç”Ÿã€Œæ ˆæº¢å‡ºã€é”™è¯¯ã€‚\n\næœ‰ä¸€ä¸ªæ¯”è¾ƒè‘—åçš„ä¾‹å­ï¼Œå°±æ˜¯è®¡ç®— Fibonacci æ•°åˆ—ï¼Œä¹Ÿèƒ½å……åˆ†è¯´æ˜å°¾é€’å½’ä¼˜åŒ–çš„é‡è¦æ€§ã€‚\n\néå°¾é€’å½’\n\n```js\nfunction Fibonacci (n) {\n  if ( n <= 1 ) {return 1};\n\n  return Fibonacci(n - 1) + Fibonacci(n - 2);\n}\n\nFibonacci(10) // 89\nFibonacci(100) // å †æ ˆæº¢å‡º\nFibonacci(500) // å †æ ˆæº¢å‡º\n```\n\nå°¾é€’å½’ä¼˜åŒ–å \n\n```js\nfunction Fibonacci(n, ac1 = 1, ac2 = 2){\n  if(n <= 1){return ac2}\n\n  return Fibonacci(n-1, ac2, ac1 + ac2);\n}\n\nFibonacci2(100) // 573147844013817200000\nFibonacci2(1000) // 7.0330367711422765e+208\nFibonacci2(10000) // Infinity\n```\n\n## å‡½æ•°å‚æ•°çš„å°¾é€—å·\n\nES2017 å…è®¸å‡½æ•°çš„æœ€åä¸€ä¸ªå‚æ•°æœ‰å°¾é€—å·ï¼ˆtrailing commaï¼‰ã€‚\n\næ­¤å‰ï¼Œå‡½æ•°å®šä¹‰å’Œè°ƒç”¨æ—¶ï¼Œéƒ½ä¸å…è®¸æœ€åä¸€ä¸ªå‚æ•°åé¢å‡ºç°é€—å·ã€‚\n\n```js\nfunction clownsEverywhere(\n  param1,\n  param2\n) { /* ... */ }\n\nclownsEverywhere(\n  'foo',\n  'bar'\n);\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œå¦‚æœåœ¨ `param2` æˆ– `bar` åé¢åŠ ä¸€ä¸ªé€—å·ï¼Œå°±ä¼šæŠ¥é”™ã€‚\n\nå¦‚æœåƒä¸Šé¢è¿™æ ·ï¼Œå°†å‚æ•°å†™æˆå¤šè¡Œï¼ˆå³æ¯ä¸ªå‚æ•°å æ®ä¸€è¡Œï¼‰ï¼Œä»¥åä¿®æ”¹ä»£ç çš„æ—¶å€™ï¼Œæƒ³ä¸ºå‡½æ•° `clownsEverywhere` æ·»åŠ ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œæˆ–è€…è°ƒæ•´å‚æ•°çš„æ¬¡åºï¼Œå°±åŠ¿å¿…è¦åœ¨åŸæ¥æœ€åä¸€ä¸ªå‚æ•°åé¢æ·»åŠ ä¸€ä¸ªé€—å·ã€‚è¿™å¯¹äºç‰ˆæœ¬ç®¡ç†ç³»ç»Ÿæ¥è¯´ï¼Œå°±ä¼šæ˜¾ç¤ºæ·»åŠ é€—å·çš„é‚£ä¸€è¡Œä¹Ÿå‘ç”Ÿäº†å˜åŠ¨ã€‚è¿™çœ‹ä¸Šå»æœ‰ç‚¹å†—ä½™ï¼Œå› æ­¤æ–°çš„è¯­æ³•å…è®¸å®šä¹‰å’Œè°ƒç”¨æ—¶ï¼Œå°¾éƒ¨ç›´æ¥æœ‰ä¸€ä¸ªé€—å·ã€‚\n\n```js\nfunction clownsEverywhere(\n  param1,\n  param2,\n) { /* ... */ }\n\nclownsEverywhere(\n  'foo',\n  'bar',\n);\n```\n\nè¿™æ ·çš„è§„å®šä¹Ÿä½¿å¾—ï¼Œå‡½æ•°å‚æ•°ä¸æ•°ç»„å’Œå¯¹è±¡çš„å°¾é€—å·è§„åˆ™ï¼Œä¿æŒä¸€è‡´äº†ã€‚\n\n","tags":["ES6"],"categories":["Note"]},{"title":"LeanJsã€Œ ES6 ã€-- æ•°å€¼çš„æ‰©å±•","url":"%2F2018%2F02%2F01%2FLeanJS%E6%95%B0%E5%80%BC%E7%9A%84%E6%89%A9%E5%B1%95%2F","content":"\n![Js](LeanJSæ•°å€¼çš„æ‰©å±•/js.png)\n\n<!--more-->\n\n## äºŒè¿›åˆ¶å’Œå…«è¿›åˆ¶è¡¨ç¤ºæ³•\n\nES6 æä¾›äº†äºŒè¿›åˆ¶å’Œå…«è¿›åˆ¶çš„æ–°çš„å†™æ³•ï¼Œåˆ†åˆ«ç”¨å‰ç¼€ `0b`ï¼ˆæˆ– `0B`ï¼‰å’Œ `0o`ï¼ˆæˆ– `0O`ï¼‰\n\n```js\n0b111110111 === 503 // true\n0o767 === 503 // true\n```\n\nç”¨ `Number` æ–¹æ³•å°†å…¶è½¬åŒ–ä¸ºåè¿›åˆ¶\n\n```js\nNumber('0b111')  // 7\nNumber('0o10')  // 8\n```\n\n## Number.isFinite(), Number.isNaN()\n\n`Number.isFinite()` ç”¨æ¥æ£€æŸ¥ä¸€ä¸ªæ•°å€¼æ˜¯å¦ä¸ºæœ‰é™çš„ï¼ˆfiniteï¼‰ï¼Œå³ä¸æ˜¯ `Infinity`ã€‚\n\n`Number.isNaN()` ç”¨æ¥æ£€æŸ¥ä¸€ä¸ªå€¼æ˜¯å¦ä¸º `NaN`ã€‚\n\nè¿™ä¸¤ä¸ªæ–¹æ³•ç¢°åˆ°éæ•°å€¼ç›´æ¥è¿”å› `false` ï¼Œå…¨å±€çš„ `isFinite()` å’Œ `isNaN()` æ–¹æ³•ä¼šå…ˆç”¨ `Number` è½¬æ¢å‚æ•°ã€‚\n\n## Number.parseInt(), Number.parseFloat()\n\nES6 å°†å…¨å±€æ–¹æ³• `parseInt()` å’Œ `parseFloat()`ï¼Œç§»æ¤åˆ° `Number` å¯¹è±¡ä¸Šé¢ï¼Œè¡Œä¸ºå®Œå…¨ä¿æŒä¸å˜ã€‚\n\n## Number.isInteger()\n\n`Number.isInteger()` ç”¨æ¥åˆ¤æ–­ä¸€ä¸ªæ•°å€¼æ˜¯å¦ä¸ºæ•´æ•°ã€‚\n\n```js\nNumber.isInteger(25) // true\nNumber.isInteger(25.1) // false\n```\n\nJavaScript å†…éƒ¨æ•´æ•°å’Œæµ®ç‚¹æ•°é‡‡ç”¨åŒæ ·çš„å‚¨å­˜æ–¹æ³•ï¼Œæ‰€ä»¥ 25 å’Œ 25.0 è¢«è§†ä¸ºåŒä¸€ä¸ªå€¼\n\n```js\nNumber.isInteger(25.0)// true\n```\n\nå¦‚æœä¸æ˜¯æ•°å€¼ï¼Œç›´æ¥è¿”å› `false` \n\næ­¤å¤–ï¼Œæ•°å€¼å¤ªå¤§å¤ªå°éƒ½ä¼šé€ æˆç»“æœçš„è¯¯åˆ¤ï¼Œå› æ­¤å¦‚æœå¯¹ç²¾åº¦è¦æ±‚è¾ƒé«˜ï¼Œä¸æ¨èä½¿ç”¨æ­¤æ–¹æ³•\n\n## Number.EPSILON\n\nES6 åœ¨ `Number` å¯¹è±¡ä¸Šé¢ï¼Œæ–°å¢ä¸€ä¸ªæå°çš„å¸¸é‡ `Number.EPSILON`ã€‚æ ¹æ®è§„æ ¼ï¼Œå®ƒè¡¨ç¤º 1 ä¸å¤§äº 1 çš„æœ€å°æµ®ç‚¹æ•°ä¹‹é—´çš„å·®ã€‚\n\nå› ä¸ºåœ¨ JavaScript ä¸­ï¼Œæµ®ç‚¹æ•°çš„è®¡ç®—æ˜¯æœ‰è¯¯å·®çš„ï¼Œè€Œ `Number.EPSILON` è¡¨ç¤ºçš„æ˜¯ JavaScript çš„æœ€å°ç²¾åº¦ï¼Œå› æ­¤åªè¦è¿ç®—çš„è¯¯å·®å°äºè¿™ä¸ªå¸¸é‡ï¼Œæˆ‘ä»¬å°±è®¤ä¸ºå®ƒå°±ä¸å­˜åœ¨è¯¯å·®äº†ã€‚\n\n```js\nfunction withinErrorMargin(left,right){\n  return Math.abs(left-right) < Number.EPSILON;\n}\n```\n\n## å®‰å…¨æ•´æ•°å’Œ Number.isSafeInteger() \n\nJavaScript èƒ½å¤Ÿå‡†ç¡®è¡¨ç¤ºåœ¨ `-2^53` ~ `2^53` ä¹‹é—´çš„æ•´æ•°ï¼Œè¶…è¿‡è¿™ä¸ªèŒƒå›´ï¼Œå°±æ— æ³•æ­£ç¡®è¡¨ç¤º\n\nES6 å¼•å…¥äº† `Number.MAX_SAFE_INTEGER` å’Œ `Number.MIN_SAFE_INTEGER` è¿™ä¸¤ä¸ªå¸¸é‡ï¼Œç”¨æ¥è¡¨ç¤ºè¿™ä¸ªèŒƒå›´çš„ä¸Šä¸‹é™ã€‚\n\n```js\nNumber.MAX_SAFE_INTEGER === Math.pow(2, 53) - 1//true\n```\n\n`Number.isSafeInteger()` åˆ™æ˜¯ç”¨æ¥åˆ¤æ–­ä¸€ä¸ªæ•´æ•°æ˜¯å¦è½åœ¨è¿™ä¸ªèŒƒå›´ä¹‹å†…ã€‚\n\n## Math å¯¹è±¡çš„æ‰©å±•\n\nES6 åœ¨ `Math` å¯¹è±¡ä¸Šæ–°å¢äº† 17 ä¸ªä¸æ•°å­¦ç›¸å…³çš„æ–¹æ³•ã€‚æ‰€æœ‰è¿™äº›æ–¹æ³•éƒ½æ˜¯é™æ€æ–¹æ³•ï¼Œåªèƒ½åœ¨ `Math` å¯¹è±¡ä¸Šè°ƒç”¨ã€‚\n\n### Math.trunc()\n\nå»é™¤ä¸€ä¸ªæ•°çš„å°æ•°éƒ¨åˆ†ï¼Œè¿”å›æ•´æ•°ï¼Œå¦‚æœå‚æ•°ä¸æ˜¯æ•´æ•°ï¼Œä¼šè°ƒç”¨ `Number` æ–¹æ³•å°†å…¶è½¬æ¢ä¸ºæ•´æ•°ï¼Œå¯¹äºæ— æ³•è½¬æ¢ä¸ºæ•´æ•°çš„å€¼è¿”å› `NaN`\n\n```js\nMath.trunc(4.1) // 4\nMath.trunc(-4.9) // -4\nMath.trunc(true) //1\nMath.trunc(null) // 0\n```\n\n### Math.sign()\n\n`Math.sign` æ–¹æ³•ç”¨æ¥åˆ¤æ–­ä¸€ä¸ªæ•°åˆ°åº•æ˜¯æ­£æ•°ã€è´Ÿæ•°ã€è¿˜æ˜¯é›¶ã€‚å¯¹äºéæ•°å€¼ï¼Œä¼šå…ˆå°†å…¶è½¬æ¢ä¸ºæ•°å€¼ã€‚\n\n- å‚æ•°ä¸ºæ­£æ•°ï¼Œè¿”å› `+1`ï¼›\n- å‚æ•°ä¸ºè´Ÿæ•°ï¼Œè¿”å› `-1`ï¼›\n- å‚æ•°ä¸º 0ï¼Œè¿”å› `0`ï¼›\n- å‚æ•°ä¸º-0ï¼Œè¿”å› `-0`;\n- å…¶ä»–å€¼ï¼Œè¿”å› `NaN` ã€‚\n\n### Math.cbrt() \n\n`Math.cbrt` æ–¹æ³•ç”¨äºè®¡ç®—ä¸€ä¸ªæ•°çš„ç«‹æ–¹æ ¹ã€‚å¯¹äºéæ•°å€¼ï¼Œä¼šå…ˆå°†å…¶è½¬æ¢ä¸ºæ•°å€¼ã€‚\n\n### Math.clz32()\n\n`Math.clz32` æ–¹æ³•è¿”å›ä¸€ä¸ªæ•°çš„ 32 ä½æ— ç¬¦å·æ•´æ•°å½¢å¼æœ‰å¤šå°‘ä¸ªå‰å¯¼ `0`ã€‚\n\n```js\nMath.clz32(0) // 32\nMath.clz32(1) // 31\nMath.clz32(1000) // 22\nMath.clz32(0b01000000000000000000000000000000) // 1\nMath.clz32(0b00100000000000000000000000000000) // 2\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œ0 çš„äºŒè¿›åˆ¶å½¢å¼å…¨ä¸º 0ï¼Œæ‰€ä»¥æœ‰ 32 ä¸ªå‰å¯¼ 0ï¼›1 çš„äºŒè¿›åˆ¶å½¢å¼æ˜¯ `0b1`ï¼Œåªå  1 ä½ï¼Œæ‰€ä»¥ 32 ä½ä¹‹ä¸­æœ‰ 31 ä¸ªå‰å¯¼ 0ï¼›1000 çš„äºŒè¿›åˆ¶å½¢å¼æ˜¯ `0b1111101000`ï¼Œä¸€å…±æœ‰ 10 ä½ï¼Œæ‰€ä»¥ 32 ä½ä¹‹ä¸­æœ‰ 22 ä¸ªå‰å¯¼ 0ã€‚\n\n### Math.imul()\n\n`Math.imul` æ–¹æ³•è¿”å›ä¸¤ä¸ªæ•°ä»¥ 32 ä½å¸¦ç¬¦å·æ•´æ•°å½¢å¼ç›¸ä¹˜çš„ç»“æœï¼Œè¿”å›çš„ä¹Ÿæ˜¯ä¸€ä¸ª 32 ä½çš„å¸¦ç¬¦å·æ•´æ•°ã€‚\n\n```js\nMath.imul(2, 4)   // 8\nMath.imul(-1, 8)  // -8\nMath.imul(-2, -2) // 4\n```\n\nå¦‚æœåªè€ƒè™‘æœ€å 32 ä½ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œ`Math.imul(a, b)` ä¸ `a * b` çš„ç»“æœæ˜¯ç›¸åŒçš„ï¼Œå³è¯¥æ–¹æ³•ç­‰åŒäº `(a * b)|0` çš„æ•ˆæœï¼ˆè¶…è¿‡ 32 ä½çš„éƒ¨åˆ†æº¢å‡ºï¼‰ã€‚ä¹‹æ‰€ä»¥éœ€è¦éƒ¨ç½²è¿™ä¸ªæ–¹æ³•ï¼Œæ˜¯å› ä¸º JavaScript æœ‰ç²¾åº¦é™åˆ¶ï¼Œè¶…è¿‡ 2 çš„ 53 æ¬¡æ–¹çš„å€¼æ— æ³•ç²¾ç¡®è¡¨ç¤ºã€‚è¿™å°±æ˜¯è¯´ï¼Œ**å¯¹äºé‚£äº›å¾ˆå¤§çš„æ•°çš„ä¹˜æ³•ï¼Œä½ä½æ•°å€¼å¾€å¾€éƒ½æ˜¯ä¸ç²¾ç¡®çš„ï¼Œ`Math.imul` æ–¹æ³•å¯ä»¥è¿”å›æ­£ç¡®çš„ä½ä½æ•°å€¼**ã€‚\n\n### Math.fround()\n\n`Math.fround` æ–¹æ³•è¿”å›ä¸€ä¸ªæ•°çš„ 32 ä½å•ç²¾åº¦æµ®ç‚¹æ•°å½¢å¼ã€‚\n\n`Math.fround` æ–¹æ³•çš„ä¸»è¦ä½œç”¨ï¼Œæ˜¯å°† 64 ä½åŒç²¾åº¦æµ®ç‚¹æ•°è½¬ä¸º 32 ä½å•ç²¾åº¦æµ®ç‚¹æ•°ã€‚å¦‚æœå°æ•°çš„ç²¾åº¦è¶…è¿‡ 24 ä¸ªäºŒè¿›åˆ¶ä½ï¼Œè¿”å›å€¼å°±ä¼šä¸åŒäºåŸå€¼ï¼Œå¦åˆ™è¿”å›å€¼ä¸å˜ï¼ˆå³ä¸ 64 ä½åŒç²¾åº¦å€¼ä¸€è‡´ï¼‰ã€‚\n\nå¯¹äº `NaN` å’Œ `Infinity`ï¼Œæ­¤æ–¹æ³•è¿”å›åŸå€¼ã€‚å¯¹äºå…¶å®ƒç±»å‹çš„éæ•°å€¼ï¼Œ`Math.fround` æ–¹æ³•ä¼šå…ˆå°†å…¶è½¬ä¸ºæ•°å€¼ï¼Œå†è¿”å›å•ç²¾åº¦æµ®ç‚¹æ•°ã€‚\n\n### Math.hypot()\n\n`Math.hypot` æ–¹æ³•è¿”å›æ‰€æœ‰å‚æ•°çš„å¹³æ–¹å’Œçš„å¹³æ–¹æ ¹ã€‚\n\n```js\nMath.hypot(3, 4);        // 5\nMath.hypot(3, 4, 5);     // 7.0710678118654755\nMath.hypot();            // 0\nMath.hypot(NaN);         // NaN\nMath.hypot(3, 4, 'foo'); // NaN\nMath.hypot(3, 4, '5');   // 7.0710678118654755\nMath.hypot(-3);          // 3\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œ3 çš„å¹³æ–¹åŠ ä¸Š 4 çš„å¹³æ–¹ï¼Œç­‰äº 5 çš„å¹³æ–¹ã€‚\n\nå¦‚æœå‚æ•°ä¸æ˜¯æ•°å€¼ï¼Œ`Math.hypot` æ–¹æ³•ä¼šå°†å…¶è½¬ä¸ºæ•°å€¼ã€‚åªè¦æœ‰ä¸€ä¸ªå‚æ•°æ— æ³•è½¬ä¸ºæ•°å€¼ï¼Œå°±ä¼šè¿”å› `NaN`ã€‚\n\n### Math.expm1()\n\n`Math.expm1(x)` è¿”å› `e^x - 1`ï¼Œå³ `Math.exp(x) - 1`ã€‚\n\n### Math.log1p()\n\n`Math.log1p(x)` æ–¹æ³•è¿”å› `1 + x` çš„è‡ªç„¶å¯¹æ•°ï¼Œå³ `Math.log(1 + x)` ã€‚å¦‚æœ `x` å°äº -1ï¼Œè¿”å› `NaN`ã€‚\n\n### Math.log10()\n\n`Math.log10(x)` è¿”å›ä»¥ 10 ä¸ºåº•çš„ `x` çš„å¯¹æ•°ã€‚å¦‚æœ `x` å°äº 0ï¼Œåˆ™è¿”å› `NaN`ã€‚\n\n### Math.log2()\n\n`Math.log2(x)` è¿”å›ä»¥ 2 ä¸ºåº•çš„ `x` çš„å¯¹æ•°ã€‚å¦‚æœ `x` å°äº 0ï¼Œåˆ™è¿”å› `NaN`ã€‚\n\n### åŒæ›²å‡½æ•°çš„æ–¹æ³•\n\n- `Math.sinh(x)` è¿”å› `x` çš„åŒæ›²æ­£å¼¦ï¼ˆhyperbolic sineï¼‰\n- `Math.cosh(x)` è¿”å› `x` çš„åŒæ›²ä½™å¼¦ï¼ˆhyperbolic cosineï¼‰\n- `Math.tanh(x)` è¿”å› `x` çš„åŒæ›²æ­£åˆ‡ï¼ˆhyperbolic tangentï¼‰\n- `Math.asinh(x)` è¿”å› `x` çš„ååŒæ›²æ­£å¼¦ï¼ˆinverse hyperbolic sineï¼‰\n- `Math.acosh(x)` è¿”å› `x` çš„ååŒæ›²ä½™å¼¦ï¼ˆinverse hyperbolic cosineï¼‰\n- `Math.atanh(x)` è¿”å› `x` çš„ååŒæ›²æ­£åˆ‡ï¼ˆinverse hyperbolic tangentï¼‰\n\n### æŒ‡æ•°è¿ç®—ç¬¦\n\nES2016 æ–°å¢äº†ä¸€ä¸ªæŒ‡æ•°è¿ç®—ç¬¦ `**`ã€‚\n\n```js\n2 ** 2 // 4\n2 ** 3 // 8\n```","tags":["ES6"],"categories":["Note"]},{"title":"LeanJsã€Œ ES6 ã€-- æ­£åˆ™çš„æ‰©å±•","url":"%2F2018%2F01%2F31%2FLeanJS%E6%AD%A3%E5%88%99%E7%9A%84%E6%89%A9%E5%B1%95%2F","content":"\n![Js](LeanJSæ­£åˆ™çš„æ‰©å±•/js.png)\n\n<!--more-->\n\n## RegExp æ„é€ å‡½æ•°\n\nES5 ä¸­çš„ `RegExp` æ„é€ å‡½æ•°åªæœ‰ä¸¤ç§æƒ…å†µ\n\n```js\n//ç¬¬ä¸€ç§\nvar regex = new RegExp('xyz', 'i');\n\n//ç¬¬äºŒç§\nvar regex = new RegExp(/xyz/i);\n\n//ç­‰ä»·äº\nvar  regex = /xyz/i\n```\n\nä½†æ˜¯ ES5 ä¸­ä¸å…è®¸ä¸‹é¢è¿™ç§æƒ…å†µ\n\n```js\nvar regex = new RegExp(/xyz/,'i')\n```\n\nES6 æ”¹å˜äº†è¿™ç§æƒ…å†µï¼Œå¦‚æœç¬¬ä¸€ä¸ªå‚æ•°ä¸ºæ­£åˆ™å¯¹è±¡æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ç¬¬äºŒä¸ªå‚æ•°ä¸ºæŒ‡å®šä¿®é¥°ç¬¦ã€‚ä½†æ˜¯è¿”å›çš„æ­£åˆ™è¡¨è¾¾å¼ä¼šå¿½ç•¥æ‰åŸæœ‰çš„æ­£åˆ™çš„ä¿®é¥°ç¬¦\n\n```js\nvar regex = new RegExp(/xyz/ig,'i')\n\nç­‰ä»·äº\nvar regex = /xyz/i\n```\n\n## u ä¿®é¥°ç¬¦\n\nES6 æ·»åŠ  `u` ä¿®é¥°ç¬¦æ¥æ­£ç¡®å¤„ç†å››ä¸ªå­—èŠ‚çš„ UTF-16 çš„ç¼–ç ï¼ŒåŠ ä¸Š `u` å­—ç¬¦å°±æ˜¯è¯†åˆ«å…¶ä¸ºä¸€ä¸ªå­—ç¬¦\n\n```js\n/^\\uD83D/u.test('\\uD83D\\uDC2A') // false\n/^\\uD83D/.test('\\uD83D\\uDC2A') // true\n```\n\nä¸€æ—¦åŠ ä¸Š `u` ä¿®é¥°ç¬¦ï¼Œå°±ä¼šä¿®æ”¹ä¸‹é¢è¿™äº›æ­£åˆ™è¡¨è¾¾å¼çš„è¡Œä¸º\n\n### ç‚¹å­—ç¬¦\n\nç‚¹ `.` å­—ç¬¦åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­ï¼Œå«ä¹‰æ˜¯é™¤äº†æ¢è¡Œç¬¦ä»¥å¤–çš„ä»»æ„å•ä¸ªå­—ç¬¦ã€‚å¯¹äºç ç‚¹å¤§äº `0xFFFF` çš„ Unicode å­—ç¬¦ï¼Œç‚¹å­—ç¬¦ä¸èƒ½è¯†åˆ«ï¼Œå¿…é¡»åŠ ä¸Š `u` ä¿®é¥°ç¬¦ã€‚\n\n```js\nvar s = 'ğ ®·';\n\n/^.$/.test(s) // false\n/^.$/u.test(s) // true\n```\nä¸Šé¢ä»£ç è¡¨ç¤ºï¼Œå¦‚æœä¸æ·»åŠ  `u` ä¿®é¥°ç¬¦ï¼Œæ­£åˆ™è¡¨è¾¾å¼å°±ä¼šè®¤ä¸ºå­—ç¬¦ä¸²ä¸ºä¸¤ä¸ªå­—ç¬¦ï¼Œä»è€ŒåŒ¹é…å¤±è´¥ã€‚\n\n### Unicode å­—ç¬¦è¡¨ç¤ºæ³•\n\nES6 æ–°å¢äº†ä½¿ç”¨å¤§æ‹¬å·è¡¨ç¤º Unicode å­—ç¬¦ï¼Œè¿™ç§è¡¨ç¤ºæ³•åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­å¿…é¡»åŠ ä¸Š `u` ä¿®é¥°ç¬¦ï¼Œæ‰èƒ½è¯†åˆ«å½“ä¸­çš„å¤§æ‹¬å·ï¼Œå¦åˆ™ä¼šè¢«è§£è¯»ä¸ºé‡è¯ã€‚\n\n```js\n/\\u{61}/.test('a') // false\n/\\u{61}/u.test('a') // true\n/\\u{20BB7}/u.test('ğ ®·') // true\n```\n\nä¸Šé¢ä»£ç è¡¨ç¤ºï¼Œå¦‚æœä¸åŠ  `u` ä¿®é¥°ç¬¦ï¼Œæ­£åˆ™è¡¨è¾¾å¼æ— æ³•è¯†åˆ« `\\u{61}` è¿™ç§è¡¨ç¤ºæ³•ï¼Œåªä¼šè®¤ä¸ºè¿™åŒ¹é… `61` ä¸ªè¿ç»­çš„ `u`ã€‚\n\n### é‡è¯\n\nä½¿ç”¨ `u` ä¿®é¥°ç¬¦åï¼Œæ‰€æœ‰é‡è¯éƒ½ä¼šæ­£ç¡®è¯†åˆ«ç ç‚¹å¤§äº `0xFFFF` çš„ Unicode å­—ç¬¦ã€‚\n\n```js\n/a{2}/.test('aa') // true\n/a{2}/u.test('aa') // true\n/ğ ®·{2}/.test('ğ ®·ğ ®·') // false\n/ğ ®·{2}/u.test('ğ ®·ğ ®·') // true\n```\n\n### é¢„å®šä¹‰æ¨¡å¼\n\n`u` ä¿®é¥°ç¬¦ä¹Ÿå½±å“åˆ°é¢„å®šä¹‰æ¨¡å¼ï¼Œèƒ½å¦æ­£ç¡®è¯†åˆ«ç ç‚¹å¤§äº `0xFFFF` çš„ Unicode å­—ç¬¦ã€‚\n\n```js\n/^\\S$/.test('ğ ®·') // false\n/^\\S$/u.test('ğ ®·') // true\n```\n\nä¸Šé¢ä»£ç çš„ `\\S` æ˜¯é¢„å®šä¹‰æ¨¡å¼ï¼ŒåŒ¹é…æ‰€æœ‰ä¸æ˜¯ç©ºæ ¼çš„å­—ç¬¦ã€‚åªæœ‰åŠ äº† `u` ä¿®é¥°ç¬¦ï¼Œå®ƒæ‰èƒ½æ­£ç¡®åŒ¹é…ç ç‚¹å¤§äº `0xFFFF` çš„ Unicode å­—ç¬¦ã€‚\n\n### i ä¿®é¥°ç¬¦\n\næœ‰äº› Unicode å­—ç¬¦çš„ç¼–ç ä¸åŒï¼Œä½†æ˜¯å­—å‹å¾ˆç›¸è¿‘ï¼Œæ¯”å¦‚ï¼Œ`\\u004B` ä¸ `\\u212A` éƒ½æ˜¯å¤§å†™çš„ `K`ã€‚\n\n```js\n/[a-z]/i.test('\\u212A') // false\n/[a-z]/iu.test('\\u212A') // true\n```\n \nä¸Šé¢ä»£ç ä¸­ï¼Œä¸åŠ  `u` ä¿®é¥°ç¬¦ï¼Œå°±æ— æ³•è¯†åˆ«éè§„èŒƒçš„ `K` å­—ç¬¦ã€‚\n\n## y ä¿®é¥°ç¬¦\n\nã€Œç²˜è¿ã€ï¼ˆstickyï¼‰ä¿®é¥°ç¬¦ã€‚\n\n`y` ä¿®é¥°ç¬¦çš„ä½œç”¨ä¸ `g` ä¿®é¥°ç¬¦ç±»ä¼¼ï¼Œä¹Ÿæ˜¯å…¨å±€åŒ¹é…ï¼Œåä¸€æ¬¡åŒ¹é…éƒ½ä»ä¸Šä¸€æ¬¡åŒ¹é…æˆåŠŸçš„ä¸‹ä¸€ä¸ªä½ç½®å¼€å§‹ã€‚ä¸åŒä¹‹å¤„åœ¨äºï¼Œ`g` ä¿®é¥°ç¬¦åªè¦å‰©ä½™ä½ç½®ä¸­å­˜åœ¨åŒ¹é…å°±å¯ï¼Œè€Œ `y` ä¿®é¥°ç¬¦ç¡®ä¿åŒ¹é…å¿…é¡»ä»å‰©ä½™çš„ç¬¬ä¸€ä¸ªä½ç½®å¼€å§‹ï¼Œè¿™ä¹Ÿå°±æ˜¯ã€Œç²˜è¿ã€çš„æ¶µä¹‰ã€‚\n\n```js\nvar s = 'aaa_aa_a';\nvar r1 = /a+/g;\nvar r2 = /a+/y;\n\nr1.exec(s) // [\"aaa\"]\nr2.exec(s) // [\"aaa\"]\n\nr1.exec(s) // [\"aa\"]\nr2.exec(s) // null\n```\n\nå› ä¸ºå‰©ä¸‹çš„å­—ç¬¦ä¸²ä¸­ `a` ä¸æ˜¯å¼€å¤´ï¼Œæ‰€ä»¥è¿”å› `null`\n\n`y` ä¿®é¥°ç¬¦åŒæ ·éµå®ˆ `lastIndex` å±æ€§ï¼Œä½†æ˜¯è¦æ±‚å¿…é¡»åœ¨ `lastIndex` æŒ‡å®šçš„ä½ç½®å‘ç°åŒ¹é…ã€‚\n\n```js\nconst REGEX = /a/y;\n\n// æŒ‡å®šä»2å·ä½ç½®å¼€å§‹åŒ¹é…\nREGEX.lastIndex = 2;\n\n// ä¸æ˜¯ç²˜è¿ï¼ŒåŒ¹é…å¤±è´¥\nREGEX.exec('xaya') // null\n\n// æŒ‡å®šä»3å·ä½ç½®å¼€å§‹åŒ¹é…\nREGEX.lastIndex = 3;\n\n// 3å·ä½ç½®æ˜¯ç²˜è¿ï¼ŒåŒ¹é…æˆåŠŸ\nconst match = REGEX.exec('xaxa');\nmatch.index // 3\nREGEX.lastIndex // 4\n```\n\nå®é™…ä¸Šï¼Œ`y` ä¿®é¥°ç¬¦å·éšå«äº†å¤´éƒ¨åŒ¹é…çš„æ ‡å¿— `^`ã€‚\n\n```js\n/b/y.exec('aba')\n// null\n```\n\nå•å•ä¸€ä¸ª `y` ä¿®é¥°ç¬¦å¯¹ `match` æ–¹æ³•ï¼Œåªèƒ½è¿”å›ç¬¬ä¸€ä¸ªåŒ¹é…ï¼Œå¿…é¡»ä¸ `g` ä¿®é¥°ç¬¦è”ç”¨ï¼Œæ‰èƒ½è¿”å›æ‰€æœ‰åŒ¹é…ã€‚\n\n```js\n'a1a2a3'.match(/a\\d/y) // [\"a1\"]\n'a1a2a3'.match(/a\\d/gy) // [\"a1\", \"a2\", \"a3\"]\n```\n\n## sticky å±æ€§\n\nä¸ `y` ä¿®é¥°ç¬¦ç›¸åŒ¹é…ï¼ŒES6 çš„æ­£åˆ™å¯¹è±¡å¤šäº† `sticky` å±æ€§ï¼Œè¡¨ç¤ºæ˜¯å¦è®¾ç½®äº† `y` ä¿®é¥°ç¬¦ã€‚\n\n```js\nvar r = /hello\\d/y;\nr.sticky // true\n```\n\n## flags å±æ€§\n\nES6 ä¸ºæ­£åˆ™è¡¨è¾¾å¼æ–°å¢äº† `flags` å±æ€§ï¼Œä¼šè¿”å›æ­£åˆ™è¡¨è¾¾å¼çš„ä¿®é¥°ç¬¦ã€‚\n\n```js\n// ES5 çš„ source å±æ€§\n// è¿”å›æ­£åˆ™è¡¨è¾¾å¼çš„æ­£æ–‡\n/abc/ig.source\n// \"abc\"\n\n// ES6 çš„ flags å±æ€§\n// è¿”å›æ­£åˆ™è¡¨è¾¾å¼çš„ä¿®é¥°ç¬¦\n/abc/ig.flags\n// 'gi'\n```\n\n## s ä¿®é¥°ç¬¦ dotAll æ¨¡å¼\n\næ­£åˆ™è¡¨è¾¾å¼ä¸­ï¼Œç‚¹ `.` æ˜¯ä¸€ä¸ªç‰¹æ®Šå­—ç¬¦ï¼Œä»£è¡¨ä»»æ„çš„å•ä¸ªå­—ç¬¦ï¼Œä½†æ˜¯æœ‰ä¸¤ä¸ªä¾‹å¤–ã€‚ä¸€ä¸ªæ˜¯å››ä¸ªå­—èŠ‚çš„ UTF-16 å­—ç¬¦ï¼Œè¿™ä¸ªå¯ä»¥ç”¨ `u` ä¿®é¥°ç¬¦è§£å†³ï¼›å¦ä¸€ä¸ªæ˜¯ ã€Œè¡Œç»ˆæ­¢ç¬¦ã€ï¼ˆline terminator characterï¼‰ã€‚\n\n```js\n/foo.bar/.test('foo\\nbar')\n// false\n\n/foo.bar/s.test('foo\\nbar')\n// true\n```\n\næ·»åŠ  `s` ä¿®é¥°ç¬¦ ï¼Œ`.` å°±å¯ä»¥ä»£è¡¨ä»»æ„ä¸€ä¸ªå•å­—å­—ç¬¦ï¼Œä¹Ÿè¢«æˆä¸º `dotAll` æ¨¡å¼ï¼Œæ„ä¸º ã€Œç‚¹ä»£è¡¨æ‰€æœ‰ã€ã€‚è¿˜æœ‰ä¸€ä¸ª `dotAll` å±æ€§ï¼Œæ¥åˆ¤åˆ«æ­£åˆ™è¡¨è¾¾å¼æ˜¯å¦åœ¨ `dotAll` æ¨¡å¼ä¸­\n\n## åè¡Œæ–­è¨€\n\nJavaScript è¯­è¨€çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œåªæ”¯æŒã€Œå…ˆè¡Œæ–­è¨€ã€ï¼ˆlookaheadï¼‰å’Œ ã€Œå…ˆè¡Œå¦å®šæ–­è¨€ã€ï¼ˆnegative lookaheadï¼‰ï¼Œä¸æ”¯æŒã€Œåè¡Œæ–­è¨€ã€ï¼ˆlookbehindï¼‰å’Œ ã€Œåè¡Œå¦å®šæ–­è¨€ã€ï¼ˆnegative lookbehindï¼‰ã€‚ES2018 å¼•å…¥ ã€Œåè¡Œæ–­è¨€ã€ï¼ŒV8 å¼•æ“ 4.9 ç‰ˆï¼ˆChrome 62ï¼‰å·²ç»æ”¯æŒã€‚\n\nã€Œå…ˆè¡Œæ–­è¨€ã€ä¸º `x` åªæœ‰åœ¨ `y` å‰é¢æ‰åŒ¹é…ï¼Œå¿…é¡»å†™æˆ `/x(?=y)/`ï¼Œã€Œå…ˆè¡Œå¦å®šæ–­è¨€ã€æŒ‡çš„æ˜¯ï¼Œ`x` åªæœ‰ä¸åœ¨ `y` å‰é¢æ‰åŒ¹é…ï¼Œå¿…é¡»å†™æˆ `/x(?!y)/`\n\n```js\n/\\d+(?=%)/.exec('100% of US presidents have been male')  // [\"100\"]\n/\\d+(?!%)/.exec('thatâ€™s all 44 of them')                 // [\"44\"]\n```\n\nä¸Šé¢åˆ†åˆ«åŒ¹é…åœ¨ `%` å‰çš„æ•°å­—å’Œä¸åœ¨ `%` å‰çš„æ•°å­—ï¼Œ`(?=%)` ä¸è®¡å…¥è¿”å›éƒ¨åˆ†\n\nã€Œåè¡Œæ–­è¨€ã€å’Œã€Œå‰è¡Œæ–­è¨€ã€æ­£å¥½ç›¸åï¼Œ`x` åªæœ‰åœ¨ `y` åé¢æ‰åŒ¹é…ï¼Œå¿…é¡»å†™æˆ `/(?<=y)x/` ã€‚æ¯”å¦‚ï¼ŒåªåŒ¹é…ç¾å…ƒç¬¦å·ä¹‹åçš„æ•°å­—ï¼Œè¦å†™æˆ `/(?<=\\$)\\d+/` ã€‚ã€Œåè¡Œå¦å®šæ–­è¨€ã€åˆ™ä¸ã€Œå…ˆè¡Œå¦å®šæ–­è¨€ã€ç›¸åï¼Œ`x` åªæœ‰ä¸åœ¨ `y` åé¢æ‰åŒ¹é…ï¼Œå¿…é¡»å†™æˆ `/(?<!y)x/`ã€‚æ¯”å¦‚ï¼ŒåªåŒ¹é…ä¸åœ¨ç¾å…ƒç¬¦å·åé¢çš„æ•°å­—ï¼Œè¦å†™æˆ `/(?<!\\$)\\d+/`ã€‚\n\nåŒæ ·ä¹Ÿæ˜¯ä¸è¿”å›`()`ä¸­çš„éƒ¨åˆ†ã€‚æ‰€ä»¥**ã€Œå‰è¡Œæ–­è¨€ã€è¿”å›å‰é¢éƒ¨åˆ†ï¼Œåˆ¤æ–­åé¢éƒ¨åˆ†ï¼Œã€Œåè¡Œæ–­è¨€ã€è¿”å›åé¢éƒ¨åˆ†ï¼Œåˆ¤æ–­å‰é¢éƒ¨åˆ†**\n\n## Unicode å±æ€§ç±»\n\nES2018 å¼•å…¥äº†ä¸€ç§æ–°çš„ç±»çš„å†™æ³• `\\p{...}` å’Œ `\\P{...}`ï¼Œå…è®¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ç¬¦åˆ Unicode æŸç§å±æ€§çš„æ‰€æœ‰å­—ç¬¦ã€‚\n\n```js\nconst regexGreekSymbol = /\\p{Script=Greek}/u;\nregexGreekSymbol.test('Ï€') // true\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œ`\\p{Script=Greek}` æŒ‡å®šåŒ¹é…ä¸€ä¸ªå¸Œè…Šæ–‡å­—æ¯ï¼Œæ‰€ä»¥åŒ¹é… `Ï€` æˆåŠŸã€‚\n\nUnicode å±æ€§ç±»è¦æŒ‡å®šå±æ€§åå’Œå±æ€§å€¼ã€‚\n\n```js\n\\p{UnicodePropertyName=UnicodePropertyValue}\n```\n\nå¯¹äºæŸäº›å±æ€§ï¼Œå¯ä»¥åªå†™å±æ€§åï¼Œæˆ–è€…åªå†™å±æ€§å€¼ã€‚\n\n```js\n\\p{UnicodePropertyName}\n\\p{UnicodePropertyValue}\n```\n\n`\\P{â€¦}` æ˜¯ `\\p{â€¦}` çš„åå‘åŒ¹é…ï¼Œå³åŒ¹é…ä¸æ»¡è¶³æ¡ä»¶çš„å­—ç¬¦ã€‚\n\nå› ä¸ºåŒ¹é…çš„æ˜¯ Unicode å­—ç¬¦ï¼Œæ‰€ä»¥éœ€è¦å¸¦ä¸Š `u` å­—ç¬¦\n\n## å…·åç»„åŒ¹é…\n\n### åŸºæœ¬ç”¨æ³•\n\næ­£åˆ™è¡¨è¾¾å¼ç”¨åœ†æ‹¬å·æ¥å®ç°ç»„çš„åŒ¹é…\n\n```js\nconst RE_DATE = /(\\d{4})-(\\d{2})-(\\d{2})/;\n\nconst matchObj = RE_DATE.exec('1999-12-31');\nconst year = matchObj[1]; // 1999\nconst month = matchObj[2]; // 12\nconst day = matchObj[3]; // 31\n```\n\nä½†æ˜¯æ¯ä¸€ç»„åŒ¹é…çš„å«ä¹‰ä¸å®¹æ˜“çœ‹å‡ºæ¥ï¼Œè€Œä¸”ä¹Ÿåªèƒ½ç”¨æ•°å­—åºå·å¼•ç”¨ï¼Œè¦æ˜¯ç»„çš„é¡ºåºå˜äº†ï¼Œå°±æ— æ³•æ­£ç¡®å–åˆ°æƒ³å–çš„å€¼\n\nES2018 å¼•å…¥äº†ã€Œå…·åç»„åŒ¹é…ã€ï¼ˆNamed Capture Groupsï¼‰ï¼Œå…è®¸ä¸ºæ¯ä¸€ä¸ªç»„åŒ¹é…æŒ‡å®šä¸€ä¸ªåå­—ï¼Œæ—¢ä¾¿äºé˜…è¯»ä»£ç ï¼Œåˆä¾¿äºå¼•ç”¨ã€‚\n\n```js\nconst RE_DATE = /(?<year>\\d{4})-(?<month>\\d{2})-(?<day>\\d{2})/;\n\nconst matchObj = RE_DATE.exec('1999-12-31');\nconst year = matchObj.groups.year; // 1999\nconst month = matchObj.groups.month; // 12\nconst day = matchObj.groups.day; // 31\n```\n\nå‡å¦‚æ²¡æœ‰åŒ¹é…åˆ°æ•°æ®ï¼Œé‚£å°†è¿”å› `undefined`\n\n### è§£æ„èµ‹å€¼å’Œæ›¿æ¢\n\næœ‰äº†å…·åç»„åŒ¹é…ä»¥åï¼Œå¯ä»¥ä½¿ç”¨è§£æ„èµ‹å€¼ç›´æ¥ä»åŒ¹é…ç»“æœä¸Šä¸ºå˜é‡èµ‹å€¼ã€‚\n\n```js\nlet {groups: {one, two}} = /^(?<one>.*):(?<two>.*)$/u.exec('foo:bar');\none  // foo\ntwo  // bar\n```\n\nè¿™é‡Œå› ä¸º ` /^(?<one>.*):(?<two>.*)$/u.exec('foo:bar')` è¿”å› `groups: {one: \"foo\", two: \"bar\"}`ï¼Œå› æ­¤å…¶å®å·¦é¢çš„å†™æ³•æ˜¯å›ºå®šçš„\n\nå­—ç¬¦ä¸²æ›¿æ¢æ—¶ï¼Œä½¿ç”¨ `$<ç»„å>` å¼•ç”¨å…·åç»„ã€‚\n\n```js\nlet re = /(?<year>\\d{4})-(?<month>\\d{2})-(?<day>\\d{2})/u;\n\n'2015-01-02'.replace(re, '$<day>/$<month>/$<year>')\n// '02/01/2015'\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œ`replace` æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè€Œä¸æ˜¯æ­£åˆ™è¡¨è¾¾å¼ã€‚\n\n### å¼•ç”¨\n\nå¦‚æœè¦åœ¨æ­£åˆ™è¡¨è¾¾å¼å†…éƒ¨å¼•ç”¨æŸä¸ªã€Œå…·åç»„åŒ¹é…ã€ï¼Œå¯ä»¥ä½¿ç”¨ `\\k<ç»„å>` çš„å†™æ³•ã€‚\n\n```js\nconst RE_TWICE = /^(?<word>[a-z]+)!\\k<word>$/;\nRE_TWICE.test('abc!abc') // true\nRE_TWICE.test('abc!ab') // false\n```\n\næ•°å­—å¼•ç”¨ `\\1` ä¾ç„¶æœ‰æ•ˆã€‚\n\n```js\nconst RE_TWICE = /^(?<word>[a-z]+)!\\1$/;\nRE_TWICE.test('abc!abc') // true\nRE_TWICE.test('abc!ab') // false\n```\n\nè¿™ä¸¤ç§å¼•ç”¨è¯­æ³•è¿˜å¯ä»¥åŒæ—¶ä½¿ç”¨ã€‚\n\n```\nconst RE_TWICE = /^(?<word>[a-z]+)!\\k<word>!\\1$/;\nRE_TWICE.test('abc!abc!abc') // true\nRE_TWICE.test('abc!abc!ab') // false\n```\n\n## String.prototype.matchAll\n\nå¦‚æœä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼åœ¨å­—ç¬¦ä¸²é‡Œé¢æœ‰å¤šä¸ªåŒ¹é…ï¼Œç°åœ¨ä¸€èˆ¬ä½¿ç”¨ `g` ä¿®é¥°ç¬¦æˆ– `y` ä¿®é¥°ç¬¦ï¼Œåœ¨å¾ªç¯é‡Œé¢é€ä¸€å–å‡ºã€‚\n\n```js\nvar regex = /t(e)(st(\\d?))/g;\nvar string = 'test1test2test3';\n\nvar matches = [];\nvar match;\nwhile (match = regex.exec(string)) {\n  matches.push(match);\n}\n\nmatches\n// [\n//   [\"test1\", \"e\", \"st1\", \"1\", index: 0, input: \"test1test2test3\"],\n//   [\"test2\", \"e\", \"st2\", \"2\", index: 5, input: \"test1test2test3\"],\n//   [\"test3\", \"e\", \"st3\", \"3\", index: 10, input: \"test1test2test3\"]\n// ]\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œ`while` å¾ªç¯å–å‡ºæ¯ä¸€è½®çš„æ­£åˆ™åŒ¹é…ï¼Œä¸€å…±ä¸‰è½®ã€‚\n\nç›®å‰æœ‰ä¸€ä¸ªææ¡ˆï¼Œå¢åŠ äº† `String.prototype.matchAll` æ–¹æ³•ï¼Œå¯ä»¥ä¸€æ¬¡æ€§å–å‡ºæ‰€æœ‰åŒ¹é…ã€‚ä¸è¿‡ï¼Œå®ƒè¿”å›çš„æ˜¯ä¸€ä¸ªéå†å™¨ï¼ˆIteratorï¼‰ï¼Œè€Œä¸æ˜¯æ•°ç»„ã€‚\n\n```js\nconst string = 'test1test2test3';\n\n// g ä¿®é¥°ç¬¦åŠ ä¸åŠ éƒ½å¯ä»¥\nconst regex = /t(e)(st(\\d?))/g;\n\nfor (const match of string.matchAll(regex)) {\n  console.log(match);\n}\n// [\"test1\", \"e\", \"st1\", \"1\", index: 0, input: \"test1test2test3\"]\n// [\"test2\", \"e\", \"st2\", \"2\", index: 5, input: \"test1test2test3\"]\n// [\"test3\", \"e\", \"st3\", \"3\", index: 10, input: \"test1test2test3\"]\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œç”±äº `string.matchAll(regex)` è¿”å›çš„æ˜¯éå†å™¨ï¼Œæ‰€ä»¥å¯ä»¥ç”¨ `for...of`  å¾ªç¯å–å‡ºã€‚ç›¸å¯¹äºè¿”å›æ•°ç»„ï¼Œè¿”å›éå†å™¨çš„å¥½å¤„åœ¨äºï¼Œå¦‚æœåŒ¹é…ç»“æœæ˜¯ä¸€ä¸ªå¾ˆå¤§çš„æ•°ç»„ï¼Œé‚£ä¹ˆéå†å™¨æ¯”è¾ƒèŠ‚çœèµ„æºã€‚\n\n\n","tags":["ES6"],"categories":["Note"]},{"title":"LeanJsã€Œ ES6 ã€-- å­—ç¬¦ä¸²çš„æ‰©å±•","url":"%2F2018%2F01%2F30%2FLeanJS%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E6%89%A9%E5%B1%95%2F","content":"![Js](LeanJSå­—ç¬¦ä¸²çš„æ‰©å±•/js.png)\n\n<!--more-->\n\n## å­—ç¬¦çš„ Unicode è¡¨ç¤ºæ³•\n\nJavaScript é‡‡ç”¨ `\\uxxxx` è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ï¼Œ `xxxx` è¡¨ç¤ºå­—ç¬¦çš„ Unicode ç ç‚¹ï¼Œä½†æ˜¯è¿™ç§æ–¹æ³•åªèƒ½è¡¨ç¤º `\\u0000`~`\\uffff`ä¹‹é—´çš„å­—ç¬¦ã€‚ä¸€æ—¦è¶…å‡ºè¿™ä¸ªèŒƒå›´ï¼Œå°±å¿…é¡»ç”¨ä¸¤ä¸ªå­—èŠ‚è¡¨ç¤º\n\nä¸Šé¢ä»£ç è¡¨ç¤ºï¼Œå¦‚æœç›´æ¥åœ¨ `\\u` åé¢è·Ÿä¸Šè¶…è¿‡ `0xFFFF` çš„æ•°å€¼ï¼ˆæ¯”å¦‚ `\\u20BB7`ï¼‰ï¼ŒJavaScript ä¼šç†è§£æˆ `\\u20BB+7`ã€‚ç”±äº `\\u20BB` æ˜¯ä¸€ä¸ªä¸å¯æ‰“å°å­—ç¬¦ï¼Œæ‰€ä»¥åªä¼šæ˜¾ç¤ºä¸€ä¸ªç©ºæ ¼ï¼Œåé¢è·Ÿç€ä¸€ä¸ª `7`ã€‚\n\nES6 ä¸­å¯¹æ­¤åšå‡ºæ”¹è¿›ï¼Œåªè¦å°†å¤§ç ç‚¹æ”¾å…¥å¤§æ‹¬å·ï¼Œå°±å¯æ­£ç¡®è§£è¯»\n\n```js\n\"\\u{20BB7}\"\n// \"ğ ®·\"\n\n\"\\uD842\\uDFB7\"\n// \"ğ ®·\"\n\n\"\\uD842\\uDFB7\" === \"\\u{20BB7}\"//true\n```\n\n## codePointAt()\n\nJavaScript å†…éƒ¨ï¼Œå­—ç¬¦å·² UTF-16 çš„æ ¼å¼å­˜å‚¨ï¼Œæ¯ä¸ªå­—ç¬¦å›ºå®šä¸º `2` ä¸ªå­—èŠ‚ï¼Œä½†æ˜¯ Unicode ç ç‚¹å¤§äº `0xFFFF` ä¼šä»¥å››ä¸ªå­—èŠ‚å­˜å‚¨ï¼ŒJavaScript ä¼šè®¤ä¸ºä¸ºä¸¤ä¸ªå­—ç¬¦\n\n```js\nvar s = \"ğ ®·\";\n\ns.length // 2\ns.charAt(0) // ''\ns.charAt(1) // ''\ns.charCodeAt(0) // 55362\ns.charCodeAt(1) // 57271\n```\n\nå¯¹äºè¿™ç§éœ€è¦å››ä¸ªå­—èŠ‚å­˜å‚¨çš„å­—ç¬¦ï¼Œ`charAt` æ–¹æ³•æ— æ³•è¯»å–ï¼Œ`charCodeAt` æ–¹æ³•åªèƒ½åˆ†åˆ«è¿”å›å‰ä¸¤ä¸ªå­—èŠ‚å’Œåä¸¤ä¸ªå­—èŠ‚çš„å€¼ï¼ŒES6 æä¾›äº† `codePointAt` å¯ä»¥æ­£ç¡®å¤„ç†å››ä¸ªå­—èŠ‚å‚¨å­˜çš„å­—ç¬¦\n\n```js\nlet s = 'ğ ®·a';\n\ns.codePointAt(0) // 134071\ns.codePointAt(1) // 57271\n\ns.codePointAt(2) // 97\n```\n\nå¯¹äº `ğ ®·` ï¼ŒJavaScript è¿˜ä¼šè®¤ä¸ºå…¶é•¿åº¦ä¸º 2ï¼Œ`codePointAt(0)` æ­£ç¡®è¿”å›äº†å®ƒçš„åè¿›åˆ¶ç ï¼Œ`codePointAt(1)` è¿”å›äº† `ğ ®·` çš„åä¸¤ä¸ªå­—èŠ‚çš„åè¿›åˆ¶ç ï¼Œ`a` çš„å¤„ç†ä¸ `charCodeAt` ç›¸åŒï¼Œä½†æ˜¯ `codePointAt` çš„å‚æ•°ç¡®æ˜¯ä¸å¯¹çš„ã€‚è§£å†³è¿™ä¸ªé—®é¢˜çš„ä¸€ä¸ªåŠæ³•ä½¿ç”¨ `for..of`\n\n```js\nlet s = 'ğ ®·a';\nfor (let ch of s) {\n  console.log(ch.codePointAt(0).toString(16));\n}\n// 20bb7\n// 61\n```\n\n`codePointAt` ä¹Ÿæ˜¯æ£€æŸ¥ä¸€ä¸ªå­—ç¬¦æ˜¯å¦æ˜¯åŒå­—èŠ‚å­˜å‚¨è¿˜æ˜¯å››å­—èŠ‚å­˜å‚¨çš„ä¸€ä¸ªå¥½æ–¹æ³•\n\n```js\nfunction is32Bit(s){\n  return s.codePointAt(0) > 0xFFFF;\n}\n\nis32Bit(\"ğ ®·\") // true\n```\n\n## String.fromCodePoint()\n\nES5 `String.fromCharCode` ä¸èƒ½è¿”å› 32 ä½ UTF-16 å­—ç¬¦ï¼ˆ Unicode å¤§äº `0xFFFF` ï¼‰\n\nä½¿ç”¨ `String.fromCodePoint()` å¯ä»¥ï¼Œå¦‚æœå…¶ä¸­æœ‰å¤šä¸ªå‚æ•°ï¼Œä¼šæŠŠæ‰€æœ‰å‚æ•°åˆå¹¶æˆä¸€ä¸ªå­—ç¬¦ä¸²\n\næ³¨æ„ï¼Œ`fromCodePoint` æ–¹æ³•å®šä¹‰åœ¨ `String` å¯¹è±¡ä¸Šï¼Œè€Œ `codePointAt` æ–¹æ³•å®šä¹‰åœ¨å­—ç¬¦ä¸²çš„å®ä¾‹å¯¹è±¡ä¸Šã€‚\n\n## å­—ç¬¦ä¸²çš„éå†å™¨æ¥å£\n\nES6 ä¸ºå­—ç¬¦ä¸²æ·»åŠ äº†éå†å™¨æ¥å£ï¼Œä½¿å¾—å­—ç¬¦ä¸²å¯ä»¥è¢« `for...of` å¾ªç¯éå†ã€‚`for...of` ä¹Ÿä¼šæ­£ç¡®è¯†åˆ« 32 ä½çš„ UTF-16 å­—ç¬¦\n\n## at()\n\nç›®å‰ï¼Œæœ‰ä¸€ä¸ªææ¡ˆï¼Œæå‡ºå­—ç¬¦ä¸²å®ä¾‹çš„ `at` æ–¹æ³•ï¼Œå¯ä»¥è¯†åˆ« Unicode ç¼–å·å¤§äº `0xFFFF` çš„å­—ç¬¦ï¼Œè¿”å›æ­£ç¡®çš„å­—ç¬¦ã€‚\n\n```js\n'abc'.at(0) // \"a\"\n'ğ ®·'.at(0) // \"ğ ®·\"\n```\n\n## normalize()\n\nES6 æä¾›å­—ç¬¦ä¸²å®ä¾‹çš„ `normalize()` æ–¹æ³•ï¼Œç”¨æ¥å°†å­—ç¬¦çš„ä¸åŒè¡¨ç¤ºæ–¹æ³•ç»Ÿä¸€ä¸ºåŒæ ·çš„å½¢å¼ï¼Œè¿™ç§°ä¸º Unicode æ­£è§„åŒ–ã€‚\n\n## includes(), startsWith(), endsWith()\n\nä¼ ç»Ÿä¸Šï¼ŒJavaScript åªæœ‰ `indexOf` æ–¹æ³•ï¼Œå¯ä»¥ç”¨æ¥ç¡®å®šä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯å¦åŒ…å«åœ¨å¦ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ã€‚ES6 åˆæä¾›äº†ä¸‰ç§æ–°æ–¹æ³•ã€‚\n\n- `includes()` ï¼šè¿”å›å¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦æ‰¾åˆ°äº†å‚æ•°å­—ç¬¦ä¸²ã€‚\n- `startsWith()` ï¼šè¿”å›å¸ƒå°”å€¼ï¼Œè¡¨ç¤ºå‚æ•°å­—ç¬¦ä¸²æ˜¯å¦åœ¨åŸå­—ç¬¦ä¸²çš„å¤´éƒ¨ã€‚\n- `endsWith()` ï¼šè¿”å›å¸ƒå°”å€¼ï¼Œè¡¨ç¤ºå‚æ•°å­—ç¬¦ä¸²æ˜¯å¦åœ¨åŸå­—ç¬¦ä¸²çš„å°¾éƒ¨ã€‚\n\n```js\nlet s = 'Hello world!';\n\ns.startsWith('Hello') // true\ns.endsWith('!') // true\ns.includes('o') // true\n```\n\nè¿™ä¸‰ä¸ªæ–¹æ³•éƒ½æ”¯æŒç¬¬äºŒä¸ªå‚æ•°ï¼Œå³å¼€å§‹æœç´¢çš„ä½ç½®ã€‚`endsWith` çš„è¡Œä¸ºä¸å…¶ä»–ä¸¤ä¸ªæ–¹æ³•æœ‰æ‰€ä¸åŒã€‚å®ƒé’ˆå¯¹å‰ `n` ä¸ªå­—ç¬¦ï¼Œè€Œå…¶ä»–ä¸¤ä¸ªæ–¹æ³•é’ˆå¯¹ä»ç¬¬ `n` ä¸ªä½ç½®ç›´åˆ°å­—ç¬¦ä¸²ç»“æŸã€‚\n\n## repeat() \n\n`repeat` æ–¹æ³•è¿”å›ä¸€ä¸ªæ–°å­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºå°†åŸå­—ç¬¦ä¸²é‡å¤ `n` æ¬¡ï¼Œç¢°åˆ°å°æ•°ä¼šå–æ•´ï¼Œç¢°åˆ°å­—ç¬¦ä¸²ä¼šå°è¯•è½¬æ¢æˆæ•°å­—ï¼Œ`NaN` è§†ä¸º `0`\n\n```js\n'x'.repeat(3) // \"xxx\"\n\n'na'.repeat(0) // \"\"\n```\n\n## padStart()ï¼ŒpadEnd()\n\n`padStart()` ç”¨äºå¤´éƒ¨è¡¥å…¨ï¼Œ`padEnd()` ç”¨äºå°¾éƒ¨è¡¥å…¨\n\n```js\n'x'.padStart(5, 'ab') // 'ababx'\n'x'.padStart(4, 'ab') // 'abax'\n\n'x'.padEnd(5, 'ab') // 'xabab'\n'x'.padEnd(4, 'ab') // 'xaba'\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œ`padStart` å’Œ `padEnd` ä¸€å…±æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ç”¨æ¥æŒ‡å®šå­—ç¬¦ä¸²çš„æœ€å°é•¿åº¦ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ç”¨æ¥è¡¥å…¨çš„å­—ç¬¦ä¸²ã€‚\n\nå¦‚æœåŸå­—ç¬¦çš„é•¿åº¦å¤§äºæˆ–è€…ç­‰äºæŒ‡å®šçš„å­—ç¬¦ä¸²é•¿åº¦ï¼Œåˆ™è¿”å›åŸå­—ç¬¦ä¸²\n\n```js\n'xxx'.padStart(2, 'ab') // 'xxx'\n'xxx'.padEnd(2, 'ab') // 'xxx'\n```\n\nå¦‚æœç”¨æ¥è¡¥å…¨çš„å­—ç¬¦ä¸²ä¸åŸå­—ç¬¦ä¸²ï¼Œä¸¤è€…çš„é•¿åº¦ä¹‹å’Œè¶…è¿‡äº†æŒ‡å®šçš„æœ€å°é•¿åº¦ï¼Œåˆ™ä¼šæˆªå»è¶…å‡ºä½æ•°çš„è¡¥å…¨å­—ç¬¦ä¸²ã€‚\n\n```js\n'abc'.padStart(10, '0123456789')\n// '0123456abc'\n```\n\nå¦‚æœçœç•¥ç¬¬äºŒä¸ªå‚æ•°ï¼Œé»˜è®¤ä½¿ç”¨ç©ºæ ¼è¡¥å…¨é•¿åº¦ã€‚\n\n```js\n'x'.padStart(4) // '   x'\n'x'.padEnd(4) // 'x   '\n```\n\n`padStart` çš„å¸¸è§ç”¨é€”æ˜¯ä¸ºæ•°å€¼è¡¥å…¨æŒ‡å®šä½æ•°ã€‚ä¸‹é¢ä»£ç ç”Ÿæˆ 10 ä½çš„æ•°å€¼å­—ç¬¦ä¸²ã€‚\n\n```js\n'1'.padStart(10, '0') // \"0000000001\"\n'12'.padStart(10, '0') // \"0000000012\"\n'123456'.padStart(10, '0') // \"0000123456\"\n```\n\nå¦ä¸€ä¸ªç”¨é€”æ˜¯æç¤ºå­—ç¬¦ä¸²æ ¼å¼ã€‚\n\n```js\n'12'.padStart(10, 'YYYY-MM-DD') // \"YYYY-MM-12\"\n'09-12'.padStart(10, 'YYYY-MM-DD') // \"YYYY-09-12\"\n```\n\n## æ¨¡æ¿å­—ç¬¦ä¸²\n\næ¨¡æ¿å­—ç¬¦ä¸²ï¼ˆtemplate stringï¼‰æ˜¯å¢å¼ºç‰ˆçš„å­—ç¬¦ä¸²ï¼Œç”¨åå¼•å·ï¼ˆ`ï¼‰æ ‡è¯†ã€‚å®ƒå¯ä»¥å½“ä½œæ™®é€šå­—ç¬¦ä¸²ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥ç”¨æ¥å®šä¹‰å¤šè¡Œå­—ç¬¦ä¸²ï¼Œæˆ–è€…åœ¨å­—ç¬¦ä¸²ä¸­åµŒå…¥å˜é‡ã€‚\n\nå¦‚æœæƒ³åœ¨æ¨¡æ¿å­—ç¬¦ä¸²ç”¨åå¼•å·ï¼Œéœ€è¦ç”¨åæ–œæ è½¬ä¹‰\n\n```js\n`yo \\` `\n```\n\næ¨¡æ¿å­—ç¬¦ä¸²ä¸­çš„æ ¼å¼ç©ºæ ¼éƒ½ä¼šä¿ç•™ï¼Œå»é™¤ç©ºæ ¼å¯ä»¥ç”¨ `trim()`\n\n```js\n$('#list').html(`\n<ul>\n  <li>first</li>\n  <li>second</li>\n</ul>\n`.trim());\n```\n\næ¨¡æ¿å­—ç¬¦ä¸²ä¸­åµŒå…¥å˜é‡éœ€è¦å†™åœ¨ `${}` ä¸­ï¼Œä½†æ˜¯ä¸èƒ½æ”¾å…¥æœªå£°æ˜çš„å˜é‡\n\n```js\n// å˜é‡placeæ²¡æœ‰å£°æ˜\nlet msg = `Hello, ${place}`;\n// æŠ¥é”™\n```\n\næ¨¡æ¿å­—ç¬¦ä¸²ç”šè‡³è¿˜èƒ½åµŒå¥—ã€‚\n\n```js\nconst tmpl = addrs => `\n  <table>\n  ${addrs.map(addr => `\n    <tr><td>${addr.first}</td></tr>\n    <tr><td>${addr.last}</td></tr>\n  `).join('')}\n  </table>\n`;\n```\n\n## æ ‡ç­¾æ¨¡æ¿\n\næ¨¡æ¿å­—ç¬¦ä¸²çš„åŠŸèƒ½ï¼Œä¸ä»…ä»…æ˜¯ä¸Šé¢è¿™äº›ã€‚å®ƒå¯ä»¥ç´§è·Ÿåœ¨ä¸€ä¸ªå‡½æ•°ååé¢ï¼Œè¯¥å‡½æ•°å°†è¢«è°ƒç”¨æ¥å¤„ç†è¿™ä¸ªæ¨¡æ¿å­—ç¬¦ä¸²ã€‚è¿™è¢«ç§°ä¸ºã€Œæ ‡ç­¾æ¨¡æ¿ã€åŠŸèƒ½ï¼ˆtagged templateï¼‰ã€‚\n\n```js\nalert`123`\n// ç­‰åŒäº\nalert(123)\n```\n\nä½†æ˜¯ï¼Œå¦‚æœæ¨¡æ¿å­—ç¬¦é‡Œé¢æœ‰å˜é‡ï¼Œå°±ä¸æ˜¯ç®€å•çš„è°ƒç”¨äº†ï¼Œè€Œæ˜¯ä¼šå°†æ¨¡æ¿å­—ç¬¦ä¸²å…ˆå¤„ç†æˆå¤šä¸ªå‚æ•°ï¼Œå†è°ƒç”¨å‡½æ•°ã€‚\n\n```js\nlet a = 5;\nlet b = 10;\n\ntag`Hello ${ a + b } world ${ a * b }`;\n// ç­‰åŒäº\ntag(['Hello ', ' world ', ''], 15, 50);\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œæ¨¡æ¿å­—ç¬¦ä¸²å‰é¢æœ‰ä¸€ä¸ªæ ‡è¯†å `tag` ï¼Œå®ƒæ˜¯ä¸€ä¸ªå‡½æ•°ã€‚æ•´ä¸ªè¡¨è¾¾å¼çš„è¿”å›å€¼ï¼Œå°±æ˜¯ `tag` å‡½æ•°å¤„ç†æ¨¡æ¿å­—ç¬¦ä¸²åçš„è¿”å›å€¼ã€‚\n\nå‡½æ•° `tag` ä¾æ¬¡ä¼šæ¥æ”¶åˆ°å¤šä¸ªå‚æ•°ã€‚\n\n```js\nfunction tag(stringArr, value1, value2...){\n  // ...\n}\n```\n\n`tag` å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºä¸€ä¸ªæ•°ç»„ï¼Œè¯¥æ•°ç»„çš„æˆå‘˜æ˜¯é‚£äº›æ²¡æœ‰å˜é‡æ›¿æ¢çš„éƒ¨åˆ†ï¼Œåé¢çš„å€¼ä¸ºå˜é‡\n\nä¸‹é¢ä¸€ä¸ªæ›´å¤æ‚çš„å€¼\n\n```js\nlet total = 30;\nlet msg = passthru`The total is ${total} (${total*1.05} with tax)`;\n\nfunction passthru(literals) {\n  let result = '';\n  let i = 0;\n\n  while (i < literals.length) {\n    result += literals[i++];\n    if (i < arguments.length) {\n      result += arguments[i];\n    }\n  }\n\n  return result;\n}\n\nmsg // \"The total is 30 (31.5 with tax)\"\n```\n\n`passthru` åªæ¥å—ä¸€ä¸ªå‚æ•°ï¼Œå°±æ˜¯é‚£ä¸ªæ¥å—æœªè¢«å˜é‡æ›¿æ¢çš„æ•°ç»„ï¼Œåœ¨æœ¬ä¾‹ä¸­ä¹Ÿå°±æ˜¯ `[\"The total is \", \" (\", \" with tax)\"]`ï¼Œè€Œ `arguments` å°±ä¸ºè¯¥å‡½æ•°çš„æ‰€æœ‰å‚æ•°ã€‚\n\n## String.raw()\n\nES6 è¿˜ä¸ºåŸç”Ÿçš„ String å¯¹è±¡ï¼Œæä¾›äº†ä¸€ä¸ª `raw` æ–¹æ³•ã€‚\n\n`String.raw` æ–¹æ³•ï¼Œå¾€å¾€ç”¨æ¥å……å½“æ¨¡æ¿å­—ç¬¦ä¸²çš„å¤„ç†å‡½æ•°ï¼Œè¿”å›ä¸€ä¸ªæ–œæ éƒ½è¢«è½¬ä¹‰ï¼ˆå³æ–œæ å‰é¢å†åŠ ä¸€ä¸ªæ–œæ ï¼‰çš„å­—ç¬¦ä¸²ï¼Œå¯¹åº”äºæ›¿æ¢å˜é‡åçš„æ¨¡æ¿å­—ç¬¦ä¸²ã€‚\n\n```js\nString.raw`Hi\\n${2+3}!`;\n// è¿”å› \"Hi\\\\n5!\"\n```\n\nå¦‚æœåŸå­—ç¬¦ä¸²çš„æ–œæ å·²ç»è½¬ä¹‰ï¼Œé‚£ä¹ˆ `String.raw` ä¼šè¿›è¡Œå†æ¬¡è½¬ä¹‰ã€‚\n\n```js\nString.raw`Hi\\\\n`\n// è¿”å› \"Hi\\\\\\\\n\"\n```\n\n`String.raw` æ–¹æ³•å¯ä»¥ä½œä¸ºå¤„ç†æ¨¡æ¿å­—ç¬¦ä¸²çš„åŸºæœ¬æ–¹æ³•ï¼Œå®ƒä¼šå°†æ‰€æœ‰å˜é‡æ›¿æ¢ï¼Œè€Œä¸”å¯¹æ–œæ è¿›è¡Œè½¬ä¹‰ï¼Œæ–¹ä¾¿ä¸‹ä¸€æ­¥ä½œä¸ºå­—ç¬¦ä¸²æ¥ä½¿ç”¨ã€‚\n\n`String.raw` æ–¹æ³•ä¹Ÿå¯ä»¥ä½œä¸ºæ­£å¸¸çš„å‡½æ•°ä½¿ç”¨ã€‚è¿™æ—¶ï¼Œå®ƒçš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œåº”è¯¥æ˜¯ä¸€ä¸ªå…·æœ‰ `raw` å±æ€§çš„å¯¹è±¡ï¼Œä¸” `raw` å±æ€§çš„å€¼åº”è¯¥æ˜¯ä¸€ä¸ªæ•°ç»„ã€‚\n\n```js\nString.raw({ raw: 'test' }, 0, 1, 2);\n// 't0e1s2t'\n\n// ç­‰åŒäº\nString.raw({ raw: ['t','e','s','t'] }, 0, 1, 2);\n```\n\nä½œä¸ºå‡½æ•°ï¼Œ`String.raw` çš„ä»£ç å®ç°åŸºæœ¬å¦‚ä¸‹ã€‚\n\n```js\nString.raw = function (strings, ...values) {\n  let output = '';\n  let index;\n  for (index = 0; index < values.length; index++) {\n    output += strings.raw[index] + values[index];\n  }\n\n  output += strings.raw[index]\n  return output;\n}\n```\n\n\n\n","tags":["ES6"],"categories":["Note"]},{"title":"LeanJsã€Œ ES6 ã€-- å˜é‡çš„è§£æ„èµ‹å€¼","url":"%2F2018%2F01%2F29%2FLeanJS%E5%8F%98%E9%87%8F%E7%9A%84%E8%A7%A3%E6%9E%84%E4%B8%8E%E8%B5%8B%E5%80%BC%2F","content":"![Js](LeanJSå˜é‡çš„è§£æ„ä¸èµ‹å€¼/js.png)\n\n<!--more-->\n\n## æ•°ç»„çš„è§£æ„èµ‹å€¼\n\n### åŸºæœ¬ç”¨æ³•\n\n>ES6 å…è®¸æŒ‰ç…§ä¸€å®šæ¨¡å¼ï¼Œä»æ•°ç»„å’Œå¯¹è±¡ä¸­æå–å€¼ï¼Œå¯¹å˜é‡è¿›è¡Œèµ‹å€¼ï¼Œè¿™è¢«ç§°ä¸ºè§£æ„ï¼ˆDestructuringï¼‰\n\næœ¬è´¨ä¸Šæ¥è¯´å°±æ˜¯ä¸€ç§ã€Œæ¨¡å¼åŒ¹é…ã€ï¼Œå¦‚æœå³è¾¹ä¸æ˜¯å¯éå†çš„ç»“æ„ï¼Œå³æœ¬èº«ä¸å…·æœ‰ Iterator æ¥å£ï¼Œæˆ–è€…è½¬æ¢ä¸ºå¯¹è±¡ä¹Ÿä¸å…·å¤‡ Iterator æ¥å£ï¼Œæ‰ä¼šæŠ¥é”™\n\n```js\n//ES6\nlet [a, b, c] = [1, 2, 3];\n\n//ES5\nvar a = 1,\n    b = 2,\n    c = 3;\n```\n\nå¦‚æœç­‰å·å·¦è¾¹çš„å€¼å¤šäºç­‰å·å³è¾¹çš„å€¼ï¼Œå°±ä¼šåŒ¹é…ä¸æˆåŠŸ\n\n```js\nlet [a, b] = [4];\n\na //4\nb //undefiend\n```\n\nåŒ¹é…ä¸æˆåŠŸï¼Œå˜é‡çš„å€¼å°±ä¸º `undefined`ï¼Œå°†ä¸Šè¿°ä»£ç è½¬æ¢æˆ ES5 åå¯ä»¥çœ‹æ¸…åŸç†\n\n```js\n\"use strict\";\n\nvar _ref = [4],\n    a = _ref[0],\n    b = _ref[1];\n```\n\nå¦‚æœç­‰å·å·¦è¾¹çš„å€¼å°‘äºç­‰å·å³è¾¹çš„å€¼ï¼Œä¸ºä¸å®Œå…¨è§£æ„\n\n```js\nlet [x, y] = [1, 2, 3];\nx // 1\ny // 2\n```\n\n### é»˜è®¤å€¼\n\nç»“æ„èµ‹å€¼å…è®¸æŒ‡å®šé»˜è®¤å€¼\n\n```js\nlet [a, b = 4] = [3]\nb//4\nlet [a, b = 4] = [3, 3]\nb//3\n```\n\nå·¥ä½œåŸç†å¦‚ä¸‹\n\n```js\n\"use strict\";\n\nvar _ref = [3],\n    a = _ref[0],\n    _ref$ = _ref[1],\n    b = _ref$ === undefined ? 4 : _ref$;\n```\n\nåªæœ‰å³è¾¹ç›¸å¯¹åº”çš„å€¼æ˜¯ `undefined` ï¼Œæ‰ä¼šä¸ºé»˜è®¤å€¼\n\n```js\nlet [b = 4] = [null]\nb//null\n```\n\nå› ä¸º `null` ä¸ä¸¥æ ¼ç­‰äº `undefined` æ‰€ä»¥é»˜è®¤å€¼ä¸ä¼šç”Ÿæ•ˆ\n\né»˜è®¤å€¼ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œä¹Ÿå¯ä»¥å¼•ç”¨è§£æ„èµ‹å€¼çš„å…¶å®ƒå˜é‡\n\n```js\nlet [x = 1, y = x] = [];     // x=1; y=1\nlet [x = y, y = 1] = [];     // ReferenceError: y is not defined\n```\n\n## å¯¹è±¡çš„è§£æ„èµ‹å€¼\n\n### åŸºæœ¬ç”¨æ³•\n\nå¯¹è±¡çš„è§£æ„ä¸æ•°ç»„æœ‰ä¸€ä¸ªé‡è¦çš„ä¸åŒï¼Œæ•°ç»„æ˜¯æŒ‰ç…§æ¬¡åºï¼Œå˜é‡çš„å–å€¼ç”±å®ƒçš„ä½ç½®å†³å®šï¼›è€Œå¯¹è±¡çš„å±æ€§æ²¡æœ‰æ¬¡åºï¼Œå˜é‡å¿…é¡»ä¸å±æ€§åŒåæ‰èƒ½ç›¸äº’åŒ¹é…\n\n```js\nlet {bar , foo} = {foo : 'aaa',bar : 'bbb'}\nbar // 'bbb'\nfoo // 'aaa'\n```\n\nä»¥ä¸Šä»£ç å¯ä»¥çœ‹å‡ºï¼Œå¯¹è±¡çš„è§£æ„èµ‹å€¼å®Œå…¨ä¸å—æ¬¡åºå½±å“ï¼Œè½¬æ¢ä¸º ES5 ä»£ç å¦‚ä¸‹\n\n```js\nvar _foo$bar = { foo: 'aaa', bar: 'bbb' },\n    bar = _foo$bar.bar,\n    foo = _foo$bar.foo;\n```\n\nä½†å…¶å®ä»¥ä¸Šä»£ç æ˜¯ä¸‹é¢ä»£ç çš„ç®€å†™å½¢å¼\n\n```js\nlet {bar: bar ,foo: foo} = {foo : 'aaa',bar : 'bbb'}\n```\n\nä¸ºä»€ä¹ˆè¿™ä¹ˆè¯´å˜ï¼Œè¯·çœ‹ä¸‹é¢çš„ä»£ç \n\n```js\nlet {baz: a, foo: b} = {foo : 'aaa',bar : 'bbb'}\n\nfoo //foo is not defined\nb //'aaa'\n```\n\nä¸Šé¢çš„ä»£ç è½¬æ¢æˆ ES5 çš„ä»£ç ä¸º\n\n```js\nvar _foo$bar = { foo: 'aaa', bar: 'bbb' },\n    a = _foo$bar.baz,\n    b = _foo$bar.foo;\n```\n\nä¹Ÿå°±æ˜¯è¯´å¯¹è±¡èµ‹å€¼çš„å†…éƒ¨æœºåˆ¶ï¼Œæ˜¯å…ˆæ‰¾åˆ°åŒåå±æ€§ï¼Œç„¶åå†èµ‹å€¼ç»™å¯¹åº”çš„å˜é‡ï¼ŒçœŸæ­£è¢«èµ‹å€¼çš„æ˜¯åè€…ï¼Œè€Œä¸æ˜¯å‰è€…ã€‚å› æ­¤ä¸Šé¢çš„ä»£ç ä¸­ï¼Œ`foo` åªæ˜¯æ¨¡å¼åŒ¹é…ï¼Œ`a` æ‰æ˜¯çœŸæ­£è¢«èµ‹å€¼çš„å˜é‡\n\nè§£æ„ä¹Ÿå¯ä»¥ç”¨äºåµŒå¥—ç»“æ„çš„å¯¹è±¡\n\n```js\nlet obj = {\n  p: [\n    'Hello',\n    { y: 'World' }\n  ]\n};\n\nlet { p: [x, { y }] } = obj;\nx // \"Hello\"\ny // \"World\"\n```\n\nä½†æ˜¯ `p` ä¸ºåŒ¹é…çš„æ¨¡å¼ï¼Œä¸æ˜¯å˜é‡ï¼Œå› æ­¤ä¸ä¼šèµ‹å€¼ã€‚å¦‚æœ `p` è¦èµ‹å€¼ï¼Œå¯ä»¥å†™æˆä¸‹é¢è¿™æ ·\n\n```js\nlet obj = {\n  p: [\n    'Hello',\n    { y: 'World' }\n  ]\n};\n\nlet { p, p: [x, { y }] } = obj;\nx // \"Hello\"\ny // \"World\"\np // [\"Hello\", {y: \"World\"}]\n```\n\nçœ‹ä¸‹é¢è¿™ä¸ªä¾‹å­\n\n```js\nconst node = {\n  loc: {\n    start: {\n      line: 1,\n      column: 5\n    }\n  }\n};\n\nlet { loc, loc: { start }, loc: { start: { line }} } = node;\nline // 1\nloc  // Object {start: Object}\nstart // Object {line: 1, column: 5}\n```\n\nä¸Šé¢ä»£ç æœ‰ä¸‰æ¬¡è§£æ„èµ‹å€¼ï¼Œåˆ†åˆ«æ˜¯å¯¹ `loc` ã€`start` ã€`line` ä¸‰ä¸ªå±æ€§çš„è§£æ„èµ‹å€¼ã€‚æ³¨æ„ï¼Œæœ€åä¸€æ¬¡å¯¹ `line` å±æ€§çš„è§£æ„èµ‹å€¼ä¹‹ä¸­ï¼Œåªæœ‰ `line` æ˜¯å˜é‡ï¼Œ`loc` å’Œ `start` éƒ½æ˜¯æ¨¡å¼ï¼Œä¸æ˜¯å˜é‡ã€‚\n\nå¯¹è±¡çš„è§£æ„ä¹Ÿå¯ä»¥æŒ‡å®šé»˜è®¤å€¼ï¼Œé»˜è®¤å€¼ç”Ÿæ•ˆçš„æ¡ä»¶æ˜¯ï¼Œç›¸å¯¹åº”çš„å¯¹è±¡çš„å±æ€§ä¸¥æ ¼ç­‰äºã€€`undefined`\n\nå¦‚æœè§£æ„æ¨¡å¼æ˜¯åµŒå¥—çš„å¯¹è±¡ï¼Œè€Œä¸”å­å¯¹è±¡æ‰€åœ¨çš„çˆ¶å±æ€§ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆå°†ä¼šæŠ¥é”™ã€‚\n\n```js\nlet {foo: {bar}} = {baz: 'baz'};\n```\n\nåŸå› å°±æ˜¯ç­‰å·å·¦è¾¹çš„ `foo` å±æ€§å¯¹åº”äº†ä¸€ä¸ªå¯¹è±¡ï¼Œå¦‚æœæƒ³ç»™ `bar` èµ‹å€¼éœ€è¦ç»è¿‡è¿™æ ·çš„æ­¥éª¤\n\n```js\nlet _tmp = {baz: 'baz'};\n_tmp.foo.bar // æŠ¥é”™\n```\n\nå› ä¸º `_tmp.foo` ä¸º `undefined`ï¼Œå½“ç„¶å°±ä¼šæŠ¥é”™\n\nå¦‚æœè¦å°†ä¸€ä¸ªå·²ç»å£°æ˜çš„å˜é‡ç”¨äºè§£æ„èµ‹å€¼ï¼Œå¿…é¡»éå¸¸å°å¿ƒã€‚\n\n```js\n// é”™è¯¯çš„å†™æ³•\nlet x;\n{x} = {x: 1};\n// SyntaxError: syntax error\n```\n\nä¸Šé¢ä»£ç çš„å†™æ³•ä¼šæŠ¥é”™ï¼Œå› ä¸º JavaScript å¼•æ“ä¼šå°† `{x}` ç†è§£æˆä¸€ä¸ªä»£ç å—ï¼Œä»è€Œå‘ç”Ÿè¯­æ³•é”™è¯¯ã€‚åªæœ‰ä¸å°†å¤§æ‹¬å·å†™åœ¨è¡Œé¦–ï¼Œé¿å… JavaScript å°†å…¶è§£é‡Šä¸ºä»£ç å—ï¼Œæ‰èƒ½è§£å†³è¿™ä¸ªé—®é¢˜ã€‚\n\n```js\n// æ­£ç¡®çš„å†™æ³•\nlet x;\n({x} = {x: 1});\n```\n\n## å­—ç¬¦ä¸²çš„è§£æ„èµ‹å€¼\n\nå­—ç¬¦ä¸²ä¹Ÿå¯ä»¥è§£æ„èµ‹å€¼ã€‚è¿™æ˜¯å› ä¸ºæ­¤æ—¶ï¼Œå­—ç¬¦ä¸²è¢«è½¬æ¢æˆäº†ä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ã€‚\n\n```js\nconst [a, b, c, d, e] = 'hello';\na // \"h\"\nb // \"e\"\nc // \"l\"\nd // \"l\"\ne // \"o\"\n```\n\nç±»ä¼¼æ•°ç»„çš„å¯¹è±¡éƒ½æœ‰ä¸€ä¸ª `length` å±æ€§ï¼Œå› æ­¤è¿˜å¯ä»¥å¯¹è¿™ä¸ªå±æ€§è§£æ„èµ‹å€¼ã€‚\n\n```js\nlet {length : len} = 'hello';\nlen // 5\n```\n\n## æ•°å€¼å’Œå¸ƒå°”å€¼è§£æ„èµ‹å€¼\n\nè§£æ„èµ‹å€¼æ—¶ï¼Œå¦‚æœç­‰å·å³è¾¹æ˜¯æ•°å€¼å’Œå¸ƒå°”å€¼ï¼Œåˆ™ä¼šå…ˆè½¬ä¸ºå¯¹è±¡ã€‚\n\nè§£æ„èµ‹å€¼çš„è§„åˆ™æ˜¯ï¼Œåªè¦ç­‰å·å³è¾¹çš„å€¼ä¸æ˜¯å¯¹è±¡æˆ–æ•°ç»„ï¼Œå°±å…ˆå°†å…¶è½¬ä¸ºå¯¹è±¡ã€‚ç”±äº `undefined` å’Œ `null` æ— æ³•è½¬ä¸ºå¯¹è±¡ï¼Œæ‰€ä»¥å¯¹å®ƒä»¬è¿›è¡Œè§£æ„èµ‹å€¼ï¼Œéƒ½ä¼šæŠ¥é”™ã€‚\n\n## å‡½æ•°å‚æ•°çš„è§£æ„èµ‹å€¼\n\n```js\nfunction add([x, y]){\n  return x + y;\n}\n\nadd([1, 2]); // 3\n```\n\nå‡½æ•°çš„å‚æ•°çš„è§£æ„ä¹Ÿå¯ä»¥ä½¿ç”¨é»˜è®¤å€¼\n\n```js\nfunction move({x = 0, y = 0} = {}) {\n  return [x, y];\n}\n\nmove({x: 3, y: 8}); // [3, 8]\nmove({x: 3}); // [3, 0]\nmove({}); // [0, 0]\nmove(); // [0, 0]\n```\n\næ³¨æ„ï¼Œä¸‹é¢çš„å†™æ³•ä¼šå¾—åˆ°ä¸ä¸€æ ·çš„ç»“æœã€‚\n\n```js\nfunction move({x, y} = { x: 0, y: 0 }) {\n  return [x, y];\n}\n\nmove({x: 3, y: 8}); // [3, 8]\nmove({x: 3}); // [3, undefined]\nmove({}); // [undefined, undefined]\nmove(); // [0, 0]\n```\n\nä¸Šé¢ä»£ç æ˜¯ä¸ºå‡½æ•° `move` çš„å‚æ•°æŒ‡å®šé»˜è®¤å€¼ï¼Œè€Œä¸æ˜¯ä¸ºå˜é‡ `x` å’Œ `y` æŒ‡å®šé»˜è®¤å€¼ï¼Œæ‰€ä»¥ä¼šå¾—åˆ°ä¸å‰ä¸€ç§å†™æ³•ä¸åŒçš„ç»“æœã€‚\n\n## åœ†æ‹¬å·é—®é¢˜\n\nè§£æ„èµ‹å€¼è™½ç„¶å¾ˆæ–¹ä¾¿ï¼Œä½†æ˜¯è§£æèµ·æ¥å¹¶ä¸å®¹æ˜“ã€‚å¯¹äºç¼–è¯‘å™¨æ¥è¯´ï¼Œä¸€ä¸ªå¼å­åˆ°åº•æ˜¯æ¨¡å¼ï¼Œè¿˜æ˜¯è¡¨è¾¾å¼ï¼Œæ²¡æœ‰åŠæ³•ä»ä¸€å¼€å§‹å°±çŸ¥é“ï¼Œå¿…é¡»è§£æåˆ°ï¼ˆæˆ–è§£æä¸åˆ°ï¼‰ç­‰å·æ‰èƒ½çŸ¥é“ã€‚\n\nç”±æ­¤å¸¦æ¥çš„é—®é¢˜æ˜¯ï¼Œå¦‚æœæ¨¡å¼ä¸­å‡ºç°åœ†æ‹¬å·æ€ä¹ˆå¤„ç†ã€‚ES6 çš„è§„åˆ™æ˜¯ï¼Œåªè¦æœ‰å¯èƒ½å¯¼è‡´è§£æ„çš„æ­§ä¹‰ï¼Œå°±ä¸å¾—ä½¿ç”¨åœ†æ‹¬å·ã€‚\n\nä½†æ˜¯ï¼Œè¿™æ¡è§„åˆ™å®é™…ä¸Šä¸é‚£ä¹ˆå®¹æ˜“è¾¨åˆ«ï¼Œå¤„ç†èµ·æ¥ç›¸å½“éº»çƒ¦ã€‚å› æ­¤ï¼Œå»ºè®®åªè¦æœ‰å¯èƒ½ï¼Œå°±ä¸è¦åœ¨æ¨¡å¼ä¸­æ”¾ç½®åœ†æ‹¬å·ã€‚\n\n### ä¸èƒ½ä½¿ç”¨åœ†æ‹¬å·\n\n#### å˜é‡å£°æ˜è¯­å¥\n\n```js\n// å…¨éƒ¨æŠ¥é”™\nlet [(a)] = [1];\n\nlet {x: (c)} = {};\nlet ({x: c}) = {};\nlet {(x: c)} = {};\nlet {(x): c} = {};\n\nlet { o: ({ p: p }) } = { o: { p: 2 } };\n```\n\n#### å‡½æ•°å‚æ•°\n\n```js\n// æŠ¥é”™\nfunction f([(z)]) { return z; }\n// æŠ¥é”™\nfunction f([z,(x)]) { return x; }\n```\n\n#### èµ‹å€¼è¯­å¥ä¸­çš„æ¨¡å¼\n\n```js\n// å…¨éƒ¨æŠ¥é”™\n({ p: a }) = { p: 42 };\n([a]) = [5];\n```\n\n### å¯ä»¥ä½¿ç”¨åœ†æ‹¬å·\n\nåªæœ‰ä¸€ç§ï¼Œé‚£å°±æ˜¯èµ‹å€¼è¯­å¥ä¸­çš„éæ¨¡å¼\n\n```js\n[(b)] = [3]; // æ­£ç¡®\n({ p: (d) } = {}); // æ­£ç¡®\n[(parseInt.prop)] = [3]; // æ­£ç¡®\n```\n\nä¸Šé¢ä¸‰è¡Œè¯­å¥éƒ½å¯ä»¥æ­£ç¡®æ‰§è¡Œï¼Œå› ä¸ºé¦–å…ˆå®ƒä»¬éƒ½æ˜¯èµ‹å€¼è¯­å¥ï¼Œè€Œä¸æ˜¯å£°æ˜è¯­å¥ï¼›å…¶æ¬¡å®ƒä»¬çš„åœ†æ‹¬å·éƒ½ä¸å±äºæ¨¡å¼çš„ä¸€éƒ¨åˆ†ã€‚ç¬¬ä¸€è¡Œè¯­å¥ä¸­ï¼Œæ¨¡å¼æ˜¯å–æ•°ç»„çš„ç¬¬ä¸€ä¸ªæˆå‘˜ï¼Œè·Ÿåœ†æ‹¬å·æ— å…³ï¼›ç¬¬äºŒè¡Œè¯­å¥ä¸­ï¼Œæ¨¡å¼æ˜¯ `p` ï¼Œè€Œä¸æ˜¯ `d` ï¼›ç¬¬ä¸‰è¡Œè¯­å¥ä¸ç¬¬ä¸€è¡Œè¯­å¥çš„æ€§è´¨ä¸€è‡´ã€‚","tags":["ES6"],"categories":["Note"]},{"title":"LeanJsã€Œ ES6 ã€-- Let å’Œ Const å‘½ä»¤","url":"%2F2018%2F01%2F28%2FLeanJSLET%E5%92%8CCONST%2F","content":"![Js](LeanJSLETå’ŒCONST/js.png)\n\n<!--more-->\n\n## Let å‘½ä»¤\n\n### åŸºæœ¬ç”¨æ³•\n\n`let` æ‰€å£°æ˜çš„å˜é‡åªåœ¨ `let` å‘½ä»¤æ‰€åœ¨çš„ä»£ç å—å†…æœ‰æ•ˆ\n\n```js\n{\n  var a = 10;\n  let b = 10;\n}\n\na // 10\nb // Uncaught ReferenceError: b is not defined\n```\n\nå¯¹äºæˆ‘ä»¬ä»¥å‰ç¢°åˆ°çš„å¾ªç¯ä¸­å¾ˆç»å…¸çš„é—®é¢˜ï¼Œå°±å¯ä»¥ç”¨ `let` æ¥è§£å†³\n\n```js\nvar a = [];\nfor(var i = 0 ; i < 5 ; i++){\n  a[i] = function(){\n    console.log(i);\n  }\n}\n\na[1]()//5\n```\n\nä¸Šé¢è¿™ç§æƒ…å†µç”¨ `var` å£°æ˜ `i`ï¼Œå®ƒåœ¨å…¨å±€ä½œç”¨å†…éƒ½æœ‰æ•ˆï¼Œæœ€åè°ƒç”¨ `a[1]()` æ—¶ï¼Œå¾ªç¯æ—©å·²ç»“æŸï¼Œè¾“å‡ºçš„æ˜¯å…¨å±€ä½œç”¨åŸŸä¸­çš„ `i`\n\n```js\nvar a = [];\nfor(let i = 0 ; i < 5 ; i++){\n  a[i] = function(){\n    console.log(i);\n  }\n}\n\na[1]()//1\n```\n\nå› ä¸º `let` å£°æ˜çš„å˜é‡ä»…åœ¨å½“å‰å—çº§ä½œç”¨åŸŸä¸­æœ‰æ•ˆï¼Œå½“å‰çš„ `i` åªåœ¨æœ¬è½®å¾ªç¯ä¸­æœ‰æ•ˆï¼Œæ‰€ä»¥æ¯æ¬¡å¾ªç¯çš„ `i` å…¶å®éƒ½ç›¸å½“äºä¸€ä¸ªæ–°çš„å˜é‡ã€‚\n\nç”¨ `babel` è½¬æ¢æˆ ES5 è¯­æ³•å…¶å®æ˜¯ä¸‹é¢è¿™ä¸ªæ ·å­\n\n```js\n\"use strict\";\n\nvar a = [];\n\nvar _loop = function _loop(i) {\n  a[i] = function () {\n    console.log(i);\n  };\n};\n\nfor (var i = 0; i < 5; i++) {\n  _loop(i);\n}\n```\n\n`for` å¾ªç¯è®¾ç½®å¾ªç¯å˜é‡çš„é‚£éƒ¨åˆ†æ˜¯ä¸€ä¸ªçˆ¶çº§ä½œç”¨åŸŸï¼Œè€Œå¾ªç¯ä½“å†…éƒ¨æ˜¯ä¸€ä¸ªå•ç‹¬çš„å­ä½œç”¨åŸŸ\n\n### ä¸å­˜åœ¨å˜é‡æå‡\n\n`let` å‘½ä»¤å®ƒæ‰€å£°æ˜çš„å˜é‡ä¸€å®šè¦åœ¨å£°æ˜åä½¿ç”¨ï¼Œå¦åˆ™æŠ¥é”™ã€‚\n\n```js\nconsole.log(varName);//undefined\nvar varName = 'h';\n\nconsole.log(letName);//letName is not defined\nlet letName = 'p';\n```\n\n### æš‚æ—¶æ€§æ­»åŒº\n\nåªè¦å—çº§ä½œç”¨åŸŸå­˜åœ¨ `let` å‘½ä»¤ï¼Œå®ƒæ‰€å£°æ˜çš„å˜é‡å°±ã€Œç»‘å®šã€è¿™ä¸ªåŒºåŸŸï¼Œä¸å†å—å¤–éƒ¨çš„å½±å“\n\nES6 æ˜ç¡®è§„å®šï¼Œå¦‚æœåŒºå—å†…éƒ¨å­˜åœ¨ `let` å’Œ `const` å‘½ä»¤ï¼Œè¿™ä¸ªåŒºå—å¯¹è¿™äº›å‘½ä»¤å£°æ˜çš„å˜é‡ï¼Œä»ä¸€å¼€å§‹å°±å½¢æˆäº†å°é—­ä½œç”¨åŸŸã€‚å‡¡æ˜¯åœ¨å£°æ˜ä¹‹å‰å°±ä½¿ç”¨è¿™äº›å˜é‡ï¼Œå°±ä¼šæŠ¥é”™ã€‚\n\nåœ¨ä»£ç å—å†…ï¼Œä»å¼€å§‹åˆ°ç”¨ `let` å£°æ˜å˜é‡ä¹‹å‰ï¼Œæ”¹å˜é‡éƒ½æ˜¯ä¸å¯ç”¨çš„ï¼Œåœ¨è¯­æ³•ä¸Šè¢«ç§°ä¸º ã€Œæš‚æ—¶æ€§æ­»åŒºã€(temporal dead zoneï¼Œç®€ç§° TDZ)\n\n```js\n{\n  //TDZå¼€å§‹\n  tmp = \"abc\"; // ReferenceError\n  console.log(tmp); // ReferenceError\n\n  let tmp;//TDZç»“æŸ\n  console.log(tmp); //undefined\n\n  tmp = 123;\n  console.log(tmp);//123\n\n}\n```\n\næœ‰äº›æ­»åŒºæ¯”è¾ƒéšè”½\n\n```js\nfunction bar(x = y,y = 2){\n  return [x,y];\n}\n\nbar();//y is not defined\n```\n\nå‚æ•° `x` é»˜è®¤ç­‰äº `y` ï¼Œè€Œæ­¤æ—¶ `y` è¿˜æ²¡æœ‰å£°æ˜\n\n```js\nlet x = x;\n```\n\nä½¿ç”¨ `let` å£°æ˜å˜é‡æ—¶ï¼Œåªè¦å˜é‡åœ¨è¿˜æ²¡æœ‰å£°æ˜å®Œæˆå‰ä½¿ç”¨ï¼Œå°±ä¼šæŠ¥é”™ã€‚ä¸Šé¢ `x` è¿˜æ²¡æœ‰å£°æ˜å®Œæˆå°±å– `x` çš„å€¼ï¼Œå°±ä¼šæŠ¥é”™\n\næ€»ä¹‹ï¼Œæš‚æ—¶æ€§æ­»åŒºçš„æœ¬è´¨å°±æ˜¯ï¼Œåªè¦ä¸€è¿›å…¥å½“å‰ä½œç”¨åŸŸï¼Œæ‰€è¦ä½¿ç”¨çš„å˜é‡å°±å·²ç»å­˜åœ¨äº†ï¼Œä½†æ˜¯ä¸å¯è·å–ï¼Œåªæœ‰ç­‰åˆ°å£°æ˜å˜é‡çš„é‚£ä¸€è¡Œä»£ç å‡ºç°ï¼Œæ‰å¯ä»¥è·å–å’Œä½¿ç”¨è¯¥å˜é‡ã€‚\n\n### ä¸å…è®¸é‡å¤å£°æ˜\n\n`let` ä¸å…è®¸åœ¨**ç›¸åŒä½œç”¨åŸŸ**å†…ï¼Œé‡å¤å£°æ˜ä¸€ä¸ªå˜é‡\n\n```js\nfunction(){\n  let a = 1;\n  var a = 10;//æŠ¥é”™\n}\n\nfunction(){\n  let a = 1;\n  let a = 10;//æŠ¥é”™\n}\n\nfunction(a){\n  let a; //æŠ¥é”™\n}\n\nfunction(a){\n  {\n    let a ;//ä¸æŠ¥é”™\n  }\n}\n```\n\n## å—çº§ä½œç”¨åŸŸ\n\nES5 ä¸­åªæœ‰ã€Œå…¨å±€ä½œç”¨åŸŸã€å’Œã€Œå‡½æ•°ä½œç”¨åŸŸã€ï¼Œæ²¡æœ‰ã€Œå—çº§ä½œç”¨åŸŸã€ï¼Œè¿™å¸¦æ¥å¾ˆå¤šä¸ä¾¿\n\né¦–å…ˆå°±æ˜¯ä¼—æ‰€å‘¨çŸ¥çš„ `for` å¾ªç¯çš„é—®é¢˜\n\n```js\nfor(var i = 0;i < 10 ;i++){\n  ...\n}\n\ni //10\n```\n\nç”¨æ¥è®¡æ•°çš„ `i` æ³„æ¼ä¸ºå…¨å±€å˜é‡\n\nå†…å­˜å˜é‡è¦†ç›–å¤–å±‚å˜é‡\n\n```js\nvar tem = 'hello';\n\nfunction f(){\n  console.log(tem);\n  if(false){\n    var tem = 'world'\n  }\n}\n\nf()//undefined\n```\n\n`if` ä»£ç å—ä¸­çš„ `tem` å› ä¸ºå˜é‡æå‡å…¶å®æ˜¯ä¸‹é¢çš„ä»£ç \n\n```js\nfunction f(){\n  var tem;\n  console.log(tem);\n  if(false){\n    tem = 'world'\n  }\n}\n```\n\nES6 å—çº§ä½œç”¨åŸŸä¹Ÿä»£æ›¿äº†ç«‹å³æ‰§è¡Œå‡½æ•°ï¼ˆIIFEï¼‰\n\n```js\n// IIFE å†™æ³•\n(function () {\n  var tmp = ...;\n  ...\n}());\n\n// å—çº§ä½œç”¨åŸŸå†™æ³•\n{\n  let tmp = ...;\n  ...\n}\n```\n\n## const å‘½ä»¤\n\n`const` å£°æ˜ä¸€ä¸ªåªè¯»çš„å¸¸é‡ã€‚ä¸€æ—¦å£°æ˜ï¼Œå¸¸é‡çš„å€¼å°±ä¸èƒ½æ”¹å˜ï¼Œè¿™æ„å‘³ç€ `const` å¿…é¡»å£°æ˜æ—¶å°±èµ‹å€¼ã€‚\n\n```js\nconst foo;//Missing initializer in const declaration\n```\n\nä½†å…¶å® `const` ä¿è¯çš„ä¸æ˜¯å˜é‡çš„å€¼ä¸èƒ½æ”¹åŠ¨ï¼Œè€Œæ˜¯å˜é‡æŒ‡å‘çš„é‚£ä¸ªå†…å­˜åœ°å€ä¸å¾—å˜åŠ¨ï¼Œå¯¹äºç®€å•ç±»å‹çš„æ•°æ®ï¼Œå°±æ˜¯å€¼ä¸èƒ½æ”¹åŠ¨ï¼Œä½†æ˜¯å¯¹äºå¤æ‚ç±»å‹æ¥è¯´å°±æ˜¯åœ°å€äº†\n\n```js\nconst foo = {};\nfoo.add = 123;\nfoo.add //123\n\nfoo = {}//Assignment to constant variable\n```\n\n`const` çš„ä½œç”¨åŸŸä»¥åŠå…¶å®ƒç‰¹ç‚¹éƒ½å’Œ `let` ç›¸åŒï¼Œä¸Šé¢åªæ˜¯æ¯” `let` å¤šå‡ºæ¥çš„ç‰¹ç‚¹\n\n## é¡¶å±‚å¯¹è±¡\n\né¡¶å±‚å¯¹è±¡ï¼Œåœ¨æµè§ˆå™¨ç¯å¢ƒæŒ‡çš„æ˜¯ window å¯¹è±¡ï¼Œåœ¨ Node æŒ‡çš„æ˜¯globalå¯¹è±¡ã€‚ES5 ä¹‹ä¸­ï¼Œã€Œé¡¶å±‚å¯¹è±¡ã€çš„å±æ€§ä¸ã€Œå…¨å±€å˜é‡ã€æ˜¯ç­‰ä»·çš„ã€‚ \n\né¡¶å±‚å¯¹è±¡å’Œå…¨å±€å˜é‡æŒ‚é’©ï¼Œä¼šé€ æˆå¾ˆå¤šé—®é¢˜ï¼Œé¦–å…ˆå°±æ˜¯æ— æ³•åœ¨ç¼–è¯‘æ—¶å°±æŠ¥å‡ºæœªå£°æ˜çš„é”™è¯¯ï¼›å…¶æ¬¡ï¼Œç¨‹åºå‘˜å¾ˆå®¹æ˜“å°±åˆ›å»ºäº†å…¨å±€å˜é‡ã€‚\n\nES6 ä¸ºäº†æ”¹å˜è¿™ä¸€ç‚¹ï¼Œåˆä¸ºäº†ä¿æŒå…¼å®¹æ€§ï¼Œè§„å®š `var` å‘½ä»¤å’Œ `function` å‘½ä»¤å£°æ˜çš„å…¨å±€å˜é‡ï¼Œä¾æ—§æ˜¯é¡¶å±‚å¯¹è±¡çš„å±æ€§ï¼›å¦ä¸€æ–¹é¢è§„å®šï¼Œ`let` å‘½ä»¤ã€`const` å‘½ä»¤ã€`class` å‘½ä»¤å£°æ˜çš„å…¨å±€å˜é‡ï¼Œä¸å±äºé¡¶å±‚å¯¹è±¡çš„å±æ€§ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä» ES6 å¼€å§‹ï¼Œå…¨å±€å˜é‡å°†é€æ­¥ä¸é¡¶å±‚å¯¹è±¡çš„å±æ€§è„±é’©ã€‚\n\n```js\nvar a = 1;\nwindow.a //1\n\nlet b = 2;\nwindow.b //undefined\n```\n\n","tags":["ES6"],"categories":["Note"]},{"title":"LeanJsã€Œ ES5 ã€-- DOM æ¨¡å‹","url":"%2F2018%2F01%2F27%2FLeanJSDOM%E6%A8%A1%E5%9E%8B%2F","content":"![Js](LeanJSDOMæ¨¡å‹/js.png)\n\n<!--more-->\n\n## DOMæ¨¡å‹æ¦‚è¿°\n\næ–‡æ¡£å¯¹è±¡æ¨¡å‹(Document Object Model)\n\n### èŠ‚ç‚¹\n\nDOM çš„æœ€å°ç»„æˆå•ä½å«åšèŠ‚ç‚¹ï¼ŒèŠ‚ç‚¹çš„ç±»å‹æœ‰ 7 ç§\n\n- `Document` : æ•´ä¸ªæ–‡æ¡£æ•°çš„é¡¶å±‚èŠ‚ç‚¹\n- `DocumentType` : `doctype`æ ‡ç­¾\n- `Element` : ç½‘é¡µçš„å„ç§HTMLæ ‡ç­¾\n- `Attribute` : ç½‘é¡µå…ƒç´ çš„å±æ€§\n- `Text` : æ ‡ç­¾ä¹‹é—´æˆ–æ ‡ç­¾åŒ…å«çš„æ–‡æœ¬\n- `Comment` : æ³¨é‡Š\n- `DocumentFragment` : æ–‡æ¡£çš„ç‰‡æ®µ\n\nè¿™ä¸ƒç§èŠ‚ç‚¹éƒ½å±äºæµè§ˆå™¨åŸç”Ÿæä¾›çš„èŠ‚ç‚¹å¯¹è±¡çš„æ´¾ç”Ÿå¯¹è±¡ï¼Œå…·æœ‰ä¸€äº›å…±åŒçš„å±æ€§å’Œæ–¹æ³•ã€‚\n\n### ç‰¹å¾ç›¸å…³å±æ€§\n\næ‰€æœ‰èŠ‚ç‚¹å¯¹è±¡éƒ½æ˜¯æµè§ˆå™¨å†…ç½® `Node` å¯¹è±¡çš„å®ä¾‹ï¼Œç»§æ‰¿äº† `Node` å±æ€§å’Œæ–¹æ³•ã€‚\n\nå¯ä»¥ç”¨ `console.dir(Node)` æŸ¥çœ‹æ–¹æ³•\n\n#### Node.nodeName Node.nodeType\n\n| ç±»å‹ | nodeName |\tnodeType |\n|----|------|------|\n|ELEMENT_NODE|\tå¤§å†™çš„HTMLå…ƒç´ å|\t1|\n|ATTRIBUTE_NODE| ç­‰åŒäºAttr.name|\t2|\n|TEXT_NODE\t|#text\t|3|\n|COMMENT_NODE\t|#comment|\t8|\n|DOCUMENT_NODE|\t#document|\t9|\n|DOCUMENT_FRAGMENT_NODE|\t#document-fragment|\t11|\n|DOCUMENT_TYPE_NODE\t| ç­‰åŒäºDocumentType.name |10|\n\n#### Node.nodeValue\n\nè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºå½“å‰èŠ‚ç‚¹æœ¬èº«çš„æ–‡æœ¬å€¼ï¼Œè¯¥å±æ€§å¯è¯»å†™\n\nå› ä¸ºåªæœ‰TextèŠ‚ç‚¹ã€CommentèŠ‚ç‚¹ï¼ŒXMLæ–‡æ¡£çš„CDATAèŠ‚ç‚¹æœ‰æ–‡æœ¬å€¼ï¼Œå› æ­¤åªæœ‰è¿™ä¸‰ç±»èŠ‚ç‚¹çš„ `nodeValue` å¯ä»¥è¿”å›ç»“æœï¼Œå…¶å®ƒç±»å‹çš„èŠ‚ç‚¹ä¸€å¾‹è¿”å› `null` ï¼Œä¹Ÿæ— æ³•è®¾ç½® `nodeValue` å±æ€§\n\n#### Node.textContent\n\n`Node.textContent` å±æ€§è¿”å›å½“å‰èŠ‚ç‚¹å’Œä»–æ‰€æœ‰åä»£èŠ‚ç‚¹çš„æ–‡æœ¬å†…å®¹\n\n```html\n<div id=\"test\">this<span>is</span>some text</div>\n```\n\n```js\ndocument.getElementById('test').textContent\n//this is some text\n```\n\nè¯¥å±æ€§æ˜¯å¯è¯»å†™çš„ï¼Œä¸è¿‡åœ¨è¿™é‡Œè¦æ³¨æ„ä¸€ç‚¹ï¼Œä»–é‡Œé¢çš„å†…å®¹ä¼šä»£æ›¿æ‰è¯¥å…ƒç´ å…¶ä¸­çš„ä»»ä½•å…ƒç´ ï¼Œè€Œä¸”æ˜¯ä»¥æ–‡æœ¬çš„å½¢å¼å±•ç¤º\n\n```js\ndocument.getElementById('test').textContent = '<p>just a test</p>'\n```\n\nè¿™é‡Œçš„`<p></p>`å¹¶ä¸ä¼šè‡ªåŠ¨è¯†åˆ«æˆ `p` æ ‡ç­¾ï¼Œè€Œæ˜¯ä»¥æ–‡æœ¬çš„å½¢å¼å±•ç°åœ¨é¡µé¢ä¸Š\n\nå¦‚æœè¦è¯»å–æ•´ä¸ªæ–‡æ¡£çš„å†…å®¹\n\n```js\ndocument.documentElement.textContent\n```\n\n#### Node.baseURI\n\nè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºå½“å‰ç½‘é¡µçš„ç»å¯¹è·¯å¾„ï¼Œå¦‚æœæ— æ³•è·å–ï¼Œåˆ™è¿”å› `null`\n\nä¸åŒèŠ‚ç‚¹éƒ½å¯ä»¥è°ƒç”¨è¿™ä¸ªå±æ€§ï¼Œä¸€èˆ¬è¿”å›çš„å€¼æ˜¯ç›¸åŒçš„\n\nè¯¥å±æ€§çš„å€¼ä¸€èˆ¬ç”±å½“å‰ç½‘å€çš„URLå†³å®šï¼Œä½†æ˜¯å¯ä»¥ç”¨HTMLçš„ `<base>` æ ‡ç­¾æ”¹å˜è¯¥å±æ€§çš„å€¼\n\n```js\n<base href=\"http://www.example.com/page.html\">\n```\n\nè®¾ç½® `<base>` ä»¥åï¼Œ`baseURI` å±æ€§å°±è¿”å› `<base>` æ ‡ç­¾è®¾ç½®çš„å€¼\n\n\n#### Node.firstChild Node.lastChild\n\n`firstChild` å±æ€§è¿”å›å½“å‰èŠ‚ç‚¹çš„ç¬¬ä¸€ä¸ªå­èŠ‚ç‚¹ï¼Œå¦‚æœå½“å‰èŠ‚ç‚¹æ²¡æœ‰å­èŠ‚ç‚¹ï¼Œåˆ™è¿”å› `null`\n\n```html\n<p id=\"para-01\">\n  <span>First span</span>\n</p>\n\n<script type=\"text/javascript\">\n  console.log(\n    document.getElementById('para-01').firstChild.nodeName\n  ) // \"#text\"\n</script>\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œpå…ƒç´ ä¸spanå…ƒç´ ä¹‹é—´æœ‰ç©ºç™½å­—ç¬¦ï¼Œè¿™å¯¼è‡´firstChildè¿”å›çš„æ˜¯æ–‡æœ¬èŠ‚ç‚¹ã€‚\n\n### èŠ‚ç‚¹å¯¹è±¡çš„æ–¹æ³•\n\n#### Node.appendChild()\n\n`Node.appendChild` æ–¹æ³•æ¥å—ä¸€ä¸ªèŠ‚ç‚¹å¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œå°†å…¶ä½œä¸ºæœ€åä¸€ä¸ªå­èŠ‚ç‚¹ï¼Œæ’å…¥å½“å‰èŠ‚ç‚¹\n\n#### Node.hasChildNodes()\n\n`Node.hasChildNodes` æ–¹æ³•è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºå½“å‰èŠ‚ç‚¹æ˜¯å¦æœ‰å­èŠ‚ç‚¹ã€‚\n\n#### Node.cloneNode()\n\n`Node.cloneNode` æ–¹æ³•ç”¨äºå…‹éš†ä¸€ä¸ªèŠ‚ç‚¹ã€‚å®ƒæ¥å—ä¸€ä¸ªå¸ƒå°”å€¼ä½œä¸ºå‚æ•°ï¼Œè¡¨ç¤ºæ˜¯å¦åŒæ—¶å…‹éš†å­èŠ‚ç‚¹ï¼Œé»˜è®¤æ˜¯ `false` ï¼Œå³ä¸å…‹éš†å­èŠ‚ç‚¹ã€‚\n\næ­¤å…‹éš†æ–¹æ³•ä¸ä¼šå…‹éš†ç»‘å®šäº‹ä»¶ï¼Œå¹¶ä¸”å¦‚æœè¢«å…‹éš†çš„å¯¹è±¡æœ‰ `id` å€¼çš„è¯ï¼Œéœ€è¦ä¿®æ”¹æ‰å…¶ä¸­çš„ä¸€ä¸ª\n\n#### Node.insertBefore()\n\n`insertBefore` æ–¹æ³•ç”¨äºå°†æŸä¸ªèŠ‚ç‚¹æ’å…¥å½“å‰èŠ‚ç‚¹å†…éƒ¨çš„æŒ‡å®šä½ç½®ã€‚å®ƒæ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ‰€è¦æ’å…¥çš„èŠ‚ç‚¹ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å½“å‰èŠ‚ç‚¹å†…éƒ¨çš„ä¸€ä¸ªå­èŠ‚ç‚¹ï¼Œæ–°çš„èŠ‚ç‚¹å°†æ’åœ¨è¿™ä¸ªå­èŠ‚ç‚¹çš„å‰é¢ã€‚è¯¥æ–¹æ³•è¿”å›è¢«æ’å…¥çš„æ–°èŠ‚ç‚¹ã€‚\n\n#### Node.removeChild()\n\n`Node.removeChild` æ–¹æ³•æ¥å—ä¸€ä¸ªå­èŠ‚ç‚¹ä½œä¸ºå‚æ•°ï¼Œç”¨äºä»å½“å‰èŠ‚ç‚¹ç§»é™¤è¯¥å­èŠ‚ç‚¹ã€‚å®ƒè¿”å›è¢«ç§»é™¤çš„å­èŠ‚ç‚¹ã€‚\n\n#### Node.replaceChild()\n\n`Node.replaceChild` æ–¹æ³•ç”¨äºå°†ä¸€ä¸ªæ–°çš„èŠ‚ç‚¹ï¼Œæ›¿æ¢å½“å‰èŠ‚ç‚¹çš„æŸä¸€ä¸ªå­èŠ‚ç‚¹ã€‚å®ƒæ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç”¨æ¥æ›¿æ¢çš„æ–°èŠ‚ç‚¹ï¼Œç¬¬äºŒä¸ªå‚æ•°å°†è¦è¢«æ›¿æ¢èµ°çš„å­èŠ‚ç‚¹ã€‚å®ƒè¿”å›è¢«æ›¿æ¢èµ°çš„é‚£ä¸ªèŠ‚ç‚¹ã€‚\n\n#### Node.contains()\n\n`Node.contains` æ–¹æ³•æ¥å—ä¸€ä¸ªèŠ‚ç‚¹ä½œä¸ºå‚æ•°ï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºå‚æ•°èŠ‚ç‚¹æ˜¯å¦ä¸ºå½“å‰èŠ‚ç‚¹çš„åä»£èŠ‚ç‚¹ã€‚\n\n#### Node.compareDocumentPosition()\n\n`compareDocumentPosition` æ–¹æ³•çš„ç”¨æ³•ï¼Œä¸ `contains` æ–¹æ³•å®Œå…¨ä¸€è‡´ï¼Œè¿”å›ä¸€ä¸ª7ä¸ªæ¯”ç‰¹ä½çš„äºŒè¿›åˆ¶å€¼ï¼Œè¡¨ç¤ºå‚æ•°èŠ‚ç‚¹ä¸å½“å‰èŠ‚ç‚¹çš„å…³ç³»ã€‚\n\n#### Node.isEqualNode()\n\n`isEqualNode` æ–¹æ³•è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œç”¨äºæ£€æŸ¥ä¸¤ä¸ªèŠ‚ç‚¹æ˜¯å¦ç›¸ç­‰ã€‚æ‰€è°“ç›¸ç­‰çš„èŠ‚ç‚¹ï¼ŒæŒ‡çš„æ˜¯ä¸¤ä¸ªèŠ‚ç‚¹çš„ç±»å‹ç›¸åŒã€å±æ€§ç›¸åŒã€å­èŠ‚ç‚¹ç›¸åŒã€‚\n\n#### Node.normalize()\n\n`normailize` æ–¹æ³•ç”¨äºæ¸…ç†å½“å‰èŠ‚ç‚¹å†…éƒ¨çš„æ‰€æœ‰TextèŠ‚ç‚¹ã€‚å®ƒä¼šå»é™¤ç©ºçš„æ–‡æœ¬èŠ‚ç‚¹ï¼Œå¹¶ä¸”å°†æ¯—é‚»çš„æ–‡æœ¬èŠ‚ç‚¹åˆå¹¶æˆä¸€ä¸ªã€‚\n\n\n### èŠ‚ç‚¹çš„é›†åˆå¯¹è±¡\n\n#### NodeList å¯¹è±¡\n\n`NodeList` å®ä¾‹å¯¹è±¡æ˜¯ä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼Œå®ƒçš„æˆå‘˜æ˜¯èŠ‚ç‚¹å¯¹è±¡ã€‚èŠ‚ç‚¹æ•°çš„å˜åŒ–ä¼šæ”¹å˜å¯¹åº”çš„ `NodeList` ï¼Œå› ä¸ºæ˜¯ç±»æ•°ç»„ï¼Œå®ƒä¸èƒ½ç›´æ¥è°ƒç”¨æ•°ç»„çš„ä¸€äº›æ–¹æ³•ã€‚\n\n#### HTMLCollection å¯¹è±¡\n\n`HTMLCollection` å®ä¾‹å¯¹è±¡ä¸ `NodeList` å®ä¾‹å¯¹è±¡ç±»ä¼¼ï¼Œä¹Ÿæ˜¯èŠ‚ç‚¹çš„é›†åˆï¼Œè¿”å›ä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ã€‚ `document.links` ã€ `docuement.forms` ã€ `document.images` ç­‰å±æ€§ï¼Œè¿”å›çš„éƒ½æ˜¯ `HTMLCollection` å®ä¾‹å¯¹è±¡ã€‚\n\n`HTMLCollection` ä¸ `NodeList` çš„åŒºåˆ«æœ‰ä»¥ä¸‹å‡ ç‚¹ã€‚\n\n1. `HTMLCollection` å®ä¾‹å¯¹è±¡çš„æˆå‘˜åªèƒ½æ˜¯ `Element` èŠ‚ç‚¹ï¼Œ`NodeList` å®ä¾‹å¯¹è±¡çš„æˆå‘˜å¯ä»¥åŒ…å«å…¶ä»–èŠ‚ç‚¹ã€‚\n\n2.` HTMLCollection` å®ä¾‹å¯¹è±¡éƒ½æ˜¯åŠ¨æ€é›†åˆï¼ŒèŠ‚ç‚¹çš„å˜åŒ–ä¼šå®æ—¶åæ˜ åœ¨é›†åˆä¸­ã€‚`NodeList` å®ä¾‹å¯¹è±¡å¯ä»¥æ˜¯é™æ€é›†åˆã€‚\n\n3. `HTMLCollection` å®ä¾‹å¯¹è±¡å¯ä»¥ç”¨ `id` å±æ€§æˆ– `name` å±æ€§å¼•ç”¨èŠ‚ç‚¹å…ƒç´ ï¼Œ `NodeList` åªèƒ½ä½¿ç”¨æ•°å­—ç´¢å¼•å¼•ç”¨ã€‚\n\n### ParentNode æ¥å£ï¼ŒChildNode æ¥å£\n\nä¸åŒçš„èŠ‚ç‚¹é™¤äº†ç»§æ‰¿ `Node` æ¥å£ä»¥å¤–ï¼Œè¿˜ä¼šç»§æ‰¿å…¶ä»–æ¥å£ã€‚`ParentNode` æ¥å£ç”¨äºè·å–å½“å‰èŠ‚ç‚¹çš„ `Element` å­èŠ‚ç‚¹ï¼Œ `ChildNode` æ¥å£ç”¨äºå¤„ç†å½“å‰èŠ‚ç‚¹çš„å­èŠ‚ç‚¹ï¼ˆåŒ…å«ä½†ä¸é™äº `Element` å­èŠ‚ç‚¹ï¼‰ã€‚\n\n#### ParentNodeæ¥å£\n\n`ParentNode` æ¥å£ç”¨äºè·å– `Element` å­èŠ‚ç‚¹ã€‚`Element` èŠ‚ç‚¹ã€`Document` èŠ‚ç‚¹å’Œ `DocumentFragment` èŠ‚ç‚¹ï¼Œéƒ¨ç½²äº† `ParentNode` æ¥å£ã€‚å‡¡æ˜¯è¿™ä¸‰ç±»èŠ‚ç‚¹ï¼Œéƒ½å…·æœ‰ä»¥ä¸‹å››ä¸ªå±æ€§ï¼Œç”¨äºè·å–Elementå­èŠ‚ç‚¹ã€‚\n\nchildren\n\n`children` å±æ€§è¿”å›ä¸€ä¸ªåŠ¨æ€çš„ `HTMLCollection` é›†åˆï¼Œç”±å½“å‰èŠ‚ç‚¹çš„æ‰€æœ‰ `Element` å­èŠ‚ç‚¹ç»„æˆã€‚\n\n\nfirstElementChild\n\n`firstElementChild` å±æ€§è¿”å›å½“å‰èŠ‚ç‚¹çš„ç¬¬ä¸€ä¸ª `Element` å­èŠ‚ç‚¹ï¼Œå¦‚æœä¸å­˜åœ¨ä»»ä½•  `Element`å­èŠ‚ç‚¹ï¼Œåˆ™è¿”å› `null` ã€‚\n\nlastElementChild\n\n`lastElementChild` å±æ€§è¿”å›å½“å‰èŠ‚ç‚¹çš„æœ€åä¸€ä¸ª `Element` å­èŠ‚ç‚¹ï¼Œå¦‚æœä¸å­˜åœ¨ä»»ä½• `Element` å­èŠ‚ç‚¹ï¼Œåˆ™è¿”å› `null`ã€‚\n\nchildElementCount\n\n`childElementCount` å±æ€§è¿”å›å½“å‰èŠ‚ç‚¹çš„æ‰€æœ‰ `Element` å­èŠ‚ç‚¹çš„æ•°ç›®ã€‚\n\n#### ChildNode æ¥å£\n\n`ChildNode` æ¥å£ç”¨äºå¤„ç†å­èŠ‚ç‚¹ï¼ˆåŒ…å«ä½†ä¸é™äº `Element` å­èŠ‚ç‚¹ï¼‰ã€‚`Element` èŠ‚ç‚¹ã€`DocumentType` èŠ‚ç‚¹å’Œ `CharacterData` æ¥å£ï¼Œéƒ¨ç½²äº† `ChildNode` æ¥å£ã€‚å‡¡æ˜¯è¿™ä¸‰ç±»èŠ‚ç‚¹ï¼ˆæ¥å£ï¼‰ï¼Œéƒ½å¯ä»¥ä½¿ç”¨ä¸‹é¢å››ä¸ªæ–¹æ³•ã€‚\n\nremove()\n\n`remove` æ–¹æ³•ç”¨äºç§»é™¤å½“å‰èŠ‚ç‚¹ã€‚\n\n```js\nel.remove()\n```\n\nä¸Šé¢æ–¹æ³•åœ¨DOMä¸­ç§»é™¤äº† `el` èŠ‚ç‚¹ã€‚æ³¨æ„ï¼Œè°ƒç”¨è¿™ä¸ªæ–¹æ³•çš„èŠ‚ç‚¹ï¼Œæ˜¯è¢«ç§»é™¤çš„èŠ‚ç‚¹æœ¬èº«ï¼Œè€Œä¸æ˜¯å®ƒçš„çˆ¶èŠ‚ç‚¹ã€‚\n\nbefore()\n\n`before` æ–¹æ³•ç”¨äºåœ¨å½“å‰èŠ‚ç‚¹çš„å‰é¢ï¼Œæ’å…¥ä¸€ä¸ªåŒçº§èŠ‚ç‚¹ã€‚å¦‚æœå‚æ•°æ˜¯èŠ‚ç‚¹å¯¹è±¡ï¼Œæ’å…¥DOMçš„å°±æ˜¯è¯¥èŠ‚ç‚¹å¯¹è±¡ï¼›å¦‚æœå‚æ•°æ˜¯æ–‡æœ¬ï¼Œæ’å…¥DOMçš„å°±æ˜¯å‚æ•°å¯¹åº”çš„æ–‡æœ¬èŠ‚ç‚¹ã€‚\n\nafter()\n\n`after` æ–¹æ³•ç”¨äºåœ¨å½“å‰èŠ‚ç‚¹çš„åé¢ï¼Œæ’å…¥ä¸€ä¸ªåŒçº§èŠ‚ç‚¹ã€‚å¦‚æœå‚æ•°æ˜¯èŠ‚ç‚¹å¯¹è±¡ï¼Œæ’å…¥DOMçš„å°±æ˜¯è¯¥èŠ‚ç‚¹å¯¹è±¡ï¼›å¦‚æœå‚æ•°æ˜¯æ–‡æœ¬ï¼Œæ’å…¥DOMçš„å°±æ˜¯å‚æ•°å¯¹åº”çš„æ–‡æœ¬èŠ‚ç‚¹ã€‚\n\nreplaceWith()\n\n`replaceWith` æ–¹æ³•ä½¿ç”¨å‚æ•°æŒ‡å®šçš„èŠ‚ç‚¹ï¼Œæ›¿æ¢å½“å‰èŠ‚ç‚¹ã€‚å¦‚æœå‚æ•°æ˜¯èŠ‚ç‚¹å¯¹è±¡ï¼Œæ›¿æ¢å½“å‰èŠ‚ç‚¹çš„å°±æ˜¯è¯¥èŠ‚ç‚¹å¯¹è±¡ï¼›å¦‚æœå‚æ•°æ˜¯æ–‡æœ¬ï¼Œæ›¿æ¢å½“å‰èŠ‚ç‚¹çš„å°±æ˜¯å‚æ•°å¯¹åº”çš„æ–‡æœ¬èŠ‚ç‚¹ã€‚\n\n## Document èŠ‚ç‚¹\n\n### å†…éƒ¨å±æ€§èŠ‚ç‚¹\n\n#### document.doctype\n\n`document` å¯¹è±¡çš„ç¬¬ä¸€ä¸ªå­èŠ‚ç‚¹ï¼ŒåŒ…å«äº†æ–‡æ¡£ç±»å‹ï¼Œé€šå¸¸ `document.firstChild` è¿”å›è¿™ä¸ªèŠ‚ç‚¹\n\n#### document.documentElement\n\n`document` å¯¹è±¡çš„ç¬¬äºŒä¸ªå­èŠ‚ç‚¹ï¼Œå¯¹äºHTMLç½‘é¡µï¼Œè¿”å› `<html>` èŠ‚ç‚¹ \n\n#### document.defaultView \n\nåœ¨æµè§ˆå™¨ä¸­è¿”å› `document` å¯¹è±¡æ‰€åœ¨çš„ `window` å¯¹è±¡ï¼Œå¦åˆ™è¿”å› `null`\n\n#### document.body,document.head\n\ndocument.headå±æ€§è¿”å›å½“å‰æ–‡æ¡£çš„ `<head>` èŠ‚ç‚¹ï¼Œ`document.body` å±æ€§è¿”å›å½“å‰æ–‡æ¡£çš„ `<body>`ã€‚\n\n#### document.activeElement\n\n`document.activeElement` å±æ€§è¿”å›å½“å‰æ–‡æ¡£ä¸­è·å¾—ç„¦ç‚¹çš„é‚£ä¸ªå…ƒç´ ã€‚ç”¨æˆ·é€šå¸¸å¯ä»¥ä½¿ç”¨Tabé”®ç§»åŠ¨ç„¦ç‚¹ï¼Œä½¿ç”¨ç©ºæ ¼é”®æ¿€æ´»ç„¦ç‚¹ã€‚æ¯”å¦‚ï¼Œå¦‚æœç„¦ç‚¹åœ¨ä¸€ä¸ªé“¾æ¥ä¸Šï¼Œæ­¤æ—¶æŒ‰ä¸€ä¸‹ç©ºæ ¼é”®ï¼Œå°±ä¼šè·³è½¬åˆ°è¯¥é“¾æ¥ã€‚\n\n### èŠ‚ç‚¹é›†åˆå±æ€§\n\n#### document.linksï¼Œdocument.formsï¼Œdocument.imagesï¼Œdocument.embeds\n\n`document.links` å±æ€§è¿”å›å½“å‰æ–‡æ¡£æ‰€æœ‰è®¾å®šäº† `href` å±æ€§çš„ `a` åŠ `area` å…ƒç´ ã€‚\n\n`document.forms` å±æ€§è¿”å›é¡µé¢ä¸­æ‰€æœ‰è¡¨å•å…ƒç´  `form`ã€‚\n\n`document.images` å±æ€§è¿”å›é¡µé¢æ‰€æœ‰å›¾ç‰‡å…ƒç´ ï¼ˆå³ `img` æ ‡ç­¾ï¼‰ã€‚\n\n`document.embeds` å±æ€§è¿”å›ç½‘é¡µä¸­æ‰€æœ‰åµŒå…¥å¯¹è±¡ï¼Œå³ `embed` æ ‡ç­¾ã€‚\n\nä»¥ä¸Šå››ä¸ªå±æ€§è¿”å›çš„éƒ½æ˜¯ `HTMLCollection` å¯¹è±¡å®ä¾‹\n\n#### document.scriptsï¼Œdocument.styleSheets\n\n`document.scripts` å±æ€§è¿”å›å½“å‰æ–‡æ¡£çš„æ‰€æœ‰è„šæœ¬ï¼ˆå³ `script` æ ‡ç­¾ï¼‰ã€‚\n\n`document.scripts`è¿”å›çš„ä¹Ÿæ˜¯ `HTMLCollection` å®ä¾‹ã€‚\n\n`document.styleSheets` å±æ€§è¿”å›ä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼Œä»£è¡¨å½“å‰ç½‘é¡µçš„æ‰€æœ‰æ ·å¼è¡¨ã€‚æ¯ä¸ªæ ·å¼è¡¨å¯¹è±¡éƒ½æœ‰ `cssRules` å±æ€§ï¼Œè¿”å›è¯¥æ ·å¼è¡¨çš„æ‰€æœ‰CSSè§„åˆ™ï¼Œè¿™æ ·è¿™å¯ä»¥æ“ä½œå…·ä½“çš„CSSè§„åˆ™äº†ã€‚\n\n### æ–‡æ¡£ä¿¡æ¯å±æ€§\n\n#### document.documentURIï¼Œdocument.URL\n\n`document.documentURI` å±æ€§å’Œ `document.URL` å±æ€§éƒ½è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºå½“å‰æ–‡æ¡£çš„ç½‘å€ã€‚ä¸åŒä¹‹å¤„æ˜¯ `documentURI` å±æ€§å¯ç”¨äºæ‰€æœ‰æ–‡æ¡£ï¼ˆåŒ…æ‹¬ XML æ–‡æ¡£ï¼‰ï¼Œ`URL` å±æ€§åªèƒ½ç”¨äº `HTML` æ–‡æ¡£ã€‚\n\n#### document.domain\n\n`document.domain` å±æ€§è¿”å›å½“å‰æ–‡æ¡£çš„åŸŸåã€‚æ¯”å¦‚ï¼ŒæŸå¼ ç½‘é¡µçš„ç½‘å€æ˜¯ http://www.example.com/hello.html ï¼Œ`domain` å±æ€§å°±ç­‰äº `www.example.com`ã€‚å¦‚æœæ— æ³•è·å–åŸŸåï¼Œè¯¥å±æ€§è¿”å› `null`ã€‚\n\n#### document.lastModified\n\n`document.lastModified` å±æ€§è¿”å›å½“å‰æ–‡æ¡£æœ€åä¿®æ”¹çš„æ—¶é—´æˆ³ï¼Œæ ¼å¼ä¸ºå­—ç¬¦ä¸²ã€‚\n\næ³¨æ„ï¼Œ`lastModified` å±æ€§çš„å€¼æ˜¯å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥ä¸èƒ½ç”¨æ¥ç›´æ¥æ¯”è¾ƒï¼Œä¸¤ä¸ªæ–‡æ¡£è°çš„æ—¥æœŸæ›´æ–°ï¼Œéœ€è¦ç”¨ `Date.parse` æ–¹æ³•è½¬æˆæ—¶é—´æˆ³æ ¼å¼ï¼Œæ‰èƒ½è¿›è¡Œæ¯”è¾ƒã€‚\n\n#### document.location\n\nå±æ€§\n\n```js\n// å½“å‰ç½‘å€ä¸º http://user:passwd@www.example.com:4097/path/a.html?x=111#part1\ndocument.location.href // \"http://user:passwd@www.example.com:4097/path/a.html?x=111#part1\"\ndocument.location.protocol // \"http:\"\ndocument.location.host // \"www.example.com:4097\"\ndocument.location.hostname // \"www.example.com\"\ndocument.location.port // \"4097\"\ndocument.location.pathname // \"/path/a.html\"\ndocument.location.search // \"?x=111\"\ndocument.location.hash // \"#part1\"\ndocument.location.user // \"user\"\ndocument.location.password // \"passwd\"\n```\n\næ–¹æ³•\n\n```js\n// è·³è½¬åˆ°å¦ä¸€ä¸ªç½‘å€\ndocument.location.assign('http://www.google.com')\n// ä¼˜å…ˆä»æœåŠ¡å™¨é‡æ–°åŠ è½½\ndocument.location.reload(true)\n// ä¼˜å…ˆä»æœ¬åœ°ç¼“å­˜é‡æ–°åŠ è½½ï¼ˆé»˜è®¤å€¼ï¼‰\ndocument.location.reload(false)\n// è·³è½¬åˆ°æ–°ç½‘å€ï¼Œå¹¶å°†å–ä»£æ‰historyå¯¹è±¡ä¸­çš„å½“å‰è®°å½•\ndocument.location.replace('http://www.google.com');\n// å°†locationå¯¹è±¡è½¬ä¸ºå­—ç¬¦ä¸²ï¼Œç­‰ä»·äºdocument.location.href\ndocument.location.toString()\n```\n\n#### document.referrerï¼Œdocument.titleï¼Œdocument.characterSet\n\n`document.referrer` å±æ€§è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºå½“å‰æ–‡æ¡£çš„è®¿é—®æ¥æºï¼Œå¦‚æœæ˜¯æ— æ³•è·å–æ¥æºæˆ–æ˜¯ç”¨æˆ·ç›´æ¥é”®å…¥ç½‘å€ï¼Œè€Œä¸æ˜¯ä»å…¶ä»–ç½‘é¡µç‚¹å‡»ï¼Œåˆ™è¿”å›ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ã€‚\n\n`document.referrer` çš„å€¼ï¼Œæ€»æ˜¯ä¸HTTPå¤´ä¿¡æ¯çš„ `Referer` ä¿æŒä¸€è‡´ï¼Œä½†æ˜¯å®ƒçš„æ‹¼å†™æœ‰ä¸¤ä¸ª `r` ã€‚\n\n`document.title` å±æ€§è¿”å›å½“å‰æ–‡æ¡£çš„æ ‡é¢˜ï¼Œè¯¥å±æ€§æ˜¯å¯å†™çš„ã€‚\n\n#### document.readyState\n\n`document.readyState` å±æ€§è¿”å›å½“å‰æ–‡æ¡£çš„çŠ¶æ€ï¼Œå…±æœ‰ä¸‰ç§å¯èƒ½çš„å€¼ã€‚\n\n- `loading`ï¼šåŠ è½½HTMLä»£ç é˜¶æ®µï¼ˆå°šæœªå®Œæˆè§£æï¼‰\n- `interactive`ï¼šåŠ è½½å¤–éƒ¨èµ„æºé˜¶æ®µæ—¶\n- `complete`ï¼šåŠ è½½å®Œæˆæ—¶\n\n#### document.designMode\n\n`document.designMode` å±æ€§æ§åˆ¶å½“å‰æ–‡æ¡£æ˜¯å¦å¯ç¼–è¾‘ï¼Œé€šå¸¸ç”¨åœ¨åˆ¶ä½œæ‰€è§å³æ‰€å¾—ç¼–è¾‘å™¨ã€‚æ‰“å¼€ `iframe` å…ƒç´ åŒ…å«çš„æ–‡æ¡£çš„ `designMode` å±æ€§ï¼Œå°±èƒ½å°†å…¶å˜ä¸ºä¸€ä¸ªæ‰€è§å³æ‰€å¾—çš„ç¼–è¾‘å™¨ã€‚\n\n#### document.implementation\n\n`document.implementation` å±æ€§è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œç”¨æ¥ç”„åˆ«å½“å‰ç¯å¢ƒéƒ¨ç½²äº†å“ªäº›DOMç›¸å…³æ¥å£ã€‚`implementation` å±æ€§çš„ `hasFeature` æ–¹æ³•ï¼Œå¯ä»¥åˆ¤æ–­å½“å‰ç¯å¢ƒæ˜¯å¦éƒ¨ç½²äº†ç‰¹å®šç‰ˆæœ¬çš„ç‰¹å®šæ¥å£ã€‚\n\n#### document.compatMode\n\n`compatMode`å±æ€§è¿”å›æµè§ˆå™¨å¤„ç†æ–‡æ¡£çš„æ¨¡å¼ï¼Œå¯èƒ½çš„å€¼ä¸º`BackCompat`ï¼ˆå‘åå…¼å®¹æ¨¡å¼ï¼‰å’Œ`CSS1Compat`ï¼ˆä¸¥æ ¼æ¨¡å¼ï¼‰ã€‚\n\nä¸€èˆ¬æ¥è¯´ï¼Œå¦‚æœç½‘é¡µä»£ç çš„ç¬¬ä¸€è¡Œè®¾ç½®äº†æ˜ç¡®çš„`DOCTYPE`ï¼ˆæ¯”å¦‚`<!doctype html>`ï¼‰ï¼Œ`document.compatMode`çš„å€¼éƒ½ä¸º`CSS1Compat`ã€‚\n\n#### document.cookie\n\næ“ä½œæµè§ˆå™¨çš„Cookie\n\n### è¯»å†™ç›¸å…³çš„æ–¹æ³•\n\n#### document.write()ï¼Œdocument.writeln()\n\nå¦‚æœé¡µé¢å·²ç»è§£æå®Œæˆï¼ˆ`DOMContentLoaded`äº‹ä»¶å‘ç”Ÿä¹‹åï¼‰ï¼Œå†è°ƒç”¨`write`æ–¹æ³•ï¼Œå®ƒä¼šå…ˆè°ƒç”¨`open`æ–¹æ³•ï¼Œæ“¦é™¤å½“å‰æ–‡æ¡£æ‰€æœ‰å†…å®¹ï¼Œç„¶åå†å†™å…¥ã€‚\n\n```js\ndocument.addEventListener('DOMContentLoaded', function (event) {\n  document.write('<p>Hello World!</p>');\n});\n\n// ç­‰åŒäº\n\ndocument.addEventListener('DOMContentLoaded', function (event) {\n  document.open();\n  document.write('<p>Hello World!</p>');\n  document.close();\n});\n```\n\n`document.writeln` æ–¹æ³•ä¸ `write` æ–¹æ³•å®Œå…¨ä¸€è‡´ï¼Œé™¤äº†ä¼šåœ¨è¾“å‡ºå†…å®¹çš„å°¾éƒ¨æ·»åŠ æ¢è¡Œç¬¦ã€‚\n\n### æŸ¥æ‰¾èŠ‚ç‚¹çš„æ–¹æ³•\n\n#### document.querySelector()ï¼Œdocument.querySelectorAll()\n\n`document.querySelector` æ–¹æ³•æ¥å—ä¸€ä¸ªCSSé€‰æ‹©å™¨ä½œä¸ºå‚æ•°ï¼Œè¿”å›åŒ¹é…è¯¥é€‰æ‹©å™¨çš„å…ƒç´ èŠ‚ç‚¹ã€‚å¦‚æœæœ‰å¤šä¸ªèŠ‚ç‚¹æ»¡è¶³åŒ¹é…æ¡ä»¶ï¼Œåˆ™è¿”å›ç¬¬ä¸€ä¸ªåŒ¹é…çš„èŠ‚ç‚¹ã€‚å¦‚æœæ²¡æœ‰å‘ç°åŒ¹é…çš„èŠ‚ç‚¹ï¼Œåˆ™è¿”å› `null`ã€‚\n\n`document.querySelectorAll` æ–¹æ³•ä¸ `querySelector` ç”¨æ³•ç±»ä¼¼ï¼ŒåŒºåˆ«æ˜¯è¿”å›ä¸€ä¸ª `NodeList` å¯¹è±¡ï¼ŒåŒ…å«æ‰€æœ‰åŒ¹é…ç»™å®šé€‰æ‹©å™¨çš„èŠ‚ç‚¹ã€‚\n\næ”¯æŒå¤æ‚çš„CSSé€‰æ‹©å™¨ï¼Œä½†æ˜¯ä¸æ”¯æŒä¼ªå…ƒç´ çš„é€‰æ‹©å™¨\n\n#### document.getElementsByTagName()\n\n`document.getElementsByTagName` æ–¹æ³•è¿”å›æ‰€æœ‰æŒ‡å®šHTMLæ ‡ç­¾çš„å…ƒç´ ï¼Œè¿”å›å€¼æ˜¯ä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„ `HTMLCollection` å¯¹è±¡ï¼Œå¯ä»¥å®æ—¶åæ˜ HTMLæ–‡æ¡£çš„å˜åŒ–ã€‚å¦‚æœæ²¡æœ‰ä»»ä½•åŒ¹é…çš„å…ƒç´ ï¼Œå°±è¿”å›ä¸€ä¸ªç©ºé›†ã€‚\n\n#### document.getElementsByClassName()\n\n`document.getElementsByClassName` æ–¹æ³•è¿”å›ä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼ˆHTMLCollectionå®ä¾‹å¯¹è±¡ï¼‰ï¼ŒåŒ…æ‹¬äº†æ‰€æœ‰ `class` åå­—ç¬¦åˆæŒ‡å®šæ¡ä»¶çš„å…ƒç´ ï¼Œå…ƒç´ çš„å˜åŒ–å®æ—¶åæ˜ åœ¨è¿”å›ç»“æœä¸­ã€‚\n\n#### document.getElementsByName()\n\n`document.getElementsByName` æ–¹æ³•ç”¨äºé€‰æ‹©æ‹¥æœ‰ `name` å±æ€§çš„HTMLå…ƒç´ ï¼ˆæ¯”å¦‚`<form>`ã€`<radio>`ã€`<img>`ã€`<frame>`ã€`<embed>`å’Œ`<object>`ç­‰ï¼‰ï¼Œè¿”å›ä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„çš„å¯¹è±¡ï¼ˆ`NodeList`å¯¹è±¡çš„å®ä¾‹ï¼‰ï¼Œå› ä¸º`name`å±æ€§ç›¸åŒçš„å…ƒç´ å¯èƒ½ä¸æ­¢ä¸€ä¸ªã€‚\n\n#### getElementById()\n\n`getElementById` æ–¹æ³•è¿”å›åŒ¹é…æŒ‡å®š `id` å±æ€§çš„å…ƒç´ èŠ‚ç‚¹ã€‚å¦‚æœæ²¡æœ‰å‘ç°åŒ¹é…çš„èŠ‚ç‚¹ï¼Œåˆ™è¿”å› `null`ã€‚\n\n#### document.elementFromPoint()\n\n`document.elementFromPoint` æ–¹æ³•è¿”å›ä½äºé¡µé¢æŒ‡å®šä½ç½®æœ€ä¸Šå±‚çš„ `Element` å­èŠ‚ç‚¹ã€‚\n\n```js\nvar element = document.elementFromPoint(50, 50);\n```\n\nä¸Šé¢ä»£ç é€‰ä¸­åœ¨ `(50, 50)` è¿™ä¸ªåæ ‡ä½ç½®çš„æœ€ä¸Šå±‚çš„é‚£ä¸ªHTMLå…ƒç´ ã€‚\n\n\n`elementFromPoint` æ–¹æ³•çš„ä¸¤ä¸ªå‚æ•°ï¼Œä¾æ¬¡æ˜¯ç›¸å¯¹äºå½“å‰è§†å£å·¦ä¸Šè§’çš„æ¨ªåæ ‡å’Œçºµåæ ‡ï¼Œå•ä½æ˜¯åƒç´ ã€‚å¦‚æœä½äºè¯¥ä½ç½®çš„HTMLå…ƒç´ ä¸å¯è¿”å›ï¼ˆæ¯”å¦‚æ–‡æœ¬æ¡†çš„æ»šåŠ¨æ¡ï¼‰ï¼Œåˆ™è¿”å›å®ƒçš„çˆ¶å…ƒç´ ï¼ˆæ¯”å¦‚æ–‡æœ¬æ¡†ï¼‰ã€‚å¦‚æœåæ ‡å€¼æ— æ„ä¹‰ï¼ˆæ¯”å¦‚è´Ÿå€¼æˆ–è¶…è¿‡è§†å£å¤§å°ï¼‰ï¼Œåˆ™è¿”å› `null`ã€‚\n\n### ç”ŸæˆèŠ‚ç‚¹çš„æ–¹æ³•\n\n#### document.createElement()\n\n`document.createElement` æ–¹æ³•ç”¨æ¥ç”Ÿæˆç½‘é¡µå…ƒç´ èŠ‚ç‚¹ã€‚\n\n#### document.createTextNode()\n\n`document.createTextNode` æ–¹æ³•ç”¨æ¥ç”Ÿæˆæ–‡æœ¬èŠ‚ç‚¹ï¼Œå‚æ•°ä¸ºæ‰€è¦ç”Ÿæˆçš„æ–‡æœ¬èŠ‚ç‚¹çš„å†…å®¹ã€‚\n\nè¿™ä¸ªæ–¹æ³•å¯ä»¥ç¡®ä¿è¿”å›çš„èŠ‚ç‚¹ï¼Œè¢«æµè§ˆå™¨å½“ä½œæ–‡æœ¬æ¸²æŸ“ï¼Œè€Œä¸æ˜¯å½“ä½œ HTML ä»£ç æ¸²æŸ“ã€‚å› æ­¤ï¼Œå¯ä»¥ç”¨æ¥å±•ç¤ºç”¨æˆ·çš„è¾“å…¥ï¼Œé¿å… XSS æ”»å‡»ã€‚\n\n```js\nvar div = document.createElement('div');\ndiv.appendChild(document.createTextNode('<span>Foo & bar</span>'));\nconsole.log(div.innerHTML)\n// &lt;span&gt;Foo &amp; bar&lt;/span&gt;\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œ`createTextNode` æ–¹æ³•å¯¹å¤§äºå·å’Œå°äºå·è¿›è¡Œè½¬ä¹‰ï¼Œä»è€Œä¿è¯å³ä½¿ç”¨æˆ·è¾“å…¥çš„å†…å®¹åŒ…å«æ¶æ„ä»£ç ï¼Œä¹Ÿèƒ½æ­£ç¡®æ˜¾ç¤ºã€‚\n\n`createTextNode` æ–¹æ³•ä¸è½¬ä¹‰åŒå¼•å·\n\n#### document.createAttribute()\n\n`document.createAttribute` æ–¹æ³•ç”Ÿæˆä¸€ä¸ªæ–°çš„å±æ€§å¯¹è±¡èŠ‚ç‚¹ï¼Œå¹¶è¿”å›å®ƒã€‚\n\nå‚æ•°æ˜¯è¿™ä¸ªå±æ€§çš„åç§°\n\n#### document.createDocumentFragment()\n\n`createDocumentFragment` æ–¹æ³•ç”Ÿæˆä¸€ä¸ªDocumentFragmentå¯¹è±¡ã€‚\n\n`DocumentFragment `å¯¹è±¡æ˜¯ä¸€ä¸ªå­˜åœ¨äºå†…å­˜çš„DOMç‰‡æ®µï¼Œä½†æ˜¯ä¸å±äºå½“å‰æ–‡æ¡£ï¼Œå¸¸å¸¸ç”¨æ¥ç”Ÿæˆè¾ƒå¤æ‚çš„DOMç»“æ„ï¼Œç„¶åæ’å…¥å½“å‰æ–‡æ¡£ã€‚è¿™æ ·åšçš„å¥½å¤„åœ¨äºï¼Œå› ä¸º**`DocumentFragment` ä¸å±äºå½“å‰æ–‡æ¡£ï¼Œå¯¹å®ƒçš„ä»»ä½•æ”¹åŠ¨ï¼Œéƒ½ä¸ä¼šå¼•å‘ç½‘é¡µçš„é‡æ–°æ¸²æŸ“ï¼Œæ¯”ç›´æ¥ä¿®æ”¹å½“å‰æ–‡æ¡£çš„DOMæœ‰æ›´å¥½çš„æ€§èƒ½è¡¨ç°**ã€‚\n\n### äº‹ä»¶ç›¸å…³çš„æ–¹æ³•\n\n#### document.createEvent()\n\n`document.createEvent` æ–¹æ³•ç”Ÿæˆä¸€ä¸ªäº‹ä»¶å¯¹è±¡ï¼Œè¯¥å¯¹è±¡å¯ä»¥è¢« `element.dispatchEvent` æ–¹æ³•ä½¿ç”¨ï¼Œè§¦å‘æŒ‡å®šäº‹ä»¶ã€‚\n\n#### document.addEventListener()ï¼Œdocument.removeEventListener()ï¼Œdocument.dispatchEvent()\n\n```js\n// æ·»åŠ äº‹ä»¶ç›‘å¬å‡½æ•°\ndocument.addEventListener('click', listener, false);\n\n// ç§»é™¤äº‹ä»¶ç›‘å¬å‡½æ•°\ndocument.removeEventListener('click', listener, false);\n\n// è§¦å‘äº‹ä»¶\nvar event = new Event('click');\ndocument.dispatchEvent(event);\n```\n\n### å…¶ä»–æ–¹æ³•\n\n#### document.hasFocus()\n\n`document.hasFocus` æ–¹æ³•è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºå½“å‰æ–‡æ¡£ä¹‹ä¸­æ˜¯å¦æœ‰å…ƒç´ è¢«æ¿€æ´»æˆ–è·å¾—ç„¦ç‚¹ã€‚\n\n#### document.createNodeIterator()ï¼Œdocument.createTreeWalker()\n\n`document.createNodeIterator` æ–¹æ³•è¿”å›ä¸€ä¸ªDOMçš„å­èŠ‚ç‚¹éå†å™¨ã€‚\n\n`document.createTreeWalker` æ–¹æ³•è¿”å›ä¸€ä¸ªDOMçš„å­æ ‘éå†å™¨ã€‚å®ƒä¸`createNodeIterator` æ–¹æ³•çš„åŒºåˆ«åœ¨äºï¼Œåè€…åªéå†å­èŠ‚ç‚¹ï¼Œè€Œå®ƒéå†æ•´ä¸ªå­æ ‘ã€‚\n\n#### document.adoptNode()\n\n`document.adoptNode` æ–¹æ³•å°†æŸä¸ªèŠ‚ç‚¹ï¼Œä»å…¶åŸæ¥æ‰€åœ¨çš„æ–‡æ¡£ç§»é™¤ï¼Œæ’å…¥å½“å‰æ–‡æ¡£ï¼Œå¹¶è¿”å›æ’å…¥åçš„æ–°èŠ‚ç‚¹ã€‚\n\n#### document.importNode()\n\n`document.importNode` æ–¹æ³•ä»å¤–éƒ¨æ–‡æ¡£æ‹·è´æŒ‡å®šèŠ‚ç‚¹ï¼Œæ’å…¥å½“å‰æ–‡æ¡£ã€‚\n\n## Element èŠ‚ç‚¹\n\n### ç‰¹å¾ç›¸å…³çš„å±æ€§\n\n#### Element.attributes\n\n`Element.attributes` å±æ€§è¿”å›ä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼Œæˆå‘˜æ˜¯å½“å‰å…ƒç´ èŠ‚ç‚¹çš„æ‰€æœ‰å±æ€§èŠ‚ç‚¹\n\n#### Element.idï¼ŒElement.tagName\n\n`Element.id` å±æ€§è¿”å›æŒ‡å®šå…ƒç´ çš„ `id` å±æ€§ï¼Œè¯¥å±æ€§å¯è¯»å†™\n\n`Element.tagName` å±æ€§è¿”å›æŒ‡å®šå…ƒç´ çš„å¤§å†™æ ‡ç­¾åï¼Œä¸ `nodeName` å±æ€§çš„å€¼ç›¸ç­‰ã€‚\n\n#### Element.innerHTML\n\n`Element.innerHTML `å±æ€§è¿”å›è¯¥å…ƒç´ åŒ…å«çš„ HTML ä»£ç ã€‚è¯¥å±æ€§å¯è¯»å†™ï¼Œå¸¸ç”¨æ¥è®¾ç½®æŸä¸ªèŠ‚ç‚¹çš„å†…å®¹ã€‚\n\n**æ³¨æ„**\n\nå¦‚æœæ–‡æœ¬èŠ‚ç‚¹ä¸­åŒ…å«&ã€å°äºå·å’Œå¤§äºå·ï¼Œ`innerHTML` å±æ€§ä¼šå°†å®ƒä»¬è½¬ä¸ºå®ä½“å½¢å¼ `&amp;` ã€ `&lt;` ã€ `&gt;`ã€‚\n\nå¦‚æœæ–‡æœ¬ä¸­å«æœ‰ `<script>` æ ‡ç­¾ï¼Œè™½ç„¶å¯ä»¥ç”Ÿæˆ `script` èŠ‚ç‚¹ï¼Œä½†æ˜¯æ’å…¥çš„ä»£ç ä¸ä¼šæ‰§è¡Œï¼Œä½†æ˜¯ `innerHTML` è¿˜æ˜¯æœ‰å®‰å…¨é£é™©\n\n```js\nvar name = \"<img src=x onerror=alert(1)>\";\nel.innerHTML = name;\n```\n\nä¸Šé¢ä»£ç ä¸­ `alert` è¿˜æ˜¯ä¼šæ‰§è¡Œçš„ï¼Œå› æ­¤ä¸ºäº†å®‰å…¨è€ƒè™‘ï¼Œå¦‚æœæ’å…¥çš„æ˜¯æ–‡æœ¬ï¼Œæœ€å¥½ç”¨ `textContent` å±æ€§ä»£æ›¿ `innerHTML`\n\n#### Element.outerHTML\n\n`Element.outerHTML` å±æ€§è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå†…å®¹ä¸ºæŒ‡å®šå…ƒç´ èŠ‚ç‚¹çš„æ‰€æœ‰ HTML ä»£ç ï¼ŒåŒ…æ‹¬å®ƒè‡ªèº«å’ŒåŒ…å«çš„æ‰€æœ‰å­å…ƒç´ ã€‚\n\n`outerHTML` å±æ€§æ˜¯å¯è¯»å†™çš„ï¼Œå¯¹å®ƒè¿›è¡Œèµ‹å€¼ï¼Œç­‰äºæ›¿æ¢æ‰å½“å‰å…ƒç´ ã€‚\n\n```js\n// HTMLä»£ç å¦‚ä¸‹\n// <div id=\"container\"><div id=\"d\">Hello</div></div>\n\ncontainer = document.getElementById('container');\nd = document.getElementById(\"d\");\ncontainer.firstChild.nodeName // \"DIV\"\nd.nodeName // \"DIV\"\n\nd.outerHTML = '<p>Hello</p>';\ncontainer.firstChild.nodeName // \"P\"\nd.nodeName // \"DIV\"\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œ`outerHTML` å±æ€§é‡æ–°èµ‹å€¼ä»¥åï¼Œå†…å±‚çš„ `div` å…ƒç´ å°±ä¸å­˜åœ¨äº†ï¼Œè¢« `p` å…ƒç´ æ›¿æ¢äº†ã€‚ä½†æ˜¯ï¼Œå˜é‡ `d` ä¾ç„¶æŒ‡å‘åŸæ¥çš„ `div` å…ƒç´ ï¼Œè¿™è¡¨ç¤ºè¢«æ›¿æ¢çš„ `DIV` å…ƒç´ è¿˜å­˜åœ¨äºå†…å­˜ä¸­ã€‚\n\n#### Element.className , Element.classList\n\n```html\n<div class=\"one two three\" id=\"myDiv\"></div>\n```\n\nä¸Šé¢ä»£ç çš„ `className` å±æ€§å’Œ `classList` å±æ€§å¦‚ä¸‹\n\n```js\ndocument.getElementById('myDiv').className\n//'one two three'\n\ndocument.getElementById('myDiv').classList\n// {\n//   0: \"one\"\n//   1: \"two\"\n//   2: \"three\"\n//   length: 3\n// }\n```\n\nclassList å¯¹è±¡æœ‰ä¸‹åˆ—å‡ ç§æ–¹æ³•\n\n- `add()` : å¢åŠ ä¸€ä¸ªclass\n- `remove()` : ç§»é™¤ä¸€ä¸ªclass\n- `contains()` : æ£€æŸ¥å½“å‰å…ƒç´ æ˜¯å¦åŒ…å«æŸä¸ªclass\n- `toggle()` : å°†æŸä¸ªclassç§»å…¥æˆ–ç§»å‡ºå…ƒç´ ï¼ˆå¦‚æœå­˜åœ¨å°±ç§»é™¤ï¼Œä¸å­˜åœ¨å°±æ·»åŠ ï¼‰\n- `item()` : è¿”å›æŒ‡å®šç´¢å¼•ä½ç½®çš„class\n- `toString()` : å°†classçš„åˆ—è¡¨è½¬ä¸ºå­—ç¬¦ä¸²\n\n### ç›’è£…æ¨¡å‹ç›¸å…³å±æ€§\n\n#### Element.clientHeight,Element.clientWidth\n\nè¿”å›å…ƒç´ èŠ‚ç‚¹å¯è§éƒ¨åˆ†çš„é«˜åº¦ï¼Œä¸åŒ…æ‹¬æº¢å‡º(overflow)çš„å¤§å°\n\nè¿™ä¸¤ä¸ªå±æ€§çš„å€¼ç­‰å…ƒç´ çš„cssé«˜åº¦ï¼ˆå®½åº¦ï¼‰åŠ ä¸Šcssçš„paddingå‡å»æ»šåŠ¨æ¡ï¼ˆå¦‚æœå­˜åœ¨æ»šåŠ¨æ¡ï¼‰ï¼Œå•ä½ä¸ºåƒç´ ã€‚\n\n#### Element.clientLeft,Element.clientTop\n\n`Element.clientLeft` å±æ€§ç­‰äºå…ƒç´ èŠ‚ç‚¹å·¦è¾¹æ¡†çš„å®½åº¦ï¼Œ`Element.clientTop` å±æ€§ç­‰äºå…ƒç´ èŠ‚ç‚¹é¡¶éƒ¨è¾¹æ¡†çš„å®½åº¦ï¼Œå•ä½ä¸ºåƒç´ \n\nå¦‚æœå…ƒç´ è®¾ç½®äº† `display:inline` å®ƒçš„ `clientLeft` å±æ€§ä¸€å¾‹ä¸º `0`\n\n#### Element.scrollLeft,Element.scrollTop\n\n`Element.scrollLeft`å±æ€§è¡¨ç¤ºç½‘é¡µå…ƒç´ çš„æ°´å¹³æ»šåŠ¨æ¡å‘å³ä¾§æ»šåŠ¨çš„åƒç´ ï¼Œ`Element.scrollTop`å±æ€§è¡¨ç¤ºç½‘é¡µå…ƒç´ çš„å‚ç›´æ»šåŠ¨æ¡å‘ä¸‹æ»šåŠ¨çš„åƒç´ æ•°é‡ï¼Œå¯¹äºæ²¡æœ‰æ»šåŠ¨æ¡çš„ç½‘é¡µå…ƒç´ ï¼Œè¿™ä¸¤ä¸ªå±æ€§æ€»æ˜¯ç­‰äº0\n\nå¦‚æœè¦æŸ¥çœ‹æ•´å¼ ç½‘é¡µçš„æ°´å¹³çš„å‚ç›´çš„æ»šåŠ¨è·ç¦»ï¼Œè¦ä»`document.documentElement` å…ƒç´ ä¸Šè¯»å–\n\n#### Element.scrollWidth,Element.scrollHeight\n\n`Element.scrollHeight` å±æ€§è¿”å›æŸä¸ªç½‘é¡µå…ƒç´ çš„æ€»é«˜åº¦ï¼Œ`Element.scrollWidth` å±æ€§è¿”å›æ€»å®½åº¦ï¼Œå¯ä»¥ç†è§£æˆå…ƒç´ åœ¨å‚ç›´å’Œæ°´å¹³ä¸¤ä¸ªæ–¹å‘ä¸Šå¯ä»¥æ»šåŠ¨çš„è·ç¦»ã€‚å®ƒä»¬éƒ½åŒ…æ‹¬ç”±äºæº¢å‡ºå®¹å™¨è€Œæ— æ³•æ˜¾ç¤ºåœ¨ç½‘é¡µä¸Šçš„é‚£éƒ¨åˆ†é«˜åº¦æˆ–å®½åº¦ã€‚è¿™ä¸¤ä¸ªå±æ€§æ˜¯åªè¯»å±æ€§ã€‚\n\nå¦‚æœå†…å®¹æ­£å¥½é€‚åˆå®ƒçš„å®¹å™¨ï¼Œæ²¡æœ‰æº¢å‡ºï¼Œé‚£ä¹ˆ `Element.scrollHeight` å’Œ `Element.clientHeight` æ˜¯ç›¸ç­‰çš„ï¼Œå¦‚æœå­˜åœ¨æº¢å‡ºï¼Œé‚£ä¹ˆ `scrollHeight` å±æ€§å¤§äº`clientHeight` å±æ€§ï¼Œå®½åº¦ä¹Ÿæ˜¯åŒæ ·ã€‚\n\nå½“å­˜åœ¨æº¢å‡ºçš„æ—¶å€™ï¼Œæ»šåŠ¨æ¡æ»šåŠ¨åˆ°å†…å®¹åº•éƒ¨æ—¶ï¼Œä¸‹åˆ—è¡¨è¾¾å¼ä¸º  `true` \n\n```js\nelement.scrollHeight - element.scrollTop === element.clientHeight \n```\n\n#### Element.offsetHeight , Element.offsetWidth\n\n`Element.offsetHeight` å±æ€§è¿”å›å…ƒç´ çš„å‚ç›´é«˜åº¦ï¼Œ`Element.offsetWidth` å±æ€§è¿”å›æ°´å¹³å®½åº¦ã€‚`offsetHeight` å¯ä»¥ç†è§£æˆå…ƒç´ å·¦ä¸‹è§’è·ç¦»å·¦ä¸Šè§’çš„ä½ç§»ï¼Œ`offsetWidth` æ˜¯å…ƒç´ å³ä¸Šè§’è·ç¦»å·¦ä¸Šè§’çš„ä½ç§»ã€‚å®ƒä»¬çš„å•ä½ä¸ºåƒç´ ï¼Œéƒ½æ˜¯åªè¯»ã€‚\n\nè¿™ä¸¤ä¸ªå±æ€§å€¼åŒ…æ‹¬ `Padding` å’Œ `Border` ã€ä»¥åŠæ»šåŠ¨æ¡ã€‚è¿™ä¹Ÿæ„å‘³ç€ï¼Œå¦‚æœä¸å­˜åœ¨å†…å®¹æº¢å‡ºï¼Œ`Element.offsetHeight` åªæ¯” `Element.clientHeight` å¤šäº†è¾¹æ¡†çš„é«˜åº¦ã€‚\n\n#### Element.offsetLeftï¼ŒElement.offsetTop\n\n`Element.offsetLeft` è¿”å›å½“å‰å…ƒç´ å·¦ä¸Šè§’ç›¸å¯¹äº `Element.offsetParent` èŠ‚ç‚¹çš„æ°´å¹³ä½ç§»ï¼Œ`Element.offsetTop` è¿”å›å‚ç›´ä½ç§»ï¼Œå•ä½ä¸ºåƒç´ ã€‚é€šå¸¸ï¼Œè¿™ä¸¤ä¸ªå€¼æ˜¯æŒ‡ç›¸å¯¹äºçˆ¶èŠ‚ç‚¹çš„ä½ç§»ã€‚\n\n\n### ç›¸å…³èŠ‚ç‚¹çš„å±æ€§\n\n#### Element.childrenï¼ŒElement.childElementCount\n\n`Element.children` å±æ€§è¿”å›ä¸€ä¸ª `HTMLCollection` å¯¹è±¡ï¼ŒåŒ…æ‹¬å½“å‰å…ƒç´ èŠ‚ç‚¹çš„æ‰€æœ‰å­å…ƒç´ \n\nè¿™ä¸ªå±æ€§ä¸ `Node.childNodes` å±æ€§çš„åŒºåˆ«æ˜¯ï¼Œå®ƒåªåŒ…æ‹¬HTMLå…ƒç´ ç±»å‹çš„å­èŠ‚ç‚¹ï¼Œä¸åŒ…æ‹¬å…¶ä»–ç±»å‹çš„å­èŠ‚ç‚¹ã€‚\n\n`Element.childElementCount` å±æ€§è¿”å›å½“å‰å…ƒç´ èŠ‚ç‚¹åŒ…å«çš„å­HTMLå…ƒç´ èŠ‚ç‚¹çš„ä¸ªæ•°ï¼Œä¸`Element.children.length` çš„å€¼ç›¸åŒã€‚æ³¨æ„ï¼Œè¯¥å±æ€§åªè®¡ç®—HTMLå…ƒç´ ç±»å‹çš„å­èŠ‚ç‚¹ã€‚\n\n#### Element.firstElementChildï¼ŒElement.lastElementChild\n\n`Element.firstElementChild` å±æ€§è¿”å›ç¬¬ä¸€ä¸ªHTMLå…ƒç´ ç±»å‹çš„å­èŠ‚ç‚¹ï¼Œ`Element.lastElementChild` è¿”å›æœ€åä¸€ä¸ªHTMLå…ƒç´ ç±»å‹çš„å­èŠ‚ç‚¹\n\n#### Element.nextElementSiblingï¼ŒElement.previousElementSibling\n\n`Element.nextElementSibling` å±æ€§è¿”å›å½“å‰HTMLå…ƒç´ èŠ‚ç‚¹çš„åä¸€ä¸ªåŒçº§HTMLå…ƒç´ èŠ‚ç‚¹\n\n`Element.previousElementSibling` å±æ€§è¿”å›å½“å‰HTMLå…ƒç´ èŠ‚ç‚¹çš„å‰ä¸€ä¸ªåŒçº§HTMLå…ƒç´ èŠ‚ç‚¹\n\n\n#### Element.offsetParent\n\n`Element.offsetParent` å±æ€§è¿”å›å½“å‰ HTML å…ƒç´ çš„æœ€é è¿‘çš„ã€å¹¶ä¸” CSS çš„ `position` å±æ€§ä¸ç­‰äº `static` çš„ä¸Šå±‚å…ƒç´ \n\nå¦‚æœè¯¥å…ƒç´ æ˜¯ä¸å¯è§çš„ï¼ˆ`display`å±æ€§ä¸º`none`ï¼‰ï¼Œæˆ–è€…ä½ç½®æ˜¯å›ºå®šçš„ï¼ˆ`position`å±æ€§ä¸º`fixed`ï¼‰ï¼Œåˆ™`offsetParent`å±æ€§è¿”å›`null`ã€‚\n\n### å±æ€§ç›¸å…³çš„æ–¹æ³•\n\n- `Element.getAttribute()`ï¼šè¯»å–æŒ‡å®šå±æ€§\n- `Element.setAttribute()`ï¼šè®¾ç½®æŒ‡å®šå±æ€§\n- `Element.hasAttribute()`ï¼šè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºå½“å‰å…ƒç´ èŠ‚ç‚¹æ˜¯å¦æœ‰æŒ‡å®šçš„å±æ€§\n- `Element.removeAttribute()`ï¼šç§»é™¤æŒ‡å®šå±æ€§\n\n### æŸ¥æ‰¾ç›¸å…³æ–¹æ³•\n\n- `Element.querySelector()`\n- `Element.querySelectorAll()`\n- `Element.getElementsByTagName()`\n- `Element.getElementsByClassName()`\n\n### äº‹ä»¶ç›¸å…³çš„æ–¹æ³•\n\n- `Element.addEventListener()` ï¼šæ·»åŠ äº‹ä»¶çš„å›è°ƒå‡½æ•°\n- `Element.removeEventListener()` ï¼šç§»é™¤äº‹ä»¶ç›‘å¬å‡½æ•°\n- `Element.dispatchEvent()` ï¼šè§¦å‘äº‹ä»¶\n\n### å…¶ä»–æ–¹æ³•\n\n#### Element.scrollIntoView()\n\n`Element.scrollIntoView` æ–¹æ³•æ»šåŠ¨å½“å‰å…ƒç´ ï¼Œè¿›å…¥æµè§ˆå™¨çš„å¯è§åŒºåŸŸï¼Œç±»ä¼¼äºè®¾ç½®`window.location.hash` çš„æ•ˆæœã€‚\n\n#### Element.getBoundingClientRect()\n\n`Element.getBoundingClientRect` æ–¹æ³•è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡æä¾›å½“å‰å…ƒç´ èŠ‚ç‚¹çš„å¤§å°ã€ä½ç½®ç­‰ä¿¡æ¯ï¼ŒåŸºæœ¬ä¸Šå°±æ˜¯CSSç›’çŠ¶æ¨¡å‹æä¾›çš„æ‰€æœ‰ä¿¡æ¯ã€‚\n\n#### Element.getClientRects()\n\n`Element.getClientRects` æ–¹æ³•è¿”å›ä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼Œé‡Œé¢æ˜¯å½“å‰å…ƒç´ åœ¨é¡µé¢ä¸Šå½¢æˆçš„æ‰€æœ‰çŸ©å½¢ã€‚æ¯ä¸ªçŸ©å½¢éƒ½æœ‰ `bottom` ã€ `height` ã€ `left` ã€ `right` ã€ `top` å’Œ `width` å…­ä¸ªå±æ€§ï¼Œè¡¨ç¤ºå®ƒä»¬ç›¸å¯¹äºè§†å£çš„å››ä¸ªåæ ‡ï¼Œä»¥åŠæœ¬èº«çš„é«˜åº¦å’Œå®½åº¦ã€‚\n\n#### Element.insertAdjacentHTML()\n\n`Element.insertAdjacentHTML` æ–¹æ³•è§£æHTMLå­—ç¬¦ä¸²ï¼Œç„¶åå°†ç”Ÿæˆçš„èŠ‚ç‚¹æ’å…¥DOMæ ‘çš„æŒ‡å®šä½ç½®ã€‚\n\n#### Element.remove()\n\n`Element.remove` æ–¹æ³•ç”¨äºå°†å½“å‰å…ƒç´ èŠ‚ç‚¹ä»DOMæ ‘åˆ é™¤ã€‚\n\n#### Element.focus()\n\n`Element.focus` æ–¹æ³•ç”¨äºå°†å½“å‰é¡µé¢çš„ç„¦ç‚¹ï¼Œè½¬ç§»åˆ°æŒ‡å®šå…ƒç´ ä¸Šã€‚\n\n## å±æ€§çš„æ“ä½œ\n\n### Element.attributes å±æ€§\n\nè¿”å›ä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„åŠ¨æ€å¯¹è±¡ï¼Œæˆå‘˜æ˜¯è¯¥å…ƒç´ æ ‡ç­¾çš„æ‰€æœ‰å±æ€§èŠ‚ç‚¹å¯¹è±¡ï¼Œå±æ€§çš„å®æ—¶å˜åŒ–éƒ½ä¼šåæ˜ åœ¨è¿™ä¸ªèŠ‚ç‚¹å¯¹è±¡ä¸Šï¼Œå…¶ä»–ç±»å‹çš„èŠ‚ç‚¹å¯¹è±¡ï¼Œè™½ç„¶ä¹Ÿæœ‰ `attribute` å±æ€§ï¼Œä½†æ˜¯è¿”å›çš„éƒ½æ˜¯ `null`\n\nå±æ€§èŠ‚ç‚¹å¯¹è±¡æœ‰ `name` å’Œ `value` å±æ€§ï¼Œå¯¹åº”è¯¥å±æ€§çš„å±æ€§åå’Œå±æ€§å€¼ã€‚ç­‰åŒäº `nodeName` å±æ€§å’Œ `nodeValue` å±æ€§\n\n### å…ƒç´ èŠ‚ç‚¹å¯¹è±¡çš„å±æ€§\n\n```js\nimg.src\na.href\n```\n\nè¿™ç§å†™æ³•è™½ç„¶å¯ä»¥è¯»å†™ HTML å±æ€§ï¼Œä½†æ˜¯æ— æ³•åˆ é™¤å±æ€§ï¼Œ `delete` è¿ç®—ç¬¦åœ¨è¿™é‡Œä¸ä¼šç”Ÿæ•ˆ\n\nHTML å…ƒç´ çš„å±æ€§åæ˜¯å¤§å°å†™ä¸æ•æ„Ÿçš„ï¼Œä½†æ˜¯ JavaScript å¯¹è±¡çš„å±æ€§åæ˜¯å¤§å°å†™æ•æ„Ÿçš„ã€‚è½¬ä¸º JavaScript å±æ€§åæ—¶ï¼Œä¸€å¾‹é‡‡ç”¨å°å†™ï¼Œå¦‚æœå±æ€§ååŒ…æ‹¬å¤šä¸ªå•è¯ï¼Œé‡‡ç”¨é©¼å³°æ‹¼å†™æ³•\n\næœ‰äº› HTML å±æ€§åæ˜¯ JavaScript çš„ä¿ç•™å­—ï¼Œè½¬ä¸º JavaScript å±æ€§æ—¶ï¼Œå¿…é¡»æ”¹å\n\n- `for` å±æ€§æ”¹ä¸º `htmlFor`\n- `class` å±æ€§æ”¹ä¸º `className`\n\n\n### å±æ€§æ“ä½œçš„æ ‡å‡†æ–¹æ³•\n\n#### getAttribute()\n\nè¿”å›å½“å‰å…ƒç´ èŠ‚ç‚¹çš„æŒ‡å®šå±æ€§ï¼Œåªè¿”å›å­—ç¬¦ä¸²ï¼ŒHTML æ ‡ç­¾å¯¹è±¡çš„å±æ€§ä¼šè¿”å›å„ç§ç±»å‹çš„å€¼ã€‚\n\n#### setAttribute()\n\n`Element.setAttribute` æ–¹æ³•ç”¨äºä¸ºå½“å‰å…ƒç´ èŠ‚ç‚¹æ–°å¢å±æ€§ã€‚å¦‚æœåŒåå±æ€§å·²å­˜åœ¨ï¼Œåˆ™ç›¸å½“äºç¼–è¾‘å·²å­˜åœ¨çš„å±æ€§ã€‚\n\n\n#### hasAttribute()\n\n`Element.hasAttribute` æ–¹æ³•è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºå½“å‰å…ƒç´ èŠ‚ç‚¹æ˜¯å¦åŒ…å«æŒ‡å®šå±æ€§ã€‚\n\n#### removeAttribute()\n\n`Element.removeAttribute` æ–¹æ³•ç”¨äºä»å½“å‰å…ƒç´ èŠ‚ç‚¹ç§»é™¤å±æ€§ã€‚\n\n### dataset å±æ€§\n\n```html\n<div id=\"mydiv\" data-foo=\"bar\">\n```\n\n```js\nvar n = document.getElementById('mydiv');\nn.dataset.foo // bar\nn.dataset.foo = 'baz'\n```\n\nå¯ä»¥é€šè¿‡ `dateset.foo` è¯»å†™ `data-foo` å±æ€§\n\nåˆ é™¤ä¸€ä¸ª `data-*` å±æ€§ï¼Œå¯ä»¥ç›´æ¥ç”¨ `delete` å‘½ä»¤\n\n**æ³¨æ„**\n\n`data-` åé¢çš„å±æ€§åæœ‰é™åˆ¶ï¼Œåªèƒ½åŒ…å«å­—æ¯ã€æ•°å­—ã€è¿è¯çº¿ï¼ˆ`-`ï¼‰ã€ç‚¹ï¼ˆ`.`ï¼‰ã€å†’å·ï¼ˆ`:`ï¼‰å’Œä¸‹åˆ’çº¿ï¼ˆ`_`ï¼‰ã€‚è€Œä¸”ï¼Œå±æ€§åä¸åº”è¯¥ä½¿ç”¨ `A` åˆ° `Z` çš„å¤§å†™å­—æ¯ï¼Œæ¯”å¦‚ä¸èƒ½æœ‰ `data-helloWorld` è¿™æ ·çš„å±æ€§åï¼Œè€Œè¦å†™æˆ `data-hello-world`ã€‚\n\nè½¬æˆ `dataset` çš„é”®åæ—¶ï¼Œè¿è¯çº¿åé¢å¦‚æœè·Ÿç€ä¸€ä¸ªå°å†™å­—æ¯ï¼Œé‚£ä¹ˆè¿è¯çº¿ä¼šè¢«ç§»é™¤ï¼Œè¯¥å°å†™å­—æ¯è½¬ä¸ºå¤§å†™å­—æ¯ï¼Œå…¶ä»–å­—ç¬¦ä¸å˜ã€‚åè¿‡æ¥ï¼Œ`dataset` çš„é”®åè½¬æˆå±æ€§åæ—¶ï¼Œæ‰€æœ‰å¤§å†™å­—æ¯éƒ½ä¼šè¢«è½¬æˆè¿è¯çº¿+è¯¥å­—æ¯çš„å°å†™å½¢å¼ï¼Œå…¶ä»–å­—ç¬¦ä¸å˜ã€‚æ¯”å¦‚ï¼Œ`dataset.helloWorld` ä¼šè½¬æˆ `data-hello-world`ã€‚\n\n## Text èŠ‚ç‚¹å’Œ DocumentFragment èŠ‚ç‚¹\n\n### Text èŠ‚ç‚¹çš„æ¦‚å¿µ \n\n`Text` èŠ‚ç‚¹ä»£è¡¨ `Element` èŠ‚ç‚¹å’Œ `Attribute` èŠ‚ç‚¹çš„æ–‡æœ¬å†…å®¹ã€‚å¦‚æœä¸€ä¸ªèŠ‚ç‚¹åªåŒ…å«ä¸€æ®µæ–‡æœ¬ï¼Œé‚£ä¹ˆå®ƒå°±æœ‰ä¸€ä¸ª `Text` å­èŠ‚ç‚¹ï¼Œä»£è¡¨è¯¥èŠ‚ç‚¹çš„æ–‡æœ¬å†…å®¹ã€‚ç”±äºç©ºæ ¼ä¹Ÿæ˜¯ä¸€ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥å“ªæ€•æœ‰ä¸€ä¸ªç©ºæ ¼ï¼Œä¹Ÿä¼šå½¢æˆ `Text` èŠ‚ç‚¹\n\n### Text èŠ‚ç‚¹çš„å±æ€§\n\n#### data\n\n`data` å±æ€§ç­‰åŒäº `nodeValue` å±æ€§ï¼Œç”¨æ¥è®¾ç½®æˆ–è¯»å– `Text` èŠ‚ç‚¹çš„å†…å®¹ã€‚\n\n#### wholeText\n\n`wholeText` å±æ€§å°†å½“å‰ `Text` èŠ‚ç‚¹ä¸æ¯—é‚»çš„ `Text` èŠ‚ç‚¹ï¼Œä½œä¸ºä¸€ä¸ªæ•´ä½“è¿”å›\n\n\n```html\n<p id=\"para\">A <em>B</em> C</p>\n```\n\n```js\nvar el = document.getElementById(\"para\");\nel.firstChild.wholeText // \"A \"\nel.firstChild.data // \"A \"\n```\n\nä½†æ˜¯ï¼Œä¸€æ—¦ç§»é™¤emèŠ‚ç‚¹ï¼Œ`wholeText` å±æ€§ä¸ `data` å±æ€§å°±ä¼šæœ‰å·®å¼‚ï¼Œå› ä¸ºè¿™æ—¶å…¶å®PèŠ‚ç‚¹ä¸‹é¢åŒ…å«äº†ä¸¤ä¸ªæ¯—é‚»çš„ `Text` èŠ‚ç‚¹ã€‚\n\n```js\nel.removeChild(para.childNodes[1]);\nel.firstChild.wholeText // \"A C\"\nel.firstChild.data // \"A \"\n```\n\n\n### Text èŠ‚ç‚¹çš„æ–¹æ³•\n\n`appendData` æ–¹æ³•ç”¨äºåœ¨ `Text` èŠ‚ç‚¹å°¾éƒ¨è¿½åŠ å­—ç¬¦ä¸²ã€‚\n\n`deleteData` æ–¹æ³•ç”¨äºåˆ é™¤ `Text` èŠ‚ç‚¹å†…éƒ¨çš„å­å­—ç¬¦ä¸²ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸ºå­å­—ç¬¦ä¸²ä½ç½®ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºå­å­—ç¬¦ä¸²é•¿åº¦ã€‚\n\n`insertData` æ–¹æ³•ç”¨äºåœ¨ `Text` èŠ‚ç‚¹æ’å…¥å­—ç¬¦ä¸²ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸ºæ’å…¥ä½ç½®ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºæ’å…¥çš„å­å­—ç¬¦ä¸²ã€‚\n\n`replaceData` æ–¹æ³•ç”¨äºæ›¿æ¢æ–‡æœ¬ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸ºæ›¿æ¢å¼€å§‹ä½ç½®ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºéœ€è¦è¢«æ›¿æ¢æ‰çš„é•¿åº¦ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°ä¸ºæ–°åŠ å…¥çš„å­—ç¬¦ä¸²ã€‚\n\n`subStringData` æ–¹æ³•ç”¨äºè·å–å­å­—ç¬¦ä¸²ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸ºå­å­—ç¬¦ä¸²åœ¨ `Text` èŠ‚ç‚¹ä¸­çš„å¼€å§‹ä½ç½®ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºå­å­—ç¬¦ä¸²é•¿åº¦ã€‚\n\n`remove` æ–¹æ³•ç”¨äºç§»é™¤å½“å‰TextèŠ‚ç‚¹ã€‚\n\n`splitText` æ–¹æ³•å°† `Text` èŠ‚ç‚¹ä¸€åˆ†ä¸ºäºŒï¼Œå˜æˆä¸¤ä¸ªæ¯—é‚»çš„ `Text` èŠ‚ç‚¹ã€‚å®ƒçš„å‚æ•°å°±æ˜¯åˆ†å‰²ä½ç½®ï¼ˆä»é›¶å¼€å§‹ï¼‰ï¼Œåˆ†å‰²åˆ°è¯¥ä½ç½®çš„å­—ç¬¦å‰ç»“æŸã€‚å¦‚æœåˆ†å‰²ä½ç½®ä¸å­˜åœ¨ï¼Œå°†æŠ¥é”™ã€‚\n\n`normalize` æ–¹æ³•å¯ä»¥å°†æ¯—é‚»çš„ä¸¤ä¸ª `Text` èŠ‚ç‚¹åˆå¹¶ã€‚\n\n### DocumentFragment èŠ‚ç‚¹\n\n`DocumentFragment` èŠ‚ç‚¹å¯¹è±¡æ²¡æœ‰è‡ªå·±çš„å±æ€§å’Œæ–¹æ³•ï¼Œå…¨éƒ¨ç»§æ‰¿è‡ª `Node` èŠ‚ç‚¹å’Œ`ParentNode` æ¥å£ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ`DocumentFragment` èŠ‚ç‚¹æ¯” `Node` èŠ‚ç‚¹å¤šå‡ºä»¥ä¸‹å››ä¸ªå±æ€§ã€‚\n\n`children`ï¼šè¿”å›ä¸€ä¸ªåŠ¨æ€çš„ `HTMLCollection` é›†åˆå¯¹è±¡ï¼ŒåŒ…æ‹¬å½“å‰ `DocumentFragment` å¯¹è±¡çš„æ‰€æœ‰å­å…ƒç´ èŠ‚ç‚¹ã€‚\n`firstElementChild`ï¼šè¿”å›å½“å‰`DocumentFragment`å¯¹è±¡çš„ç¬¬ä¸€ä¸ªå­å…ƒç´ èŠ‚ç‚¹ï¼Œå¦‚æœæ²¡æœ‰åˆ™è¿”å›`null`ã€‚\n`lastElementChild`ï¼šè¿”å›å½“å‰`DocumentFragment`å¯¹è±¡çš„æœ€åä¸€ä¸ªå­å…ƒç´ èŠ‚ç‚¹ï¼Œå¦‚æœæ²¡æœ‰åˆ™è¿”å›`null`ã€‚\n`childElementCount`ï¼šè¿”å›å½“å‰`DocumentFragment`å¯¹è±¡çš„æ‰€æœ‰å­å…ƒç´ æ•°é‡ã€‚\n\n## äº‹ä»¶æ¨¡å‹\n\n### EventTarget æ¥å£\n\nDOMçš„äº‹ä»¶æ“ä½œï¼ˆç›‘å¬å’Œè§¦å‘ï¼‰ï¼Œéƒ½å®šä¹‰åœ¨ `EventTarget` æ¥å£ã€‚`Element` èŠ‚ç‚¹ã€ `document` èŠ‚ç‚¹å’Œ `window` å¯¹è±¡ï¼Œéƒ½éƒ¨ç½²äº†è¿™ä¸ªæ¥å£\n\n- addEventListener ç»‘å®šäº‹ä»¶çš„ç›‘å¬å‡½æ•°\n- removeEventListener ç§»é™¤äº‹ä»¶çš„ç›‘å¬å‡½æ•°\n- dispatchEvent è§¦å‘äº‹ä»¶\n\n### addEventListener\n\næ¥å—ä¸‰ä¸ªå‚æ•°\n\n- `type`ï¼šäº‹ä»¶åç§°ï¼Œå¤§å°å†™æ•æ„Ÿã€‚\n- `listener`ï¼šç›‘å¬å‡½æ•°ã€‚äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œä¼šè°ƒç”¨è¯¥ç›‘å¬å‡½æ•°ã€‚\n- `useCapture`ï¼šå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºç›‘å¬å‡½æ•°æ˜¯å¦åœ¨æ•è·é˜¶æ®µï¼ˆcaptureï¼‰è§¦å‘ï¼ˆå‚è§åæ–‡ã€Šäº‹ä»¶çš„ä¼ æ’­ã€‹éƒ¨åˆ†ï¼‰ï¼Œé»˜è®¤ä¸º`false`ï¼ˆç›‘å¬å‡½æ•°åªåœ¨å†’æ³¡é˜¶æ®µè¢«è§¦å‘ï¼‰ã€‚è€å¼æµè§ˆå™¨è§„å®šè¯¥å‚æ•°å¿…å†™ï¼Œè¾ƒæ–°ç‰ˆæœ¬çš„æµè§ˆå™¨å…è®¸è¯¥å‚æ•°å¯é€‰ã€‚ä¸ºäº†ä¿æŒå…¼å®¹ï¼Œå»ºè®®æ€»æ˜¯å†™ä¸Šè¯¥å‚æ•°ã€‚\n\n### removeEventListener()\n\n`removeEventListener` æ–¹æ³•ç”¨æ¥ç§»é™¤ `addEventListener` æ–¹æ³•æ·»åŠ çš„äº‹ä»¶ç›‘å¬å‡½æ•°ã€‚\n\n### dispatchEvent()\n\n`dispatchEvent` æ–¹æ³•åœ¨å½“å‰èŠ‚ç‚¹ä¸Šè§¦å‘æŒ‡å®šäº‹ä»¶ï¼Œä»è€Œè§¦å‘ç›‘å¬å‡½æ•°çš„æ‰§è¡Œã€‚è¯¥æ–¹æ³•è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œåªè¦æœ‰ä¸€ä¸ªç›‘å¬å‡½æ•°è°ƒç”¨äº† `Event.preventDefault()` ï¼Œåˆ™è¿”å›å€¼ä¸º`false`ï¼Œå¦åˆ™ä¸º `true` ã€‚\n\n### ç›‘å¬å‡½æ•°\n\näº‹ä»¶å‘ç”Ÿæ—¶ï¼Œç¨‹åºæ‰€è¦æ‰§è¡Œçš„å‡½æ•°\n\n#### HTML æ ‡ç­¾çš„ on- å±æ€§\n\nä½¿ç”¨è¿™ç§å‘æ”¾æ—¶ `on-` å±æ€§çš„å€¼æ˜¯å°†ä¼šæ‰§è¡Œçš„ä»£ç ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå‡½æ•°\n\n```html\n<!-- æ­£ç¡® -->\n<body onload=\"doSomething()\">\n\n<!-- é”™è¯¯ -->\n<body onload=\"doSomething\">\n```\n\n#### Element èŠ‚ç‚¹çš„äº‹ä»¶å±æ€§\n\n```js\ndiv.onclick = function(event){\n  //...\n}\n```\n\nåªä¼šåœ¨å†’æ³¡é˜¶æ®µè§¦å‘\n\n#### addEventListeneræ–¹æ³•\n\nç¬¬ä¸€ç§â€œHTMLæ ‡ç­¾çš„on-å±æ€§â€ï¼Œè¿åäº†HTMLä¸JavaScriptä»£ç ç›¸åˆ†ç¦»çš„åŸåˆ™ï¼›ç¬¬äºŒç§â€œElementèŠ‚ç‚¹çš„äº‹ä»¶å±æ€§â€çš„ç¼ºç‚¹æ˜¯ï¼ŒåŒä¸€ä¸ªäº‹ä»¶åªèƒ½å®šä¹‰ä¸€ä¸ªç›‘å¬å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœå®šä¹‰ä¸¤æ¬¡onclickå±æ€§ï¼Œåä¸€æ¬¡å®šä¹‰ä¼šè¦†ç›–å‰ä¸€æ¬¡ã€‚å› æ­¤ï¼Œè¿™ä¸¤ç§æ–¹æ³•éƒ½ä¸æ¨èä½¿ç”¨ï¼Œé™¤éæ˜¯ä¸ºäº†ç¨‹åºçš„å…¼å®¹é—®é¢˜ï¼Œå› ä¸ºæ‰€æœ‰æµè§ˆå™¨éƒ½æ”¯æŒè¿™ä¸¤ç§æ–¹æ³•ã€‚\n\naddEventListeneræ˜¯æ¨èçš„æŒ‡å®šç›‘å¬å‡½æ•°çš„æ–¹æ³•ã€‚å®ƒæœ‰å¦‚ä¸‹ä¼˜ç‚¹ï¼š\n\nå¯ä»¥é’ˆå¯¹åŒä¸€ä¸ªäº‹ä»¶ï¼Œæ·»åŠ å¤šä¸ªç›‘å¬å‡½æ•°ã€‚\n\nèƒ½å¤ŸæŒ‡å®šåœ¨å“ªä¸ªé˜¶æ®µï¼ˆæ•è·é˜¶æ®µè¿˜æ˜¯å†’æ³¡é˜¶æ®µï¼‰è§¦å‘å›ç›‘å¬å‡½æ•°ã€‚\n\né™¤äº†DOMèŠ‚ç‚¹ï¼Œè¿˜å¯ä»¥éƒ¨ç½²åœ¨`window`ã€`XMLHttpRequest`ç­‰å¯¹è±¡ä¸Šé¢ï¼Œç­‰äºç»Ÿä¸€äº†æ•´ä¸ªJavaScriptçš„ç›‘å¬å‡½æ•°æ¥å£ã€‚\n\n#### this å¯¹è±¡çš„æŒ‡å‘\n\nä»¥ä¸‹å†™æ³•çš„ `this` å¯¹è±¡éƒ½æŒ‡å‘ Element èŠ‚ç‚¹\n\n```js\nelement.onclick = print\nelement.addEventListener('click',print,false)\nelement.onclick = function(){console.log(this.id)}\n\n<element onclick=\"console.log(this.id)\">\n```\n\nä»¥ä¸‹å†™æ³•çš„ `this` å¯¹è±¡ï¼Œéƒ½æŒ‡å‘å…¨å±€å¯¹è±¡\n\n```js\nelement.onclick = function(){print()}\nelement.setAttribute('onclick','print()')\n\n<element onclick=\"print()\">\n```\n\n### äº‹ä»¶çš„ä¼ æ’­\n\n#### ä¼ æ’­çš„ä¸‰ä¸ªé˜¶æ®µ\n\nç¬¬ä¸€é˜¶æ®µ \n\nä» window å¯¹è±¡ä¼ å¯¼åˆ°ç›®æ ‡èŠ‚ç‚¹ï¼Œç§°ä¸ºã€Œæ•è·ã€é˜¶æ®µ\n\nç¬¬äºŒé˜¶æ®µ\n\nåœ¨ç›®æ ‡èŠ‚ç‚¹è§¦å‘ï¼Œç§°ä¸ºã€Œç›®æ ‡ã€é˜¶æ®µ\n\nç¬¬ä¸‰é˜¶æ®µ\n\nä»ç›®æ ‡èŠ‚ç‚¹ä¼ å¯¼å› window å¯¹è±¡ï¼Œæˆä¸ºã€Œå†’æ³¡ã€é˜¶æ®µ\n\n```html\n<div>\n  <p>Click Me</p>\n</div>\n``` \n\n- æ•è·é˜¶æ®µï¼šäº‹ä»¶ä»`<div>`å‘`<p>`ä¼ æ’­æ—¶ï¼Œè§¦å‘`<div>`çš„`click`äº‹ä»¶ï¼›\n- ç›®æ ‡é˜¶æ®µï¼šäº‹ä»¶ä»`<div>`åˆ°è¾¾`<p>`æ—¶ï¼Œè§¦å‘`<p>`çš„clickäº‹ä»¶ï¼›\n- ç›®æ ‡é˜¶æ®µï¼šäº‹ä»¶ç¦»å¼€`<p>`æ—¶ï¼Œè§¦å‘`<p>`çš„`click`äº‹ä»¶ï¼›\n- å†’æ³¡é˜¶æ®µï¼šäº‹ä»¶ä»`<p>`ä¼ å›`<div>`æ—¶ï¼Œå†æ¬¡è§¦å‘`<div>`çš„`click`äº‹ä»¶\n\nç”¨æˆ·ç‚¹å‡»æ—¶ï¼Œæµè§ˆå™¨æ€»æ˜¯å‡å®š `click` äº‹ä»¶çš„ç›®æ ‡èŠ‚ç‚¹å°±æ˜¯ç‚¹å‡»ä½ç½®çš„åµŒå¥—æœ€æ·±çš„é‚£ä¸ªèŠ‚ç‚¹ã€‚æ‰€ä»¥ `<p>` èŠ‚ç‚¹çš„æ•è·é˜¶æ®µå’Œå†’æ³¡é˜¶æ®µä¼šæ˜¯ `target` é˜¶æ®µ\n\näº‹ä»¶ä¼ æ’­çš„æœ€ä¸Šå±‚å¯¹è±¡æ˜¯ `window` æ¥ç€ä¾æ¬¡æ˜¯ `document` `body` å¦‚æœ `<body>` å…ƒç´ ä¸­æœ‰ä¸€ä¸ª `<div>` å…ƒç´ ,ç‚¹å‡»è¯¥å…ƒç´ ï¼Œåœ¨æ•è·é˜¶æ®µä¸º `window`ã€`document`ã€`html`ã€`body`ã€`div` ï¼Œ åœ¨å†’æ³¡é˜¶æ®µä¾æ¬¡ä¸º `div`ã€`body`ã€`html`ã€`document`ã€`window`ã€‚\n\n#### äº‹ä»¶çš„ä»£ç†\n\nç”±äºäº‹ä»¶ä¼šåœ¨å†’æ³¡é˜¶æ®µå‘ä¸Šä¼ æ’­åˆ°çˆ¶èŠ‚ç‚¹ï¼Œå› æ­¤å¯ä»¥æŠŠå­èŠ‚ç‚¹çš„ç›‘å¬å‡½æ•°å®šä¹‰åœ¨çˆ¶èŠ‚ç‚¹ä¸Šï¼Œç”±çˆ¶èŠ‚ç‚¹çš„ç›‘å¬å‡½æ•°ç»Ÿä¸€å¤„ç†å¤šä¸ªå­å…ƒç´ çš„äº‹ä»¶ã€‚è¿™ç§æ–¹æ³•å«åšäº‹ä»¶çš„ä»£ç†ï¼ˆdelegationï¼‰ã€‚\n\nå¦‚æœå¸Œæœ›äº‹ä»¶åˆ°æŸä¸ªèŠ‚ç‚¹ä¸ºæ­¢ä¸å†ä¼ æ’­ï¼Œå¯ä»¥ä½¿ç”¨äº‹ä»¶å¯¹è±¡çš„ `stopPropagation` æ–¹æ³•ã€‚\nä½†æ˜¯ `stopPropagation` æ–¹æ³•åªä¼šé˜»æ­¢å½“å‰ç›‘å¬å‡½æ•°çš„ä¼ æ’­ï¼Œä¸ä¼šé˜»æ­¢èŠ‚ç‚¹ä¸Šçš„å…¶å®ƒåŒæ ·äº‹ä»¶çš„ç›‘å¬å‡½æ•°ï¼Œå¦‚æœæƒ³è¦ä¸å†è§¦å‘é‚£äº›ç›‘å¬å‡½æ•°ï¼Œå¯ä»¥ä½¿ç”¨ `stopImmediatePropagation` \n\n### Event å¯¹è±¡\n\näº‹ä»¶å‘ç”Ÿä»¥åï¼Œä¼šç”Ÿæˆä¸€ä¸ªäº‹ä»¶å¯¹è±¡ï¼Œä½œä¸ºå‚æ•°ä¼ ç»™ç›‘å¬å‡½æ•°ã€‚æµè§ˆå™¨åŸç”Ÿæä¾›äº†ä¸€ä¸ª `Event` å¯¹è±¡ï¼Œæ‰€æœ‰çš„äº‹ä»¶éƒ½æ˜¯è¿™ä¸ªå¯¹è±¡çš„å®ä¾‹ï¼Œæˆ–è€…è¯´ç»§æ‰¿äº† `Event.prototype` å¯¹è±¡\n\n```js\nevent = new Event(typeArg,eventInit)\n```\n\n`Event`æ„é€ å‡½æ•°æ¥å—ä¸¤ä¸ªå‚æ•°ã€‚ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºäº‹ä»¶çš„åç§°ï¼›ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè¡¨ç¤ºäº‹ä»¶å¯¹è±¡çš„é…ç½®ã€‚è¯¥å‚æ•°å¯ä»¥æœ‰ä»¥ä¸‹ä¸¤ä¸ªå±æ€§ã€‚\n\n- `bubbles`ï¼šå¸ƒå°”å€¼ï¼Œå¯é€‰ï¼Œé»˜è®¤ä¸º`false`ï¼Œè¡¨ç¤ºäº‹ä»¶å¯¹è±¡æ˜¯å¦å†’æ³¡ã€‚\n- `cancelable`ï¼šå¸ƒå°”å€¼ï¼Œå¯é€‰ï¼Œé»˜è®¤ä¸º`false`ï¼Œè¡¨ç¤ºäº‹ä»¶æ˜¯å¦å¯ä»¥è¢«å–æ¶ˆã€‚\n\n#### event å±æ€§\n\n`bubbles` å±æ€§è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºå½“å‰äº‹ä»¶æ˜¯å¦ä¼šå†’æ³¡ã€‚è¯¥å±æ€§ä¸ºåªè¯»å±æ€§ï¼Œåªèƒ½åœ¨æ–°å»ºäº‹ä»¶æ—¶æ”¹å˜ã€‚é™¤éæ˜¾å¼å£°æ˜ï¼ŒEventæ„é€ å‡½æ•°ç”Ÿæˆçš„äº‹ä»¶ï¼Œé»˜è®¤æ˜¯ä¸å†’æ³¡çš„ã€‚\n\n`eventPhase` å±æ€§è¿”å›ä¸€ä¸ªæ•´æ•°å€¼ï¼Œè¡¨ç¤ºäº‹ä»¶ç›®å‰æ‰€å¤„çš„é˜¶æ®µã€‚\n\n- 0ï¼Œäº‹ä»¶ç›®å‰æ²¡æœ‰å‘ç”Ÿã€‚\n- 1ï¼Œäº‹ä»¶ç›®å‰å¤„äºæ•è·é˜¶æ®µï¼Œå³å¤„äºä»ç¥–å…ˆèŠ‚ç‚¹å‘ç›®æ ‡èŠ‚ç‚¹çš„ä¼ æ’­è¿‡ç¨‹ä¸­ã€‚è¯¥è¿‡ç¨‹æ˜¯ä»`Window`å¯¹è±¡åˆ°`Document`èŠ‚ç‚¹ï¼Œå†åˆ°`HTMLHtmlElement`èŠ‚ç‚¹ï¼Œç›´åˆ°ç›®æ ‡èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ä¸ºæ­¢ã€‚\n- 2ï¼Œäº‹ä»¶åˆ°è¾¾ç›®æ ‡èŠ‚ç‚¹ï¼Œå³`target`å±æ€§æŒ‡å‘çš„é‚£ä¸ªèŠ‚ç‚¹ã€‚\n- 3ï¼Œäº‹ä»¶å¤„äºå†’æ³¡é˜¶æ®µï¼Œå³å¤„äºä»ç›®æ ‡èŠ‚ç‚¹å‘ç¥–å…ˆèŠ‚ç‚¹çš„åå‘ä¼ æ’­è¿‡ç¨‹ä¸­ã€‚è¯¥è¿‡ç¨‹æ˜¯ä»çˆ¶èŠ‚ç‚¹ä¸€ç›´åˆ°`Window`å¯¹è±¡ã€‚åªæœ‰`bubbles`å±æ€§ä¸º`true`æ—¶ï¼Œè¿™ä¸ªé˜¶æ®µæ‰å¯èƒ½å‘ç”Ÿã€‚\n\n`cancelable` å±æ€§è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºäº‹ä»¶æ˜¯å¦å¯ä»¥å–æ¶ˆã€‚è¯¥å±æ€§ä¸ºåªè¯»å±æ€§ï¼Œåªèƒ½åœ¨æ–°å»ºäº‹ä»¶æ—¶æ”¹å˜ã€‚é™¤éæ˜¾å¼å£°æ˜ï¼Œ`Event`æ„é€ å‡½æ•°ç”Ÿæˆçš„äº‹ä»¶ï¼Œé»˜è®¤æ˜¯ä¸å¯ä»¥å–æ¶ˆçš„\n\n`defaultPrevented` å±æ€§è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºè¯¥äº‹ä»¶æ˜¯å¦è°ƒç”¨è¿‡ `preventDefault` æ–¹æ³•ã€‚ã€‚\n\n\n#### event.currentTargetï¼Œevent.target\n\n`currentTarget` å±æ€§è¿”å›äº‹ä»¶å½“å‰æ‰€åœ¨çš„èŠ‚ç‚¹ï¼Œå³æ­£åœ¨æ‰§è¡Œçš„ç›‘å¬å‡½æ•°æ‰€ç»‘å®šçš„é‚£ä¸ªèŠ‚ç‚¹ï¼Œ`target` å±æ€§è¿”å›äº‹ä»¶æ­£å‘ç”Ÿçš„èŠ‚ç‚¹\n\n```js\nfunction hide(e){\n  console.log(this === e.target);  // æœ‰å¯èƒ½ä¸æ˜¯true\n  e.target.style.visibility = \"hidden\";\n}\n\n// HTMLä»£ç ä¸º\n// <p id=\"para\">Hello <em>World</em></p>\npara.addEventListener('click', hide, false);\n```\n\nç‚¹å‡» World ä¼šéšè— `<em>` èŠ‚ç‚¹ï¼Œ`event.currentTarget` ä¸º `<p>` ï¼Œ`event.target` ä¸º `<em>` èŠ‚ç‚¹\n\nåœ¨ IE6-IE8 ä¸­ï¼Œè¯¥å±æ€§çš„åå­—ä¸æ˜¯ `target` ï¼Œè€Œæ˜¯ `srcElement`ã€‚\n\n#### event.typeï¼Œevent.detailï¼Œevent.timeStampï¼Œevent.isTrusted\n\n\n`type` å±æ€§è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºäº‹ä»¶ç±»å‹ï¼Œå¤§å°å†™æ•æ„Ÿã€‚\n\n`detail` å±æ€§è¿”å›ä¸€ä¸ªæ•°å€¼ï¼Œè¡¨ç¤ºäº‹ä»¶çš„æŸç§ä¿¡æ¯ã€‚å…·ä½“å«ä¹‰ä¸äº‹ä»¶ç±»å‹æœ‰å…³ï¼Œå¯¹äºé¼ æ ‡äº‹ä»¶ï¼Œè¡¨ç¤ºé¼ æ ‡æŒ‰é”®åœ¨æŸä¸ªä½ç½®æŒ‰ä¸‹çš„æ¬¡æ•°ï¼Œæ¯”å¦‚å¯¹äº`dblclick`äº‹ä»¶ï¼Œ`detail`å±æ€§çš„å€¼æ€»æ˜¯`2`ã€‚\n\n`timeStamp` å±æ€§è¿”å›ä¸€ä¸ªæ¯«ç§’æ—¶é—´æˆ³ï¼Œè¡¨ç¤ºäº‹ä»¶å‘ç”Ÿçš„æ—¶é—´ã€‚\n\n`isTrusted` å±æ€§è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºè¯¥äº‹ä»¶æ˜¯å¦ä¸ºçœŸå®ç”¨æˆ·è§¦å‘ã€‚\n\n#### event.preventDefault()\n\n`preventDefault` æ–¹æ³•å–æ¶ˆæµè§ˆå™¨å¯¹å½“å‰äº‹ä»¶çš„é»˜è®¤è¡Œä¸ºï¼Œæ¯”å¦‚ç‚¹å‡»é“¾æ¥åï¼Œæµè§ˆå™¨è·³è½¬åˆ°æŒ‡å®šé¡µé¢ï¼Œæˆ–è€…æŒ‰ä¸€ä¸‹ç©ºæ ¼é”®ï¼Œé¡µé¢å‘ä¸‹æ»šåŠ¨ä¸€æ®µè·ç¦»ã€‚è¯¥æ–¹æ³•ç”Ÿæ•ˆçš„å‰ææ˜¯ï¼Œäº‹ä»¶å¯¹è±¡çš„`cancelable`å±æ€§ä¸º`true`ï¼Œå¦‚æœä¸º`false`ï¼Œåˆ™è°ƒç”¨è¯¥æ–¹æ³•æ²¡æœ‰ä»»ä½•æ•ˆæœã€‚\n\n#### event.stopPropagation()\n\n`stopPropagation` æ–¹æ³•é˜»æ­¢äº‹ä»¶åœ¨ DOM ä¸­ç»§ç»­ä¼ æ’­ï¼Œé˜²æ­¢å†è§¦å‘å®šä¹‰åœ¨åˆ«çš„èŠ‚ç‚¹ä¸Šçš„ç›‘å¬å‡½æ•°ï¼Œä½†æ˜¯ä¸åŒ…æ‹¬åœ¨å½“å‰èŠ‚ç‚¹ä¸Šæ–°å®šä¹‰çš„äº‹ä»¶ç›‘å¬å‡½æ•°ã€‚\n\n#### event.stopImmediatePropagation()\n\n`stopImmediatePropagation` æ–¹æ³•é˜»æ­¢åŒä¸€ä¸ªäº‹ä»¶çš„å…¶ä»–ç›‘å¬å‡½æ•°è¢«è°ƒç”¨ã€‚\n\n## äº‹ä»¶ç§ç±»\n\n### é¼ æ ‡äº‹ä»¶\n\n#### onclick ,dblclick\n\né¼ æ ‡å•å‡»å®šä¹‰ä¸ºç”¨æˆ·åœ¨åŒä¸€ä¸ªä½ç½®å®Œæˆä¸€æ¬¡ `mousedown` å’Œ `mouseup` åŠ¨ä½œã€‚ ä»–ä»¬çš„è§¦å‘é¡ºåºæ˜¯ `mousedown` é¦–å…ˆè§¦å‘ï¼Œ `mouseup` æ¥ç€è§¦å‘ `click` æœ€åè§¦å‘\n\n`dblclick` äº‹ä»¶å½“ç”¨æˆ·åœ¨ `element`ã€`document`ã€`window` å¯¹è±¡ä¸Šï¼ŒåŒå‡»é¼ æ ‡æ—¶è§¦å‘ã€‚è¯¥äº‹ä»¶ä¼šåœ¨ `mousedown`ã€`mouseup`ã€`click`ä¹‹åè§¦å‘ã€‚\n\n#### mouseup mousedown mousemove\n\n`mouseup` äº‹ä»¶åœ¨é‡Šæ”¾æŒ‰ä¸‹çš„é¼ æ ‡é”®æ—¶è§¦å‘ã€‚\n\n`mousedown` äº‹ä»¶åœ¨æŒ‰ä¸‹é¼ æ ‡é”®æ—¶è§¦å‘ã€‚\n\n`mousemove` äº‹ä»¶å½“é¼ æ ‡åœ¨ä¸€ä¸ªèŠ‚ç‚¹å†…éƒ¨ç§»åŠ¨æ—¶è§¦å‘ã€‚å½“é¼ æ ‡æŒç»­ç§»åŠ¨æ—¶ï¼Œè¯¥äº‹ä»¶ä¼š**è¿ç»­è§¦å‘**ã€‚ä¸ºäº†é¿å…æ€§èƒ½é—®é¢˜ï¼Œå»ºè®®å¯¹è¯¥äº‹ä»¶çš„ç›‘å¬å‡½æ•°åšä¸€äº›é™å®šï¼Œæ¯”å¦‚é™å®šä¸€æ®µæ—¶é—´å†…åªèƒ½è¿è¡Œä¸€æ¬¡ä»£ç ã€‚\n\n#### mouseoverï¼Œmouseenter\n\n`mouseover`äº‹ä»¶å’Œ`mouseenter`äº‹ä»¶ï¼Œéƒ½æ˜¯é¼ æ ‡**è¿›å…¥ä¸€ä¸ªèŠ‚ç‚¹æ—¶è§¦å‘**ã€‚\n\nä¸¤è€…çš„åŒºåˆ«æ˜¯ï¼Œ`mouseenter`äº‹ä»¶åªè§¦å‘ä¸€æ¬¡ï¼Œè€Œåªè¦é¼ æ ‡åœ¨èŠ‚ç‚¹å†…éƒ¨ç§»åŠ¨ï¼Œ`mouseover` äº‹ä»¶ä¼šåœ¨**å­èŠ‚ç‚¹ä¸Šè§¦å‘å¤šæ¬¡**ã€‚\n\n#### mouseoutï¼Œmouseleave \n\n`mouseout` äº‹ä»¶å’Œ `mouseleave` äº‹ä»¶ï¼Œéƒ½æ˜¯é¼ æ ‡ç¦»å¼€ä¸€ä¸ªèŠ‚ç‚¹æ—¶è§¦å‘ã€‚\n\nä¸¤è€…çš„åŒºåˆ«æ˜¯ï¼Œ`mouseout` äº‹ä»¶ä¼šå†’æ³¡ï¼Œ`mouseleave` äº‹ä»¶ä¸ä¼šã€‚å­èŠ‚ç‚¹çš„ `mouseout` äº‹ä»¶ä¼šå†’æ³¡åˆ°çˆ¶èŠ‚ç‚¹ï¼Œè¿›è€Œè§¦å‘çˆ¶èŠ‚ç‚¹çš„ `mouseout` äº‹ä»¶ã€‚`mouseleave` äº‹ä»¶å°±æ²¡æœ‰è¿™ç§æ•ˆæœï¼Œæ‰€ä»¥ç¦»å¼€å­èŠ‚ç‚¹æ—¶ï¼Œä¸ä¼šè§¦å‘çˆ¶èŠ‚ç‚¹çš„ç›‘å¬å‡½æ•°ã€‚\n\n#### contextmenu äº‹ä»¶\n\n`contextmenu` äº‹ä»¶åœ¨ä¸€ä¸ªèŠ‚ç‚¹ä¸Šç‚¹å‡»é¼ æ ‡å³é”®æ—¶è§¦å‘ï¼Œæˆ–è€…æŒ‰ä¸‹ã€Œä¸Šä¸‹æ–‡èœå•ã€é”®æ—¶è§¦å‘ã€‚\n\n### MouseEvent å¯¹è±¡\n\n#### altKeyï¼ŒctrlKeyï¼ŒmetaKeyï¼ŒshiftKey\n\nä»¥ä¸‹å±æ€§è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºé¼ æ ‡äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œæ˜¯å¦åŒæ—¶æŒ‰ä¸‹æŸä¸ªé”®ã€‚\n\n- `altKey` å±æ€§ ï¼šAlt é”®\n- `ctrlKey` å±æ€§ ï¼šCtrl é”®\n- `metaKey` å±æ€§ ï¼šMeta é”®ï¼ˆMacé”®ç›˜æ˜¯ä¸€ä¸ªå››ç“£çš„å°èŠ±ï¼ŒWindowsé”®ç›˜æ˜¯Windowsé”®ï¼‰\n- `shiftKey` å±æ€§ ï¼šShift é”®\n\n#### buttonï¼Œbuttons\n\n`button` å±æ€§è¿”å›ä¸€ä¸ªæ•°å€¼ï¼Œè¡¨ç¤ºæŒ‰ä¸‹äº†é¼ æ ‡å“ªä¸ªé”®ã€‚\n\n- -1ï¼šæ²¡æœ‰æŒ‰ä¸‹é”®ã€‚\n- 0ï¼šæŒ‰ä¸‹ä¸»é”®ï¼ˆé€šå¸¸æ˜¯å·¦é”®ï¼‰ã€‚\n- 1ï¼šæŒ‰ä¸‹è¾…åŠ©é”®ï¼ˆé€šå¸¸æ˜¯ä¸­é”®æˆ–è€…æ»šè½®é”®ï¼‰ã€‚\n- 2ï¼šæŒ‰ä¸‹æ¬¡é”®ï¼ˆé€šå¸¸æ˜¯å³é”®ï¼‰ã€‚\n\n`buttons` å±æ€§è¿”å›ä¸€ä¸ª3ä¸ªæ¯”ç‰¹ä½çš„å€¼ï¼Œè¡¨ç¤º**åŒæ—¶æŒ‰ä¸‹äº†å“ªäº›é”®**ã€‚å®ƒç”¨æ¥å¤„ç†åŒæ—¶æŒ‰ä¸‹å¤šä¸ªé¼ æ ‡é”®çš„æƒ…å†µã€‚\n\n- 1ï¼šäºŒè¿›åˆ¶ä¸º001ï¼Œè¡¨ç¤ºæŒ‰ä¸‹å·¦é”®ã€‚\n- 2ï¼šäºŒè¿›åˆ¶ä¸º010ï¼Œè¡¨ç¤ºæŒ‰ä¸‹å³é”®ã€‚\n- 4ï¼šäºŒè¿›åˆ¶ä¸º100ï¼Œè¡¨ç¤ºæŒ‰ä¸‹ä¸­é”®æˆ–æ»šè½®é”®ã€‚\n\nåŒæ—¶æŒ‰ä¸‹å¤šä¸ªé”®çš„æ—¶å€™ï¼Œæ¯ä¸ªæŒ‰ä¸‹çš„é”®å¯¹åº”çš„æ¯”ç‰¹ä½éƒ½ä¼šæœ‰å€¼ã€‚æ¯”å¦‚ï¼ŒåŒæ—¶æŒ‰ä¸‹å·¦é”®å’Œå³é”®ï¼Œä¼šè¿”å›3ï¼ˆäºŒè¿›åˆ¶ä¸º011ï¼‰ã€‚\n\n#### clientXï¼ŒclientY\n\n`clientX`ï¼Œ`clientY` å±æ€§è¿”å›é¼ æ ‡ä½ç½®ç›¸å¯¹äºæµè§ˆå™¨çª—å£å·¦ä¸Šè§’çš„æ°´å¹³å‚ç›´åæ ‡ï¼Œå•ä½ä¸ºåƒç´ ï¼Œä¸é¡µé¢æ˜¯å¦æ¨ªå‘æ»šåŠ¨æ— å…³ã€‚\n\n#### movementXï¼ŒmovementY\n\n`movementX` å±æ€§è¿”å›ä¸€ä¸ªæ°´å¹³ä½ç§»ï¼Œå•ä½ä¸ºåƒç´ ï¼Œè¡¨ç¤ºå½“å‰ä½ç½®ä¸ä¸Šä¸€ä¸ª `mousemove` äº‹ä»¶ä¹‹é—´çš„æ°´å¹³è·ç¦»ã€‚åœ¨æ•°å€¼ä¸Šï¼Œç­‰äº `currentEvent.movementX` = `currentEvent.screenX` - `previousEvent.screenX`ã€‚\n\n#### screenXï¼ŒscreenY\n\n`screenX`ï¼Œ`screenY` å±æ€§è¿”å›é¼ æ ‡ä½ç½®ç›¸å¯¹äºå±å¹•å·¦ä¸Šè§’çš„æ°´å¹³åæ ‡ï¼Œå•ä½ä¸ºåƒç´ ã€‚\n\n### Wheel äº‹ä»¶\n\n`Wheel` äº‹ä»¶æ˜¯ä¸é¼ æ ‡æ»šè½®ç›¸å…³çš„äº‹ä»¶ï¼Œç›®å‰åªæœ‰ä¸€ä¸ª `Wheel` äº‹ä»¶ã€‚ç”¨æˆ·æ»šåŠ¨æ»šè½®ï¼Œè§¦å‘æ­¤äº‹ä»¶\n\nè¯¥äº‹ä»¶ç»§æ‰¿äº† MouseEvent ï¼ŒUIEvent ï¼ŒEvent å±æ€§ ï¼Œè¿˜æœ‰å‡ ä¸ªè‡ªå·±çš„å±æ€§\n\n- deltaX : è¿”å›ä¸€ä¸ªæ•°å€¼ï¼Œè¡¨ç¤ºä¸€ä¸ªæ»šè½®çš„æ°´å¹³æ»šåŠ¨é‡\n- deltxY : è¿”å›ä¸€ä¸ªæ•°å€¼ï¼Œè¡¨ç¤ºä¸€ä¸ªæ»šè½®çš„å‚ç›´æ»šåŠ¨é‡\n- deltxZ : è¿”å›ä¸€ä¸ªæ•°å€¼ï¼Œè¡¨ç¤ºä¸€ä¸ªæ»šè½®çš„Zè½´æ»šåŠ¨é‡\n- deltaMode : è¿”å›ä¸€ä¸ªæ•°å€¼ï¼Œè¡¨ç¤ºä¸€ä¸ªå•ä½ã€‚0ä¸ºåƒç´ ï¼Œ1è¡¨ç¤ºè¡Œï¼Œ2è¡¨ç¤ºé¡µ\n\n### é”®ç›˜äº‹ä»¶\n\n- keydown : æŒ‰ä¸‹é”®ç›˜æ—¶è§¦å‘çš„äº‹ä»¶\n- keypress : åªè¦æŒ‰ä¸‹çš„é”®å¹¶é Ctrl ï¼Œ Alt ï¼ŒShift å’Œ Meta ï¼Œå°±æ¥ç€è§¦å‘ keypress äº‹ä»¶\n- keyup : æ¾å¼€é”®ç›˜æ—¶è§¦å‘è¯¥äº‹ä»¶\n\nå¦‚æœç”¨æˆ·ä¸€ç›´æŒ‰é”®ä¸æ¾å¼€ï¼Œå°±ä¼šè¿ç»­è§¦å‘é”®ç›˜äº‹ä»¶ï¼Œè§¦å‘çš„äº‹ä»¶å¦‚ä¸‹\n\n- keydown\n- keypress\n- keydown\n- keypress\n- ã€Œé‡å¤ä»¥ä¸Šè¿‡ç¨‹ã€\n- keyup\n\nkeyBoard äº‹ä»¶è¿˜æœ‰å‡ ä¸ªå¯é…ç½®å­—æ®µ\n\n- key : é»˜è®¤ä¸ºç©ºå­—ç¬¦ä¸²ï¼Œè¿”å›æŒ‰ä¸‹çš„é”®çš„å­—ç¬¦ä¸²\n- ctrlKey : æ˜¯å¦æŒ‰ä¸‹ ctrl é”®\n- shiftKey : æ˜¯å¦æŒ‰ä¸‹ shift é”®\n- altKey : æ˜¯å¦æŒ‰ä¸‹ alt é”®\n- metaKey : æ˜¯å¦æŒ‰ä¸‹ meta é”®\n- charCode : è¿”å›ä¸€ä¸ªæ•°å€¼ï¼Œè¡¨ç¤ºkeypressæŒ‰é”®çš„Unicodeå€¼ï¼Œè¯¥å±æ€§å·²ä»æ ‡å‡†ä¸­ç§»é™¤\n\n### è¿›åº¦äº‹ä»¶\n\n- abort : å½“è¿›åº¦äº‹ä»¶è¢«ä¸­æ­¢æ—¶è§¦å‘ã€‚å¦‚æœå‘ç”Ÿé”™è¯¯ï¼Œå¯¼è‡´äº‹ä»¶ä¸­æ­¢ï¼Œä¸ä¼šè§¦å‘è¯¥äº‹ä»¶\n- error : ç”±äºé”™è¯¯å¯¼è‡´èµ„æºæ— æ³•åŠ è½½æ—¶è§¦å‘\n- load : è¿›åº¦æˆåŠŸç»“æŸæ—¶è§¦å‘\n- loadstart : è¿›åº¦å¼€å§‹æ—¶è§¦å‘\n- loadend : è¿›åº¦åœæ­¢æ—¶è§¦å‘ï¼Œå‘ç”Ÿé¡ºåºåœ¨ `error` äº‹ä»¶ã€ `abort` äº‹ä»¶ã€`load` äº‹ä»¶åé¢\n- progress : å½“æ“ä½œå¤„äºè¿›åº¦ä¹‹ä¸­ï¼Œç”±ä¼ è¾“çš„æ•°æ®å—ä¸æ–­è§¦å‘\n- timeout : è¿›åº¦è¶…è¿‡é™æ—¶è§¦å‘\n\n\næœ‰æ—¶å€™ï¼Œå›¾ç‰‡åŠ è½½ä¼šåœ¨è„šæœ¬è¿è¡Œä¹‹å‰å°±å®Œæˆï¼Œå°¤å…¶æ˜¯è„šæœ¬æ”¾ç½®åœ¨ç½‘é¡µåº•éƒ¨çš„æ—¶å€™ï¼Œå› æ­¤æœ‰å¯èƒ½ä½¿å¾— `load` å’Œ `error` äº‹ä»¶çš„ç›‘å¬å‡½æ•°æ ¹æœ¬ä¸ä¼šæ‰§è¡Œï¼Œ`error` äº‹ä»¶çš„ç›‘å¬å‡½æ•°æœ€å¥½æ”¾åœ¨ `img` å…ƒç´ çš„ HTML å±æ€§ä¸­ï¼Œè¿™æ ·æ‰èƒ½ä¿è¯å‘ç”Ÿé”™è¯¯æ—¶ç™¾åˆ†ä¹‹ç™¾æ‰§è¡Œã€‚`error` äº‹ä»¶ä¹Ÿä¸ä¼šå†’æ³¡\n\n`progress` äº‹ä»¶ä¹Ÿæœ‰å‡ ä¸ªå±æ€§\n\n- lenthComputable : è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºå½“å‰è¿›åº¦æ˜¯å¦å…·æœ‰å¯è®¡ç®—çš„é•¿åº¦ï¼Œå¦‚æœä¸º `false` ï¼Œå°±è¡¨ç¤ºå½“å‰è¿›åº¦æ— æ³•æµ‹é‡\n- total : è¿”å›ä¸€ä¸ªæ•°å€¼ï¼Œè¡¨ç¤ºå½“å‰è¿›åº¦çš„æ€»é•¿åº¦ï¼Œå¦‚æœæ˜¯é€šè¿‡ HTTP ä¸‹è½½æŸä¸ªèµ„æºï¼Œè¡¨ç¤ºå†…å®¹æœ¬èº«çš„é•¿åº¦ï¼Œä¸å« HTTP å¤´éƒ¨çš„é•¿åº¦ã€‚å¦‚æœ `lengthComputable` å±æ€§ä¸º `false` ï¼Œåˆ™ `total` å±æ€§å°±æ— æ³•å»çš„æ­£ç¡®çš„å€¼\n- loaded : è¿”å›ä¸€ä¸ªæ•°å€¼ï¼Œè¡¨ç¤ºå½“å‰è¿›åº¦å·²ç»å®Œæˆçš„æ•°é‡ã€‚è¯¥å±æ€§é™¤ä»¥ `total` å±æ€§å°±å¯ä»¥å¾—åˆ°ç›®å‰è¿›åº¦çš„ç™¾åˆ†æ¯”\n\n### æ‹–æ‹‰äº‹ä»¶\n\næ‹–æ‹‰æŒ‡çš„æ˜¯ï¼Œç”¨æˆ·åœ¨æŸä¸ªå¯¹è±¡ä¸ŠæŒ‰ä¸‹é¼ æ ‡é”®ä¸æ”¾ï¼Œæ‹–åŠ¨å®ƒåˆ°å¦ä¸€ä¸ªä½ç½®ï¼Œç„¶åé‡Šæ”¾é¼ æ ‡é”®ï¼Œå°†è¯¥å¯¹è±¡æ”¾åœ¨é‚£é‡Œ\n\nå›¾ç‰‡å’Œé“¾æ¥ä¸åŠ æœ¬èº«å°±å¯ä»¥æ‹–åŠ¨ï¼Œ`Element` èŠ‚ç‚¹éœ€è¦è®¾ç½® `draggable` å±æ€§ä¸º `true` ï¼Œä½†æ˜¯è¿™æ ·é¼ æ ‡å°±æ— æ³•é€‰ä¸­è¯¥å­—èŠ‚å†…éƒ¨çš„æ–‡å­—å’Œå­èŠ‚äº†\n\n#### äº‹ä»¶ç§ç±»\n\nå½“ `Element` èŠ‚ç‚¹æˆ–é€‰ä¸­çš„æ–‡æœ¬è¢«æ‹–æ‹‰æ—¶ï¼Œå°±ä¼šæŒç»­è§¦å‘æ‹–æ‹‰äº‹ä»¶ï¼ŒåŒ…æ‹¬ä»¥ä¸‹ä¸€äº›äº‹ä»¶\n\nåœ¨æ‹–æ‹‰èŠ‚ç‚¹ä¸Šè§¦å‘çš„äº‹ä»¶\n\n- dragäº‹ä»¶ ï¼š æ‹–æ‹‰è¿‡ç¨‹ä¸­ï¼Œåœ¨è¢«æ‹–æ‹‰çš„èŠ‚ç‚¹ä¸ŠæŒç»­è§¦å‘\n- dragstartäº‹ä»¶ ï¼šæ‹–æ‹‰å¼€å§‹æ—¶è§¦å‘ï¼Œè¯¥äº‹ä»¶çš„ `target` å±æ€§æ˜¯è¢«æ‹–æ‹‰çš„èŠ‚ç‚¹\n- dragendäº‹ä»¶ ï¼š åœ¨æ‹–æ‹‰ç»“æŸæ—¶è§¦å‘\n\nåœ¨ç›®æ ‡èŠ‚ç‚¹ä¸Šè§¦å‘çš„äº‹ä»¶\n\n- dragenteräº‹ä»¶ ï¼š æ‹–æ‹‰è¿›å…¥å½“å‰èŠ‚ç‚¹æ—¶è§¦å‘\n- dragoveräº‹ä»¶ ï¼šæ‹–æ‹‰åˆ°å½“å‰èŠ‚ç‚¹ä¸Šæ–¹æ—¶æŒç»­è§¦å‘\n- dragleaveäº‹ä»¶ ï¼šæ‹–æ‹‰ç¦»å¼€å½“å‰èŒƒå›´èŠ‚ç‚¹æ—¶è§¦å‘\n- dropäº‹ä»¶ ï¼šè¢«æ‹–æ‹‰çš„èŠ‚ç‚¹é‡Šæ”¾ï¼Œç›®æ ‡èŠ‚ç‚¹è§¦å‘\n\n**æ³¨æ„**\n\n- æ‹–æ‹‰è¿‡ç¨‹åªè§¦å‘ä»¥ä¸Šè¿™äº›æ‹–æ‹‰äº‹ä»¶ï¼Œå°½ç®¡é¼ æ ‡åœ¨ç§»åŠ¨ï¼Œä½†æ˜¯é¼ æ ‡äº‹ä»¶ä¸ä¼šè§¦å‘\n- å°†æ–‡ä»¶ä»æ“ä½œç³»ç»Ÿæ‹–æ‹‰è¿›æµè§ˆå™¨ï¼Œä¸ä¼šè§¦å‘ `dragstart` å’Œ `dragend` äº‹ä»¶\n- `dragenter` å’Œ `dragover` äº‹ä»¶é»˜è®¤è®¾ç½®ä¸ºå½“å‰èŠ‚ç‚¹ä¸å…è®¸dropï¼Œå¦‚æœæƒ³è¦åœ¨ç›®æ ‡èŠ‚ç‚¹ä¸Š `drop` æ‹–æ‹‰çš„æ•°æ®ï¼Œé¦–å…ˆå¿…é¡»é˜»æ­¢è¿™ä¸¤ä¸ªäº‹ä»¶çš„é»˜è®¤è¡Œä¸ºï¼Œæˆ–è€…å–æ¶ˆè¿™ä¸¤ä¸ªäº‹ä»¶\n\n```html\n<div ondragover=\"event.preventDefault()\"></div>\n```\n\n#### DataTransfer å¯¹è±¡æ¦‚è¿°\n\næ‰€æœ‰çš„æ‹–æ‹‰äº‹ä»¶éƒ½æœ‰ä¸€ä¸ª dataTransfer å±æ€§ï¼Œç”¨æ¥ä¿å­˜éœ€è¦ä¼ é€’çš„æ•°æ®ã€‚è¿™ä¸ªå±æ€§çš„å€¼æ˜¯ä¸€ä¸ª DataTransfer å¯¹è±¡\n\næ‹–æ‹‰çš„æ•°æ®ä¿å­˜ä¸¤æ–¹é¢çš„æ•°æ®ï¼Œæ•°æ®çš„ç§ç±»å’Œæ•°æ®çš„æ•°å€¼ï¼Œç§ç±»æ˜¯ä¸€ä¸ªMIMEå­—ç¬¦ä¸²ï¼Œæ•°æ®çš„å€¼æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²\n\næ‹–æ‹‰å¼€å§‹æ—¶æä¾›æ•°æ®ç±»å‹å’Œæ•°æ®å€¼ï¼Œ`dragenter` å’Œ `dragover` äº‹ä»¶æ£€æŸ¥æ•°æ®ï¼Œä»¥ç¡®å®šæ˜¯å¦å‡†è®¸æ”¾ä¸‹ã€‚\n\n#### DataTransfer å¯¹è±¡çš„å±æ€§\n\n**dropEffect**\n\nè®¾ç½®æ”¾ä¸‹è¢«æ‹–æ‹‰èŠ‚ç‚¹æ—¶çš„æ•ˆæœ\n\n- copy å¤åˆ¶è¢«æ‹–æ‹‰çš„èŠ‚ç‚¹\n- move ç§»åŠ¨è¢«æ‹–æ‹‰çš„èŠ‚ç‚¹\n- link åˆ›å»ºæŒ‡å‘è¢«æ‹–æ‹‰çš„èŠ‚ç‚¹çš„é“¾æ¥\n- none æ— æ³•æ”¾ä¸‹è¢«æ‹–æ‹‰çš„èŠ‚ç‚¹\n\nä¸€èˆ¬åœ¨ `dragenter` å’Œ `dragover` äº‹ä»¶çš„ç›‘å¬å‡½æ•°ä¸­è®¾ç½®ï¼Œå¯¹äº `dragstart`ã€`drag`ã€`dragleave` è¿™ä¸‰ä¸ªäº‹ä»¶ï¼Œè¯¥å±æ€§ä¸èµ·ä½œç”¨ã€‚è¿›å…¥ç›®æ ‡èŠ‚ç‚¹åï¼Œç”¨æˆ·å¯é€šè¿‡Shifté”®å’ŒControlé”®ï¼Œæ”¹å˜åˆå§‹å€¼\n\nç®­å¤´ä¼šæ ¹æ® `dropEffect` å±æ€§æ”¹å˜å½¢çŠ¶\n\n**effectAllowed**\n\n`effectAllowed` å±æ€§è®¾ç½®æœ¬æ¬¡æ‹–æ‹‰ä¸­å…è®¸çš„æ•ˆæœ\n\n- copy å¤åˆ¶è¢«æ‹–æ‹‰çš„èŠ‚ç‚¹\n- move ç§»åŠ¨è¢«æ‹–æ‹‰çš„èŠ‚ç‚¹\n- link åˆ›å»ºæŒ‡å‘è¢«æ‹–æ‹‰èŠ‚ç‚¹çš„é“¾æ¥\n- copyLink å…è®¸copyæˆ–link\n- copyMove å…è®¸copyæˆ–move\n- linkMove å…è®¸linkæˆ–move\n- all å…è®¸æ‰€æœ‰æ•ˆæœ\n- none æ— æ³•æ”¾ä¸‹è¢«æ‹–æ‹‰çš„èŠ‚ç‚¹\n- uninitialized é»˜è®¤å€¼ï¼Œç­‰åŒäºall\n\nåªè¦ `dropEffect` å±æ€§å’Œ `effectAllowed` å±æ€§ä¹‹ä¸­ï¼Œæœ‰ä¸€ä¸ªä¸ºnoneï¼Œå°±æ— æ³•åœ¨ç›®æ ‡èŠ‚ç‚¹å®Œæˆ  `drop` æ“ä½œ\n\n**files**\n\n`files` å±æ€§æ˜¯ä¸€ä¸ª FileList å¯¹è±¡ï¼Œå¦‚æœæœ¬æ¬¡æ‹–æ‹‰ä¸æ¶‰åŠæ–‡ä»¶ï¼Œåˆ™å±æ€§ä¸ºç©ºçš„ FileList å¯¹è±¡\n\né€šè¿‡ `files` å±æ€§è¯»å–æ‹–æ‹‰æ–‡ä»¶çš„ä¿¡æ¯ï¼Œå¦‚æœæƒ³è¦è¯»å–æ–‡ä»¶çš„å†…å®¹ï¼Œè¦ä½¿ç”¨ FileReader å¯¹è±¡\n\n**types**\n\n`types` å±æ€§æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œä¿å­˜æ¯ä¸€æ¬¡æ‹–æ‹‰çš„æ•°æ®æ ¼å¼ï¼Œæ¯”å¦‚æ‹–æ‹‰æ–‡ä»¶ï¼Œåˆ™æ ¼å¼ä¿¡æ¯ä¸ºFile\n\n#### DataTransfer å¯¹è±¡çš„æ–¹æ³•\n\n**setData()**\n\n`setData` æ–¹æ³•ç”¨æ¥è®¾ç½®äº‹ä»¶æ‰€å¸¦æœ‰çš„æŒ‡å®šç±»å‹çš„æ•°æ®ã€‚å®ƒæ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯æ•°æ®ç±»å‹ï¼Œç¬¬äºŒä¸ªæ˜¯å…·ä½“æ•°æ®ã€‚å¦‚æœæŒ‡å®šçš„ç±»å‹åœ¨ç°æœ‰æ•°æ®ä¸­ä¸å­˜åœ¨ï¼Œåˆ™è¯¥ç±»å‹å°†å†™å…¥ `types` å±æ€§ï¼›å¦‚æœå·²ç»å­˜åœ¨ï¼Œåœ¨è¯¥ç±»å‹çš„ç°æœ‰æ•°æ®å°†è¢«æ›¿æ¢ã€‚\n\nå¦‚æœæ‹–æ‹‰æ–‡æœ¬æ¡†æˆ–è€…æ‹–æ‹‰é€‰ä¸­çš„æ–‡æœ¬ï¼Œä¼šé»˜è®¤å°†æ–‡æœ¬æ•°æ®æ·»åŠ åˆ° `dataTransfer` å±æ€§ï¼Œä¸ç”¨æ‰‹åŠ¨æŒ‡å®šã€‚\n\n```html\n<div draggable=\"true\" ondragstart=\"\n  event.dataTransfer.setData('text/plain', 'bbb')\">\n  aaa\n</div>\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œæ‹–æ‹‰æ•°æ®å®é™…ä¸Šæ˜¯ bbb ï¼Œè€Œä¸æ˜¯ aaa\n\nç”±äº `text/plain` æ˜¯æœ€æ™®éæ”¯æŒçš„æ ¼å¼ï¼Œä¸ºäº†ä¿è¯å…¼å®¹æ€§ï¼Œå»ºè®®æœ€åæ€»æ˜¯å°†æ•°æ®ä¿å­˜ä¸€ä»½çº¯æ–‡æœ¬çš„æ ¼å¼ã€‚\n\n```js\nvar dt = event.dataTransfer;\n\n// æ·»åŠ é“¾æ¥\ndt.setData(\"text/uri-list\", \"http://www.example.com\");\ndt.setData(\"text/plain\", \"http://www.example.com\");\n// æ·»åŠ HTMLä»£ç \ndt.setData(\"text/html\", \"Hello there, <strong>stranger</strong>\");\ndt.setData(\"text/plain\", \"Hello there, <strong>stranger</strong>\");\n// æ·»åŠ å›¾åƒçš„URL\ndt.setData(\"text/uri-list\", imageurl);\ndt.setData(\"text/plain\", imageurl);\n```\n\n**getData()**\n\n`getData` æ–¹æ³•æ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²ï¼ˆè¡¨ç¤ºæ•°æ®ç±»å‹ï¼‰ä½œä¸ºå‚æ•°ï¼Œè¿”å›äº‹ä»¶æ‰€å¸¦çš„æŒ‡å®šç±»å‹çš„æ•°æ®ï¼ˆé€šå¸¸æ˜¯ç”¨ `setData` æ–¹æ³•æ·»åŠ çš„æ•°æ®ï¼‰ã€‚å¦‚æœæŒ‡å®šç±»å‹çš„æ•°æ®ä¸å­˜åœ¨ï¼Œåˆ™è¿”å›ç©ºå­—ç¬¦ä¸²ã€‚é€šå¸¸åªæœ‰ `drop` äº‹ä»¶è§¦å‘åï¼Œæ‰èƒ½å–å‡ºæ•°æ®ã€‚å¦‚æœå–å‡ºå¦ä¸€ä¸ªåŸŸåå­˜æ”¾çš„æ•°æ®ï¼Œå°†ä¼šæŠ¥é”™ã€‚\n\n**clearData()**\n\n`clearData` æ–¹æ³•æ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²ï¼ˆè¡¨ç¤ºæ•°æ®ç±»å‹ï¼‰ä½œä¸ºå‚æ•°ï¼Œåˆ é™¤äº‹ä»¶æ‰€å¸¦çš„æŒ‡å®šç±»å‹çš„æ•°æ®ã€‚å¦‚æœæ²¡æœ‰æŒ‡å®šç±»å‹ï¼Œåˆ™åˆ é™¤æ‰€æœ‰æ•°æ®ã€‚å¦‚æœæŒ‡å®šç±»å‹ä¸å­˜åœ¨ï¼Œåˆ™åŸæ•°æ®ä¸å—å½±å“ã€‚\n\n**setDragImage()**\n\næ‹–åŠ¨è¿‡ç¨‹ä¸­ï¼ˆ `dragstart` äº‹ä»¶è§¦å‘åï¼‰ï¼Œæµè§ˆå™¨ä¼šæ˜¾ç¤ºä¸€å¼ å›¾ç‰‡è·Ÿéšé¼ æ ‡ä¸€èµ·ç§»åŠ¨ï¼Œè¡¨ç¤ºè¢«æ‹–åŠ¨çš„èŠ‚ç‚¹ã€‚è¿™å¼ å›¾ç‰‡æ˜¯è‡ªåŠ¨åˆ›é€ çš„ï¼Œé€šå¸¸æ˜¾ç¤ºä¸ºè¢«æ‹–åŠ¨èŠ‚ç‚¹çš„å¤–è§‚ï¼Œä¸éœ€è¦è‡ªå·±åŠ¨æ‰‹è®¾ç½® ã€‚`setDragImage` æ–¹æ³•å¯ä»¥ç”¨æ¥è‡ªå®šä¹‰è¿™å¼ å›¾ç‰‡ï¼Œå®ƒæ¥å—ä¸‰ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯`img` å›¾ç‰‡å…ƒç´ æˆ–è€… `canvas` å…ƒç´ ï¼Œå¦‚æœçœç•¥æˆ–ä¸º `null` åˆ™ä½¿ç”¨è¢«æ‹–åŠ¨çš„èŠ‚ç‚¹çš„å¤–è§‚ï¼Œç¬¬äºŒä¸ªå’Œç¬¬ä¸‰ä¸ªå‚æ•°ä¸ºé¼ æ ‡ç›¸å¯¹äºè¯¥å›¾ç‰‡å·¦ä¸Šè§’çš„æ¨ªåæ ‡å’Œå³åæ ‡ã€‚\n\n```js\ndiv.addEventListener('dragstart',function(e){\n  var img = document.createElement(\"img\");\n  img.src=\"http://path/to/img\";\n  e.dataTransfer.setDragImage(img,0,0);\n},false)\n```\n\n### è§¦æ‘¸äº‹ä»¶\n\nTouch å¯¹è±¡è¡¨ç¤ºè§¦æ‘¸ç‚¹ï¼Œå¤šä¸ªè§¦æ‘¸ç‚¹ç”± TouchList å¯¹è±¡è¡¨ç¤ºï¼ŒTouchEvent å¯¹è±¡ä»£è¡¨ç”±è§¦æ‘¸å¼•å‘çš„äº‹ä»¶ã€‚\n\nå¾ˆå¤šæ—¶å€™ï¼Œè§¦æ‘¸äº‹ä»¶å’Œé¼ æ ‡äº‹ä»¶åŒæ—¶è§¦å‘ï¼Œå³ä½¿è¿™ä¸ªæ—¶å€™å¹¶æ²¡æœ‰ç”¨åˆ°é¼ æ ‡ã€‚è¿™æ˜¯ä¸ºäº†è®©é‚£äº›åªå®šä¹‰é¼ æ ‡äº‹ä»¶ã€æ²¡æœ‰å®šä¹‰è§¦æ‘¸äº‹ä»¶çš„ä»£ç ï¼Œåœ¨è§¦æ‘¸å±çš„æƒ…å†µä¸‹ä»ç„¶èƒ½ç”¨ã€‚å¦‚æœæƒ³é¿å…è¿™ç§æƒ…å†µï¼Œå¯ä»¥ç”¨ `preventDefault` æ–¹æ³•é˜»æ­¢å‘å‡ºé¼ æ ‡äº‹ä»¶ã€‚\n\n#### Touch å¯¹è±¡\n\nTouch å¯¹è±¡ä»£è¡¨ä¸€ä¸ªè§¦æ‘¸ç‚¹\n\n**identifier**\n\n`identifier` å±æ€§è¡¨ç¤º `Touch` å®ä¾‹çš„ç‹¬ä¸€æ— äºŒçš„è¯†åˆ«ç¬¦ã€‚å®ƒåœ¨æ•´ä¸ªè§¦æ‘¸è¿‡ç¨‹ä¸­ä¿æŒä¸å˜ã€‚\n\n**screenXï¼ŒscreenYï¼ŒclientXï¼ŒclientYï¼ŒpageXï¼ŒpageY**\n\n`screenX` å±æ€§å’Œ `screenY` å±æ€§ï¼Œåˆ†åˆ«è¡¨ç¤ºè§¦æ‘¸ç‚¹ç›¸å¯¹äºå±å¹•å·¦ä¸Šè§’çš„æ¨ªåæ ‡å’Œçºµåæ ‡ï¼Œä¸é¡µé¢æ˜¯å¦æ»šåŠ¨æ— å…³ã€‚\n\n`clientX` å±æ€§å’Œ `clientY` å±æ€§ï¼Œåˆ†åˆ«è¡¨ç¤ºè§¦æ‘¸ç‚¹ç›¸å¯¹äºæµè§ˆå™¨è§†å£å·¦ä¸Šè§’çš„æ¨ªåæ ‡å’Œçºµåæ ‡ï¼Œä¸é¡µé¢æ˜¯å¦æ»šåŠ¨æ— å…³ã€‚\n\n`pageX` å±æ€§å’Œ `pageY` å±æ€§ï¼Œåˆ†åˆ«è¡¨ç¤ºè§¦æ‘¸ç‚¹ç›¸å¯¹äºå½“å‰é¡µé¢å·¦ä¸Šè§’çš„æ¨ªåæ ‡å’Œçºµåæ ‡ï¼ŒåŒ…å«äº†é¡µé¢æ»šåŠ¨å¸¦æ¥çš„ä½ç§»ã€‚\n\n**radiusXï¼ŒradiusYï¼ŒrotationAngle**\n\n`radiusX` å±æ€§å’Œ `radiusY` å±æ€§ï¼Œåˆ†åˆ«è¿”å›è§¦æ‘¸ç‚¹å‘¨å›´å—åˆ°å½±å“çš„æ¤­åœ†èŒƒå›´çš„Xè½´å’ŒYè½´ï¼Œå•ä½ä¸ºåƒç´ ã€‚\n\n`rotationAngle` å±æ€§è¡¨ç¤ºè§¦æ‘¸åŒºåŸŸçš„æ¤­åœ†çš„æ—‹è½¬è§’åº¦ï¼Œå•ä½ä¸ºåº¦æ•°ï¼Œåœ¨0åˆ°90åº¦ä¹‹é—´ã€‚\n\nä¸Šé¢è¿™ä¸‰ä¸ªå±æ€§å…±åŒå®šä¹‰äº†ç”¨æˆ·ä¸å±å¹•æ¥è§¦çš„åŒºåŸŸï¼Œå¯¹äºæè¿°æ‰‹æŒ‡è¿™ä¸€ç±»éç²¾ç¡®çš„è§¦æ‘¸ï¼Œå¾ˆæœ‰å¸®åŠ©ã€‚æŒ‡å°–æ¥è§¦å±å¹•ï¼Œè§¦æ‘¸èŒƒå›´ä¼šå½¢æˆä¸€ä¸ªæ¤­åœ†ï¼Œè¿™ä¸‰ä¸ªå±æ€§å°±ç”¨æ¥æè¿°è¿™ä¸ªæ¤­åœ†åŒºåŸŸã€‚\n\n**force**\n\n`force `å±æ€§è¿”å›ä¸€ä¸ª0åˆ°1ä¹‹é—´çš„æ•°å€¼ï¼Œè¡¨ç¤ºè§¦æ‘¸å‹åŠ›ã€‚0ä»£è¡¨æ²¡æœ‰å‹åŠ›ï¼Œ1ä»£è¡¨ç¡¬ä»¶æ‰€èƒ½è¯†åˆ«çš„æœ€å¤§å‹åŠ›ã€‚\n\n**target**\n\n`target` å±æ€§è¿”å›ä¸€ä¸ªElementèŠ‚ç‚¹ï¼Œä»£è¡¨è§¦æ‘¸å‘ç”Ÿçš„é‚£ä¸ªèŠ‚ç‚¹ã€‚\n\n#### TouchList å¯¹è±¡\n\n`TouchList` å¯¹è±¡æ˜¯ä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼Œæˆå‘˜æ˜¯ä¸æŸä¸ªè§¦æ‘¸äº‹ä»¶ç›¸å…³çš„æ‰€æœ‰è§¦æ‘¸ç‚¹ã€‚\n\n`TouchList` å®ä¾‹çš„ `identifiedTouch` æ–¹æ³•å’Œ `item` æ–¹æ³•ï¼Œåˆ†åˆ«ä½¿ç”¨idå±æ€§å’Œç´¢å¼•å€¼ï¼ˆä»0å¼€å§‹ï¼‰ä½œä¸ºå‚æ•°ï¼Œå–å‡ºæŒ‡å®šçš„ `Touch` å¯¹è±¡ã€‚\n\n#### TouchEvent å¯¹è±¡\n\n**é”®ç›˜ç›¸å…³å±æ€§**\n\n- altKey æ˜¯å¦æŒ‰ä¸‹alté”®\n- ctrlKey æ˜¯å¦æŒ‰ä¸‹ctrlé”®\n- metaKey æ˜¯å¦æŒ‰ä¸‹metaé”®\n- shiftKey æ˜¯å¦æŒ‰ä¸‹shifté”®\n\n**changedTouches**\n\n`changedTouches` å±æ€§è¿”å›ä¸€ä¸ª `TouchList` å¯¹è±¡ï¼ŒåŒ…å«äº†ç”±å½“å‰è§¦æ‘¸äº‹ä»¶å¼•å‘çš„æ‰€æœ‰ `Touch` å¯¹è±¡ï¼ˆå³ç›¸å…³çš„è§¦æ‘¸ç‚¹ï¼‰ã€‚\n\n**targetTouches**\n\n`targetTouches` å±æ€§è¿”å›ä¸€ä¸ª `TouchList` å¯¹è±¡ï¼ŒåŒ…å«äº†è§¦æ‘¸çš„ç›®æ ‡ElementèŠ‚ç‚¹å†…éƒ¨ï¼Œæ‰€æœ‰ä»ç„¶å¤„äºæ´»åŠ¨çŠ¶æ€çš„è§¦æ‘¸ç‚¹ã€‚\n\n**touches**\n\n`touches` å±æ€§è¿”å›ä¸€ä¸ª `TouchList` å¯¹è±¡ï¼ŒåŒ…å«äº†æ‰€æœ‰ä»ç„¶å¤„äºæ´»åŠ¨çŠ¶æ€çš„è§¦æ‘¸ç‚¹ã€‚\n\n#### è§¦æ‘¸äº‹ä»¶çš„ç§ç±»\n\n- touchstartï¼šç”¨æˆ·æ¥è§¦è§¦æ‘¸å±æ—¶è§¦å‘ï¼Œå®ƒçš„targetå±æ€§è¿”å›å‘ç”Ÿè§¦æ‘¸çš„ElementèŠ‚ç‚¹ã€‚\n- touchendï¼šç”¨æˆ·ä¸å†æ¥è§¦è§¦æ‘¸å±æ—¶ï¼ˆæˆ–è€…ç§»å‡ºå±å¹•è¾¹ç¼˜æ—¶ï¼‰è§¦å‘ï¼Œå®ƒçš„targetå±æ€§ä¸touchstartäº‹ä»¶çš„targetå±æ€§æ˜¯ä¸€è‡´çš„ï¼Œå®ƒçš„changedToucheså±æ€§è¿”å›ä¸€ä¸ªTouchListå¯¹è±¡ï¼ŒåŒ…å«æ‰€æœ‰ä¸å†è§¦æ‘¸çš„è§¦æ‘¸ç‚¹ï¼ˆTouchå¯¹è±¡ï¼‰ã€‚\n- touchmoveï¼šç”¨æˆ·ç§»åŠ¨è§¦æ‘¸ç‚¹æ—¶è§¦å‘ï¼Œå®ƒçš„targetå±æ€§ä¸touchstartäº‹ä»¶çš„targetå±æ€§ä¸€è‡´ã€‚å¦‚æœè§¦æ‘¸çš„åŠå¾„ã€è§’åº¦ã€åŠ›åº¦å‘ç”Ÿå˜åŒ–ï¼Œä¹Ÿä¼šè§¦å‘è¯¥äº‹ä»¶ã€‚\n- touchcancelï¼šè§¦æ‘¸ç‚¹å–æ¶ˆæ—¶è§¦å‘ï¼Œæ¯”å¦‚åœ¨è§¦æ‘¸åŒºåŸŸè·³å‡ºä¸€ä¸ªæƒ…æ€çª—å£ï¼ˆmodal windowï¼‰ã€è§¦æ‘¸ç‚¹ç¦»å¼€äº†æ–‡æ¡£åŒºåŸŸï¼ˆè¿›å…¥æµè§ˆå™¨èœå•æ åŒºåŸŸï¼‰ã€ç”¨æˆ·æ”¾ç½®æ›´å¤šçš„è§¦æ‘¸ç‚¹ï¼ˆè‡ªåŠ¨å–æ¶ˆæ—©å…ˆçš„è§¦æ‘¸ç‚¹ï¼‰ã€‚\n\n### è¡¨å•äº‹ä»¶\n\n#### Inputäº‹ä»¶ï¼Œselectäº‹ä»¶ï¼Œchangeäº‹ä»¶\n\n`input` äº‹ä»¶å½“ `<input>`ã€`<textarea>` çš„å€¼å‘ç”Ÿå˜åŒ–æ—¶è§¦å‘ã€‚æ­¤å¤–ï¼Œæ‰“å¼€`contenteditable` å±æ€§çš„å…ƒç´ ï¼Œåªè¦å€¼å‘ç”Ÿå˜åŒ–ï¼Œä¹Ÿä¼šè§¦å‘ `input` äº‹ä»¶ã€‚\n\n`input` äº‹ä»¶çš„ä¸€ä¸ªç‰¹ç‚¹ï¼Œå°±æ˜¯ä¼šè¿ç»­è§¦å‘ï¼Œæ¯”å¦‚ç”¨æˆ·æ¯æ¬¡æŒ‰ä¸‹ä¸€æ¬¡æŒ‰é”®ï¼Œå°±ä¼šè§¦å‘ä¸€æ¬¡`input` äº‹ä»¶ã€‚\n\n\n`select` äº‹ä»¶å½“åœ¨ `<input>`ã€`<textarea>` ä¸­é€‰ä¸­æ–‡æœ¬æ—¶è§¦å‘ã€‚\n\n`Change` äº‹ä»¶å½“ `<input>`ã€`<select>`ã€`<textarea>` çš„å€¼å‘ç”Ÿå˜åŒ–æ—¶è§¦å‘ã€‚å®ƒä¸`input` äº‹ä»¶çš„æœ€å¤§ä¸åŒï¼Œå°±æ˜¯ä¸ä¼šè¿ç»­è§¦å‘ï¼Œåªæœ‰å½“å…¨éƒ¨ä¿®æ”¹å®Œæˆæ—¶æ‰ä¼šè§¦å‘ï¼Œè€Œä¸”`input` äº‹ä»¶å¿…ç„¶ä¼šå¼•å‘ `change` äº‹ä»¶ã€‚å…·ä½“æ¥è¯´ï¼Œåˆ†æˆä»¥ä¸‹å‡ ç§æƒ…å†µã€‚\n\n- æ¿€æ´»å•é€‰æ¡†ï¼ˆradioï¼‰æˆ–å¤é€‰æ¡†ï¼ˆcheckboxï¼‰æ—¶è§¦å‘ã€‚\n- æˆ·æäº¤æ—¶è§¦å‘ã€‚æ¯”å¦‚ï¼Œä»ä¸‹åˆ—åˆ—è¡¨ï¼ˆselectï¼‰å®Œæˆé€‰æ‹©ï¼Œåœ¨æ—¥æœŸæˆ–æ–‡ä»¶è¾“å…¥æ¡†å®Œæˆé€‰æ‹©ã€‚\n- å½“æ–‡æœ¬æ¡†æˆ– `textarea` å…ƒç´ çš„å€¼å‘ç”Ÿæ”¹å˜ï¼Œå¹¶ä¸”ä¸§å¤±ç„¦ç‚¹æ—¶è§¦å‘ã€‚\n\n#### resetäº‹ä»¶ï¼Œsubmitäº‹ä»¶\n\n`reset` äº‹ä»¶å½“è¡¨å•é‡ç½®ï¼ˆæ‰€æœ‰è¡¨å•æˆå‘˜å˜å›é»˜è®¤å€¼ï¼‰æ—¶è§¦å‘ã€‚\n\n`submit` äº‹ä»¶å½“è¡¨å•æ•°æ®å‘æœåŠ¡å™¨æäº¤æ—¶è§¦å‘ã€‚æ³¨æ„ï¼Œ`submit` äº‹ä»¶çš„å‘ç”Ÿå¯¹è±¡æ˜¯ `form` å…ƒç´ ï¼Œ**è€Œä¸æ˜¯ `button` å…ƒç´ ï¼ˆå³ä½¿å®ƒçš„ç±»å‹æ˜¯ `submit` ï¼‰ï¼Œå› ä¸ºæäº¤çš„æ˜¯è¡¨å•ï¼Œè€Œä¸æ˜¯æŒ‰é’®ã€‚**\n\n### æ–‡æ¡£äº‹ä»¶\n\n#### beforeunload äº‹ä»¶\n\n`beforeunload` äº‹ä»¶åœ¨çª—å£å°†è¦å…³é—­ï¼Œæˆ–è€…ç½‘é¡µï¼ˆå³ `document` å¯¹è±¡ï¼‰å°†è¦å¸è½½æ—¶è§¦å‘ã€‚å®ƒå¯ä»¥ç”¨æ¥é˜²æ­¢ç”¨æˆ·ä¸å°å¿ƒå…³é—­ç½‘é¡µã€‚\n\næ ¹æ®æ ‡å‡†ï¼Œåªè¦åœ¨è¯¥äº‹ä»¶çš„å›è°ƒå‡½æ•°ä¸­ï¼Œè°ƒç”¨äº† `event.preventDefault()` ï¼Œæˆ–è€… `event.returnValue` å±æ€§çš„å€¼æ˜¯ä¸€ä¸ªéç©ºçš„å€¼ï¼Œå°±ä¼šè‡ªåŠ¨è·³å‡ºä¸€ä¸ªç¡®è®¤æ¡†ï¼Œè®©ç”¨æˆ·ç¡®è®¤æ˜¯å¦å…³é—­ç½‘é¡µã€‚å¦‚æœç”¨æˆ·ç‚¹å‡»â€œå–æ¶ˆâ€æŒ‰é’®ï¼Œç½‘é¡µå°±ä¸ä¼šå…³é—­ã€‚ `event.returnValue` å±æ€§çš„å€¼ï¼Œä¼šæ˜¾ç¤ºåœ¨ç¡®è®¤å¯¹è¯æ¡†ä¹‹ä¸­ã€‚\n\nè®¸å¤šæ‰‹æœºæµè§ˆå™¨é»˜è®¤å¿½è§†è¿™ä¸ªäº‹ä»¶ï¼Œè€Œæ¡Œé¢æµè§ˆå™¨ä¹Ÿå¯ä»¥è¿™æ ·è®¾ç½®ï¼Œæ‰€ä»¥è¿™ä¸ªäº‹ä»¶æœ‰å¯èƒ½æ ¹æœ¬ä¸ç”Ÿæ•ˆã€‚æ‰€ä»¥ï¼Œ**ä¸èƒ½ä¾èµ–å®ƒæ¥é˜»æ­¢ç”¨æˆ·å…³é—­çª—å£**ã€‚\n\n#### unload äº‹ä»¶\n\nunloadäº‹ä»¶åœ¨çª—å£å…³é—­æˆ–è€…documentå¯¹è±¡å°†è¦å¸è½½æ—¶è§¦å‘ï¼Œå‘ç”Ÿåœ¨windowã€bodyã€framesetç­‰å¯¹è±¡ä¸Šé¢ã€‚å®ƒçš„è§¦å‘é¡ºåºæ’åœ¨beforeunloadã€pagehideäº‹ä»¶åé¢ã€‚unloadäº‹ä»¶åªåœ¨é¡µé¢æ²¡æœ‰è¢«æµè§ˆå™¨ç¼“å­˜æ—¶æ‰ä¼šè§¦å‘ï¼Œæ¢è¨€ä¹‹ï¼Œå¦‚æœé€šè¿‡æŒ‰ä¸‹â€œå‰è¿›/åé€€â€å¯¼è‡´é¡µé¢å¸è½½ï¼Œå¹¶ä¸ä¼šè§¦å‘unloadäº‹ä»¶ã€‚\n\nå½“unloadäº‹ä»¶å‘ç”Ÿæ—¶ï¼Œdocumentå¯¹è±¡å¤„äºä¸€ä¸ªç‰¹æ®ŠçŠ¶æ€ã€‚æ‰€æœ‰èµ„æºä¾ç„¶å­˜åœ¨ï¼Œä½†æ˜¯å¯¹ç”¨æˆ·æ¥è¯´éƒ½ä¸å¯è§ï¼ŒUIäº’åŠ¨ï¼ˆwindow.openã€alertã€confirmæ–¹æ³•ç­‰ï¼‰å…¨éƒ¨æ— æ•ˆã€‚è¿™æ—¶å³ä½¿æŠ›å‡ºé”™è¯¯ï¼Œä¹Ÿä¸èƒ½åœæ­¢æ–‡æ¡£çš„å¸è½½ã€‚\n\nå¦‚æœåœ¨windowå¯¹è±¡ä¸Šå®šä¹‰äº†è¯¥äº‹ä»¶ï¼Œç½‘é¡µå°±ä¸ä¼šè¢«æµè§ˆå™¨ç¼“å­˜ã€‚\n\n#### loadäº‹ä»¶ï¼Œerroräº‹ä»¶\n\n`load` äº‹ä»¶åœ¨é¡µé¢åŠ è½½æˆåŠŸæ—¶è§¦å‘ï¼Œ`error` äº‹ä»¶åœ¨é¡µé¢åŠ è½½å¤±è´¥æ—¶è§¦å‘ã€‚æ³¨æ„ï¼Œé¡µé¢ä»æµè§ˆå™¨ç¼“å­˜åŠ è½½ï¼Œå¹¶ä¸ä¼šè§¦å‘ `load` äº‹ä»¶ã€‚\n\n#### pageshowäº‹ä»¶ï¼Œpagehideäº‹ä»¶\n\né»˜è®¤æƒ…å†µä¸‹ï¼Œæµè§ˆå™¨ä¼šåœ¨å½“å‰ä¼šè¯ï¼ˆsessionï¼‰ç¼“å­˜é¡µé¢ï¼Œå½“ç”¨æˆ·ç‚¹å‡»â€œå‰è¿›/åé€€â€æŒ‰é’®æ—¶ï¼Œæµè§ˆå™¨å°±ä¼šä»ç¼“å­˜ä¸­åŠ è½½é¡µé¢ã€‚\n\npageshowäº‹ä»¶åœ¨é¡µé¢åŠ è½½æ—¶è§¦å‘ï¼ŒåŒ…æ‹¬ç¬¬ä¸€æ¬¡åŠ è½½å’Œä»ç¼“å­˜åŠ è½½ä¸¤ç§æƒ…å†µã€‚å¦‚æœè¦æŒ‡å®šé¡µé¢æ¯æ¬¡åŠ è½½ï¼ˆä¸ç®¡æ˜¯ä¸æ˜¯ä»æµè§ˆå™¨ç¼“å­˜ï¼‰æ—¶éƒ½è¿è¡Œçš„ä»£ç ï¼Œå¯ä»¥æ”¾åœ¨è¿™ä¸ªäº‹ä»¶çš„ç›‘å¬å‡½æ•°ã€‚\n\npagehideäº‹ä»¶ä¸pageshowäº‹ä»¶ç±»ä¼¼ï¼Œå½“ç”¨æˆ·é€šè¿‡â€œå‰è¿›/åé€€â€æŒ‰é’®ï¼Œç¦»å¼€å½“å‰é¡µé¢æ—¶è§¦å‘ã€‚å®ƒä¸unloadäº‹ä»¶çš„åŒºåˆ«åœ¨äºï¼Œå¦‚æœåœ¨windowå¯¹è±¡ä¸Šå®šä¹‰unloadäº‹ä»¶çš„ç›‘å¬å‡½æ•°ä¹‹åï¼Œé¡µé¢ä¸ä¼šä¿å­˜åœ¨ç¼“å­˜ä¸­ï¼Œè€Œä½¿ç”¨pagehideäº‹ä»¶ï¼Œé¡µé¢ä¼šä¿å­˜åœ¨ç¼“å­˜ä¸­ã€‚\n\n#### DOMContentLoadedäº‹ä»¶\n\nå½“HTMLæ–‡æ¡£ä¸‹è½½å¹¶è§£æå®Œæˆä»¥åï¼Œå°±ä¼šåœ¨documentå¯¹è±¡ä¸Šè§¦å‘DOMContentLoadedäº‹ä»¶ã€‚è¿™æ—¶ï¼Œä»…ä»…å®Œæˆäº†HTMLæ–‡æ¡£çš„è§£æï¼ˆæ•´å¼ é¡µé¢çš„DOMç”Ÿæˆï¼‰ï¼Œæ‰€æœ‰å¤–éƒ¨èµ„æºï¼ˆæ ·å¼è¡¨ã€è„šæœ¬ã€iframeç­‰ç­‰ï¼‰å¯èƒ½è¿˜æ²¡æœ‰ä¸‹è½½ç»“æŸã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸ªäº‹ä»¶æ¯”loadäº‹ä»¶ï¼Œå‘ç”Ÿæ—¶é—´æ—©å¾—å¤šã€‚\n\n#### readystatechangeäº‹ä»¶\n\nreadystatechangeäº‹ä»¶å‘ç”Ÿåœ¨Documentå¯¹è±¡å’ŒXMLHttpRequestå¯¹è±¡ï¼Œå½“å®ƒä»¬çš„readyStateå±æ€§å‘ç”Ÿå˜åŒ–æ—¶è§¦å‘ã€‚\n\n#### scrolläº‹ä»¶\n\nscrolläº‹ä»¶åœ¨æ–‡æ¡£æˆ–æ–‡æ¡£å…ƒç´ æ»šåŠ¨æ—¶è§¦å‘ï¼Œä¸»è¦å‡ºç°åœ¨ç”¨æˆ·æ‹–åŠ¨æ»šåŠ¨æ¡ã€‚\n\n#### resizeäº‹ä»¶\n\nresizeäº‹ä»¶åœ¨æ”¹å˜æµè§ˆå™¨çª—å£å¤§å°æ—¶è§¦å‘ï¼Œå‘ç”Ÿåœ¨windowã€bodyã€framesetå¯¹è±¡ä¸Šé¢ã€‚\n\n#### ç„¦ç‚¹äº‹ä»¶\n\n- focusäº‹ä»¶ï¼šElementèŠ‚ç‚¹è·å¾—ç„¦ç‚¹åè§¦å‘ï¼Œè¯¥äº‹ä»¶ä¸ä¼šå†’æ³¡ã€‚\n- bluräº‹ä»¶ï¼šElementèŠ‚ç‚¹å¤±å»ç„¦ç‚¹åè§¦å‘ï¼Œè¯¥äº‹ä»¶ä¸ä¼šå†’æ³¡ã€‚\n- focusinäº‹ä»¶ï¼šElementèŠ‚ç‚¹å°†è¦è·å¾—ç„¦ç‚¹æ—¶è§¦å‘ï¼Œå‘ç”Ÿåœ¨focusäº‹ä»¶ä¹‹å‰ã€‚è¯¥äº‹ä»¶ä¼šå†’æ³¡ã€‚Firefoxä¸æ”¯æŒè¯¥äº‹ä»¶ã€‚\n- focusoutäº‹ä»¶ï¼šElementèŠ‚ç‚¹å°†è¦å¤±å»ç„¦ç‚¹æ—¶è§¦å‘ï¼Œå‘ç”Ÿåœ¨bluräº‹ä»¶ä¹‹å‰ã€‚è¯¥äº‹ä»¶ä¼šå†’æ³¡ã€‚Firefoxä¸æ”¯æŒè¯¥äº‹ä»¶ã€‚\n\n## CSS æ“ä½œ\n\n### style å±æ€§\n\næ“ä½œ CSS æ ·å¼æœ€ç®€å•çš„æ–¹æ³•ï¼Œå°±æ˜¯ä½¿ç”¨ç½‘é¡µå…ƒç´ èŠ‚ç‚¹çš„ `getAttribute` æ–¹æ³•ã€ `setAttribute` æ–¹æ³•å’Œ `removeAttribute` æ–¹æ³•ï¼Œç›´æ¥è¯»å†™æˆ–åˆ é™¤ç½‘é¡µå…ƒç´ çš„ `style` å±æ€§ã€‚\n\n```js\ndiv.setAttribute(\n  'style',\n  'background-color:red;' + 'border:1px solid black;'\n);\n```\n\n### Style å¯¹è±¡\n\n```js\nvar divStyle = document.querySelector('div').style;\n```\n\nè¿™ä¸ª `style` å¯¹è±¡å¯ä»¥ç›´æ¥æ“ä½œï¼Œä½†æ˜¯åå­—éœ€è¦æ”¹å†™ï¼Œæ¯”å¦‚ `background-color` å†™æˆ `backgroundColor`ã€‚å¦‚æœCSSå±æ€§æ˜¯JavaScriptä¿ç•™å­—ï¼Œé‚£è§„åˆ™åä¹‹å‰éœ€è¦åŠ ä¸Šå­—ç¬¦ä¸²`css` ï¼Œæ¯”å¦‚ `float` å†™æˆ `cssFloat` \n\n#### cssText å±æ€§\n\nå…ƒç´ èŠ‚ç‚¹å¯¹è±¡çš„ `style` å¯¹è±¡ï¼Œæœ‰ä¸€ä¸ª `cssText` å±æ€§ï¼Œå¯ä»¥è¯»å†™æˆ–åˆ é™¤æ•´ä¸ªæ ·å¼ã€‚\n\n```js\nvar divStyle = document.querySelector('div').style;\n\ndivStyle.cssText = 'background-color: red;'\n  + 'border: 1px solid black;'\n  + 'height: 100px;'\n  + 'width: 100px;';\n```\n\n`cssText` çš„å±æ€§å€¼ä¸ç”¨æ”¹å†™ CSS å±æ€§å\n\n#### CSS æ¨¡å—çš„ä¾¦æµ‹\n\nCSSçš„è§„æ ¼å‘å±•å¤ªå¿«ï¼Œæ–°çš„æ¨¡å—å±‚å‡ºä¸ç©·ã€‚ä¸åŒæµè§ˆå™¨çš„ä¸åŒç‰ˆæœ¬ï¼Œå¯¹CSSæ¨¡å—çš„æ”¯æŒæƒ…å†µéƒ½ä¸ä¸€æ ·ã€‚æœ‰æ—¶å€™ï¼Œéœ€è¦çŸ¥é“å½“å‰æµè§ˆå™¨æ˜¯å¦æ”¯æŒæŸä¸ªæ¨¡å—ï¼Œè¿™å°±å«åšã€ŒCSSæ¨¡å—çš„ä¾¦æµ‹ã€ã€‚\n\n#### setProperty()ï¼ŒgetPropertyValue()ï¼ŒremoveProperty()\n\n- `setProperty(propertyName,value)` ï¼šè®¾ç½®æŸä¸ªCSSå±æ€§ã€‚\n- `getPropertyValue(propertyName)` ï¼šè¯»å–æŸä¸ªCSSå±æ€§ã€‚\n- `removeProperty(propertyName)` ï¼šåˆ é™¤æŸä¸ªCSSå±æ€§ã€‚ \n\n#### window.getComputedStyle()\n\n`window.getComputedStyle` æ–¹æ³•ï¼Œå°±ç”¨æ¥è¿”å›è¿™ä¸ªè§„åˆ™ã€‚å®ƒæ¥å—ä¸€ä¸ªDOMèŠ‚ç‚¹å¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œè¿”å›ä¸€ä¸ªåŒ…å«è¯¥èŠ‚ç‚¹æœ€ç»ˆæ ·å¼ä¿¡æ¯çš„å¯¹è±¡ã€‚æ‰€è°“â€œæœ€ç»ˆæ ·å¼ä¿¡æ¯â€ï¼ŒæŒ‡çš„æ˜¯å„ç§CSSè§„åˆ™å åŠ åçš„ç»“æœã€‚\n\n`getComputedStyle` æ–¹æ³•è¿˜å¯ä»¥æ¥å—ç¬¬äºŒä¸ªå‚æ•°ï¼Œè¡¨ç¤ºæŒ‡å®šèŠ‚ç‚¹çš„ä¼ªå…ƒç´ ï¼ˆæ¯”å¦‚`:before`ã€`:after`ã€`:first-line`ã€`:first-letter` ç­‰ï¼‰\n\n**æ³¨æ„**\n\n- è¿”å›çš„CSSå€¼éƒ½æ˜¯ç»å¯¹å•ä½ï¼Œæ¯”å¦‚ï¼Œé•¿åº¦éƒ½æ˜¯åƒç´ å•ä½ï¼ˆè¿”å›å€¼åŒ…æ‹¬pxåç¼€ï¼‰ï¼Œé¢œè‰²æ˜¯ `rgb(#, #, #)` æˆ– `rgba(#, #, #, #)` æ ¼å¼ã€‚\n- CSSè§„åˆ™çš„ç®€å†™å½¢å¼æ— æ•ˆï¼Œæ¯”å¦‚ï¼Œæƒ³è¯»å– `margin` å±æ€§çš„å€¼ï¼Œä¸èƒ½ç›´æ¥è¯»ï¼Œåªèƒ½è¯» `marginLeft`ã€`marginTop` ç­‰å±æ€§ã€‚\n- å¦‚æœä¸€ä¸ªå…ƒç´ ä¸æ˜¯ç»å¯¹å®šä½ï¼Œ `top` å’Œ `left` å±æ€§æ€»æ˜¯è¿”å› `auto` ã€‚\n- è¯¥æ–¹æ³•è¿”å›çš„æ ·å¼å¯¹è±¡çš„ `cssText` å±æ€§æ— æ•ˆï¼Œè¿”å› `undefined` ã€‚\n- è¯¥æ–¹æ³•è¿”å›çš„æ ·å¼å¯¹è±¡æ˜¯åªè¯»çš„ï¼Œå¦‚æœæƒ³è®¾ç½®æ ·å¼ï¼Œåº”è¯¥ä½¿ç”¨å…ƒç´ èŠ‚ç‚¹çš„ `style` å±æ€§ã€‚\n\n### CSS ä¼ªå…ƒç´ \n\nCSSä¼ªå…ƒç´ æ˜¯é€šè¿‡CSSå‘DOMæ·»åŠ çš„å…ƒç´ ï¼Œä¸»è¦æ–¹æ³•æ˜¯é€šè¿‡ `:before` å’Œ `:after` é€‰æ‹©å™¨ç”Ÿæˆä¼ªå…ƒç´ ï¼Œç„¶åç”¨ `content` å±æ€§æŒ‡å®šä¼ªå…ƒç´ çš„å†…å®¹ã€‚\n\n### StyleSheetå¯¹è±¡\n\n#### è·å–æ ·å¼è¡¨\n\n`document.styleSheets` è¿”å›å½“å‰é¡µé¢æ‰€æœ‰ `StyleSheet` å¯¹è±¡ã€‚æ˜¯ä¸€ä¸ªç±»æ•°ç»„å¯¹è±¡\n\n#### å±æ€§\n\n**media**\n\n`media` å±æ€§è¡¨ç¤ºè¿™ä¸ªæ ·å¼è¡¨æ˜¯ç”¨äºå±å¹•ï¼ˆscreenï¼‰ï¼Œè¿˜æ˜¯ç”¨äºæ‰“å°ï¼ˆprintï¼‰ï¼Œæˆ–ä¸¤è€…éƒ½é€‚ç”¨ï¼ˆallï¼‰ã€‚è¯¥å±æ€§åªè¯»ï¼Œé»˜è®¤å€¼æ˜¯ `screen`ã€‚\n\n**disabled**\n\n`disabled` å±æ€§ç”¨äºæ‰“å¼€æˆ–å…³é—­ä¸€å¼ æ ·å¼è¡¨ã€‚`disabled` å±æ€§åªèƒ½åœ¨ JavaScript è„šæœ¬ä¸­è®¾ç½®ï¼Œä¸èƒ½åœ¨ HTML è¯­å¥ä¸­è®¾ç½®ã€‚\n\n**href**\n\n`href` å±æ€§æ˜¯åªè¯»å±æ€§ï¼Œè¿”å› `StyleSheet` å¯¹è±¡è¿æ¥çš„æ ·å¼è¡¨åœ°å€ã€‚å¯¹äºå†…åµŒçš„ `<style>` èŠ‚ç‚¹ï¼Œè¯¥å±æ€§ç­‰äº `null` ã€‚\n\n**title**\n\n`title` å±æ€§è¿”å› `StyleSheet` å¯¹è±¡çš„ `title` å€¼ã€‚\n\n**typeå±æ€§**\n\n`type` å±æ€§è¿”å› `StyleSheet` å¯¹è±¡çš„ `type` å€¼ï¼Œé€šå¸¸æ˜¯ `text/css`ã€‚\n\n**parentStyleSheet**\n\nCSSçš„ `@import` å‘½ä»¤å…è®¸åœ¨æ ·å¼è¡¨ä¸­åŠ è½½å…¶ä»–æ ·å¼è¡¨ã€‚`parentStyleSheet` å±æ€§è¿”å›åŒ…å«äº†å½“å‰æ ·å¼è¡¨çš„é‚£å¼ æ ·å¼è¡¨ã€‚å¦‚æœå½“å‰æ ·å¼è¡¨æ˜¯é¡¶å±‚æ ·å¼è¡¨ï¼Œåˆ™è¯¥å±æ€§è¿”å› `null`ã€‚\n\n**ownerNode**\n\n`ownerNode` å±æ€§è¿”å› `StyleSheet` å¯¹è±¡æ‰€åœ¨çš„DOMèŠ‚ç‚¹ï¼Œé€šå¸¸æ˜¯ `<link>` æˆ– `<style>`ã€‚å¯¹äºé‚£äº›ç”±å…¶ä»–æ ·å¼è¡¨å¼•ç”¨çš„æ ·å¼è¡¨ï¼Œè¯¥å±æ€§ä¸º `null`ã€‚\n\n```js\n// HTMLä»£ç ä¸º\n// <link rel=\"StyleSheet\" href=\"example.css\" type=\"text/css\" />\n\ndocument.styleSheets[0].ownerNode // [object HTMLLinkElement]\n```\n\n**cssRules**\n\n`cssRules` å±æ€§æŒ‡å‘ä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼Œé‡Œé¢æ¯ä¸€ä¸ªæˆå‘˜å°±æ˜¯å½“å‰æ ·å¼è¡¨çš„ä¸€æ¡CSSè§„åˆ™ã€‚ä½¿ç”¨è¯¥è§„åˆ™çš„ `cssText` å±æ€§ï¼Œå¯ä»¥å¾—åˆ°CSSè§„åˆ™å¯¹åº”çš„å­—ç¬¦ä¸²ã€‚\n\n#### insertRule()ï¼ŒdeleteRule()\n\n`insertRule` æ–¹æ³•ç”¨äºåœ¨å½“å‰æ ·å¼è¡¨çš„ `cssRules` å¯¹è±¡æ’å…¥CSSè§„åˆ™ï¼Œ`deleteRule` æ–¹æ³•ç”¨äºåˆ é™¤ `cssRules` å¯¹è±¡çš„CSSè§„åˆ™ã€‚\n\n`insertRule` æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¡¨ç¤ºCSSè§„åˆ™çš„å­—ç¬¦ä¸²ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯è¯¥è§„åˆ™åœ¨`cssRules` è±¡çš„æ’å…¥ä½ç½®ï¼Œæ˜¯ä¸€ä¸ªæ•°å€¼ã€‚`deleteRule` æ–¹æ³•çš„å‚æ•°æ˜¯è¯¥æ¡è§„åˆ™åœ¨`cssRules` å¯¹è±¡ä¸­çš„ä½ç½®ã€‚\n\n#### æ·»åŠ æ ·å¼è¡¨\n\næ·»åŠ å†…éƒ¨æ ·å¼è¡¨ `<style>` èŠ‚ç‚¹\n\n```js\nvar style = document.createElement('style');\nstyle.setAttribute('media','screen');\nstyle.setAttribute('media','@media only screen and (max-width : 1024px)');\nstyle.innerHTML = 'body{color:red}';\ndocument.head.appendChild(style);\n```\n\næ·»åŠ å¤–éƒ¨æ ·å¼è¡¨ï¼Œåœ¨æ–‡æ¡£ä¸­æ·»åŠ  `<link>` èŠ‚ç‚¹\n\n```js\nvar linkElm = document.createElement('link');\nlinkElm.setAttribute('rel', 'stylesheet');\nlinkElm.setAttribute('type', 'text/css');\nlinkElm.setAttribute('href', 'reset-min.css');\n\ndocument.head.appendChild(linkElm);\n```\n\n### CSS è§„åˆ™\n\nä¸€æ¡CSSè§„åˆ™åŒ…æ‹¬ä¸¤ä¸ªéƒ¨åˆ†ï¼šCSSé€‰æ‹©å™¨å’Œæ ·å¼å£°æ˜ã€‚ä¸‹é¢å°±æ˜¯ä¸€æ¡å…¸å‹çš„CSSè§„åˆ™ã€‚\n\n```css\n.myClass {\n  background-color: yellow;\n}\n```\n\n### window.matchMedia()\n\n`window.matchMedia` æ–¹æ³•ç”¨æ¥æ£€æŸ¥CSSçš„ `mediaQuery` è¯­å¥\n\n```js\nvar result = window.matchMedia('(min-width: 600px)');\nresult.media // (min-width: 600px)\nresult.matches // true\n```\n\n`media` è¿”å›æ‰€æŸ¥è¯¢çš„ `mediaQuery` è¯­å¥å­—ç¬¦ä¸²ï¼Œ`matches` è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºå½“å‰ç¯å¢ƒæ˜¯å¦åŒ¹é…æŸ¥è¯¢è¯­å¥\n\n```js\nvar result = window.matchMedia('(max-width: 700px)');\n\nif (result.matches) {\n  console.log('é¡µé¢å®½åº¦å°äºç­‰äº700px');\n} else {\n  console.log('é¡µé¢å®½åº¦å¤§äº700px');\n}\n```\n\n#### ç›‘å¬äº‹ä»¶\n\n`window.matchMedia` æ–¹æ³•è¿”å›çš„ `MediaQueryList` å¯¹è±¡æœ‰ä¸¤ä¸ªæ–¹æ³•ï¼Œç”¨æ¥ç›‘å¬äº‹ä»¶ï¼š`addListener` æ–¹æ³•å’Œ `removeListener` æ–¹æ³•ã€‚å¦‚æœ `mediaQuery` æŸ¥è¯¢ç»“æœå‘ç”Ÿå˜åŒ–ï¼Œå°±è°ƒç”¨æŒ‡å®šçš„å›è°ƒå‡½æ•°ã€‚\n\n```js\nvar mql = window.matchMedia(\"(max-width: 700px)\");\n\nmql.addListener(mqCallback);\n\n//...\n```\n\n### CSSäº‹ä»¶\n\n#### transitionEnd äº‹ä»¶\n\ncssçš„è¿‡æ¸¡æ•ˆæœã€Œtransitionã€ç»“æŸåï¼Œè§¦å‘ `transitionEnd` äº‹ä»¶\n\n```js\nel.addEventListener('transitionend', onTransitionEnd, false);\n\nfunction onTransitionEnd() {\n  console.log('Transition end');\n}\n```\n\n`transitionEnd` çš„äº‹ä»¶å¯¹è±¡å…·æœ‰ä»¥ä¸‹å±æ€§ã€‚\n\n- `propertyName` ï¼šå‘ç”Ÿ `transition` æ•ˆæœçš„CSSå±æ€§åã€‚\n- `elapsedTime` ï¼š`transition` æ•ˆæœæŒç»­çš„ç§’æ•°ï¼Œä¸å« `transition-delay` çš„æ—¶é—´ã€‚\n- `pseudoElement` ï¼šå¦‚æœ `transition` æ•ˆæœå‘ç”Ÿåœ¨ä¼ªå…ƒç´ ï¼Œä¼šè¿”å›è¯¥ä¼ªå…ƒç´ çš„åç§°ï¼Œä»¥ã€Œ::ã€å¼€å¤´ã€‚å¦‚æœä¸å‘ç”Ÿåœ¨ä¼ªå…ƒç´ ä¸Šï¼Œåˆ™è¿”å›ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ã€‚\n\n#### animationstartäº‹ä»¶ï¼Œanimationendäº‹ä»¶ï¼Œanimationiterationäº‹ä»¶\n\n- animationstart : åŠ¨ç”»å¼€å§‹æ—¶è§¦å‘\n- animationend : åŠ¨ç”»ç»“æŸæ—¶è§¦å‘\n- animationiteration : å¼€å§‹æ–°ä¸€è½®åŠ¨ç”»å¾ªç¯æ—¶è§¦å‘ã€‚å¦‚æœanimationiteration-countå±æ€§ç­‰äº1ï¼Œè¯¥äº‹ä»¶ä¸è§¦å‘ï¼Œå³åªæ’­æ”¾ä¸€è½®çš„CSSåŠ¨ç”»ï¼Œä¸è§¦å‘animationiterationäº‹ä»¶\n\n\n## Mutation Observer API\n\n### æ¦‚è¿°\n\nç”¨æ¥ç›‘è§† DOM å˜åŠ¨ï¼Œå¼‚æ­¥è§¦å‘è€Œä¸”ä¸æ˜¯é©¬ä¸Šè§¦å‘ï¼Œè€Œæ˜¯è¦ç­‰åˆ°å½“å‰æ‰€æœ‰ DOM æ“ä½œéƒ½ç»“æŸæ‰è§¦å‘\n\n- å®ƒç­‰å¾…æ‰€æœ‰è„šæœ¬ä»»åŠ¡å®Œæˆåï¼Œæ‰ä¼šè¿è¡Œï¼Œå³é‡‡ç”¨å¼‚æ­¥æ–¹å¼ã€‚\n- å®ƒæŠŠ DOM å˜åŠ¨è®°å½•å°è£…æˆä¸€ä¸ªæ•°ç»„è¿›è¡Œå¤„ç†ï¼Œè€Œä¸æ˜¯ä¸€æ¡æ¡åœ°ä¸ªåˆ«å¤„ç† DOM å˜åŠ¨ã€‚\n- å®ƒæ—¢å¯ä»¥è§‚å¯Ÿå‘ç”Ÿåœ¨ DOM çš„æ‰€æœ‰ç±»å‹å˜åŠ¨ï¼Œä¹Ÿå¯ä»¥è§‚å¯ŸæŸä¸€ç±»å˜åŠ¨ã€‚\n\n### MutationObserver æ„é€ å‡½æ•°\n\nå›è°ƒå‡½æ•°æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯å˜åŠ¨æ•°ç»„ï¼Œç¬¬äºŒä¸ªæ˜¯è§‚å¯Ÿå®ä¾‹\n\n```js\nvar observer = new MutationObserver(function (mutations, observer) {\n  mutations.forEach(function(mutation) {\n    console.log(mutation);\n  });\n});\n```\n\n### å®ä¾‹æ–¹æ³•\n\n#### observe()\n\n- ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ‰€è¦è§‚å¯Ÿçš„ DOM èŠ‚ç‚¹\n- ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªé…ç½®å¯¹è±¡ï¼Œç”¨æ¥æŒ‡å®šæ‰€è¦è§‚å¯Ÿçš„ç‰¹å®šå˜åŠ¨\n\né…ç½®å¯¹è±¡æœ‰ä»¥ä¸‹å‡ ç§\n\n- childListï¼šå­èŠ‚ç‚¹çš„å˜åŠ¨ã€‚\n- attributesï¼šå±æ€§çš„å˜åŠ¨ã€‚\n- characterDataï¼šèŠ‚ç‚¹å†…å®¹æˆ–èŠ‚ç‚¹æ–‡æœ¬çš„å˜åŠ¨ã€‚\n- subtreeï¼šæ‰€æœ‰åä»£èŠ‚ç‚¹çš„å˜åŠ¨ã€‚\n- attributeOldValueï¼šç±»å‹ä¸ºå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºè§‚å¯Ÿattributeså˜åŠ¨æ—¶ï¼Œæ˜¯å¦éœ€è¦è®°å½•å˜åŠ¨å‰çš„å±æ€§å€¼ã€‚\n- characterDataOldValueï¼šç±»å‹ä¸ºå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºè§‚å¯ŸcharacterDataå˜åŠ¨æ—¶ï¼Œæ˜¯å¦éœ€è¦è®°å½•å˜åŠ¨å‰çš„å€¼ã€‚\n- attributeFilterï¼šç±»å‹ä¸ºæ•°ç»„ï¼Œè¡¨ç¤ºéœ€è¦è§‚å¯Ÿçš„ç‰¹å®šå±æ€§ï¼ˆæ¯”å¦‚['class','src']ï¼‰ã€‚\n\n#### disconnect(),takeRecords()\n\n`disconnect` æ–¹æ³•ç”¨æ¥åœæ­¢è§‚å¯Ÿã€‚è°ƒç”¨è¯¥æ–¹æ³•åï¼ŒDOM å†å‘ç”Ÿå˜åŠ¨ï¼Œä¹Ÿä¸ä¼šè§¦å‘è§‚å¯Ÿå™¨ã€‚\n\n`takeRecords` æ–¹æ³•ç”¨æ¥æ¸…é™¤å˜åŠ¨è®°å½•ï¼Œå³ä¸å†å¤„ç†æœªå¤„ç†çš„å˜åŠ¨ã€‚è¯¥æ–¹æ³•è¿”å›å˜åŠ¨è®°å½•çš„æ•°ç»„ã€‚\n\n### MutationRecord å¯¹è±¡\n\n`MutationRecord` å¯¹è±¡åŒ…å«äº†DOMçš„ç›¸å…³ä¿¡æ¯ï¼Œæœ‰å¦‚ä¸‹å±æ€§ï¼š\n\n- typeï¼šè§‚å¯Ÿçš„å˜åŠ¨ç±»å‹ï¼ˆattributeã€characterDataæˆ–è€…childListï¼‰ã€‚\n- targetï¼šå‘ç”Ÿå˜åŠ¨çš„DOMèŠ‚ç‚¹ã€‚\n- addedNodesï¼šæ–°å¢çš„DOMèŠ‚ç‚¹ã€‚\n- removedNodesï¼šåˆ é™¤çš„DOMèŠ‚ç‚¹ã€‚\n- previousSiblingï¼šå‰ä¸€ä¸ªåŒçº§èŠ‚ç‚¹ï¼Œå¦‚æœæ²¡æœ‰åˆ™è¿”å›nullã€‚\n- nextSiblingï¼šä¸‹ä¸€ä¸ªåŒçº§èŠ‚ç‚¹ï¼Œå¦‚æœæ²¡æœ‰åˆ™è¿”å›nullã€‚\n- attributeNameï¼šå‘ç”Ÿå˜åŠ¨çš„å±æ€§ã€‚å¦‚æœè®¾ç½®äº†attributeFilterï¼Œåˆ™åªè¿”å›é¢„å…ˆæŒ‡å®šçš„å±æ€§ã€‚\n- oldValueï¼šå˜åŠ¨å‰çš„å€¼ã€‚è¿™ä¸ªå±æ€§åªå¯¹attributeå’ŒcharacterDataå˜åŠ¨æœ‰æ•ˆï¼Œå¦‚æœå‘ç”ŸchildListå˜åŠ¨ï¼Œåˆ™è¿”å›nullã€‚\n\n\n","tags":["ES5"],"categories":["Note"]},{"title":"LeanJsã€Œ ES5 ã€-- æµè§ˆå™¨ç¯å¢ƒ","url":"%2F2018%2F01%2F27%2FLeanJS%E6%B5%8F%E8%A7%88%E5%99%A8%E7%8E%AF%E5%A2%83%2F","content":"![Js](LeanJSæµè§ˆå™¨ç¯å¢ƒ/js.png)\n\n<!--more-->\n\n## æ¦‚è¿°\n\n### JavaScript ä»£ç åµŒå…¥ç½‘é¡µçš„æ–¹æ³•\n\n#### scriptæ ‡ç­¾:ä»£ç åµŒå…¥ç½‘é¡µ\n\n`type` æŒ‡å®šè„šæœ¬ç±»å‹\n\n- `text/javascript` æ˜¯é»˜è®¤å€¼\n- `application/javascript` å¯¹äºæ–°å¼æµè§ˆå™¨ï¼Œå»ºè®®è¿™ä¸ªå€¼\n- ä¹Ÿå¯ä»¥ä¸å†™ `type`\n- å†™ä¸€ä¸ªæµè§ˆå™¨ä¸è®¤è¯†çš„ï¼Œå°±ä¸ä¼šæ‰§è¡Œ\n\n#### scriptæ ‡ç­¾ï¼šåŠ è½½å¤–éƒ¨è„šæœ¬\n\n```html\n<script src=\"example.js\"></script>\n```\n\nåŠ è½½å¤–éƒ¨çš„è„šæ­¥å’Œç›´æ¥æ·»åŠ ä»£ç å—ä¸èƒ½æ··ç”¨\n\n```html\n<script src=\"example.js\">\n  console.log('hello world');\n</script>\n```\n\n`console.log` ä¼šè¢«å¿½ç•¥\n\nä¸ºäº†é˜²æ­¢æ”»å‡»è€…ç¯¡æ”¹å¤–éƒ¨è„šæœ¬ï¼Œ`script` æ ‡ç­¾å…è®¸è®¾ç½®ä¸€ä¸ª `integrity` å±æ€§ï¼Œå†™å…¥è¯¥å¤–éƒ¨è„šæœ¬çš„Hashç­¾åï¼Œç”¨æ¥éªŒè¯è„šæœ¬çš„ä¸€è‡´æ€§\n\n```html\n<script src=\"/assets/application.js\"\n  integrity=\"sha256-TvVUHzSfftWg1rcfL6TIJ0XKEGrgLyEq6lEpcmrG9qs=\">\n</script>\n```\n\n\n#### äº‹ä»¶å±æ€§\n\n```html\n<div onclick=\"alert('Hello')\"></div>\n```\n\n#### URLåè®®\n\nURLæ”¯æŒ `javascript:` åè®®ï¼Œè°ƒç”¨è¿™ä¸ªURLæ—¶ï¼Œå°±ä¼šæ‰§è¡ŒJavaScriptä»£ç ã€‚\n\n```html\n<a href=\"javascript:alert('Hello')\"></a>\n```\n\n### scriptæ ‡ç­¾\n\n#### å·¥ä½œåŸç†\n\næ­£å¸¸çš„ç½‘é¡µåŠ è½½æµç¨‹æ˜¯è¿™æ ·çš„\n\n1. æµè§ˆå™¨ä¸€è¾¹ä¸‹è½½HTMLç½‘é¡µï¼Œä¸€è¾¹å¼€å§‹è§£æ\n2. è§£æè¿‡ç¨‹ä¸­ï¼Œå‘ç° `<script>` æ ‡ç­¾\n3. æš‚åœè§£æï¼Œç½‘é¡µæ¸²æŸ“çš„æ§åˆ¶æƒè½¬äº¤ç»™JavaScriptå¼•æ“\n4. å¦‚æœ `<script>` æ ‡ç­¾å¼•ç”¨äº†å¤–éƒ¨è„šæœ¬ï¼Œå°±ä¸‹è½½è¯¥è„šæœ¬ï¼Œå¦åˆ™å°±ç›´æ¥è¿›è¡Œ\n5. æ‰§è¡Œå®Œæ¯•ï¼Œæ§åˆ¶æƒäº¤è¿˜ç»™æ¸²æŸ“å¼•æ“ï¼Œæ¢å¤å¾€ä¸‹è§£æHTMLç½‘é¡µ\n\n#### defer å±æ€§\n\nä¸ºäº†è§£å†³è„šæœ¬æ–‡ä»¶ä¸‹è½½é˜»å¡ç½‘é¡µæ¸²æŸ“çš„é—®é¢˜ï¼Œä¸€ä¸ªæ–¹æ³•æ˜¯åŠ å…¥ `defer` å±æ€§\n\n```html\n<script src=\"a.js\" defer></script>\n<script src=\"b.js\" defer></script>\n```\n\n`defer` çš„è¿è¡Œæµç¨‹å¦‚ä¸‹\n\n1. æµè§ˆå™¨å¼€å§‹è§£æHTMLç½‘é¡µ\n2. è§£æè¿‡ç¨‹ä¸­ï¼Œå‘ç°å¸¦æœ‰ `defer` å±æ€§çš„ `script` æ ‡ç­¾\n3. æµè§ˆå™¨ç»§ç»­å¾€ä¸‹è§£æ HTML ç½‘é¡µï¼ŒåŒæ—¶å¹¶è¡Œä¸‹è½½ `script` æ ‡ç­¾ä¸­çš„å¤–éƒ¨è„šæœ¬\n4. æµè§ˆå™¨å®Œæˆè§£æHTMLç½‘é¡µï¼Œæ­¤æ—¶å†æ‰§è¡Œä¸‹è½½çš„è„šæœ¬\n\nä½¿ç”¨ `defer` åŠ è½½çš„å¤–éƒ¨è„šæœ¬ä¸åº”è¯¥ä½¿ç”¨ `document.write` æ–¹æ³•\n\n#### async\n\nè§£å†³ã€Œé˜»å¡æ•ˆåº”ã€çš„ä¸€ä¸ªæ–¹æ³•æ˜¯åŠ å…¥ `async`\n\n`async` å±æ€§çš„ä½œç”¨æ˜¯ï¼Œä½¿ç”¨å¦ä¸€ä¸ªè¿›ç¨‹ä¸‹è½½è„šæœ¬ï¼Œä¸‹è½½æ—¶ä¸ä¼šé˜»å¡æ¸²æŸ“\n\n`async` çš„è¿è¡Œæµç¨‹å¦‚ä¸‹\n\n1. æµè§ˆå™¨å¼€å§‹è§£æHTMLç½‘é¡µ\n2. è§£æè¿‡ç¨‹ä¸­ï¼Œå‘ç°å¸¦æœ‰ `async` å±æ€§çš„ `script` æ ‡ç­¾\n3. æµè§ˆå™¨ç»§ç»­å¾€ä¸‹è§£æ HTML ç½‘é¡µï¼ŒåŒæ—¶å¹¶è¡Œä¸‹è½½ `script` æ ‡ç­¾ä¸­çš„å¤–éƒ¨æ–‡ä»¶\n4. è„šæœ¬ä¸‹è½½å®Œæˆï¼Œæµè§ˆå™¨æš‚åœè§£æ HTML ç½‘é¡µï¼Œå¼€å§‹æ‰§è¡Œä¸‹è½½çš„è„šæœ¬\n5. è„šæœ¬æ‰§è¡Œå®Œæ¯•ï¼Œæµè§ˆå™¨æ¢å¤è§£æ HTML ç½‘é¡µ\n\n`async` æ— æ³•ä¿è¯è„šæœ¬çš„æ‰§è¡Œé¡ºåºï¼Œä¸€èˆ¬æ¥è¯´ï¼Œå¦‚æœè„šæœ¬æ²¡æœ‰ä¾èµ–å…³ç³»ï¼Œç”¨ `async` å±æ€§ï¼Œè„šæœ¬ä¹‹é—´æœ‰ä¾èµ–å…³ç³»ï¼Œç”¨ `defer` å±æ€§ï¼ŒåŒæ—¶ä½¿ç”¨ `async` å’Œ `defer` å±æ€§ï¼Œåè€…ä¸èµ·ä½œç”¨ï¼Œæµè§ˆå™¨è¡Œä¸ºç”± `async` å±æ€§å†³å®š\n\n#### è„šæœ¬çš„åŠ¨æ€åŠ è½½\n\n```js\nvar script = document.createElement('script');\nscript.src = 'a.js';\ndocument.head.appendChild(script);\n```\n\n#### åŠ è½½ä½¿ç”¨çš„åè®®\n\nå¦‚æœä¸æŒ‡å®šåè®®ï¼Œæµè§ˆå™¨é»˜è®¤é‡‡ç”¨ HTTP åè®®ä¸‹è½½\n\nå¦‚æœè¦é‡‡ç”¨ HTTPS ä¸‹è½½ï¼Œå¿…é¡»å†™æ˜\n\n```html\n<script src=\"https://example.js\"></script>\n```\n\n### æµè§ˆå™¨çš„ç»„æˆ\n\næµè§ˆå™¨çš„æ ¸å¿ƒæ˜¯ä¸¤éƒ¨åˆ†ï¼šæ¸²æŸ“å¼•æ“å’Œ JavaScript è§£é‡Šå™¨\n\n#### æ¸²æŸ“å¼•æ“\n\n- Firefox : Gecko\n- Safari : WebKit\n- Chrome : Blink\n- IE : Trident\n- Edge : EdgeHTML\n\næ¸²æŸ“å¼•æ“å¤„ç†ç½‘é¡µï¼Œé€šå¸¸åˆ†ä¸ºå››ä¸ªé˜¶æ®µ\n\n1. è§£æä»£ç  ï¼šHTML ä»£ç è§£æä¸º DOMï¼ŒCSS ä»£ç è§£æä¸º CSSSOM ã€ŒCSS Object Modelã€\n2. å¯¹è±¡åˆæˆ ï¼šå°† DOM å’Œ CSSOM åˆæˆä¸€æ£µæ¸²æŸ“æ ‘ ã€Œrender treeã€\n3. å¸ƒå±€ ï¼šè®¡ç®—å‡ºæ¸²æŸ“æ ‘çš„å¸ƒå±€ ã€Œlayoutã€\n4. ç»˜åˆ¶ ï¼šå°†æ¸²æŸ“æ ‘ç»˜åˆ¶åˆ°å±å¹•\n\nå¾€å¾€ç¬¬ä¸€æ­¥è¿˜æ²¡å®Œæˆï¼Œç¬¬äºŒéƒ¨å’Œç¬¬ä¸‰éƒ¨å·²ç»å¼€å§‹äº†ã€‚\n\n#### é‡æµå’Œé‡ç»˜\n\næ¸²æŸ“æ ‘è½¬æ¢ä¸ºç½‘é¡µå¸ƒå±€ï¼Œç§°ä¸ºã€Œå¸ƒå±€æµã€ï¼ˆflowï¼‰ï¼›å¸ƒå±€æ˜¾ç¤ºåˆ°é¡µé¢çš„è¿™ä¸ªè¿‡ç¨‹ï¼Œç§°ä¸ºã€Œç»˜åˆ¶ã€ï¼ˆpaintï¼‰ã€‚å®ƒä»¬éƒ½å…·æœ‰é˜»å¡æ•ˆåº”ï¼Œå¹¶ä¸”ä¼šè€—è´¹å¾ˆå¤šæ—¶é—´å’Œè®¡ç®—èµ„æºã€‚\n\né‡æµä¸€å®šä¼šè§¦å‘é‡ç»˜ï¼Œé‡ç»˜ä¸ä¸€å®šéœ€è¦é‡æµã€‚\n\nä»¥ä¸‹æ˜¯ä¸€äº›ä¼˜åŒ–æŠ€å·§\n\n- è¯»å– DOM æˆ–è€…å†™å…¥ DOM ï¼Œå°½é‡å†™åœ¨ä¸€èµ·ï¼Œä¸è¦æ··æ‚\n- ç¼“å­˜ DOM ä¿¡æ¯\n- ä¸è¦ä¸€é¡¹ä¸€é¡¹åœ°æ”¹å˜æ ·å¼ï¼Œè€Œæ˜¯ä½¿ç”¨CSS classä¸€æ¬¡æ€§æ”¹å˜æ ·å¼\n- ä½¿ç”¨document fragmentæ“ä½œDOM\n- åŠ¨ç”»æ—¶ä½¿ç”¨absoluteå®šä½æˆ–fixedå®šä½ï¼Œè¿™æ ·å¯ä»¥å‡å°‘å¯¹å…¶ä»–å…ƒç´ çš„å½±å“\n- åªåœ¨å¿…è¦æ—¶æ‰æ˜¾ç¤ºå…ƒç´ \n- ä½¿ç”¨ `window.requestAnimationFrame()`ï¼Œå› ä¸ºå®ƒå¯ä»¥æŠŠä»£ç æ¨è¿Ÿåˆ°ä¸‹ä¸€æ¬¡é‡æµæ—¶æ‰§è¡Œï¼Œè€Œä¸æ˜¯ç«‹å³è¦æ±‚é¡µé¢é‡æµ\n- ä½¿ç”¨è™šæ‹ŸDOMï¼ˆvirtual DOMï¼‰åº“\n\n#### JavaScript å¼•æ“\n\næ—©æœŸçš„æµè§ˆå™¨å†…éƒ¨å¤„ç† JavaScript\n\n1. è¯»å–ä»£ç ï¼Œè¿›è¡Œè¯æ³•åˆ†æï¼ˆLexical analysisï¼‰ï¼Œå°†ä»£ç åˆ†è§£æˆè¯å…ƒï¼ˆtokenï¼‰ã€‚\n2. å¯¹è¯å…ƒè¿›è¡Œè¯­æ³•åˆ†æï¼ˆparsingï¼‰ï¼Œå°†ä»£ç æ•´ç†æˆâ€œè¯­æ³•æ ‘â€ï¼ˆsyntax treeï¼‰ã€‚\n3. ä½¿ç”¨â€œç¿»è¯‘å™¨â€ï¼ˆtranslatorï¼‰ï¼Œå°†ä»£ç è½¬ä¸ºå­—èŠ‚ç ï¼ˆbytecodeï¼‰ã€‚\n4. ä½¿ç”¨â€œå­—èŠ‚ç è§£é‡Šå™¨â€ï¼ˆbytecode interpreterï¼‰ï¼Œå°†å­—èŠ‚ç è½¬ä¸ºæœºå™¨ç ã€‚\n\nç°åœ¨éƒ½é‡‡ç”¨äº†å³æ—¶ç¼–è¯‘ï¼Œè¿è¡Œåˆ°å“ªä¸€è¡Œä»£ç ç¿»è¯‘å“ªä¸€è¡Œï¼ŒæŠŠç¼–è¯‘ç»“æœç¼“å­˜ã€‚V8çœç•¥äº†ç¿»è¯‘å­—èŠ‚ç çš„æ­¥éª¤ï¼Œç›´æ¥ç¿»è¯‘ä¸ºæœºå™¨ç \n\n## window å¯¹è±¡\n\n### æ¦‚è¿°\n\nåœ¨æµè§ˆå™¨ä¸­ï¼Œ`window` å¯¹è±¡ï¼ˆæ³¨æ„ï¼Œwä¸ºå°å†™ï¼‰æŒ‡å½“å‰çš„æµè§ˆå™¨çª—å£ã€‚å®ƒä¹Ÿæ˜¯æ‰€æœ‰å¯¹è±¡çš„é¡¶å±‚å¯¹è±¡ã€‚\n\n### window å±æ€§\n\n#### window.windowï¼Œwindow.name\n\n`window` å¯¹è±¡çš„ `window` å±æ€§æŒ‡å‘è‡ªèº«ã€‚\n\n`window.name` å±æ€§ç”¨äºè®¾ç½®å½“å‰æµè§ˆå™¨çª—å£çš„åå­—ã€‚è¯¥å±æ€§åªèƒ½ä¿å­˜å­—ç¬¦ä¸²ï¼Œä¸”å½“æµè§ˆå™¨çª—å£å…³é—­åï¼Œæ‰€ä¿å­˜çš„å€¼å°±ä¼šæ¶ˆå¤±ã€‚å› æ­¤å±€é™æ€§æ¯”è¾ƒå¤§ï¼Œä½†æ˜¯ä¸ `<iframe>` çª—å£é€šä¿¡æ—¶ï¼Œéå¸¸æœ‰ç”¨ã€‚\n\n#### window.location\n\n`window.location` è¿”å›ä¸€ä¸ª `location` å¯¹è±¡ï¼Œç”¨äºè·å–çª—å£å½“å‰çš„URLä¿¡æ¯ã€‚å®ƒç­‰åŒäº `document.location` å¯¹è±¡\n\n#### window.closedï¼Œwindow.opener\n\n`window.closed` å±æ€§è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºçª—å£æ˜¯å¦å…³é—­ã€‚\n\n`window.opener` å±æ€§è¿”å›æ‰“å¼€å½“å‰çª—å£çš„çˆ¶çª—å£ã€‚å¦‚æœå½“å‰çª—å£æ²¡æœ‰çˆ¶çª—å£ï¼Œåˆ™è¿”å› `null`ã€‚\n\n#### window.frames ï¼Œwindow.length\n\n`window.frames` å±æ€§è¿”å›ä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼Œæˆå‘˜ä¸ºé¡µé¢å†…æ‰€æœ‰æ¡†æ¶çª—å£\n\n`window.length` å±æ€§è¿”å›å½“å‰ç½‘é¡µåŒ…å«çš„æ¡†æ¶æ€»æ•°\n\n#### window.screenX ï¼Œwindow.screenY\n\n`window.screenX` å’Œ `window.screenY` å±æ€§ï¼Œè¿”å›æµè§ˆå™¨çª—å£å·¦ä¸Šè§’ç›¸å¯¹äºå½“å‰å±å¹•å·¦ä¸Šè§’ï¼ˆ`(0, 0)`ï¼‰çš„æ°´å¹³è·ç¦»å’Œå‚ç›´è·ç¦»ï¼Œå•ä½ä¸ºåƒç´ ã€‚\n\n#### window.outerHeightï¼Œwindow.outerWidth\n\n`window.outerHeight` å’Œ `window.outerWidth` å±æ€§è¿”å›æµè§ˆå™¨çª—å£çš„é«˜åº¦å’Œå®½åº¦ï¼ŒåŒ…æ‹¬æµè§ˆå™¨èœå•å’Œè¾¹æ¡†ï¼Œå•ä½ä¸ºåƒç´ ã€‚\n\n#### window.pageXOffsetï¼Œwindow.pageYOffset\n\n`window.pageXOffset` å±æ€§è¿”å›é¡µé¢çš„æ°´å¹³æ»šåŠ¨è·ç¦»ï¼Œ`window.pageYOffset` å±æ€§è¿”å›é¡µé¢çš„å‚ç›´æ»šåŠ¨è·ç¦»ï¼Œå•ä½éƒ½ä¸ºåƒç´ ã€‚\n\n### navigator å¯¹è±¡\n\n#### navigator.userAgent\n\n`navigator.userAgent` å±æ€§è¿”å›æµè§ˆå™¨çš„User-Agentå­—ç¬¦ä¸²ï¼Œæ ‡ç¤ºæµè§ˆå™¨çš„å‚å•†å’Œç‰ˆæœ¬ä¿¡æ¯ã€‚\n\nç”¨è¿‡ `userAgent` å±æ€§è¯†åˆ«æµè§ˆå™¨ä¸æ˜¯ä¸€ä¸ªå¥½æ–¹æ³•ï¼Œä½†æ˜¯ `userAgent` å¯ä»¥å¤§è‡´å‡†ç¡®åœ°è¯†åˆ«æ‰‹æœºæµè§ˆå™¨\n\n```js\nvar ua = navigator.userAgent.toLowerCase();\n\nif(/mobi/i.test(ua)){\n  //æ‰‹æœºæµè§ˆå™¨\n}else{\n  //éæ‰‹æœºæµè§ˆå™¨\n}\n```\n\n#### navigator.plugins\n\n`navigator.plugins` å±æ€§è¿”å›ä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼Œæˆå‘˜æ˜¯æµè§ˆå™¨å®‰è£…çš„æ’ä»¶ï¼Œæ¯”å¦‚Flashã€ActiveXç­‰ã€‚\n\n#### navigator.platform\n\n`navigator.platform` å±æ€§è¿”å›ç”¨æˆ·çš„æ“ä½œç³»ç»Ÿä¿¡æ¯ã€‚\n\n#### navigator.onLine\n\n`navigator.onLine` å±æ€§è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºç”¨æˆ·å½“å‰åœ¨çº¿è¿˜æ˜¯ç¦»çº¿ã€‚\n\n#### navigator.geolocation\n\n`navigator.geolocation` è¿”å›ä¸€ä¸ªGeolocationå¯¹è±¡ï¼ŒåŒ…å«ç”¨æˆ·åœ°ç†ä½ç½®çš„ä¿¡æ¯ã€‚\n\n#### navigator.javaEnabled()ï¼Œnavigator.cookieEnabled\n\n`javaEnabled` æ–¹æ³•è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæµè§ˆå™¨æ˜¯å¦èƒ½è¿è¡ŒJava Appletå°ç¨‹åº\n\n`cookieEnabled` å±æ€§è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæµè§ˆå™¨æ˜¯å¦èƒ½å‚¨å­˜Cookieã€‚\n\n### window.screen å¯¹è±¡\n\n`window.screen` å¯¹è±¡åŒ…å«äº†æ˜¾ç¤ºè®¾å¤‡çš„ä¿¡æ¯ã€‚\n\n### windowå¯¹è±¡çš„æ–¹æ³•\n\n#### window.moveTo()ï¼Œwindow.moveBy()\n\n`window.moveTo` æ–¹æ³•ç”¨äºç§»åŠ¨æµè§ˆå™¨çª—å£åˆ°æŒ‡å®šä½ç½®ã€‚å®ƒæ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯çª—å£å·¦ä¸Šè§’è·ç¦»å±å¹•å·¦ä¸Šè§’çš„æ°´å¹³è·ç¦»å’Œå‚ç›´è·ç¦»ï¼Œå•ä½ä¸ºåƒç´ ã€‚\n\n`window.moveBy` æ–¹æ³•å°†çª—å£ç§»åŠ¨åˆ°ä¸€ä¸ªç›¸å¯¹ä½ç½®ã€‚å®ƒæ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œåˆ†å¸ƒæ˜¯çª—å£å·¦ä¸Šè§’å‘å³ç§»åŠ¨çš„æ°´å¹³è·ç¦»å’Œå‘ä¸‹ç§»åŠ¨çš„å‚ç›´è·ç¦»ï¼Œå•ä½ä¸ºåƒç´ ã€‚\n\n#### window.scrollTo()ï¼Œwindow.scrollBy()\n\n`window.scrollTo` æ–¹æ³•ç”¨äºå°†ç½‘é¡µçš„æŒ‡å®šä½ç½®ï¼Œæ»šåŠ¨åˆ°æµè§ˆå™¨å·¦ä¸Šè§’ã€‚å®ƒçš„å‚æ•°æ˜¯ç›¸å¯¹äºæ•´å¼ ç½‘é¡µçš„æ¨ªåæ ‡å’Œçºµåæ ‡ã€‚å®ƒæœ‰ä¸€ä¸ªåˆ«å `window.scroll` ã€‚\n\n`window.scrollBy` æ–¹æ³•ç”¨äºå°†ç½‘é¡µç§»åŠ¨æŒ‡å®šè·ç¦»ï¼Œå•ä½ä¸ºåƒç´ ã€‚å®ƒæ¥å—ä¸¤ä¸ªå‚æ•°ï¼šå‘å³æ»šåŠ¨çš„åƒç´ ï¼Œå‘ä¸‹æ»šåŠ¨çš„åƒç´ ã€‚\n\n#### window.open(), window.close()\n\n`window.open` æ–¹æ³•ç”¨äºæ–°å»ºå¦ä¸€ä¸ªæµè§ˆå™¨çª—å£ï¼Œå¹¶ä¸”è¿”å›è¯¥çª—å£å¯¹è±¡ã€‚\n\n`window.close` æ–¹æ³•ç”¨äºå…³é—­å½“å‰çª—å£ï¼Œä¸€èˆ¬ç”¨æ¥å…³é—­window.openæ–¹æ³•æ–°å»ºçš„çª—å£ã€‚\n\n#### window.print()\n\n`print` æ–¹æ³•ä¼šè·³å‡ºæ‰“å°å¯¹è¯æ¡†ï¼ŒåŒç”¨æˆ·ç‚¹å‡»èœå•é‡Œé¢çš„â€œæ‰“å°â€å‘½ä»¤æ•ˆæœç›¸åŒã€‚\n\n#### window.getComputedStyle()\n\n`getComputedStyle` æ–¹æ³•æ¥å—ä¸€ä¸ªHTMLå…ƒç´ ä½œä¸ºå‚æ•°ï¼Œè¿”å›ä¸€ä¸ªåŒ…å«è¯¥HTMLå…ƒç´ çš„æœ€ç»ˆæ ·å¼ä¿¡æ¯çš„å¯¹è±¡\n\n#### window.matchMedia()\n\n`window.matchMedia` æ–¹æ³•ç”¨æ¥æ£€æŸ¥CSSçš„mediaQueryè¯­å¥\n\n#### window.focus()\n\n`focus` æ–¹æ³•ä¼šæ¿€æ´»æŒ‡å®šå½“å‰çª—å£ï¼Œä½¿å…¶è·å¾—ç„¦ç‚¹ã€‚\n\n#### window.getSelection()\n\n`window.getSelection` æ–¹æ³•è¿”å›ä¸€ä¸ª `Selection` å¯¹è±¡ï¼Œè¡¨ç¤ºç”¨æˆ·ç°åœ¨é€‰ä¸­çš„æ–‡æœ¬ã€‚\n\n### å¤šçª—å£æ“ä½œ\n\n#### çª—å£çš„å¼•ç”¨\n\n- top : é¡¶å±‚çª—å£ï¼Œå³æœ€ä¸Šå±‚çš„é‚£ä¸ªçª—å£\n- parent : çˆ¶çª—å£\n- self : å½“å‰çª—å£ï¼Œå³è‡ªèº«\n\n#### iframe æ ‡ç­¾\n\nå¯¹äº `iframe` åµŒå…¥çš„çª—å£ï¼Œ`document.getElementById` æ–¹æ³•å¯ä»¥æ‹¿åˆ°è¯¥çª—å£çš„DOMèŠ‚ç‚¹ï¼Œç„¶åä½¿ç”¨ `contentWindow` å±æ€§è·å¾— `iframe` èŠ‚ç‚¹åŒ…å«çš„ `window` å¯¹è±¡ï¼Œæˆ–è€…ä½¿ç”¨ `contentDocument` å±æ€§è·å¾—åŒ…å«çš„ `document` å¯¹è±¡ã€‚\n\n#### frames å±æ€§\n\n`window` å¯¹è±¡çš„ `frames` å±æ€§è¿”å›ä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼Œæˆå‘˜æ˜¯æ‰€æœ‰å­çª—å£çš„ `window` å¯¹è±¡\n\néœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ`window.frames` æ¯ä¸ªæˆå‘˜çš„å€¼ï¼Œæ˜¯æ¡†æ¶å†…çš„çª—å£ï¼ˆå³æ¡†æ¶çš„ `window` å¯¹è±¡ï¼‰ï¼Œè€Œä¸æ˜¯ `iframe` æ ‡ç­¾åœ¨çˆ¶çª—å£çš„DOMèŠ‚ç‚¹ã€‚å¦‚æœè¦è·å–æ¯ä¸ªæ¡†æ¶å†…éƒ¨çš„DOMæ ‘ï¼Œéœ€è¦ä½¿ç”¨ `window.frames[0].document` çš„å†™æ³•ã€‚\n\nå¦å¤–ï¼Œå¦‚æœ `iframe` å…ƒç´ è®¾ç½®äº† `name` æˆ– `id` å±æ€§ï¼Œé‚£ä¹ˆå±æ€§å€¼ä¼šè‡ªåŠ¨æˆä¸ºå…¨å±€å˜é‡ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡ `window.frames` å±æ€§å¼•ç”¨ï¼Œè¿”å›å­çª—å£çš„ `window` å¯¹è±¡ã€‚\n\n### äº‹ä»¶\n\n#### load äº‹ä»¶å’Œonload å±æ€§\n\n`load` äº‹ä»¶å‘ç”Ÿåœ¨æ–‡æ¡£åœ¨æµè§ˆå™¨çª—å£åŠ è½½å®Œæ¯•æ—¶ã€‚`window.onload` å±æ€§å¯ä»¥æŒ‡å®šè¿™ä¸ªäº‹ä»¶çš„å›è°ƒå‡½æ•°ã€‚\n\n#### error äº‹ä»¶å’Œ onerror å±æ€§\n\næµè§ˆå™¨è„šæœ¬å‘ç”Ÿé”™è¯¯æ—¶ï¼Œä¼šè§¦å‘ `window` å¯¹è±¡çš„ `error` äº‹ä»¶ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ `window.onerror` å±æ€§å¯¹è¯¥äº‹ä»¶æŒ‡å®šå›è°ƒå‡½æ•°ã€‚\n\nç”±äºå†å²åŸå› ï¼Œ`window `çš„ `error` äº‹ä»¶çš„å›è°ƒå‡½æ•°ä¸æ¥å—é”™è¯¯å¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œè€Œæ˜¯ä¸€å…±å¯ä»¥æ¥å—äº”ä¸ªå‚æ•°ï¼Œå®ƒä»¬çš„å«ä¹‰ä¾æ¬¡å¦‚ä¸‹ã€‚\n\n- å‡ºé”™ä¿¡æ¯\n- å‡ºé”™è„šæœ¬çš„ç½‘å€\n- è¡Œå·\n- åˆ—å·\n- é”™è¯¯å¯¹è±¡\n\nè€æµè§ˆå™¨åªæ”¯æŒå‰ä¸‰ä¸ªå‚æ•°\n\n### URLçš„ç¼–ç /è§£ç æ–¹æ³•\n\n#### encodeURI\n\n`encodeURI` æ–¹æ³•çš„å‚æ•°æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä»£è¡¨æ•´ä¸ªURLã€‚å®ƒä¼šå°†å…ƒå­—ç¬¦å’Œè¯­ä¹‰å­—ç¬¦ä¹‹å¤–çš„å­—ç¬¦ï¼Œéƒ½è¿›è¡Œè½¬ä¹‰ã€‚\n\n#### encodeURIComponent\n\n`encodeURIComponent` åªè½¬é™¤äº†è¯­ä¹‰å­—ç¬¦ä¹‹å¤–çš„å­—ç¬¦ï¼Œ**å…ƒå­—ç¬¦ä¹Ÿä¼šè¢«è½¬ä¹‰**ã€‚å› æ­¤ï¼Œå®ƒçš„å‚æ•°é€šå¸¸æ˜¯URLçš„è·¯å¾„æˆ–å‚æ•°å€¼ï¼Œè€Œä¸æ˜¯æ•´ä¸ªURLã€‚\n\n#### decodeURI\n\n`decodeURI` ç”¨äºè¿˜åŸè½¬ä¹‰åçš„URLã€‚å®ƒæ˜¯ `encodeURI` æ–¹æ³•çš„é€†è¿ç®—ã€‚\n\n#### decodeURIComponent\n\n`decodeURIComponent` ç”¨äºè¿˜åŸè½¬ä¹‰åçš„URLç‰‡æ®µã€‚å®ƒæ˜¯ `encodeURIComponent` æ–¹æ³•çš„é€†è¿ç®—ã€‚\n\n#### alert()ï¼Œprompt()ï¼Œconfirm()\n\n`alert` æ–¹æ³•å¼¹å‡ºçš„å¯¹è¯æ¡†ï¼Œåªæœ‰ä¸€ä¸ªâ€œç¡®å®šâ€æŒ‰é’®ï¼Œå¾€å¾€ç”¨æ¥é€šçŸ¥ç”¨æˆ·æŸäº›ä¿¡æ¯ã€‚\n\n`prompt` æ–¹æ³•å¼¹å‡ºçš„å¯¹è¯æ¡†ï¼Œåœ¨æç¤ºæ–‡å­—çš„ä¸‹æ–¹ï¼Œè¿˜æœ‰ä¸€ä¸ªè¾“å…¥æ¡†ï¼Œè¦æ±‚ç”¨æˆ·è¾“å…¥ä¿¡æ¯ï¼Œå¹¶æœ‰â€œç¡®å®šâ€å’Œâ€œå–æ¶ˆâ€ä¸¤ä¸ªæŒ‰é’®ã€‚å®ƒå¾€å¾€ç”¨æ¥è·å–ç”¨æˆ·è¾“å…¥çš„æ•°æ®ã€‚\n\n`confirm` æ–¹æ³•å¼¹å‡ºçš„å¯¹è¯æ¡†ï¼Œé™¤äº†æç¤ºä¿¡æ¯ä¹‹å¤–ï¼Œåªæœ‰â€œç¡®å®šâ€å’Œâ€œå–æ¶ˆâ€ä¸¤ä¸ªæŒ‰é’®ï¼Œå¾€å¾€ç”¨æ¥å¾è¯¢ç”¨æˆ·çš„æ„è§ã€‚\n\n## history å¯¹è±¡\n\n### æ¦‚è¿°\n\næµè§ˆå™¨çª—å£æœ‰ä¸€ä¸ª `history` å¯¹è±¡ï¼Œç”¨æ¥ä¿å­˜æµè§ˆå†å²\n\n`history` å¯¹è±¡æä¾›äº†ä¸€ç³»åˆ—æ–¹æ³•ï¼Œå…è®¸åœ¨æµè§ˆå™¨å†å²ä¹‹é—´ç§»åŠ¨\n\n- `back` : ç§»åŠ¨åˆ°ä¸Šä¸€ä¸ªè®¿é—®é¡µé¢ï¼Œç­‰åŒäºæµè§ˆå™¨çš„åé€€é”®\n- `forward` : ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªè®¿é—®é¡µé¢ï¼Œç­‰åŒäºæµè§ˆå™¨çš„å‰è¿›é”®\n- `go` : æ¥å—ä¸€ä¸ªæ•´æ•°ä½œä¸ºå‚æ•°ï¼Œç§»åŠ¨åˆ°è¯¥æ•´æ•°æŒ‡å®šçš„é¡µé¢ï¼Œ`go(0)` ç›¸å½“äºåˆ·æ–°é¡µé¢\n\n### history.pushState()\n\næ¥å—ä¸‰ä¸ªå‚æ•°\n\n- `state` ï¼šä¸€ä¸ªä¸æŒ‡å®šç½‘å€ç›¸å…³çš„çŠ¶æ€å¯¹è±¡ï¼Œ`popstate` äº‹ä»¶è§¦å‘æ—¶ï¼Œè¯¥å¯¹è±¡ä¼šä¼ å…¥å›è°ƒå‡½æ•°ã€‚å¦‚æœä¸éœ€è¦è¿™ä¸ªå¯¹è±¡ï¼Œæ­¤å¤„å¯ä»¥å¡« `null` ã€‚\n- `title` ï¼šæ–°é¡µé¢çš„æ ‡é¢˜ï¼Œä½†æ˜¯æ‰€æœ‰æµè§ˆå™¨ç›®å‰éƒ½å¿½ç•¥è¿™ä¸ªå€¼ï¼Œå› æ­¤è¿™é‡Œå¯ä»¥å¡« `null`ã€‚\n- `url` ï¼šæ–°çš„ç½‘å€ï¼Œå¿…é¡»ä¸å½“å‰é¡µé¢å¤„åœ¨åŒä¸€ä¸ªåŸŸã€‚æµè§ˆå™¨çš„åœ°å€æ å°†æ˜¾ç¤ºè¿™ä¸ªç½‘å€ã€‚\n\n```js\nvar stateObj = { foo: 'bar' };\nhistory.pushState(stateObj, 'page 2', '2.html');\n```\n\næ·»åŠ ä¸Šé¢è¿™ä¸ªæ–°è®°å½•åï¼Œæµè§ˆå™¨åœ°å€æ ç«‹åˆ»æ˜¾ç¤º `example.com/2.html`ï¼Œä½†å¹¶ä¸ä¼šè·³è½¬åˆ°`2.html`ï¼Œç”šè‡³ä¹Ÿä¸ä¼šæ£€æŸ¥ `2.html` æ˜¯å¦å­˜åœ¨ï¼Œå®ƒåªæ˜¯æˆä¸ºæµè§ˆå†å²ä¸­çš„æœ€æ–°è®°å½•ã€‚è¿™æ—¶ï¼Œä½ åœ¨åœ°å€æ è¾“å…¥ä¸€ä¸ªæ–°çš„åœ°å€(æ¯”å¦‚è®¿é—® `google.com` )ï¼Œç„¶åç‚¹å‡»äº†å€’é€€æŒ‰é’®ï¼Œé¡µé¢çš„ `URL` å°†æ˜¾ç¤º `2.html`ï¼›ä½ å†ç‚¹å‡»ä¸€æ¬¡å€’é€€æŒ‰é’®ï¼ŒURL å°†æ˜¾ç¤º `1.html`ã€‚\n\næ€»ä¹‹ï¼Œ`pushState`æ–¹æ³•ä¸ä¼šè§¦å‘é¡µé¢åˆ·æ–°ï¼Œåªæ˜¯å¯¼è‡´`history`å¯¹è±¡å‘ç”Ÿå˜åŒ–ï¼Œåœ°å€æ ä¼šæœ‰ååº”ã€‚\n\nå¦‚æœ `pushStateçš„url` å‚æ•°ï¼Œè®¾ç½®äº†ä¸€ä¸ªæ–°çš„é”šç‚¹å€¼ï¼ˆå³hashï¼‰ï¼Œå¹¶ä¸ä¼šè§¦å‘ `hashchange` äº‹ä»¶ã€‚å¦‚æœè®¾ç½®äº†ä¸€ä¸ªè·¨åŸŸç½‘å€ï¼Œåˆ™ä¼šæŠ¥é”™ã€‚\n\n### history.replaceState()\n\n`history.replaceState` æ–¹æ³•çš„å‚æ•°ä¸ `pushState` æ–¹æ³•ä¸€æ¨¡ä¸€æ ·ï¼ŒåŒºåˆ«æ˜¯å®ƒä¿®æ”¹æµè§ˆå†å²ä¸­å½“å‰è®°å½•ã€‚\n\n### history.stateå±æ€§\n\n`history.state` å±æ€§è¿”å›å½“å‰é¡µé¢çš„ `state` å¯¹è±¡ã€‚\n\n### popstate äº‹ä»¶\n\næ¯å½“åŒä¸€ä¸ªæ–‡æ¡£çš„æµè§ˆå†å²ï¼ˆå³ `history` å¯¹è±¡ï¼‰å‡ºç°å˜åŒ–æ—¶ï¼Œå°±ä¼šè§¦å‘ `popstate` äº‹ä»¶ã€‚\n\néœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä»…ä»…è°ƒç”¨ `pushState` æ–¹æ³•æˆ– `replaceState` æ–¹æ³• ï¼Œå¹¶ä¸ä¼šè§¦å‘è¯¥äº‹ä»¶ï¼Œåªæœ‰ç”¨æˆ·ç‚¹å‡»æµè§ˆå™¨å€’é€€æŒ‰é’®å’Œå‰è¿›æŒ‰é’®ï¼Œæˆ–è€…ä½¿ç”¨ JavaScript è°ƒç”¨ `back`ã€`forward`ã€`go` æ–¹æ³•æ—¶æ‰ä¼šè§¦å‘ã€‚å¦å¤–ï¼Œè¯¥äº‹ä»¶åªé’ˆå¯¹åŒä¸€ä¸ªæ–‡æ¡£ï¼Œå¦‚æœæµè§ˆå†å²çš„åˆ‡æ¢ï¼Œå¯¼è‡´åŠ è½½ä¸åŒçš„æ–‡æ¡£ï¼Œè¯¥äº‹ä»¶ä¹Ÿä¸ä¼šè§¦å‘ã€‚\n\nå¯ä»¥ç”¨ `onpushState` æ¥å—å›è°ƒå‡½æ•°ï¼Œå®ƒæ¥å—ä¸€ä¸ª `event` çš„å›è°ƒå‚æ•°ï¼Œé€šè¿‡ `pushState` å’Œ `replaceState` æ–¹æ³•ä¼ é€’çš„ç¬¬ä¸€ä¸ªå‚æ•°ã€‚ä¹Ÿå¯ä»¥é€šè¿‡ `history.state` å¯¹è±¡è·å–ã€‚\n\næ³¨æ„ï¼Œé¡µé¢ç¬¬ä¸€æ¬¡åŠ è½½çš„æ—¶å€™ä¸ä¼šè§¦å‘ `popstate` äº‹ä»¶\n\n### URLSearchParams API\n\nURLSearchParams APIç”¨äºå¤„ç†URLä¹‹ä¸­çš„æŸ¥è¯¢å­—ç¬¦ä¸²ï¼Œå³é—®å·ä¹‹åçš„éƒ¨åˆ†\n\n- `has()` ï¼šè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦å…·æœ‰æŸä¸ªå‚æ•°\n- `get()` ï¼šè¿”å›æŒ‡å®šå‚æ•°çš„ç¬¬ä¸€ä¸ªå€¼\n- `getAll()` ï¼šè¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œæˆå‘˜æ˜¯æŒ‡å®šå‚æ•°çš„æ‰€æœ‰å€¼\n- `set()` ï¼šè®¾ç½®æŒ‡å®šå‚æ•°\n- `delete()` ï¼šåˆ é™¤æŒ‡å®šå‚æ•°\n- `append()` ï¼šåœ¨æŸ¥è¯¢å­—ç¬¦ä¸²ä¹‹ä¸­ï¼Œè¿½åŠ ä¸€ä¸ªé”®å€¼å¯¹\n- `toString()` ï¼šè¿”å›æ•´ä¸ªæŸ¥è¯¢å­—ç¬¦ä¸²\n\n```js\nvar paramsString = 'q=URLUtils.searchParams&topic=api';\nvar searchParams = new URLSearchParams(paramsString);\n\nsearchParams.has('topic') // true\n```\n\n- `keys()` ï¼šéå†æ‰€æœ‰å‚æ•°å\n- `values()` ï¼šéå†æ‰€æœ‰å‚æ•°å€¼\n- `entries()` ï¼šéå†æ‰€æœ‰å‚æ•°çš„é”®å€¼å¯¹\n\nDOMçš„ `a` å…ƒç´ èŠ‚ç‚¹çš„ `searchParams` å±æ€§ï¼Œå°±æ˜¯ä¸€ä¸ª `URLSearchParams` å®ä¾‹ã€‚\n\n```js\nvar a = document.createElement('a');\na.href = 'https://example.com?filter=api';\na.searchParams.get('filter') // \"api\"\n```\n\n`URLSearchParams `è¿˜å¯ä»¥ä¸ `URL` æ¥å£ç»“åˆä½¿ç”¨ã€‚\n\n```js\nvar url = new URL(location);\nvar foo = url.searchParams.get('foo') || 'somedefault';\n```\n\n## Cookie\n\n### æ¦‚è¿°\n\nCookie æ˜¯æœåŠ¡å™¨ä¿å­˜åœ¨æµè§ˆå™¨çš„ä¸€å°æ®µæ–‡æœ¬ä¿¡æ¯ï¼Œæ¯ä¸ª Cookie çš„å¤§å°ä¸€èˆ¬ä¸èƒ½è¶…è¿‡4KBã€‚æµè§ˆå™¨æ¯æ¬¡å‘æœåŠ¡å™¨å‘å‡ºè¯·æ±‚ï¼Œå°±ä¼šè‡ªåŠ¨é™„ä¸Šè¿™æ®µä¿¡æ¯ã€‚\n\nCookie ä¿å­˜ä»¥ä¸‹å‡ æ–¹é¢çš„ä¿¡æ¯\n\n- Cookie çš„åå­—\n- Cookie çš„å€¼\n- åˆ°æœŸæ—¶é—´\n- æ‰€å±åŸŸå\n- ç”Ÿæ•ˆçš„è·¯å¾„\n\næµè§ˆå™¨å¯ä»¥è®¾ç½®ä¸æ¥å— Cookieï¼Œä¹Ÿå¯ä»¥è®¾ç½®ä¸å‘æœåŠ¡å™¨å‘é€ Cookie\n\n`window.navigation.cookieEnabled` å±æ€§è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæµè§ˆå™¨æ˜¯å¦æ‰“å¼€ Cookie åŠŸèƒ½\n\n`document.cookie` è¿”å›æ‰€æœ‰ Cookieï¼Œ`document.cookie` ä¸€æ¬¡åªèƒ½å†™å…¥ä¸€ä¸ª Cookie\n\n### Cookie çš„å±æ€§\n\næœåŠ¡å™¨å‘æµè§ˆå™¨å‘é€ Cookie çš„æ—¶å€™ï¼Œé™¤äº† Cookie æœ¬èº«çš„å†…å®¹ï¼Œè¿˜æœ‰ä¸€äº›å¯é€‰çš„å±æ€§ä¹Ÿæ˜¯å¯ä»¥å†™å…¥çš„ï¼Œå®ƒä»¬éƒ½å¿…é¡»ä»¥åˆ†å·å¼€å¤´ã€‚\n\nï¼ˆ1ï¼‰value å±æ€§\n\n`value` å±æ€§æ˜¯å¿…éœ€çš„ï¼Œå®ƒæ˜¯ä¸€ä¸ªé”®å€¼å¯¹ï¼Œç”¨äºæŒ‡å®šCookieçš„å€¼ã€‚\n\nï¼ˆ2ï¼‰expires å±æ€§\n\n`expires` å±æ€§ç”¨äºæŒ‡å®š Cookie è¿‡æœŸæ—¶é—´ã€‚å®ƒçš„æ ¼å¼é‡‡ç”¨ `Date.toUTCString()` çš„æ ¼å¼ã€‚\n\nå¦‚æœä¸è®¾ç½®è¯¥å±æ€§ï¼Œæˆ–è€…è®¾ä¸º`null`ï¼ŒCookieåªåœ¨å½“å‰ä¼šè¯ï¼ˆsessionï¼‰æœ‰æ•ˆï¼Œæµè§ˆå™¨çª—å£ä¸€æ—¦å…³é—­ï¼Œå½“å‰ Session ç»“æŸï¼Œè¯¥ Cookie å°±ä¼šè¢«åˆ é™¤ã€‚\n\næµè§ˆå™¨æ ¹æ®æœ¬åœ°æ—¶é—´ï¼Œå†³å®š Cookie æ˜¯å¦è¿‡æœŸï¼Œç”±äºæœ¬åœ°æ—¶é—´æ˜¯ä¸ç²¾ç¡®çš„ï¼Œæ‰€ä»¥æ²¡æœ‰åŠæ³•ä¿è¯ Cookie ä¸€å®šä¼šåœ¨æœåŠ¡å™¨æŒ‡å®šçš„æ—¶é—´è¿‡æœŸã€‚\n\nï¼ˆ3ï¼‰domainå±æ€§\n\n`domain` å±æ€§æŒ‡å®š Cookie æ‰€åœ¨çš„åŸŸåï¼Œæ¯”å¦‚ `example.com` æˆ– `.example.com` ï¼ˆè¿™ç§å†™æ³•å°†å¯¹æ‰€æœ‰å­åŸŸåç”Ÿæ•ˆï¼‰ã€`subdomain.example.com` ã€‚\n\nå¦‚æœæœªæŒ‡å®šï¼Œé»˜è®¤ä¸ºè®¾å®šè¯¥Cookieçš„åŸŸåã€‚æ‰€æŒ‡å®šçš„åŸŸåå¿…é¡»æ˜¯å½“å‰å‘é€Cookieçš„åŸŸåçš„ä¸€éƒ¨åˆ†ï¼Œæ¯”å¦‚å½“å‰è®¿é—®çš„åŸŸåæ˜¯ `example.com` ï¼Œå°±ä¸èƒ½å°†å…¶è®¾ä¸º `google.com` ã€‚åªæœ‰è®¿é—®çš„åŸŸååŒ¹é… `domain` å±æ€§ï¼ŒCookie æ‰ä¼šå‘é€åˆ°æœåŠ¡å™¨ã€‚\n\nï¼ˆ4ï¼‰path å±æ€§\n\n`path` å±æ€§ç”¨æ¥æŒ‡å®šè·¯å¾„ï¼Œå¿…é¡»æ˜¯ç»å¯¹è·¯å¾„ï¼ˆæ¯”å¦‚/ã€/mydirï¼‰ï¼Œå¦‚æœæœªæŒ‡å®šï¼Œé»˜è®¤ä¸ºè¯·æ±‚è¯¥ Cookie çš„ç½‘é¡µè·¯å¾„ã€‚\n\nåªæœ‰pathå±æ€§åŒ¹é…å‘æœåŠ¡å™¨å‘é€çš„è·¯å¾„ï¼ŒCookie æ‰ä¼šå‘é€ã€‚è¿™é‡Œçš„åŒ¹é…ä¸æ˜¯ç»å¯¹åŒ¹é…ï¼Œè€Œæ˜¯ä»æ ¹è·¯å¾„å¼€å§‹ï¼Œåªè¦ `path` å±æ€§åŒ¹é…å‘é€è·¯å¾„çš„ä¸€éƒ¨åˆ†ï¼Œå°±å¯ä»¥å‘é€ã€‚æ¯”å¦‚ï¼Œpathå±æ€§ç­‰äº `/blog`ï¼Œåˆ™å‘é€è·¯å¾„æ˜¯ `/blog` æˆ–è€… `/blog/roll` ï¼ŒCookieéƒ½ä¼šå‘é€ã€‚pathå±æ€§ç”Ÿæ•ˆçš„å‰ææ˜¯domainå±æ€§åŒ¹é…ã€‚\n\nï¼ˆ5ï¼‰secure å±æ€§\n\nsecureå±æ€§ç”¨æ¥æŒ‡å®šCookieåªèƒ½åœ¨åŠ å¯†åè®®HTTPSä¸‹å‘é€åˆ°æœåŠ¡å™¨ã€‚\n\nè¯¥å±æ€§åªæ˜¯ä¸€ä¸ªå¼€å…³ï¼Œä¸éœ€è¦æŒ‡å®šå€¼ã€‚å¦‚æœé€šä¿¡æ˜¯HTTPSåè®®ï¼Œè¯¥å¼€å…³è‡ªåŠ¨æ‰“å¼€ã€‚\n\nï¼ˆ6ï¼‰max-age\n\n`max-age` å±æ€§ç”¨æ¥æŒ‡å®šCookieæœ‰æ•ˆæœŸï¼Œæ¯”å¦‚ `60 * 60 * 24 * 365`ï¼ˆå³ä¸€å¹´31536e3ç§’ï¼‰ã€‚\n\nï¼ˆ7ï¼‰HttpOnly\n\n`HttpOnly` å±æ€§ç”¨äºè®¾ç½®è¯¥Cookieä¸èƒ½è¢«JavaScriptè¯»å–ï¼Œè¯¦è§ä¸‹æ–‡çš„è¯´æ˜ã€‚\n\nä»¥ä¸Šå±æ€§å¯ä»¥åŒæ—¶è®¾ç½®ä¸€ä¸ªæˆ–å¤šä¸ªï¼Œä¹Ÿæ²¡æœ‰æ¬¡åºçš„è¦æ±‚ã€‚å¦‚æœæœåŠ¡å™¨æƒ³æ”¹å˜ä¸€ä¸ªæ—©å…ˆè®¾ç½®çš„Cookieï¼Œå¿…é¡»åŒæ—¶æ»¡è¶³å››ä¸ªæ¡ä»¶ï¼šCookieçš„ `key`ã€`domain`ã€`path` å’Œ `secure` éƒ½åŒ¹é…ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœåŸå§‹çš„Cookieæ˜¯ç”¨å¦‚ä¸‹çš„ `Set-Cookie` è®¾ç½®çš„ã€‚\n\n### Cookie çš„é™åˆ¶\n\næµè§ˆå™¨å¯¹ Cookie æ•°é‡çš„é™åˆ¶ï¼Œè§„å®šä¸ä¸€æ ·ã€‚ç›®å‰ï¼ŒFirefox æ˜¯æ¯ä¸ªåŸŸåæœ€å¤šè®¾ç½®50ä¸ª Cookieï¼Œè€Œ Safari å’Œ Chrome æ²¡æœ‰åŸŸåæ•°é‡çš„é™åˆ¶ã€‚\n\næ‰€æœ‰ Cookie çš„ç´¯åŠ é•¿åº¦é™åˆ¶ä¸º4KBã€‚è¶…è¿‡è¿™ä¸ªé•¿åº¦çš„ Cookieï¼Œå°†è¢«å¿½ç•¥ï¼Œä¸ä¼šè¢«è®¾ç½®ã€‚\n\nç”±äº Cookie å¯èƒ½å­˜åœ¨æ•°é‡é™åˆ¶ï¼Œæœ‰æ—¶ä¸ºäº†è§„é¿é™åˆ¶ï¼Œå¯ä»¥å°† Cookie è®¾ç½®æˆä¸‹é¢çš„å½¢å¼ã€‚\n\n```\nname=a=b&c=d&e=f&g=h\n```\n\nä¸Šé¢ä»£ç å®é™…ä¸Šæ˜¯è®¾ç½®äº†ä¸€ä¸ª Cookieï¼Œä½†æ˜¯è¿™ä¸ª Cookie å†…éƒ¨ä½¿ç”¨&ç¬¦å·ï¼Œè®¾ç½®äº†å¤šéƒ¨åˆ†çš„å†…å®¹ã€‚å› æ­¤ï¼Œè¯»å–è¿™ä¸ª Cookie çš„æ—¶å€™ï¼Œå°±è¦è‡ªè¡Œè§£æï¼Œå¾—åˆ°å¤šä¸ªé”®å€¼å¯¹ã€‚è¿™æ ·å°±è§„é¿äº† Cookie çš„æ•°é‡é™åˆ¶ã€‚\n\n### åŒæºæ”¿ç­–\n\næµè§ˆå™¨çš„åŒæºæ”¿ç­–è§„å®šï¼Œä¸¤ä¸ªç½‘å€åªè¦åŸŸåç›¸åŒå’Œç«¯å£ç›¸åŒï¼Œå°±å¯ä»¥å…±äº« Cookieã€‚\n\n### Http-Only Cookie\n\nè®¾ç½® Cookie çš„æ—¶å€™ï¼Œå¦‚æœæœåŠ¡å™¨åŠ ä¸Šäº† `HttpOnly` å±æ€§ï¼Œåˆ™è¿™ä¸ª Cookie æ— æ³•è¢« JavaScript è¯»å–ï¼ˆå³ `document.cookie` ä¸ä¼šè¿”å›è¿™ä¸ªCookieçš„å€¼ï¼‰ï¼Œåªç”¨äºå‘æœåŠ¡å™¨å‘é€\n\n## Web Storage ã€Œ æµè§ˆå™¨ç«¯æ•°æ®å‚¨å­˜æœºåˆ¶ ã€\n\n### æ¦‚è¿°\n\n`sessionStorage` ä¿å­˜çš„æ•°æ®ç”¨äºæµè§ˆå™¨çš„ä¸€æ¬¡ä¼šè¯ï¼Œå½“ä¼šè¯ç»“æŸï¼ˆé€šå¸¸æ˜¯è¯¥çª—å£å…³é—­ï¼‰ï¼Œæ•°æ®è¢«æ¸…ç©ºï¼›`localStorage` ä¿å­˜çš„æ•°æ®é•¿æœŸå­˜åœ¨ï¼Œä¸‹ä¸€æ¬¡è®¿é—®è¯¥ç½‘ç«™çš„æ—¶å€™ï¼Œç½‘é¡µå¯ä»¥ç›´æ¥è¯»å–ä»¥å‰ä¿å­˜çš„æ•°æ®ã€‚é™¤äº†ä¿å­˜æœŸé™çš„é•¿çŸ­ä¸åŒï¼Œè¿™ä¸¤ä¸ªå¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•å®Œå…¨ä¸€æ ·ã€‚\n\n### æ“ä½œæ–¹æ³•\n\n#### å­˜å…¥/è¯»å–æ•°æ®\n\n```js\nsessionStorage.setItem(\"key\",\"value\")\nlocalStorage.setItem(\"key\",\"value\")\n```\n\n```js\nvar valueSession = sessionStorage.getItem(\"key\")\nvar valueLocal = localStorage.getItem(\"key\")\n```\n\n#### æ¸…é™¤æ•°æ®\n\n`removeItem('key')` æ–¹æ³•ç”¨äºæ¸…é™¤å¯¹åº”é”®åçš„å€¼\n\n`clear` æ–¹æ³•ç”¨äºæ¸…é™¤æ‰€æœ‰ä¿å­˜çš„æ•°æ®\n\n#### éå†æ“ä½œ\n\n```js\nfor(var i = 0;i < localStorage.length ;i++){\n  console.log(localSotrage.key(i));\n}\n```\n\n### storage äº‹ä»¶\n\nå½“å‚¨å­˜çš„æ•°æ®å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œä¼šè§¦å‘ storage äº‹ä»¶\n\n```js\nwindow.addEventListener(\"storage\",callback);\n```\n\nå›è°ƒå‡½æ•°æ¥å—ä¸€ä¸ª event å¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œè¿™ä¸ª event å¯¹è±¡çš„ `key` å±æ€§ï¼Œä¿å­˜å‘ç”Ÿå˜åŒ–çš„é”®å\n\né™¤äº† `key` å±æ€§å¤–ï¼Œ event å±æ€§è¿˜æœ‰ä¸‰ä¸ª\n\n- `oldValue` ï¼šæ›´æ–°å‰çš„å€¼ã€‚å¦‚æœè¯¥é”®ä¸ºæ–°å¢åŠ ï¼Œåˆ™è¿™ä¸ªå±æ€§ä¸º `null`ã€‚\n- `newValue` ï¼šæ›´æ–°åçš„å€¼ã€‚å¦‚æœè¯¥é”®è¢«åˆ é™¤ï¼Œåˆ™è¿™ä¸ªå±æ€§ä¸º `null`ã€‚\n- `url` ï¼šåŸå§‹è§¦å‘ `storage` äº‹ä»¶çš„é‚£ä¸ªç½‘é¡µçš„ç½‘å€ã€‚\n\nå€¼å¾—ç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼Œ**è¯¥äº‹ä»¶ä¸åœ¨å¯¼è‡´æ•°æ®å˜åŒ–çš„å½“å‰é¡µé¢è§¦å‘**ã€‚å¦‚æœæµè§ˆå™¨åŒæ—¶æ‰“å¼€ä¸€ä¸ªåŸŸåä¸‹é¢çš„å¤šä¸ªé¡µé¢ï¼Œå½“å…¶ä¸­çš„ä¸€ä¸ªé¡µé¢æ”¹å˜ `sessionStorage` æˆ– `localStorage` çš„æ•°æ®æ—¶ï¼Œå…¶ä»–æ‰€æœ‰é¡µé¢çš„ `storage` äº‹ä»¶ä¼šè¢«è§¦å‘ï¼Œè€ŒåŸå§‹é¡µé¢å¹¶ä¸è§¦å‘ `storage` äº‹ä»¶ã€‚å¯ä»¥é€šè¿‡è¿™ç§æœºåˆ¶ï¼Œå®ç°å¤šä¸ªçª—å£ä¹‹é—´çš„é€šä¿¡ã€‚æ‰€æœ‰æµè§ˆå™¨ä¹‹ä¸­ï¼Œåªæœ‰IEæµè§ˆå™¨é™¤å¤–ï¼Œå®ƒä¼šåœ¨æ‰€æœ‰é¡µé¢è§¦å‘ `storage` äº‹ä»¶ã€‚\n\n## åŒæºæ”¿ç­–\n\n### æ¦‚è¿°\n\n#### å«ä¹‰\n\n1995 å¹´ï¼ŒåŒæºæ”¿ç­–ç”± Netscape å…¬å¸å¼•å…¥æµè§ˆå™¨ã€‚ç›®å‰ï¼Œæ‰€æœ‰æµè§ˆå™¨éƒ½å®è¡Œè¿™ä¸ªæ”¿ç­–\n\næœ€åˆï¼Œå®ƒçš„å‡½æ•°æ˜¯æŒ‡ï¼ŒAç½‘é¡µè®¾ç½®çš„Cookieï¼ŒBç½‘é¡µä¸èƒ½æ‰“å¼€ï¼Œé™¤éè¿™ä¸¤ä¸ªç½‘é¡µã€ŒåŒæºã€\n\n- åè®®å½¢åŒ\n- åŸŸåç›¸åŒ\n- ç«¯å£ç›¸åŒ\n\n#### ç›®çš„\n\nä¸ºäº†ä¿è¯ç”¨æˆ·çš„å®‰å…¨ï¼ŒA ç½‘ç«™çš„ Cookie æ²¡æœ‰åŒæºæ”¿ç­–å°±å¯ä»¥ è¢«å…¶å®ƒæµè§ˆçš„ç½‘ç«™çªƒå–ã€‚\n\n#### é™åˆ¶èŒƒå›´\n\n- Cookieã€LocalStorage å’Œ IndexedDB æ— æ³•è¯»å–ã€‚\n- DOM æ— æ³•è·å¾—ã€‚\n- AJAX è¯·æ±‚æ— æ•ˆï¼ˆå¯ä»¥å‘é€ï¼Œä½†æµè§ˆå™¨ä¼šæ‹’ç»æ¥å—å“åº”ï¼‰ã€‚\n\n### Cookie\n\nå½“ä¸¤ä¸ªç½‘é¡µçš„ä¸€çº§åŸŸåç›¸åŒï¼Œåªæ˜¯äºŒçº§åŸŸåä¸åŒæ—¶ï¼Œæµè§ˆå™¨å…è®¸é€šè¿‡è®¾ç½® `document.domain` å…±äº« Cookie\n\nä¸¾ä¾‹æ¥è¯´ï¼ŒAç½‘é¡µæ˜¯ `http://w1.example.com/a.html` ï¼ŒBç½‘é¡µæ˜¯ `http://w2.example.com/b.html` ï¼Œé‚£ä¹ˆåªè¦è®¾ç½®ç›¸åŒçš„ `document.domain` ï¼Œä¸¤ä¸ªç½‘é¡µå°±å¯ä»¥å…±äº«Cookieã€‚\n\n### iframe\n\nå…³äºå®Œå…¨ä¸åŒæºçš„ç½‘ç«™ï¼Œç›®å‰æœ‰ä¸¤ç§æ–¹æ³•ï¼Œå¯ä»¥è§£å†³è·¨åŸŸçª—å£çš„é€šä¿¡é—®é¢˜\n\n#### ç‰‡æ®µè¯†åˆ«ç¬¦\n\nç‰‡æ®µæ ‡è¯†ç¬¦æŒ‡çš„æ˜¯ URL çš„ `#` å·åé¢çš„éƒ¨åˆ†ã€‚å¦‚æœåªæ˜¯æ”¹å˜ç‰‡æ®µæ ‡è¯†ç¬¦ï¼Œé¡µé¢ä¸ä¼šé‡æ–°åˆ·æ–°\n\nçˆ¶çª—å£å¯ä»¥æŠŠä¿¡æ¯ï¼Œå†™å…¥å­çª—å£çš„ç‰‡æ®µæ ‡è¯†ç¬¦\n\n```js\nvar src = originURL + '#' + data;\ndocument.getElementById('myIFrame').src = src;\n```\n\nå­çª—å£é€šè¿‡ `hashchange` äº‹ä»¶å¾—åˆ°é€šçŸ¥\n\n```js\nwindow.onhashchange = checkMessage;\n\nfunction checkMessage() {\n  var message = window.location.hash;\n  // ...\n}r\n```\n\nåŒæ ·çš„ï¼Œå­çª—å£ä¹Ÿå¯ä»¥æ”¹å˜çˆ¶çª—å£çš„ç‰‡æ®µæ ‡è¯†ç¬¦ã€‚\n\n```js\nparent.location.href= target + '#' + hash;\n```\n\n#### window.postMessage\n\næ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å‘é€çš„æ•°æ®ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æ¥å—æ¶ˆæ¯çš„çª—å£çš„æºï¼Œå³\"åè®®+åŸŸå+ç«¯å£\"\n\n```js\nwindow.postMessage(\"hellp\",\"http://example.com:80\");\n```\n\næ¥å—ä¿¡æ¯\n\n```js\nwindow.addEventListener(\"message\",function(e){\n  e.data//æ•°æ®\n})\n```\n\n`message` äº‹ä»¶çš„å¯¹è±¡ `event` æä¾›ä¸‰ä¸ªå±æ€§\n\n- `event.source` å‘é€æ¶ˆæ¯çš„çª—å£\n- `event.origin` æ¶ˆæ¯å‘å‘çš„ç½‘å€\n- `event.data` æ¶ˆæ¯å†…å®¹\n\n### AJAX\n\nåŒæºæ”¿ç­–è§„å®šï¼ŒAJAXè¯·æ±‚åªèƒ½å‘ç»™åŒæºçš„ç½‘å€ï¼Œå¦åˆ™å°±æŠ¥é”™ã€‚\n\né™¤äº†æ¶è®¾æœåŠ¡å™¨ä»£ç†ï¼ˆæµè§ˆå™¨è¯·æ±‚åŒæºæœåŠ¡å™¨ï¼Œå†ç”±åè€…è¯·æ±‚å¤–éƒ¨æœåŠ¡ï¼‰ï¼Œæœ‰ä¸‰ç§æ–¹æ³•è§„é¿è¿™ä¸ªé™åˆ¶ã€‚\n\n#### JSONP\n\nåŸºæœ¬æ€æƒ³æ˜¯ï¼Œç½‘é¡µé€šè¿‡æ·»åŠ ä¸€ä¸ª `<script>` å…ƒç´ ï¼Œå‘æœåŠ¡å™¨è¯·æ±‚JSONæ•°æ®ï¼Œè¿™ç§åšæ³•ä¸å—åŒæºæ”¿ç­–é™åˆ¶ï¼›æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚åï¼Œå°†æ•°æ®æ”¾åœ¨ä¸€ä¸ªæŒ‡å®šçš„å›è°ƒå‡½æ•°é‡Œä¼ å›æ¥\n\né¦–å…ˆç½‘é¡µåŠ¨æ€æ’å…¥ `<script>` å…ƒç´ ï¼Œç”±å®ƒå‘è·¨æºç½‘å€å‘å‡ºè¯·æ±‚\n\n```js\nfunction addScriptTag(src) {\n  var script = document.createElement('script');\n  script.setAttribute(\"type\",\"text/javascript\");\n  script.src = src;\n  document.body.appendChild(script);\n}\n\nwindow.onload = function () {\n  addScriptTag('http://example.com/ip?callback=foo');\n}\n\nfunction foo(data) {\n  console.log('Your public IP address is: ' + data.ip);\n};\n```\n\næœåŠ¡å™¨æ”¶åˆ°è¿™ä¸ªè¯·æ±‚ä»¥åï¼Œä¼šå°†æ•°æ®æ”¾åœ¨å›è°ƒå‡½æ•°çš„å‚æ•°ä½ç½®è¿”å›ã€‚\n\n```js\nfoo({\n  \"ip\": \"8.8.8.8\"\n});\n```\n\n#### WebSocket\n\nWebSocketæ˜¯ä¸€ç§é€šä¿¡åè®®ï¼Œä½¿ç”¨ `ws://`ï¼ˆéåŠ å¯†ï¼‰å’Œ `wss://`ï¼ˆåŠ å¯†ï¼‰ä½œä¸ºåè®®å‰ç¼€ã€‚è¯¥åè®®ä¸å®è¡ŒåŒæºæ”¿ç­–ï¼Œåªè¦æœåŠ¡å™¨æ”¯æŒï¼Œå°±å¯ä»¥é€šè¿‡å®ƒè¿›è¡Œè·¨æºé€šä¿¡ã€‚\n\n```\nGET /chat HTTP/1.1\nHost: server.example.com\nUpgrade: websocket\nConnection: Upgrade\nSec-WebSocket-Key: x3JJHMbDL1EzLkh9GBhXDw==\nSec-WebSocket-Protocol: chat, superchat\nSec-WebSocket-Version: 13\nOrigin: http://example.com\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œæœ‰ä¸€ä¸ªå­—æ®µæ˜¯ `Origin`ï¼Œè¡¨ç¤ºè¯¥è¯·æ±‚çš„è¯·æ±‚æºï¼ˆoriginï¼‰ï¼Œå³å‘è‡ªå“ªä¸ªåŸŸåã€‚\n\næ­£æ˜¯å› ä¸ºæœ‰äº† `Origin` è¿™ä¸ªå­—æ®µï¼Œæ‰€ä»¥WebSocketæ‰æ²¡æœ‰å®è¡ŒåŒæºæ”¿ç­–ã€‚å› ä¸ºæœåŠ¡å™¨å¯ä»¥æ ¹æ®è¿™ä¸ªå­—æ®µï¼Œåˆ¤æ–­æ˜¯å¦è®¸å¯æœ¬æ¬¡é€šä¿¡ã€‚å¦‚æœè¯¥åŸŸååœ¨ç™½åå•å†…ï¼ŒæœåŠ¡å™¨å°±ä¼šåšå‡ºå¦‚ä¸‹å›åº”ã€‚\n\n```\nHTTP/1.1 101 Switching Protocols\nUpgrade: websocket\nConnection: Upgrade\nSec-WebSocket-Accept: HSmrc0sMlYUkAGmm5OPpG2HaGWk=\nSec-WebSocket-Protocol: chat\n```\n\n#### CORS\n\nCORSæ˜¯è·¨æºèµ„æºåˆ†äº«ï¼ˆCross-Origin Resource Sharingï¼‰çš„ç¼©å†™ã€‚å®ƒæ˜¯W3Cæ ‡å‡†ï¼Œæ˜¯è·¨æºAJAXè¯·æ±‚çš„æ ¹æœ¬è§£å†³æ–¹æ³•ã€‚ç›¸æ¯” `JSONP` åªèƒ½å‘ `GET` è¯·æ±‚ï¼ŒCORSå…è®¸ä»»ä½•ç±»å‹çš„è¯·æ±‚ã€‚\n\n## CORS é€šä¿¡\n\nCORSéœ€è¦æµè§ˆå™¨å’ŒæœåŠ¡å™¨åŒæ—¶æ”¯æŒã€‚ç›®å‰ï¼Œæ‰€æœ‰æµè§ˆå™¨éƒ½æ”¯æŒè¯¥åŠŸèƒ½ï¼ŒIEæµè§ˆå™¨ä¸èƒ½ä½äºIE10ã€‚\n\n### ä¸¤ç§è¯·æ±‚\n\nç®€å•è¯·æ±‚ï¼ˆsimple requestï¼‰å’Œéç®€å•è¯·æ±‚ï¼ˆnot-so-simple requestï¼‰ã€‚\n\nåªè¦åŒæ—¶æ»¡è¶³ä»¥ä¸‹ä¸¤å¤§æ¡ä»¶ï¼Œå°±å±äºç®€å•è¯·æ±‚\n\nè¯·æ±‚æ–¹æ³•æ˜¯ä»¥ä¸‹ä¸‰ç§ä¹‹ä¸€\n\n- HEAD\n- GET\n- POST\n\nHTTP çš„å¤´ä¿¡æ¯ä¸è¶…å‡ºä»¥ä¸‹å‡ ç§å­—æ®µ\n\n- Accept\n- Accept-Language\n- Content-Language\n- Last-Event-ID\n- Content-Type: åªé™äºä¸‰ä¸ªå€¼application/x-www-form-urlencodedã€multipart/form-dataã€text/plain\n\n\n### ç®€å•è¯·æ±‚\n\n#### åŸºæœ¬æµç¨‹\n\nå¯¹äºç®€å•è¯·æ±‚ï¼Œæµè§ˆå™¨ç›´æ¥å‘å‡ºCORSè¯·æ±‚ã€‚å…·ä½“æ¥è¯´ï¼Œå°±æ˜¯åœ¨å¤´ä¿¡æ¯ä¹‹ä¸­ï¼Œå¢åŠ ä¸€ä¸ª `Origin` å­—æ®µã€‚\n\n```\nGET /cors HTTP/1.1\nOrigin: http://api.bob.com\nHost: api.alice.com\nAccept-Language: en-US\nConnection: keep-alive\nUser-Agent: Mozilla/5.0...\n```\n\nå¦‚æœ `Origin` æŒ‡å®šçš„æºï¼Œä¸åœ¨è®¸å¯èŒƒå›´å†…ï¼ŒæœåŠ¡å™¨ä¼šè¿”å›ä¸€ä¸ªæ­£å¸¸çš„HTTPå›åº”ã€‚æµè§ˆå™¨å‘ç°ï¼Œè¿™ä¸ªå›åº”çš„å¤´ä¿¡æ¯æ²¡æœ‰åŒ…å« `Access-Control-Allow-Origin` å­—æ®µï¼Œå°±çŸ¥é“å‡ºé”™äº†ï¼Œä»è€ŒæŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼Œè¢« `XMLHttpRequest` çš„ `onerror` å›è°ƒå‡½æ•°æ•è·ã€‚æ³¨æ„ï¼Œè¿™ç§é”™è¯¯æ— æ³•é€šè¿‡çŠ¶æ€ç è¯†åˆ«ï¼Œå› ä¸ºHTTPå›åº”çš„çŠ¶æ€ç æœ‰å¯èƒ½æ˜¯ `200` ã€‚\n\nå¦‚æœ`Origin`æŒ‡å®šçš„åŸŸååœ¨è®¸å¯èŒƒå›´å†…ï¼ŒæœåŠ¡å™¨è¿”å›çš„å“åº”ï¼Œä¼šå¤šå‡ºå‡ ä¸ªå¤´ä¿¡æ¯å­—æ®µã€‚\n\n```\nAccess-Control-Allow-Origin: http://api.bob.com\nAccess-Control-Allow-Credentials: true\nAccess-Control-Expose-Headers: FooBar\nContent-Type: text/html; charset=utf-8\n```\n\n#### withCredentials å±æ€§\n\nä¸Šé¢è¯´åˆ°ï¼ŒCORSè¯·æ±‚é»˜è®¤ä¸åŒ…å«Cookieä¿¡æ¯ï¼ˆä»¥åŠHTTPè®¤è¯ä¿¡æ¯ç­‰ï¼‰ã€‚å¦‚æœéœ€è¦åŒ…å«Cookieä¿¡æ¯ï¼Œä¸€æ–¹é¢è¦æœåŠ¡å™¨åŒæ„ï¼ŒæŒ‡å®š `Access-Control-Allow-Credentials` å­—æ®µã€‚\n\n```\nAccess-Control-Allow-Credentials: true\n```\n\nå¦ä¸€æ–¹é¢ï¼Œå¼€å‘è€…å¿…é¡»åœ¨AJAXè¯·æ±‚ä¸­æ‰“å¼€ `withCredentials` å±æ€§ã€‚\n\n```js\nvar xhr = new XMLHttpRequest();\nxhr.withCredentials = true;\n```\n\n\n","tags":["ES5"],"categories":["Note"]},{"title":"LeanJsã€Œ ES5 ã€-- è¯­æ³•ä¸“é¢˜","url":"%2F2018%2F01%2F26%2FLeanJS%E8%AF%AD%E6%B3%95%E4%B8%93%E9%A2%98%2F","content":"\n![Js](LeanJSè¯­æ³•ä¸“é¢˜/js.png)\n\n<!--more-->\n\n## å•çº¿ç¨‹æ¨¡å¼\n\nJavaScript åªåœ¨ä¸€ä¸ªçº¿ç¨‹ä¸Šè¿è¡Œï¼Œä¹Ÿå°±æ˜¯è¯´åŒæ—¶åªèƒ½è¿›è¡Œä¸€ä¸ªä»»åŠ¡ï¼Œå…¶ä»–ä»»åŠ¡å¿…é¡»è¦æ’é˜Ÿ.ä½†æ˜¯è¿™ä¸ä»£è¡¨ JavaScript åªæœ‰ä¸€ä¸ªçº¿ç¨‹ï¼Œå®é™…ä¸Š JavaScript å¼•æ“æœ‰å¤šä¸ªçº¿ç¨‹ã€‚\n\nå•çº¿ç¨‹æ¨¡å¼å¸¦æ¥å¾ˆå¤šé—®é¢˜ï¼Œå› ä¸ºæ–°çš„ä»»åŠ¡åªèƒ½åŠ åœ¨ä»»åŠ¡é˜Ÿåˆ—çš„æœ«å°¾ï¼Œå¦‚æœæ’åœ¨å‰é¢çš„ä»»åŠ¡åŠ è½½éœ€è¦è¿‡é•¿çš„æ—¶é—´ï¼Œåé¢çš„æ‰€æœ‰ä»»åŠ¡éƒ½ä¼šåœ¨ç­‰å¾…ï¼Œé€ æˆæµè§ˆå™¨å¤±å»å“åº”ï¼Œåˆç§°ä¸ºã€Œå‡æ­»ã€\n\nè€Œä¸”æœ‰çš„æ—¶å€™å¹¶ä¸æ˜¯å› ä¸ºè®¡ç®—é‡å¤§ï¼Œè€Œæ˜¯å› ä¸ºæœ‰çš„æ—¶å€™è¾“å…¥è¾“å‡ºè®¾å¤‡æˆ–è€…ä¸€äº›è€—æ—¶çš„è¯·æ±‚é˜»ç¢é˜Ÿåˆ—çš„æ­£å¸¸çš„è¿›è¡Œï¼Œæ­¤æ—¶CPUåœ¨é—²ç€ç¡®è¿˜æ˜¯å‡ºç°äº†å‡æ­»çš„ç°è±¡\n\n### æ¶ˆæ¯é˜Ÿåˆ—\n\nä¸ºäº†é¿å…ä»¥ä¸Šè¯´çš„æƒ…å†µï¼Œè®¾è®¡è€…è®¾è®¡äº†ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—ï¼Œä¹Ÿå°±æ˜¯å¯¹äºä¸€äº›è€—æ—¶çš„æ“ä½œï¼Œ JavaScript å¼•æ“æä¾›äº†ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—ï¼Œæ’åœ¨ä»»åŠ¡é˜Ÿåˆ—çš„æœ€åã€‚å…ˆä¼˜å…ˆå¤„ç†ç›¸å¯¹ç®€å•çš„ä»»åŠ¡ï¼Œç­‰ä»»åŠ¡é˜Ÿåˆ—å¤„ç†å®Œæˆä¹‹åï¼Œå†å¤„ç†æ¶ˆæ¯é˜Ÿåˆ—ã€‚\n\n### Event Loop\n\næ‰€è°“Event Loopæœºåˆ¶ï¼ŒæŒ‡çš„æ˜¯ä¸€ç§å†…éƒ¨å¾ªç¯ï¼Œç”¨æ¥**ä¸€è½®åˆä¸€è½®åœ°å¤„ç†æ¶ˆæ¯é˜Ÿåˆ—ä¹‹ä¸­çš„æ¶ˆæ¯ï¼Œå³æ‰§è¡Œå¯¹åº”çš„å›è°ƒå‡½æ•°**ã€‚\n\næ¶ˆæ¯é˜Ÿåˆ—æ˜¯ä¸€ä¸ªå…ˆè¿›å…ˆå‡ºçš„æ•°æ®ç»“æ„ï¼ŒæŒ‰é¡ºåºåŠ¨æ€æ·»åŠ å¤„ç†æ¶ˆæ¯é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡\n\n## å®šæ—¶å™¨\n\n### setTimeout()\n\nç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¦æ‰§è¡Œçš„å‡½æ•°åï¼Œå›è°ƒå‡½æ•°æˆ–è€…æ˜¯ä»£ç ï¼Œå¦‚æœä¼ å…¥çš„æ˜¯ä»£ç è¦ç”¨å­—ç¬¦ä¸²çš„å½¢å¼ï¼Œå› ä¸ºå¼•æ“å†…éƒ¨ç”¨ `eval`ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æ¨è¿Ÿçš„æ—¶é—´å•ä½ä¸ºæ¯«ç§’\n\n```js\nsetTimeout(func|code,timeout)\n```\n\n`setTimeout` è¿˜å…è®¸æ·»åŠ æ›´å¤šçš„å‚æ•°ï¼Œå¤šä½™çš„å‚æ•°ä¼šè¢«ä¼ å…¥å›è°ƒå‡½æ•°ä¸­ï¼Œè¿™ç§æ–¹å¼IE9ä»¥ä¸‹ä¸æ”¯æŒ\n\n```js\nsetTimeout(function(a,b){\n  console.log(a+b);\n},1000,1,2)\n```\n\nå¦‚æœè¿˜æ˜¯æƒ³å®ç°ä¼ å‚çš„è¯å¯ä»¥è‡ªå®šä¹‰ä¸€ä¸ªå‡½æ•°\n\n```js\nsetTimeout(function(){\n  add(a,b);\n},1000)\n```\n\n`setTimeout` ä¼ å…¥çš„å›è°ƒå‡½æ•°å¦‚æœæ˜¯æŸä¸ªå¯¹è±¡çš„æ–¹æ³•ï¼Œé‚£ä¹ˆè¯¥æ–¹æ³•ä¸­çš„ `this` ä¼šæŒ‡å‘å…¨å±€å¯¹è±¡\n\n```js\nfunction User(login) {\n  this.login = login;\n  this.sayHi = function() {\n    console.log(this.login);\n  }\n}\n\nvar user = new User('John');\n\nsetTimeout(user.sayHi, 1000); //undefined\n```\n\nå†™åœ¨å›è°ƒå‡½æ•°ä¸­å³å¯\n\n```js\nsetTimeout(function(){\n  user.sayHi()\n}, 1000);\n```\n\nä¹Ÿå¯ç”¨ `bind`\n\n```js\nsetTimeout(user.sayHi.bind(this),1000)\n```\n\nHTML 5æ ‡å‡†è§„å®šï¼Œ`setTimeout` çš„æœ€çŸ­æ—¶é—´é—´éš”æ˜¯4æ¯«ç§’ã€‚ä¸ºäº†èŠ‚ç”µï¼Œå¯¹äºé‚£äº›ä¸å¤„äºå½“å‰çª—å£çš„é¡µé¢ï¼Œæµè§ˆå™¨ä¼šå°†æ—¶é—´é—´éš”æ‰©å¤§åˆ°1000æ¯«ç§’ã€‚å¦å¤–ï¼Œå¦‚æœç¬”è®°æœ¬ç”µè„‘å¤„äºç”µæ± ä¾›ç”µçŠ¶æ€ï¼ŒChromeå’ŒIE 9ä»¥ä¸Šçš„ç‰ˆæœ¬ï¼Œä¼šå°†æ—¶é—´é—´éš”åˆ‡æ¢åˆ°ç³»ç»Ÿå®šæ—¶å™¨ï¼Œå¤§çº¦æ˜¯15.6æ¯«ç§’ã€‚\n\n### setInterval()\n\n`setInterval` å‡½æ•°çš„ç”¨æ³•ä¸ `setTimeout` å®Œå…¨ä¸€è‡´ï¼ŒåŒºåˆ«ä»…ä»…åœ¨äº `setInterval` æŒ‡å®šæŸä¸ªä»»åŠ¡æ¯éš”ä¸€æ®µæ—¶é—´å°±æ‰§è¡Œä¸€æ¬¡ï¼Œä¹Ÿå°±æ˜¯æ— é™æ¬¡çš„å®šæ—¶æ‰§è¡Œã€‚\n\n`setInterval` çš„æ—¶é—´é—´éš”ä¸æ˜¯ç»“æŸåçš„æ—¶é—´ï¼Œè€Œæ˜¯å¼€å§‹åå°±å¼€å§‹ç®—ï¼Œå‡å¦‚ `delay` æ—¶é—´è®¾ç½®çš„æ˜¯ `1000ms` å‡å¦‚è¿™ä¸ªä»»åŠ¡æ‰§è¡Œäº†100msï¼Œé‚£ä¹ˆä¸‹æ¬¡è°ƒç”¨è¿™ä¸ªä»»åŠ¡å°±æ˜¯è¿™ä¸ªä»»åŠ¡ç»“æŸåçš„900msæ‰§è¡Œï¼Œå‡å¦‚è¿™ä¸ªä»»åŠ¡æ‰§è¡Œäº†1000msé‚£ä¹ˆåé¢çš„ä»»åŠ¡å°±åœ¨å®ƒæ‰§è¡Œåç«‹é©¬æ‰§è¡Œ\n\nä¸ºäº†ç¡®ä¿ä¸¤æ¬¡æ‰§è¡Œçš„é—´éš”ä¹‹é—´ç›¸åŒï¼Œæ¨èä½¿ç”¨ `setTimeout` ä»£æ›¿ `setInterval`\n\n```js\nvar timer = setTimeout(function(){\n  //do something\n  var timer = setTimeout(arguments.callee,2000)\n},2000)\n```\n\nä¹Ÿå¯ä»¥è‡ªå®šä¹‰ä¸€ä¸ªå‡½æ•°æ¥æ›¿ä»£ `setInterval`\n\n```js\nfunction interval(func,delay){\n  var interv = function(){\n    //å°†funcçš„thisæŒ‡å‘å…¨å±€\n    func.call(null);\n    setTimeout(interv,delay)\n  }\n  setTimeout(interv,delay);\n}\n```\n\nHTML 5æ ‡å‡†è§„å®šï¼Œ`setInterval` çš„æœ€çŸ­é—´éš”æ—¶é—´æ˜¯10æ¯«ç§’ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå°äº10æ¯«ç§’çš„æ—¶é—´é—´éš”ä¼šè¢«è°ƒæ•´åˆ°10æ¯«ç§’ã€‚\n\n### clearTimeout() clearInterval()\n\n`setTimeout` å’Œ `setInterval` å‡½æ•°ï¼Œéƒ½è¿”å›ä¸€ä¸ªè¡¨ç¤ºè®¡æ•°å™¨ç¼–å·çš„æ•´æ•°å€¼ï¼Œå°†è¯¥æ•´æ•°ä¼ å…¥ `clearTimeout` å’Œ `clearInterval` å‡½æ•°ï¼Œå°±å¯ä»¥å–æ¶ˆå¯¹åº”çš„å®šæ—¶å™¨ã€‚\n\n`setTimeout` å’Œ `setInterval` è¿”å›çš„æ•´æ•°å€¼æ˜¯è¿ç»­çš„ã€‚\n\nåˆ©ç”¨è¿™ä¸€ç‚¹å¯ä»¥å†™ä¸€ä¸ªå‡½æ•°å–æ¶ˆå½“å‰æ‰€æœ‰çš„ `setTimeout()`\n\n```js\n(function() {\n  var gid = setInterval(clearAllTimeouts, 0);\n\n  function clearAllTimeouts() {\n    //æ­¤idä»£è¡¨çš„æ•°å€¼ä¸ºå®šä¹‰çš„å®šæ—¶å™¨ä¸­æœ€å¤§çš„\n    var id = setTimeout(function() {}, 0);\n    while (id > 0) {\n      if (id !== gid) {\n        clearTimeout(id);\n      }\n      id--;\n    }\n  }\n})();\n```\n\nè¿è¡Œä¸Šé¢ä»£ç åï¼Œå®é™…ä¸Šå†è®¾ç½®ä»»ä½• `setTimeout` éƒ½æ— æ•ˆäº†ã€‚\n\né˜²æŠ–åŠ¨å‡½æ•°ä¹Ÿå¯ä»¥åˆ©ç”¨ `setTimeout` æ”¹å†™\n\n```js\nfunciton debounce(func,delay){\n  var timer = null;\n  return function(){\n    var context = this;\n    var args = arguments;\n    clearTimeout(timer);\n    var timer = setTimeout(function(){\n      func.apply(context,args);\n    },delay)\n  }\n}\n```\n\n### è¿è¡Œæœºåˆ¶\n\n`setTimeout` å’Œ `setInterval` çš„è¿è¡Œæœºåˆ¶æ˜¯ï¼Œå°†æŒ‡å®šçš„ä»£ç ç§»å‡ºæœ¬æ¬¡æ‰§è¡Œï¼Œç­‰åˆ°ä¸‹ä¸€è½® Event Loop æ—¶ï¼Œå†æ£€æŸ¥æ˜¯å¦åˆ°äº†æŒ‡å®šæ—¶é—´ã€‚å¦‚æœåˆ°äº†ï¼Œå°±æ‰§è¡Œå¯¹åº”çš„ä»£ç ï¼›å¦‚æœä¸åˆ°ï¼Œå°±ç­‰åˆ°å†ä¸‹ä¸€è½® Event Loop æ—¶é‡æ–°åˆ¤æ–­ã€‚\n\n### setTimeout(f,0)\n\n#### è°ƒæ•´äº‹ä»¶çš„æ‰§è¡Œé¡ºåº\n\nç”¨æˆ·è‡ªå®šä¹‰çš„å›è°ƒå‡½æ•°ï¼Œé€šå¸¸åœ¨æµè§ˆå™¨çš„é»˜è®¤åŠ¨ä½œä¹‹å‰è§¦å‘ã€‚æ¯”å¦‚ï¼Œç”¨æˆ·åœ¨è¾“å…¥æ¡†è¾“å…¥æ–‡æœ¬ï¼Œ`keypress` äº‹ä»¶ä¼šåœ¨æµè§ˆå™¨æ¥æ”¶æ–‡æœ¬ä¹‹å‰è§¦å‘ã€‚å› æ­¤ï¼Œä¸‹é¢çš„å›è°ƒå‡½æ•°æ˜¯è¾¾ä¸åˆ°ç›®çš„çš„ã€‚\n\n```js\ndocument.getElementById('input-box').onkeypress = function(event) {\n  this.value = this.value.toUpperCase();\n}\n```\n\nä¸Šé¢ä»£ç æƒ³åœ¨ç”¨æˆ·è¾“å…¥æ–‡æœ¬åï¼Œç«‹å³å°†å­—ç¬¦è½¬ä¸ºå¤§å†™ã€‚ä½†æ˜¯å®é™…ä¸Šï¼Œå®ƒåªèƒ½å°†ä¸Šä¸€ä¸ªå­—ç¬¦è½¬ä¸ºå¤§å†™ï¼Œå› ä¸ºæµè§ˆå™¨æ­¤æ—¶è¿˜æ²¡æ¥æ”¶åˆ°æ–‡æœ¬ï¼Œæ‰€ä»¥ `this.value` å–ä¸åˆ°æœ€æ–°è¾“å…¥çš„é‚£ä¸ªå­—ç¬¦ã€‚åªæœ‰ç”¨ `setTimeout` æ”¹å†™ï¼Œä¸Šé¢çš„ä»£ç æ‰èƒ½å‘æŒ¥ä½œç”¨ã€‚\n\n```js\ndocument.getElementById('my-ok').onkeypress = function() {\n  var self = this;\n  setTimeout(function() {\n    self.value = self.value.toUpperCase();\n  }, 0);\n}\n```\n\nä¸Šé¢ä»£ç å°†ä»£ç æ”¾å…¥ `setTimeout` ä¹‹ä¸­ï¼Œå°±èƒ½ä½¿å¾—å®ƒåœ¨æµè§ˆå™¨æ¥æ”¶åˆ°æ–‡æœ¬ä¹‹åè§¦å‘ã€‚\n\n#### åˆ†æ‰¹å¤„ç†è€—æ—¶çš„ä»»åŠ¡\n\nç”±äº `setTimeout(f,0)` å®é™…ä¸Šæ„å‘³ç€ï¼Œå°†ä»»åŠ¡æ”¾åˆ°æµè§ˆå™¨æœ€æ—©å¯å¾—çš„ç©ºé—²æ—¶æ®µæ‰§è¡Œï¼Œæ‰€ä»¥é‚£äº›è®¡ç®—é‡å¤§ã€è€—æ—¶é•¿çš„ä»»åŠ¡ï¼Œå¸¸å¸¸ä¼šè¢«æ”¾åˆ°å‡ ä¸ªå°éƒ¨åˆ†ï¼Œåˆ†åˆ«æ”¾åˆ° `setTimeout(f,0)` é‡Œé¢æ‰§è¡Œã€‚\n\n```js\nvar div = document.getElementsByTagName('div')[0];\n\n// å†™æ³•ä¸€\nfor (var i = 0xA00000; i < 0xFFFFFF; i++) {\n  div.style.backgroundColor = '#' + i.toString(16);\n}\n\n// å†™æ³•äºŒ\nvar timer;\nvar i=0x100000;\n\nfunction func() {\n  timer = setTimeout(func, 0);\n  div.style.backgroundColor = '#' + i.toString(16);\n  if (i++ == 0xFFFFFF) clearTimeout(timer);\n}\n\ntimer = setTimeout(func, 0);\n```\n\nä¸Šé¢ä»£ç æœ‰ä¸¤ç§å†™æ³•ï¼Œéƒ½æ˜¯æ”¹å˜ä¸€ä¸ªç½‘é¡µå…ƒç´ çš„èƒŒæ™¯è‰²ã€‚å†™æ³•ä¸€ä¼šé€ æˆæµè§ˆå™¨ã€Œå µå¡ã€ï¼Œ**å› ä¸ºJavaScriptæ‰§è¡Œé€Ÿåº¦è¿œé«˜äºDOM**ï¼Œä¼šé€ æˆå¤§é‡DOMæ“ä½œã€Œå †ç§¯ã€ï¼Œè€Œå†™æ³•äºŒå°±ä¸ä¼šï¼Œè¿™å°±æ˜¯ `setTimeout(f, 0)` çš„å¥½å¤„ã€‚\n\nå¦ä¸€ä¸ªä½¿ç”¨è¿™ç§æŠ€å·§çš„ä¾‹å­æ˜¯ä»£ç é«˜äº®çš„å¤„ç†ã€‚å¦‚æœä»£ç å—å¾ˆå¤§ï¼Œä¸€æ¬¡æ€§å¤„ç†ï¼Œå¯èƒ½ä¼šå¯¹æ€§èƒ½é€ æˆå¾ˆå¤§çš„å‹åŠ›ï¼Œé‚£ä¹ˆå°†å…¶åˆ†æˆä¸€ä¸ªä¸ªå°å—ï¼Œä¸€æ¬¡å¤„ç†ä¸€å—ï¼Œæ¯”å¦‚å†™æˆ `setTimeout(highlightNext, 50)` çš„æ ·å­ï¼Œæ€§èƒ½å‹åŠ›å°±ä¼šå‡è½»ã€‚\n\n### æ­£å¸¸ä»»åŠ¡å’Œå¾®ä»»åŠ¡\n\nè¿™æ—¶ï¼Œéœ€è¦åŒºåˆ†ä¸¤ç§ä»»åŠ¡ï¼šæ­£å¸¸ä»»åŠ¡ï¼ˆtaskï¼‰ä¸å¾®ä»»åŠ¡ï¼ˆmicrotaskï¼‰ã€‚å®ƒä»¬çš„åŒºåˆ«åœ¨äºï¼Œã€Œæ­£å¸¸ä»»åŠ¡ã€åœ¨ä¸‹ä¸€è½®Event Loopæ‰§è¡Œï¼Œã€Œå¾®ä»»åŠ¡ã€åœ¨æœ¬è½®Event Loopçš„æ‰€æœ‰ä»»åŠ¡ç»“æŸåæ‰§è¡Œã€‚\n\nå¾®ä»»åŠ¡ä¸»è¦æ˜¯ `process.nextTick`å’Œ Promise\n\næ­£å¸¸ä»»åŠ¡ä¸º \n\n- setTimeout\n- setInterval\n- setImmediate\n- I/O\n- å„ç§äº‹ä»¶ï¼ˆæ¯”å¦‚é¼ æ ‡å•å‡»äº‹ä»¶ï¼‰çš„å›è°ƒå‡½æ•°\n\n\n```js\nconsole.log(1);\n\nsetTimeout(function() {\n  console.log(2);\n}, 0);\n\nPromise.resolve().then(function() {\n  console.log(3);\n}).then(function() {\n  console.log(4);\n});\n\nconsole.log(5);\n\n// 1\n// 5\n// 3\n// 4\n// 2\n```\n\n`setTimeout` ä¸ºæ­£å¸¸ä»»åŠ¡ï¼Œåœ¨ä¸‹ä¸€è½®æ‰§è¡Œï¼ŒPromise åœ¨é˜Ÿåˆ—ç»“æŸåç«‹é©¬æ‰§è¡Œï¼Œæ‰€ä»¥ 5 åå…ˆæ˜¯ 3 å’Œ 4 ç„¶åå†æ˜¯ 2\n\n## Promise\n\n### JavaScript çš„å¼‚æ­¥æ‰§è¡Œ\n\nã€Œå¼‚æ­¥æ¨¡å¼ã€åˆ™å®Œå…¨ä¸åŒï¼Œæ¯ä¸€ä¸ªä»»åŠ¡åˆ†æˆä¸¤æ®µï¼Œç¬¬ä¸€æ®µä»£ç åŒ…å«å¯¹å¤–éƒ¨æ•°æ®çš„è¯·æ±‚ï¼Œç¬¬äºŒæ®µä»£ç è¢«å†™æˆä¸€ä¸ªå›è°ƒå‡½æ•°ï¼ŒåŒ…å«äº†å¯¹å¤–éƒ¨æ•°æ®çš„å¤„ç†ã€‚ç¬¬ä¸€æ®µä»£ç æ‰§è¡Œå®Œï¼Œä¸æ˜¯ç«‹åˆ»æ‰§è¡Œç¬¬äºŒæ®µä»£ç ï¼Œè€Œæ˜¯å°†ç¨‹åºçš„æ‰§è¡Œæƒäº¤ç»™ç¬¬äºŒä¸ªä»»åŠ¡ã€‚ç­‰åˆ°å¤–éƒ¨æ•°æ®è¿”å›äº†ï¼Œå†ç”±ç³»ç»Ÿé€šçŸ¥æ‰§è¡Œç¬¬äºŒæ®µä»£ç ã€‚æ‰€ä»¥ï¼Œç¨‹åºçš„æ‰§è¡Œé¡ºåºä¸ä»»åŠ¡çš„æ’åˆ—é¡ºåºæ˜¯ä¸ä¸€è‡´çš„ã€å¼‚æ­¥çš„ã€‚\n\n#### å›è°ƒå‡½æ•°\n\nå›è°ƒå‡½æ•°æ˜¯å¼‚æ­¥ç¼–ç¨‹æœ€åŸºæœ¬çš„æ–¹æ³•\n\nå›è°ƒå‡½æ•°çš„ä¼˜ç‚¹æ˜¯ç®€å•ã€å®¹æ˜“ç†è§£å’Œéƒ¨ç½²ï¼Œç¼ºç‚¹æ˜¯ä¸åˆ©äºä»£ç çš„é˜…è¯»å’Œç»´æŠ¤ï¼Œå„ä¸ªéƒ¨åˆ†ä¹‹é—´é«˜åº¦è€¦åˆï¼ˆCouplingï¼‰ï¼Œä½¿å¾—ç¨‹åºç»“æ„æ··ä¹±ã€æµç¨‹éš¾ä»¥è¿½è¸ªï¼ˆå°¤å…¶æ˜¯å›è°ƒå‡½æ•°åµŒå¥—çš„æƒ…å†µï¼‰ï¼Œè€Œä¸”æ¯ä¸ªä»»åŠ¡åªèƒ½æŒ‡å®šä¸€ä¸ªå›è°ƒå‡½æ•°ã€‚\n\n#### äº‹ä»¶ç›‘å¬\n\nå¦ä¸€ç§æ€è·¯æ˜¯é‡‡ç”¨äº‹ä»¶é©±åŠ¨æ¨¡å¼ã€‚ä»»åŠ¡çš„æ‰§è¡Œä¸å–å†³äºä»£ç çš„é¡ºåºï¼Œè€Œå–å†³äºæŸä¸ªäº‹ä»¶æ˜¯å¦å‘ç”Ÿã€‚\n\nè¿™ç§æ–¹æ³•çš„ä¼˜ç‚¹æ˜¯æ¯”è¾ƒå®¹æ˜“ç†è§£ï¼Œå¯ä»¥ç»‘å®šå¤šä¸ªäº‹ä»¶ï¼Œæ¯ä¸ªäº‹ä»¶å¯ä»¥æŒ‡å®šå¤šä¸ªå›è°ƒå‡½æ•°ï¼Œè€Œä¸”å¯ä»¥ã€Œå»è€¦åˆã€ï¼ˆDecouplingï¼‰ï¼Œæœ‰åˆ©äºå®ç°æ¨¡å—åŒ–ã€‚ç¼ºç‚¹æ˜¯æ•´ä¸ªç¨‹åºéƒ½è¦å˜æˆäº‹ä»¶é©±åŠ¨å‹ï¼Œè¿è¡Œæµç¨‹ä¼šå˜å¾—å¾ˆä¸æ¸…æ™°ã€‚\n\n#### å‘å¸ƒ/è®¢é˜…\n\nâ€œäº‹ä»¶â€å®Œå…¨å¯ä»¥ç†è§£æˆâ€ä¿¡å·â€ï¼Œå¦‚æœå­˜åœ¨ä¸€ä¸ªâ€ä¿¡å·ä¸­å¿ƒâ€ï¼ŒæŸä¸ªä»»åŠ¡æ‰§è¡Œå®Œæˆï¼Œå°±å‘ä¿¡å·ä¸­å¿ƒâ€å‘å¸ƒâ€ï¼ˆpublishï¼‰ä¸€ä¸ªä¿¡å·ï¼Œå…¶ä»–ä»»åŠ¡å¯ä»¥å‘ä¿¡å·ä¸­å¿ƒâ€è®¢é˜…â€ï¼ˆsubscribeï¼‰è¿™ä¸ªä¿¡å·ï¼Œä»è€ŒçŸ¥é“ä»€ä¹ˆæ—¶å€™è‡ªå·±å¯ä»¥å¼€å§‹æ‰§è¡Œã€‚è¿™å°±å«åšâ€å‘å¸ƒ/è®¢é˜…æ¨¡å¼â€œï¼ˆpublish-subscribe patternï¼‰ï¼Œåˆç§°â€è§‚å¯Ÿè€…æ¨¡å¼â€œï¼ˆobserver patternï¼‰ã€‚\n\nè¿™ä¸ªæ¨¡å¼æœ‰å¤šç§å®ç°ï¼Œä¸‹é¢é‡‡ç”¨çš„æ˜¯Ben Almançš„Tiny Pub/Subï¼Œè¿™æ˜¯jQueryçš„ä¸€ä¸ªæ’ä»¶ã€‚\n\né¦–å…ˆï¼Œf2å‘â€ä¿¡å·ä¸­å¿ƒâ€jQueryè®¢é˜…â€doneâ€ä¿¡å·ã€‚\n\n```js\njQuery.subscribe(\"done\", f2);\n```\n\nç„¶åï¼Œf1è¿›è¡Œå¦‚ä¸‹æ”¹å†™ï¼š\n\n```js\nfunction f1(){\n\tsetTimeout(function () {\n\t\t// f1çš„ä»»åŠ¡ä»£ç \n\t\tjQuery.publish(\"done\");\n\t}, 1000);\n}\n```\njQuery.publish(â€œdoneâ€)çš„æ„æ€æ˜¯ï¼Œf1æ‰§è¡Œå®Œæˆåï¼Œå‘â€ä¿¡å·ä¸­å¿ƒâ€jQueryå‘å¸ƒâ€doneâ€ä¿¡å·ï¼Œä»è€Œå¼•å‘f2çš„æ‰§è¡Œã€‚\n\nf2å®Œæˆæ‰§è¡Œåï¼Œä¹Ÿå¯ä»¥å–æ¶ˆè®¢é˜…ï¼ˆunsubscribeï¼‰ã€‚\n\n```js\njQuery.unsubscribe(\"done\", f2);\n```\nè¿™ç§æ–¹æ³•çš„æ€§è´¨ä¸â€äº‹ä»¶ç›‘å¬â€ç±»ä¼¼ï¼Œä½†æ˜¯æ˜æ˜¾ä¼˜äºåè€…ã€‚å› ä¸ºæˆ‘ä»¬å¯ä»¥é€šè¿‡æŸ¥çœ‹â€æ¶ˆæ¯ä¸­å¿ƒâ€ï¼Œäº†è§£å­˜åœ¨å¤šå°‘ä¿¡å·ã€æ¯ä¸ªä¿¡å·æœ‰å¤šå°‘è®¢é˜…è€…ï¼Œä»è€Œç›‘æ§ç¨‹åºçš„è¿è¡Œã€‚\n\n### å¼‚æ­¥æ“ä½œçš„æµç¨‹æ§åˆ¶\n\nç»å†å›è°ƒå‡½æ•°åµŒå¥—ã€ä¸²è¡Œæ‰§è¡Œã€å¹¶è¡Œæ‰§è¡Œåˆ°ä¸²è¡Œä¸å¹¶è¡Œçš„ç»“åˆ\n\næ‰€è°“å¹¶è¡Œä¸ä¸²è¡Œçš„ç»“åˆï¼Œå°±æ˜¯è®¾ç½®ä¸€ä¸ªé—¨æ§›ï¼Œæ¯æ¬¡æœ€å¤šåªèƒ½å¹¶è¡Œæ‰§è¡Œnä¸ªå¼‚æ­¥ä»»åŠ¡ã€‚è¿™æ ·å°±é¿å…äº†è¿‡åˆ†å ç”¨ç³»ç»Ÿèµ„æºã€‚\n\n### Promise å¯¹è±¡\n\n`Promise` å¯¹è±¡æ˜¯ CommonJS å·¥ä½œç»„æå‡ºçš„ä¸€ç§è§„èŒƒï¼Œç›®çš„æ˜¯ä¸ºå¼‚æ­¥æ“ä½œæä¾›ç»Ÿä¸€æ¥å£ã€‚\n\nå®ƒçš„æ€æƒ³æ˜¯ï¼Œæ¯ä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡ç«‹åˆ»è¿”å›ä¸€ä¸ª `Promise` å¯¹è±¡ï¼Œç”±äºæ˜¯ç«‹åˆ»è¿”å›ï¼Œæ‰€ä»¥å¯ä»¥é‡‡ç”¨åŒæ­¥æ“ä½œçš„æµç¨‹ã€‚è¿™ä¸ª `Promises` å¯¹è±¡æœ‰ä¸€ä¸ª `then` æ–¹æ³•ï¼Œå…è®¸æŒ‡å®šå›è°ƒå‡½æ•°ï¼Œåœ¨å¼‚æ­¥ä»»åŠ¡å®Œæˆåè°ƒç”¨ã€‚\n\nå‰é¢è¯´è¿‡ï¼ŒPromiseæ¥å£çš„åŸºæœ¬æ€æƒ³æ˜¯ï¼Œå¼‚æ­¥ä»»åŠ¡è¿”å›ä¸€ä¸ªPromiseå¯¹è±¡ã€‚\n\nPromiseå¯¹è±¡åªæœ‰ä¸‰ç§çŠ¶æ€ã€‚\n\nå¼‚æ­¥æ“ä½œã€Œæœªå®Œæˆã€ï¼ˆpendingï¼‰ã€å¼‚æ­¥æ“ä½œ ã€Œå·²å®Œæˆã€ï¼ˆresolvedï¼Œåˆç§°fulfilledï¼‰ã€å¼‚æ­¥æ“ä½œã€Œå¤±è´¥ã€ï¼ˆrejectedï¼‰\n\nä¸‰ç§çŠ¶æ€çš„å˜åŒ–é€”å¾„ä¹Ÿåªæœ‰ä¸¤ç§\n\næœªå®Œæˆåˆ°æˆåŠŸã€æœªå®Œæˆåˆ°å¤±è´¥\n\nå˜åŒ–åªèƒ½å‘ç”Ÿä¸€æ¬¡ï¼Œå¼‚æ­¥æ“ä½œæˆåŠŸï¼ŒPromiseå¯¹è±¡ä¼ å›ä¸€ä¸ªå€¼ï¼ŒçŠ¶æ€å˜ä¸º `resolved`ï¼Œå¼‚æ­¥æ“ä½œå¤±è´¥ï¼ŒPromiseå¯¹è±¡æŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼ŒçŠ¶æ€å˜ä¸º `rejected`ã€‚\n\n```js\npo.then(step1)\n  .then(step2)\n  .then(step3)\n  .then(\n    console.log,\n    console.error\n  )\n```\n\n`po`çš„çŠ¶æ€ä¸€æ—¦å˜ä¸º `resolved` å°±è°ƒç”¨ä¸‹ä¸€ä¸ª `then` ä¸­çš„æ–¹æ³•ï¼Œä¾æ¬¡è¿›è¡Œã€‚`console.log` è¿™ä¸ªæ–¹æ³•åªæ˜¾ç¤º `step3` çš„è¿”å›å€¼ï¼Œè€Œ `console.error` ä¼šæ˜¾ç¤º `step1` ã€ `step2` ã€ `step3` ä¸­çš„ä»»æ„ä¸€ä¸ªé”™è¯¯ã€‚å› ä¸ºå‡å®š `step1` æ‰§è¡Œå‡ºé”™ï¼Œè¿™æ—¶ `step2` `step3` å°±ä¸ä¼šå†æ‰§è¡Œä¸‹å»ï¼Œç„¶å Promise å°±ä¼š**å¯»æ‰¾æ¥ä¸‹æ¥ç¬¬ä¸€ä¸ªæ“ä½œå¤±è´¥çš„å›è°ƒå‡½æ•°**\n\nPromise å¯¹è±¡çš„ä¾‹å­\n\n```js\nvar promise = new Promise(function(resolve,reject){\n  //å¼‚æ­¥æ“ä½œçš„ä»£ç \n  if(//å¼‚æ­¥æ“ä½œæˆåŠŸ){\n    resolve(value);\n  }else{\n    reject(error);\n  }\n})\n```\n\n#### ç”¨æ³•è¾¨æ\n\n`finalHandler` å›è°ƒå‡½æ•°çš„å‚æ•°ï¼Œæ˜¯ `doSomethingElse` å‡½æ•°çš„è¿è¡Œç»“æœ\n\n```js\ndoSomething().then(function () {\n  return doSomethingElse();\n}).then(finalHandler);\n```\n\n`findlHandler` å›è°ƒå‡½æ•°çš„å‚æ•°æ˜¯ `undefined`\n\n```js\ndoSomething().then(function () {\n  doSomethingElse();\n  return;\n}).then(finalHandler);\n```\n\n`finalHandler` å›è°ƒå‡½æ•°çš„å‚æ•°æ˜¯ `doSomethingElse` å‡½æ•°çš„è¿”å›å€¼\n\n```js\ndoSomething().then(doSomethingElse())\n  .then(finalHandler);\n```\n\n`doSomethingElse` çš„å‚æ•°æ˜¯ `doSomething` çš„è¿”å›å€¼\n\n```\ndoSomething().then(doSomethingElse)\n  .then(finalHandler);\n```\n\n### Promise åº”ç”¨\n\n#### åŠ è½½å›¾ç‰‡\n\n```js\nvar preloadImage = function(path){\n  return new Promise(function(resolve,reject){\n    var img = new Image();\n    img.onload = resolve;\n    img.error = reject;\n    img.src = path;\n  })\n}\n```\n\n#### Ajax æ“ä½œ\n\n```js\nfunction search(term) {\n  var url = 'http://example.com/search?q=' + term;\n  var xhr = new XMLHttpRequest();\n  var result;\n\n  var p = new Promise(function (resolve, reject) {\n    xhr.open('GET', url, true);\n    xhr.onload = function (e) {\n      if (this.status === 200) {\n        result = JSON.parse(this.responseText);\n        resolve(result);\n      }\n    };\n    xhr.onerror = function (e) {\n      reject(e);\n    };\n    xhr.send();\n  });\n\n  return p;\n}\n\nsearch(\"Hello World\").then(console.log, console.error);\n```\n\n#### å°ç»“\n\nPromiseå¯¹è±¡çš„ä¼˜ç‚¹åœ¨äºï¼Œè®©å›è°ƒå‡½æ•°å˜æˆäº†è§„èŒƒçš„é“¾å¼å†™æ³•ï¼Œç¨‹åºæµç¨‹å¯ä»¥çœ‹å¾—å¾ˆæ¸…æ¥šã€‚å®ƒçš„ä¸€æ•´å¥—æ¥å£ï¼Œå¯ä»¥å®ç°è®¸å¤šå¼ºå¤§çš„åŠŸèƒ½ï¼Œæ¯”å¦‚ä¸ºå¤šä¸ªå¼‚æ­¥æ“ä½œéƒ¨ç½²ä¸€ä¸ªå›è°ƒå‡½æ•°ã€ä¸ºå¤šä¸ªå›è°ƒå‡½æ•°ä¸­æŠ›å‡ºçš„é”™è¯¯ç»Ÿä¸€æŒ‡å®šå¤„ç†æ–¹æ³•ç­‰ç­‰ã€‚\n\nè€Œä¸”ï¼Œå®ƒè¿˜æœ‰ä¸€ä¸ªå‰é¢ä¸‰ç§æ–¹æ³•éƒ½æ²¡æœ‰çš„å¥½å¤„ï¼šå¦‚æœä¸€ä¸ªä»»åŠ¡å·²ç»å®Œæˆï¼Œå†æ·»åŠ å›è°ƒå‡½æ•°ï¼Œè¯¥å›è°ƒå‡½æ•°ä¼šç«‹å³æ‰§è¡Œã€‚æ‰€ä»¥ï¼Œä½ ä¸ç”¨æ‹…å¿ƒæ˜¯å¦é”™è¿‡äº†æŸä¸ªäº‹ä»¶æˆ–ä¿¡å·ã€‚è¿™ç§æ–¹æ³•çš„ç¼ºç‚¹å°±æ˜¯ï¼Œç¼–å†™å’Œç†è§£éƒ½ç›¸å¯¹æ¯”è¾ƒéš¾ã€‚\n\n## ä¸¥æ ¼æ¨¡å¼\n\n### è®¾è®¡ç›®çš„\n\n- æ˜ç¡®ç¦æ­¢ä¸€äº›ä¸åˆç†ã€ä¸ä¸¥è°¨çš„è¯­æ³•ï¼Œå‡å°‘ JavaScript è¯­è¨€çš„ä¸€äº›æ€ªå¼‚è¡Œä¸ºã€‚\n- å¢åŠ æ›´å¤šæŠ¥é”™çš„åœºåˆï¼Œæ¶ˆé™¤ä»£ç è¿è¡Œçš„ä¸€äº›ä¸å®‰å…¨ä¹‹å¤„ï¼Œä¿è¯ä»£ç è¿è¡Œçš„å®‰å…¨ã€‚\n- æé«˜ç¼–è¯‘å™¨æ•ˆç‡ï¼Œå¢åŠ è¿è¡Œé€Ÿåº¦ã€‚\n- ä¸ºæœªæ¥æ–°ç‰ˆæœ¬çš„ JavaScript è¯­æ³•åšå¥½é“ºå«ã€‚\n\n### ç‰¹ç‚¹\n\nåœ¨æ–‡ä»¶å¤´æˆ–è€…å‡½æ•°å†…éƒ¨æ·»åŠ  `use strict` å³å¯å¼€å¯ä¸¥æ ¼æ¨¡å¼ã€‚\n\n```html\n<script>\n'use strict'\n//ä¸¥æ ¼æ¨¡å¼\n</script>\n\n<script>\n//æ­£å¸¸æ¨¡å¼\n</script>\n```\n\n```js\n//æ­£å¸¸æ¨¡å¼\n'use strict'\n// ä¸¥æ ¼æ¨¡å¼\n```\n\næœ‰çš„æ—¶å€™éœ€è¦åˆå¹¶ä¸åŒçš„è„šæœ¬ï¼Œä¸¥æ ¼æ¨¡å¼çš„è„šæœ¬åœ¨å‰ï¼Œåˆ™åˆå¹¶çš„è„šæœ¬éƒ½æ˜¯ä¸¥æ ¼æ¨¡å¼ï¼Œå¦‚æœæ­£å¸¸çš„è„šæœ¬åœ¨å‰ï¼Œåˆ™åˆå¹¶åéƒ½æ˜¯æ­£å¸¸æ¨¡å¼çš„è„šæœ¬ï¼Œä½†æ˜¯è¿™ä¸¤ç§æƒ…å†µéƒ½æ˜¯é”™è¯¯çš„ï¼Œè¿™æ—¶å¯ä»¥è€ƒè™‘æŠŠæ•´ä¸ªè„šæœ¬æ”¾åœ¨ä¸€ä¸ªç«‹å³æ‰§è¡Œçš„å‡½æ•°ä¹‹ä¸­\n\n### æ˜¾ç¤ºæŠ¥é”™\n\nhttp://javascript.ruanyifeng.com/advanced/strict.html\n\n","tags":["ES5"],"categories":["Note"]},{"title":"LeanJsã€Œ ES5 ã€-- é¢å‘å¯¹è±¡ç¼–ç¨‹","url":"%2F2018%2F01%2F25%2FLeanJS%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B%2F","content":"\n![Js](LeanJSé¢å‘å¯¹è±¡ç¼–ç¨‹/js.png)\n\n<!--more-->\n\n## æ„é€ å‡½æ•°ä¸ new å‘½ä»¤\n\né¢å‘å¯¹è±¡ç¼–ç¨‹ï¼ˆObject Oriented Programmingï¼Œç¼©å†™ä¸º OOPï¼‰æ˜¯ç›®å‰ä¸»æµçš„ç¼–ç¨‹èŒƒå¼ã€‚å®ƒå°†çœŸå®ä¸–ç•Œå„ç§å¤æ‚çš„å…³ç³»ï¼ŒæŠ½è±¡ä¸ºä¸€ä¸ªä¸ªå¯¹è±¡ï¼Œç„¶åç”±å¯¹è±¡ä¹‹é—´çš„åˆ†å·¥ä¸åˆä½œï¼Œå®Œæˆå¯¹çœŸå®ä¸–ç•Œçš„æ¨¡æ‹Ÿã€‚\n\n**å¯¹è±¡æ˜¯å•ä¸ªå®ç‰©çš„æŠ½è±¡**\n\nä¸€æœ¬ä¹¦ã€ä¸€è¾†æ±½è½¦ã€ä¸€ä¸ªäººéƒ½å¯ä»¥æ˜¯å¯¹è±¡ï¼Œä¸€ä¸ªæ•°æ®åº“ã€ä¸€å¼ ç½‘é¡µã€ä¸€ä¸ªä¸è¿œç¨‹æœåŠ¡å™¨çš„è¿æ¥ä¹Ÿå¯ä»¥æ˜¯å¯¹è±¡ã€‚å½“å®ç‰©è¢«æŠ½è±¡æˆå¯¹è±¡ï¼Œå®ç‰©ä¹‹é—´çš„å…³ç³»å°±å˜æˆäº†å¯¹è±¡ä¹‹é—´çš„å…³ç³»ï¼Œä»è€Œå°±å¯ä»¥æ¨¡æ‹Ÿç°å®æƒ…å†µï¼Œé’ˆå¯¹å¯¹è±¡è¿›è¡Œç¼–ç¨‹ã€‚\n\n**å¯¹è±¡æ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œå°è£…äº†å±æ€§ï¼ˆpropertyï¼‰å’Œæ–¹æ³•ï¼ˆmethodï¼‰**\n\nå±æ€§æ˜¯å¯¹è±¡çš„çŠ¶æ€ï¼Œæ–¹æ³•æ˜¯å¯¹è±¡çš„è¡Œä¸ºï¼ˆå®ŒæˆæŸç§ä»»åŠ¡ï¼‰ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠåŠ¨ç‰©æŠ½è±¡ä¸ºanimalå¯¹è±¡ï¼Œä½¿ç”¨â€œå±æ€§â€è®°å½•å…·ä½“æ˜¯é‚£ä¸€ç§åŠ¨ç‰©ï¼Œä½¿ç”¨â€œæ–¹æ³•â€è¡¨ç¤ºåŠ¨ç‰©çš„æŸç§è¡Œä¸ºï¼ˆå¥”è·‘ã€æ•çŒã€ä¼‘æ¯ç­‰ç­‰ï¼‰ã€‚\n\n### new \n\n```js\nvar Vehicle = function () {\n  this.price = 1000;\n};\n\nvar v = new Vehicle();\nv.price // 1000\n```\n\nä½¿ç”¨ `new` å‘½ä»¤æ—¶ï¼Œæ ¹æ®éœ€è¦ï¼Œæ„é€ å‡½æ•°ä¹Ÿå¯ä»¥æ¥å—å‚æ•°ã€‚\n\n```js\nvar Vehicle = function (p) {\n  this.price = p;\n};\n\nvar v = new Vehicle(500);\n```\n\n`new` å‘½ä»¤æœ¬èº«å°±å¯ä»¥æ‰§è¡Œæ„é€ å‡½æ•°ï¼Œæ‰€ä»¥åé¢çš„æ„é€ å‡½æ•°å¯ä»¥å¸¦æ‹¬å·ï¼Œä¹Ÿå¯ä»¥ä¸å¸¦æ‹¬å·ã€‚ä¸‹é¢ä¸¤è¡Œä»£ç æ˜¯ç­‰ä»·çš„ã€‚\n\n```js\nvar v = new Vehicle();\nvar v = new Vehicle;\n```\n\n**æ³¨æ„**\n\n`new` å¿…é¡»è¦ä½¿ç”¨,ä¸ä½¿ç”¨ `new` å°±ä¸ä¼šäº§ç”Ÿå®ä¾‹å¯¹è±¡ï¼Œæ­¤æ—¶çš„ `this` å°±ä¼šæŒ‡å‘å…¨å±€å¯¹è±¡\n\n```js\nvar Vehicle = function (){\n  this.price = 1000;\n};\n\nvar v = Vehicle();\nv.price\n// Uncaught TypeError: Cannot read property 'price' of undefined\n\nprice\n// 1000\n```\n\n### new çš„åŸç†\n\n- åˆ›å»ºä¸€ä¸ªç©ºå¯¹è±¡ï¼Œä½œä¸ºå°†è¦è¿”å›çš„å¯¹è±¡å®ä¾‹\n- å°†è¿™ä¸ªç©ºå¯¹è±¡çš„åŸå‹ï¼ŒæŒ‡å‘æ„é€ å‡½æ•°çš„prototypeå±æ€§\n- å°†è¿™ä¸ªç©ºå¯¹è±¡èµ‹å€¼ç»™å‡½æ•°å†…éƒ¨çš„thiså…³é”®å­—\n- å¼€å§‹æ‰§è¡Œæ„é€ å‡½æ•°å†…éƒ¨çš„ä»£ç \n\nä¹Ÿå°±æ˜¯è¯´ï¼Œæ„é€ å‡½æ•°å†…éƒ¨ï¼Œ`this` æŒ‡çš„æ˜¯ä¸€ä¸ªæ–°ç”Ÿæˆçš„ç©ºå¯¹è±¡ï¼Œæ‰€æœ‰é’ˆå¯¹ `this` çš„æ“ä½œï¼Œéƒ½ä¼šå‘ç”Ÿåœ¨è¿™ä¸ªç©ºå¯¹è±¡ä¸Šã€‚æ„é€ å‡½æ•°ä¹‹æ‰€ä»¥å«ã€Œæ„é€ å‡½æ•°ã€ï¼Œå°±æ˜¯è¯´è¿™ä¸ªå‡½æ•°çš„ç›®çš„ï¼Œå°±æ˜¯æ“ä½œä¸€ä¸ªç©ºå¯¹è±¡ï¼ˆå³ `this` å¯¹è±¡ï¼‰ï¼Œå°†å…¶ã€Œæ„é€ ã€ä¸ºéœ€è¦çš„æ ·å­ã€‚\n\nå¦‚æœæ„é€ å‡½æ•°å†…éƒ¨æœ‰ `return` è¯­å¥ï¼Œè€Œä¸” `return` åé¢è·Ÿç€ä¸€ä¸ªå¯¹è±¡ï¼Œ`new` å‘½ä»¤ä¼šè¿”å› `return` è¯­å¥æŒ‡å®šçš„å¯¹è±¡ï¼›å¦åˆ™ï¼Œå°±ä¼šä¸ç®¡ `return`è¯­å¥ï¼Œè¿”å› `this` å¯¹è±¡ã€‚\n\nä½†æ˜¯ï¼Œå¦‚æœ `return` è¯­å¥è¿”å›çš„æ˜¯ä¸€ä¸ªè·Ÿ `this` æ— å…³çš„æ–°å¯¹è±¡ï¼Œ`new` å‘½ä»¤ä¼šè¿”å›è¿™ä¸ªæ–°å¯¹è±¡ï¼Œè€Œä¸æ˜¯ `this` å¯¹è±¡ã€‚è¿™ä¸€ç‚¹éœ€è¦ç‰¹åˆ«å¼•èµ·æ³¨æ„ã€‚\n```js\nvar Vehicle = function (){\n  this.price = 1000;\n  return { price: 2000 };\n};\n\n(new Vehicle()).price\n// 2000\n```\nä¸Šé¢ä»£ç ä¸­ï¼Œæ„é€ å‡½æ•° `Vehicle` çš„ `return` è¯­å¥ï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ªæ–°å¯¹è±¡ã€‚**`new` å‘½ä»¤ä¼šè¿”å›è¿™ä¸ªå¯¹è±¡ï¼Œè€Œä¸æ˜¯ `this` å¯¹è±¡**ã€‚\n\n**å¦ä¸€æ–¹é¢ï¼Œå¦‚æœå¯¹æ™®é€šå‡½æ•°ï¼ˆå†…éƒ¨æ²¡æœ‰ `this` å…³é”®å­—çš„å‡½æ•°ï¼‰ä½¿ç”¨ `new` å‘½ä»¤ï¼Œåˆ™ä¼šè¿”å›ä¸€ä¸ªç©ºå¯¹è±¡**ã€‚\n```js\nfunction getMessage() {\n  return 'this is a message';\n}\n\nvar msg = new getMessage();\n\nmsg // {}\ntypeof msg // \"object\"\n```\nä¸Šé¢ä»£ç ä¸­ï¼Œ`getMessage` æ˜¯ä¸€ä¸ªæ™®é€šå‡½æ•°ï¼Œè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚å¯¹å®ƒä½¿ç”¨ `new` å‘½ä»¤ï¼Œä¼šå¾—åˆ°ä¸€ä¸ªç©ºå¯¹è±¡ã€‚è¿™æ˜¯å› ä¸º `new` å‘½ä»¤æ€»æ˜¯è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè¦ä¹ˆæ˜¯å®ä¾‹å¯¹è±¡ï¼Œè¦ä¹ˆæ˜¯ `return` è¯­å¥æŒ‡å®šçš„å¯¹è±¡ã€‚æœ¬ä¾‹ä¸­ï¼Œ`return` è¯­å¥è¿”å›çš„æ˜¯å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥ `new` å‘½ä»¤å°±**å¿½ç•¥äº†è¯¥è¯­å¥**ã€‚\n\n### new.target\n\nå‡½æ•°å†…éƒ¨å¯ä»¥ä½¿ç”¨ `new.target` å±æ€§ã€‚å¦‚æœå½“å‰å‡½æ•°æ˜¯ `new` å‘½ä»¤è°ƒç”¨ï¼Œ`new.target` æŒ‡å‘å½“å‰å‡½æ•°ï¼Œå¦åˆ™ä¸º `undefined`ã€‚\n```js\nfunction f() {\n  console.log(new.target === f);\n}\n\nf() // false\nnew f() // true\n```\nä½¿ç”¨è¿™ä¸ªå±æ€§ï¼Œå¯ä»¥åˆ¤æ–­å‡½æ•°è°ƒç”¨çš„æ—¶å€™ï¼Œæ˜¯å¦ä½¿ç”¨ `new` å‘½ä»¤ã€‚\n```js\nfunction f() {\n  if (!new.target) {\n    throw new Error('è¯·ä½¿ç”¨ new å‘½ä»¤è°ƒç”¨ï¼');\n  }\n  // ...\n}\n\nf() // Uncaught Error: è¯·ä½¿ç”¨ new å‘½ä»¤è°ƒç”¨ï¼\n```\nä¸Šé¢ä»£ç ä¸­ï¼Œæ„é€ å‡½æ•° `f` è°ƒç”¨æ—¶ï¼Œæ²¡æœ‰ä½¿ç”¨ `new` å‘½ä»¤ï¼Œå°±æŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚\n\n### Object.create()\n\næ„é€ å‡½æ•°ä½œä¸ºæ¨¡æ¿ï¼Œå¯ä»¥ç”Ÿæˆå®ä¾‹å¯¹è±¡ã€‚ä½†æ˜¯ï¼Œæœ‰æ—¶åªèƒ½æ‹¿åˆ°å®ä¾‹å¯¹è±¡ï¼Œè€Œè¯¥å¯¹è±¡æ ¹æœ¬å°±ä¸æ˜¯ç”±æ„é€ å‡½æ•°ç”Ÿæˆçš„ï¼Œè¿™æ—¶å¯ä»¥ä½¿ç”¨ `Object.create()` æ–¹æ³•ï¼Œç›´æ¥ä»¥æŸä¸ªå®ä¾‹å¯¹è±¡ä½œä¸ºæ¨¡æ¿ï¼Œç”Ÿæˆä¸€ä¸ªæ–°çš„å®ä¾‹å¯¹è±¡ã€‚\n```js\nvar person1 = {\n  name: 'å¼ ä¸‰',\n  age: 38,\n  greeting: function() {\n    console.log('Hi! I\\'m ' + this.name + '.');\n  }\n};\n\nvar person2 = Object.create(person1);\n\nperson2.name // å¼ ä¸‰\nperson2.greeting() // Hi! I'm å¼ ä¸‰.\n```\n\n## this\n\n`this` æ€»æ˜¯è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œå°±æ˜¯è¿”å›å±æ€§å’Œæ–¹æ³•ã€Œå½“å‰ã€æ‰€åœ¨çš„å¯¹è±¡\n\nç”±äºå¯¹è±¡çš„å±æ€§å’Œå¯ä»¥èµ‹ç»™å¦ä¸€ä¸ªå¯¹è±¡ï¼Œæ‰€ä»¥ç›¸åŒå±æ€§æ‰€åœ¨çš„å½“å‰å¯¹è±¡æ˜¯å¯å˜çš„ï¼Œå³ `this` çš„æŒ‡å‘æ˜¯å¯ä»¥æ”¹å˜çš„\n\n```js\nfunction printf(){\n  return this.name;\n}\n\nvar A = {\n  name : 'Hutchins',\n  print : printf\n}\n\nvar B = {\n  name : 'zhangsan',\n  print : printf\n}\n\nA.print() //'Hutchins'\nB.print() //'zhangsan'\n```\n\nåœ¨ `printf` ä¸­ä½¿ç”¨äº† `this` å…³é”®å­—ï¼Œéšç€ `printf` æ‰€åœ¨çš„å½“å‰å¯¹è±¡çš„ä¸åŒï¼Œ`this` çš„æŒ‡å‘ä¹Ÿä¸åŒ\n\nåªè¦å‡½æ•°è¢«èµ‹ç»™å¦ä¸€ä¸ªå˜é‡ï¼Œ`this` çš„æŒ‡å‘ä¹Ÿä¼šå‘ç”Ÿæ”¹å˜\n\n```js\nvar A = {\n  name: 'å¼ ä¸‰',\n  describe: function () {\n    return 'å§“åï¼š'+ this.name;\n  }\n};\n\nvar name = 'æå››';\nvar f = A.describe;\nf() // \"å§“åï¼šæå››\"\n```\n\n`A.describe` è¢«èµ‹å€¼ç»™ `f` ï¼Œ**å†…éƒ¨çš„ `this` å°±ä¼šæŒ‡å‘ `f` è¿è¡Œæ—¶æ‰€åœ¨çš„å¯¹è±¡**(æœ¬ä¾‹æ˜¯é¡¶å±‚å¯¹è±¡)\n\n### å¤šå±‚å¯¹è±¡\n\nå¦‚æœæŸä¸ªæ–¹æ³•ä½äºå¤šå±‚å¯¹è±¡çš„å†…éƒ¨ï¼Œè¿™æ—¶ `this` åªæ˜¯æŒ‡å‘å½“å‰ä¸€å±‚çš„å¯¹è±¡ï¼Œè€Œä¸ä¼šç»§æ‰¿æ›´ä¸Šé¢çš„å±‚ã€‚\n\n```js\nvar a = {\n  p: 'Hello',\n  b: {\n    m: function() {\n      console.log(this);//b{..}\n      console.log(this.p);\n    }\n  }\n};\n\na.b.m() // undefined\n```\n\n`a.b.m` æ–¹æ³•åœ¨ `a` å¯¹è±¡çš„ç¬¬äºŒå±‚ï¼Œè¯¥æ–¹æ³•å†…éƒ¨çš„ `this` ä¸æ˜¯æŒ‡å‘ `a` ï¼Œè€Œæ˜¯æŒ‡å‘ `a.b` ã€‚è¿™æ˜¯å› ä¸ºå®é™…æ‰§è¡Œçš„æ˜¯ä¸‹é¢çš„ä»£ç ã€‚\n\n```js\nvar b = {\n  m: function() {\n   console.log(this.p);\n  }\n};\n\nvar a = {\n  p: 'Hello',\n  b: b\n};\n\n(a.b).m() // ç­‰åŒäº b.m()\n```\n\nå¦‚æœè¿™æ—¶å°†åµŒå¥—å¯¹è±¡å†…éƒ¨çš„æ–¹æ³•èµ‹å€¼ç»™ä¸€ä¸ªå˜é‡ï¼Œ`this` ä¾ç„¶ä¼šæŒ‡å‘å…¨å±€å¯¹è±¡ã€‚\n\n```js\nvar a = {\n  b: {\n    m: function() {\n      console.log(this.p);\n    },\n    p: 'Hello'\n  }\n};\n\nvar hello = a.b.m;\nhello() // undefined\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œ`m` æ˜¯å¤šå±‚å¯¹è±¡å†…éƒ¨çš„ä¸€ä¸ªæ–¹æ³•ã€‚ä¸ºæ±‚ç®€ä¾¿ï¼Œå°†å…¶èµ‹å€¼ç»™ `hello` å˜é‡ï¼Œç»“æœè°ƒç”¨æ—¶ï¼Œ`this` æŒ‡å‘äº†é¡¶å±‚å¯¹è±¡ã€‚ä¸ºäº†é¿å…è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥åªå°† `m` æ‰€åœ¨çš„å¯¹è±¡èµ‹å€¼ç»™ `hello`ï¼Œè¿™æ ·è°ƒç”¨æ—¶ï¼Œ`this` çš„æŒ‡å‘å°±ä¸ä¼šå˜ã€‚\n\n```js\nvar hello = a.b;\nhello.m() // Hello\n```\n\n### é¿å…å¤šå±‚this\n\nç”±äº `this` çš„æŒ‡å‘æ˜¯ä¸ç¡®å®šçš„ï¼Œæ‰€ä»¥åˆ‡å‹¿åœ¨å‡½æ•°ä¸­åŒ…å«å¤šå±‚çš„ `this`ã€‚\n\n```js\nvar o = {\n  f1: function () {\n    console.log(this);\n    var f2 = function () {\n      console.log(this);\n    }();\n  }\n}\n\no.f1()\n// Object\n// Window\n```\n\nä¸Šé¢ä»£ç åŒ…å«ä¸¤å±‚ `this` ï¼Œç»“æœè¿è¡Œåï¼Œç¬¬ä¸€å±‚æŒ‡å‘è¯¥å¯¹è±¡ï¼Œç¬¬äºŒå±‚æŒ‡å‘å…¨å±€å¯¹è±¡\n\nä¸€ä¸ªè§£å†³æ–¹æ³•æ˜¯åœ¨ç¬¬äºŒå±‚æ”¹ç”¨ä¸€ä¸ªæŒ‡å‘å¤–å±‚ `this` çš„å˜é‡ã€‚\n\n```js\nvar o = {\n  f1: function() {\n    console.log(this);\n    var that = this;\n    var f2 = function() {\n      console.log(that);\n    }();\n  }\n}\n\no.f1()\n// Object\n// Object\n```\n\nä¸Šé¢ä»£ç å®šä¹‰äº†å˜é‡ `that` ï¼Œå›ºå®šæŒ‡å‘å¤–å±‚çš„ `this` ï¼Œç„¶ååœ¨å†…å±‚ä½¿ç”¨ `that`ï¼Œå°±ä¸ä¼šå‘ç”Ÿ `this` æŒ‡å‘çš„æ”¹å˜ã€‚\n\n### é¿å…æ•°ç»„å¤„ç†æ–¹æ³•ä¸­çš„this\n\næ•°ç»„çš„ `map` å’Œ `foreach` æ–¹æ³•ï¼Œå…è®¸æä¾›ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ã€‚è¿™ä¸ªå‡½æ•°å†…éƒ¨ä¸åº”è¯¥ä½¿ç”¨ `this`ã€‚\n```js\nvar o = {\n  v: 'hello',\n  p: [ 'a1', 'a2' ],\n  f: function f() {\n    this.p.forEach(function (item) {\n      console.log(this.v + ' ' + item);\n    });\n  }\n}\n\no.f()\n// undefined a1\n// undefined a2\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œ`foreach` æ–¹æ³•çš„å›è°ƒå‡½æ•°ä¸­çš„ `this` ï¼Œå…¶å®æ˜¯æŒ‡å‘ `window` å¯¹è±¡ï¼Œå› æ­¤å–ä¸åˆ° `o.v` çš„å€¼ã€‚åŸå› è·Ÿä¸Šä¸€æ®µçš„å¤šå±‚ `this` æ˜¯ä¸€æ ·çš„ï¼Œå°±æ˜¯å†…å±‚çš„ `this` ä¸æŒ‡å‘å¤–éƒ¨ï¼Œè€ŒæŒ‡å‘**é¡¶å±‚å¯¹è±¡**ã€‚\n\nè§£å†³è¿™ä¸ªé—®é¢˜çš„ä¸€ç§æ–¹æ³•ï¼Œæ˜¯ä½¿ç”¨ä¸­é—´å˜é‡ã€‚\n```js\nvar o = {\n  v: 'hello',\n  p: [ 'a1', 'a2' ],\n  f: function f() {\n    var that = this;\n    this.p.forEach(function (item) {\n      console.log(that.v+' '+item);\n    });\n  }\n}\n\no.f()\n// hello a1\n// hello a2\n```\nå¦ä¸€ç§æ–¹æ³•æ˜¯å°† `this` å½“ä½œ `foreach` æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°ï¼Œå›ºå®šå®ƒçš„è¿è¡Œç¯å¢ƒã€‚\n\n```js\nvar o = {\n  v: 'hello',\n  p: [ 'a1', 'a2' ],\n  f: function f() {\n    this.p.forEach(function (item) {\n      console.log(this.v + ' ' + item);\n    }, this);\n  }\n}\n\no.f()\n// hello a1\n// hello a2\n```\n\n### ç»‘å®šthisçš„æ–¹æ³•\n\n#### function.prototype.call()\n\n`call` æ–¹æ³•çš„å‚æ•°ï¼Œåº”è¯¥æ˜¯ä¸€ä¸ªå¯¹è±¡ã€‚å¦‚æœå‚æ•°ä¸ºç©ºã€`null` å’Œ `undefined`ï¼Œåˆ™é»˜è®¤ä¼ å…¥å…¨å±€å¯¹è±¡ã€‚\n\n```js\nvar n = 123;\nvar obj = { n: 456 };\n\nfunction a() {\n  console.log(this.n);\n}\n\na.call() // 123\na.call(null) // 123\na.call(undefined) // 123\na.call(window) // 123\na.call(obj) // 456\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œ`a` å‡½æ•°ä¸­çš„ `this` å…³é”®å­—ï¼Œå¦‚æœæŒ‡å‘å…¨å±€å¯¹è±¡ï¼Œè¿”å›ç»“æœä¸º `123` ã€‚å¦‚æœä½¿ç”¨ `call` æ–¹æ³•å°† `this` å…³é”®å­—æŒ‡å‘ `obj` å¯¹è±¡ï¼Œè¿”å›ç»“æœä¸º `456` ã€‚å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœ `call` æ–¹æ³•æ²¡æœ‰å‚æ•°ï¼Œæˆ–è€…å‚æ•°ä¸º `null` æˆ– `undefined` ï¼Œåˆ™ç­‰åŒäºæŒ‡å‘å…¨å±€å¯¹è±¡ã€‚\n\nå¦‚æœ `call` æ–¹æ³•çš„å‚æ•°æ˜¯ä¸€ä¸ªåŸå§‹å€¼ï¼Œé‚£ä¹ˆè¿™ä¸ªåŸå§‹å€¼ä¼šè‡ªåŠ¨è½¬æˆå¯¹åº”çš„åŒ…è£…å¯¹è±¡ï¼Œç„¶åä¼ å…¥ `call` æ–¹æ³•ã€‚\n\n```js\nvar f = function () {\n  return this;\n};\n\nf.call(5)\n// Number {[[PrimitiveValue]]: 5}\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œ `call` çš„å‚æ•°ä¸º5ï¼Œä¸æ˜¯å¯¹è±¡ï¼Œä¼šè¢«è‡ªåŠ¨è½¬æˆåŒ…è£…å¯¹è±¡ï¼ˆNumberçš„å®ä¾‹ï¼‰ï¼Œç»‘å®š `f` å†…éƒ¨çš„ `this`ã€‚\n\n`call` æ–¹æ³•è¿˜å¯ä»¥æ¥å—å¤šä¸ªå‚æ•°ã€‚\n\n```js\nfunc.call(thisValue, arg1, arg2, ...)\n```\n\n`call` çš„ç¬¬ä¸€ä¸ªå‚æ•°å°±æ˜¯ `this` æ‰€è¦æŒ‡å‘çš„é‚£ä¸ªå¯¹è±¡ï¼Œåé¢çš„å‚æ•°åˆ™æ˜¯å‡½æ•°è°ƒç”¨æ—¶æ‰€éœ€çš„å‚æ•°ã€‚\n\n`call` æ–¹æ³•çš„ä¸€ä¸ªä½¿ç”¨æ˜¯è°ƒç”¨å¯¹è±¡çš„åŸå§‹æ–¹æ³•\n\n```js\nvar num = 6;\nnum.toString()//\"6\"\n\nObject.prototype.toString.call(num)//\"[object Number]\"\n```\n\n#### function.prototype.apply()\n\n`apply` æ–¹æ³•çš„ä½œç”¨ä¸ `call` æ–¹æ³•ç±»ä¼¼ï¼Œä¹Ÿæ˜¯æ”¹å˜ `this` æŒ‡å‘ï¼Œç„¶åå†è°ƒç”¨è¯¥å‡½æ•°ã€‚å”¯ä¸€çš„åŒºåˆ«å°±æ˜¯ï¼Œå®ƒæ¥æ”¶ä¸€ä¸ªæ•°ç»„ä½œä¸ºå‡½æ•°æ‰§è¡Œæ—¶çš„å‚æ•°ï¼Œä½¿ç”¨æ ¼å¼å¦‚ä¸‹ã€‚\n\n```js\nfunc.apply(thisValue, [arg1, arg2, ...])\n```\n\n**å°†æ•°ç»„çš„ç©ºå…ƒç´ å˜ä¸º `undefined`**\n\né€šè¿‡ `apply` æ–¹æ³•ï¼Œåˆ©ç”¨ `Array` æ„é€ å‡½æ•°å°†æ•°ç»„çš„ç©ºå…ƒç´ å˜æˆ `undefined`ã€‚\n\n```js\nArray.apply(null, [\"a\",,\"b\"])\n// [ 'a', undefined, 'b' ]\n```\n\nç©ºå…ƒç´ ä¸ `undefined` çš„å·®åˆ«åœ¨äºï¼Œæ•°ç»„çš„ `forEach` æ–¹æ³•ä¼šè·³è¿‡ç©ºå…ƒç´ ï¼Œä½†æ˜¯ä¸ä¼šè·³è¿‡ `undefined` ã€‚å› æ­¤ï¼Œéå†å†…éƒ¨å…ƒç´ çš„æ—¶å€™ï¼Œä¼šå¾—åˆ°ä¸åŒçš„ç»“æœã€‚\n\n```js\nvar a = ['a', , 'b'];\n\nfunction print(i) {\n  console.log(i);\n}\n\na.forEach(print)\n// a\n// b\n\nArray.apply(null, a).forEach(print)\n// a\n// undefined\n// b\n```\n\n**ç±»æ•°ç»„è½¬æ¢**\n\n```js\nvar arr = Array.prototype.slice.call(arrayLike);\n```\n\n#### function.prototype.bind()\n\n`bind` æ–¹æ³•ç”¨äºå°†å‡½æ•°ä½“å†…çš„ `this` ç»‘å®šåˆ°æŸä¸ªå¯¹è±¡ï¼Œç„¶åè¿”å›ä¸€ä¸ªæ–°å‡½æ•°ã€‚ \n\n`bind` æ¯” `call` æ–¹æ³•å’Œ `apply` æ–¹æ³•æ›´è¿›ä¸€æ­¥çš„æ˜¯ï¼Œé™¤äº†ç»‘å®š `this` ä»¥å¤–ï¼Œè¿˜å¯ä»¥ç»‘å®šåŸå‡½æ•°çš„å‚æ•°ã€‚\n```js\nvar add = function (x, y) {\n  return x * this.m + y * this.n;\n}\n\nvar obj = {\n  m: 2,\n  n: 2\n};\n\nvar newAdd = add.bind(obj, 5);\n\nnewAdd(5)\n// 20\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œ`bind` æ–¹æ³•é™¤äº†ç»‘å®š `this` å¯¹è±¡ï¼Œè¿˜å°† `add` å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•° `x` ç»‘å®šæˆ `5` ï¼Œç„¶åè¿”å›ä¸€ä¸ªæ–°å‡½æ•° `newAdd` ï¼Œè¿™ä¸ªå‡½æ•°åªè¦å†æ¥å—ä¸€ä¸ªå‚æ•° `y` å°±èƒ½è¿è¡Œäº†ã€‚\n\n## prototype å¯¹è±¡\n\nJavaScript ç»§æ‰¿æœºåˆ¶çš„è®¾è®¡å°±æ˜¯ï¼ŒåŸå‹çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ï¼Œéƒ½èƒ½è¢«å­å¯¹è±¡å…±äº«ã€‚\n\n```js\nfunction Car(name){\n  this.name = name;\n}\nCar.prototype.speed = 70;\n\nvar car1 = new Car('baoma');\nvar car2 = new Car('benchi');\ncar1.speed // 70\ncar2.speed // 70\n```\n\nåœ¨åŸå‹ä¸Šå®šä¹‰äº†ä¸€ä¸ª `speed` å±æ€§ï¼Œæ‰€æœ‰ `Car` å®ä¾‹å¯¹è±¡éƒ½æœ‰è¿™ä¸€ä¸ªå±æ€§ï¼Œå¦‚æœå®ä¾‹å¯¹è±¡ä¹Ÿå®šä¹‰ `speed` å±æ€§ï¼Œé‚£ä¹ˆå°±ä¼šæœ‰ä¸€ä¸ªå…¶è‡ªèº«çš„ `speed` å±æ€§ï¼Œä¸ä¼šå½±å“å…¶å®ƒåŸå‹ä¸Šçš„å±æ€§å’Œå…¶å®ƒå®ä¾‹å¯¹è±¡\n\n### åŸå‹é“¾\n\næ‰€æœ‰å¯¹è±¡çš„åŸå‹éƒ½å¯ä»¥è¿½æº¯åˆ° `Object.prototype` ï¼Œè€Œ `Object.prototype` çš„åŸå‹å°±æ˜¯æ²¡æœ‰ä»»ä½•å±æ€§å’Œä»»ä½•æ–¹æ³•çš„ `null` å¯¹è±¡ã€‚è€Œ `null` æ²¡æœ‰è‡ªå·±çš„åŸå‹\n\nã€ŒåŸå‹é“¾ã€çš„ä½œç”¨æ˜¯ï¼Œè¯»å–å¯¹è±¡çš„æŸä¸ªå±æ€§æ—¶ï¼ŒJavaScript å¼•æ“å…ˆå¯»æ‰¾å¯¹è±¡æœ¬èº«çš„å±æ€§ï¼Œå¦‚æœæ‰¾ä¸åˆ°ï¼Œå°±åˆ°å®ƒçš„åŸå‹å»æ‰¾ï¼Œå¦‚æœè¿˜æ˜¯æ‰¾ä¸åˆ°ï¼Œå°±åˆ°åŸå‹çš„åŸå‹å»æ‰¾ã€‚å¦‚æœç›´åˆ°æœ€é¡¶å±‚çš„ `Object.prototype` è¿˜æ˜¯æ‰¾ä¸åˆ°ï¼Œåˆ™è¿”å› `undefined`ã€‚\n\nå¦‚æœå¯¹è±¡è‡ªèº«å’Œå®ƒçš„åŸå‹ï¼Œéƒ½å®šä¹‰äº†ä¸€ä¸ªåŒåå±æ€§ï¼Œé‚£ä¹ˆä¼˜å…ˆè¯»å–å¯¹è±¡è‡ªèº«çš„å±æ€§ï¼Œè¿™å«åšã€Œè¦†ç›–ã€ï¼ˆoverridingï¼‰ã€‚\n\néœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸€çº§çº§å‘ä¸Šï¼Œåœ¨åŸå‹é“¾å¯»æ‰¾æŸä¸ªå±æ€§ï¼Œå¯¹æ€§èƒ½æ˜¯æœ‰å½±å“çš„ã€‚æ‰€å¯»æ‰¾çš„å±æ€§åœ¨è¶Šä¸Šå±‚çš„åŸå‹å¯¹è±¡ï¼Œå¯¹æ€§èƒ½çš„å½±å“è¶Šå¤§ã€‚å¦‚æœå¯»æ‰¾æŸä¸ªä¸å­˜åœ¨çš„å±æ€§ï¼Œå°†ä¼šéå†æ•´ä¸ªåŸå‹é“¾ã€‚\n\nå¦‚æœè®©æŸä¸ªå‡½æ•°çš„ `prototype` æŒ‡å‘ä¸€ä¸ªæ•°ç»„ï¼Œå°±æ„å‘³ç€è¿™ä¸ªå‡½æ•°å¯ä»¥å½“ä½œæ•°ç»„çš„æ„é€ å‡½æ•°ï¼Œå› ä¸ºå®ƒç”Ÿæˆçš„å®ä¾‹å¯¹è±¡éƒ½å¯ä»¥è°ƒç”¨æ•°ç»„çš„å±æ€§å’Œæ–¹æ³•\n\n```js\nvar MyArray = function(){};\n\nMyArray.prototype = new Array();\n\nvar mine = new myArray()\nmine.push(1,2,3);\n\nmine.length // 3\nmine instanceof Array // true\n```\n\n### constructor\n\n`prototype` å¯¹è±¡æœ‰ä¸€ä¸ª `constructor` å±æ€§ï¼Œé»˜è®¤æŒ‡å‘ `prototype` å¯¹è±¡æ‰€åœ¨çš„æ„é€ å‡½æ•°ã€‚\n\nç”±äº `constructor` å±æ€§å®šä¹‰åœ¨ `prototype` å¯¹è±¡ä¸Šé¢ï¼Œæ„å‘³ç€å¯ä»¥è¢«æ‰€æœ‰å®ä¾‹å¯¹è±¡ç»§æ‰¿\n\n```js\nfunction P(){};\nvar p = new P();\n\nP.prototype.constructor === p.constructor//true\n```\n\nä½†æ˜¯å®ä¾‹å¯¹è±¡è‡ªèº«æ˜¯æ²¡æœ‰ `constructor` å±æ€§\n\n```js\np.hasOwnProperty('constructor')//false\n```\n\né€šè¿‡ `constructor` çš„ `name` å±æ€§å¯ä»¥è·å¾—æ„é€ å‡½æ•°çš„åå­—\n\n```js\np.constructor.name // 'P'\n```\n\n`constructor` å±æ€§è¡¨ç¤ºåŸå‹å¯¹è±¡ä¸æ„é€ å‡½æ•°ä¹‹é—´çš„å…³è”å…³ç³»ï¼Œå¦‚æœä¿®æ”¹äº†åŸå‹å¯¹è±¡ï¼Œä¸€èˆ¬ä¼šåŒæ—¶ä¿®æ”¹ `constructor` å±æ€§ï¼Œé˜²æ­¢å¼•ç”¨çš„æ—¶å€™å‡ºé”™ã€‚\n\nä¿®æ”¹åŸå‹å¯¹è±¡æ—¶ï¼Œä¸€èˆ¬è¦åŒæ—¶æ ¡æ­£ `constructor` å±æ€§çš„æŒ‡å‘ã€‚\n\n```js\n// é¿å…è¿™ç§å†™æ³•\nC.prototype = {\n  method1: function (...) { ... },\n  // ...\n};\n\n// è¾ƒå¥½çš„å†™æ³•\nC.prototype = {\n  constructor: C,\n  method1: function (...) { ... },\n  // ...\n};\n\n// æ›´å¥½å¥½çš„å†™æ³•\nC.prototype.method1 = function (...) { ... };\n```\n\n### instanceof\n\n`instanceof` è¿ç®—ç¬¦çš„å·¦è¾¹æ˜¯å®ä¾‹å¯¹è±¡ï¼Œå³è¾¹æ˜¯æ„é€ å‡½æ•°ã€‚å®ƒä¼šæ£€æŸ¥å³è¾¹æ„å»ºå‡½æ•°çš„åŸå‹å¯¹è±¡ï¼ˆprototypeï¼‰ï¼Œæ˜¯å¦åœ¨å·¦è¾¹å¯¹è±¡çš„åŸå‹é“¾ä¸Šã€‚\n\n`instanceof` çš„åŸç†æ˜¯æ£€æŸ¥åŸå‹é“¾ï¼Œå¯¹äºé‚£äº›ä¸å­˜åœ¨åŸå‹é“¾çš„å¯¹è±¡ï¼Œå°±æ— æ³•åˆ¤æ–­ã€‚ä¾‹å¦‚ `null`\n\n`instanceof` è¿ç®—ç¬¦åªèƒ½ç”¨äºå¯¹è±¡ï¼Œä¸é€‚ç”¨åŸå§‹ç±»å‹çš„å€¼ã€‚\n\nå¯¹äº `undefined` å’Œ `null` ï¼Œ`instanceOf` è¿ç®—ç¬¦æ€»æ˜¯è¿”å› `false` ã€‚\n\n### Object.getPrototypeOf()\n\n`Object.getPrototypeOf` æ–¹æ³•è¿”å›ä¸€ä¸ªå¯¹è±¡çš„åŸå‹ã€‚è¿™æ˜¯è·å–åŸå‹å¯¹è±¡çš„æ ‡å‡†æ–¹æ³•ã€‚\n\n```js\nObject.getPrototypeOf({}) === Object.prototype\n```\n\n### Object.setPrototypeOf()\n\n`Object.setPrototypeOf` æ–¹æ³•å¯ä»¥ä¸ºç°æœ‰å¯¹è±¡è®¾ç½®åŸå‹ï¼Œè¿”å›ä¸€ä¸ªæ–°å¯¹è±¡ã€‚\n\n`Object.setPrototypeOf` æ–¹æ³•æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯ç°æœ‰å¯¹è±¡ï¼Œç¬¬äºŒä¸ªæ˜¯åŸå‹å¯¹è±¡ã€‚\n\n`new` å‘½ä»¤é€šè¿‡æ„é€ å‡½æ•°æ–°å»ºå®ä¾‹å¯¹è±¡ï¼Œå®è´¨å°±æ˜¯å°†å®ä¾‹å¯¹è±¡çš„åŸå‹ï¼ŒæŒ‡å‘æ„é€ å‡½æ•°çš„ `prototype` å±æ€§ï¼Œç„¶ååœ¨å®ä¾‹å¯¹è±¡ä¸Šæ‰§è¡Œæ„é€ å‡½æ•°ã€‚\n\n```js\nvar F = function () {\n  this.foo = 'bar';\n};\n\nvar f = new F();\n\n// ç­‰åŒäº\nvar f = Object.setPrototypeOf({}, F.prototype);\nF.call(f);//ç»‘å®šthis\n```\n\n### Object.create()\n\n```js\nif (typeof Object.create !== 'function') {\n  Object.create = function (obj) {\n    function F() {}\n    F.prototype = obj;\n    return new F();\n  };\n}\n```\n\n`Object.create` æ–¹æ³•çš„å®è´¨æ˜¯æ–°å»ºä¸€ä¸ªæ„é€ å‡½æ•° `F` ï¼Œç„¶åè®© `F.prototype` å±æ€§æŒ‡å‘å‚æ•°å¯¹è±¡ `obj` ï¼Œæœ€åè¿”å›ä¸€ä¸ª `F` çš„å®ä¾‹ï¼Œä»è€Œå®ç°è®©è¯¥å®ä¾‹ç»§æ‰¿ `obj` çš„å±æ€§\n\nä½¿ç”¨ `Object.create` æ–¹æ³•çš„æ—¶å€™ï¼Œå¿…é¡»æä¾›å¯¹è±¡åŸå‹ï¼Œå³å‚æ•°ä¸èƒ½ä¸ºç©ºï¼Œæˆ–è€…ä¸æ˜¯å¯¹è±¡ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚\n\n```js\nObject.create()\n// TypeError: Object prototype may only be an Object or null\n\nObject.create(123)\n// TypeError: Object prototype may only be an Object or null\n```\n\n`object.create` æ–¹æ³•ç”Ÿæˆçš„æ–°å¯¹è±¡ï¼ŒåŠ¨æ€ç»§æ‰¿äº†åŸå‹ã€‚åœ¨åŸå‹ä¸Šæ·»åŠ æˆ–ä¿®æ”¹ä»»ä½•æ–¹æ³•ï¼Œä¼šç«‹åˆ»åæ˜ åœ¨æ–°å¯¹è±¡ä¹‹ä¸Šã€‚\n\n```js\nvar obj1 = { p: 1 };\nvar obj2 = Object.create(obj1);\n\nobj1.p = 2;\nobj2.p\n// 2\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œä¿®æ”¹å¯¹è±¡åŸå‹ `obj1` ä¼šå½±å“åˆ°æ–°ç”Ÿæˆçš„å®ä¾‹å¯¹è±¡ `obj2`ã€‚\n\né™¤äº†å¯¹è±¡çš„åŸå‹ï¼Œ`Object.create` æ–¹æ³•è¿˜å¯ä»¥æ¥å—ç¬¬äºŒä¸ªå‚æ•°ã€‚è¯¥å‚æ•°æ˜¯ä¸€ä¸ªå±æ€§æè¿°å¯¹è±¡ï¼Œå®ƒæ‰€æè¿°çš„å¯¹è±¡å±æ€§ï¼Œä¼šæ·»åŠ åˆ°å®ä¾‹å¯¹è±¡ï¼Œä½œä¸ºè¯¥å¯¹è±¡è‡ªèº«çš„å±æ€§ã€‚\n\n```js\nvar obj = Object.create({}, {\n  p1: {\n    value: 123,\n    enumerable: true,\n    configurable: true,\n    writable: true,\n  },\n  p2: {\n    value: 'abc',\n    enumerable: true,\n    configurable: true,\n    writable: true,\n  }\n});\n\n// ç­‰åŒäº\nvar obj = Object.create({});\nobj.p1 = 123;\nobj.p2 = 'abc';\n```\n\n`Object.create` æ–¹æ³•ç”Ÿæˆçš„å¯¹è±¡ï¼Œç»§æ‰¿äº†å®ƒçš„åŸå‹å¯¹è±¡çš„æ„é€ å‡½æ•°ã€‚\n\n```js\nfunction A() {}\nvar a = new A();\nvar b = Object.create(a);\n\nb.constructor === A // true\nb instanceof A // true\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œ`b` å¯¹è±¡çš„åŸå‹æ˜¯ `a` å¯¹è±¡ï¼Œå› æ­¤ç»§æ‰¿äº† `a` å¯¹è±¡çš„æ„é€ å‡½æ•° `A`ã€‚\n\n### Object.prototype.isPrototypeOf()\n\nå¯¹è±¡å®ä¾‹çš„ `isPrototypeOf` æ–¹æ³•ï¼Œç”¨æ¥åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦æ˜¯å¦ä¸€ä¸ªå¯¹è±¡çš„åŸå‹ã€‚\n\nåªè¦æŸä¸ªå¯¹è±¡å¤„åœ¨åŸå‹é“¾ä¸Šï¼Œ`isPrototypeOf` éƒ½è¿”å› `true`ã€‚\n\n## Object å¯¹è±¡ä¸ç»§æ‰¿\n\n### Object.getOwnPropertyNames()\n\n`Object.getOwnPropertyNames` æ–¹æ³•è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œ**æˆå‘˜æ˜¯å¯¹è±¡æœ¬èº«çš„æ‰€æœ‰å±æ€§çš„é”®åï¼Œä¸åŒ…å«ç»§æ‰¿çš„å±æ€§é”®å**ï¼Œè€Œä¸”ä¼šå°†ä¸å¯æšä¸¾çš„ä¹Ÿä¸€åŒè·å–åˆ°\n\n### Object.keys()\n\n`Object.keys` ä¹Ÿæ˜¯è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œä¸ `Object.getOwnPropertyNames` ä¸åŒçš„æ˜¯ï¼Œ**åªèƒ½æšä¸¾å‡ºå¯æšä¸¾çš„è‡ªèº«å±æ€§**\n\n### Object.prototype.hasOwnProperty()\n\nå¯¹è±¡å®ä¾‹çš„ `hasOwnProperty` æ–¹æ³•è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œç”¨äºåˆ¤æ–­æŸä¸ªå±æ€§å®šä¹‰åœ¨å¯¹è±¡è‡ªèº«ï¼Œè¿˜æ˜¯å®šä¹‰åœ¨åŸå‹é“¾ä¸Šã€‚\n\n### in è¿ç®—ç¬¦å’Œ forâ€¦in å¾ªç¯\n\n`in` è¿ç®—ç¬¦è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºä¸€ä¸ªå¯¹è±¡æ˜¯å¦å…·æœ‰æŸä¸ªå±æ€§ã€‚**å®ƒä¸åŒºåˆ†è¯¥å±æ€§æ˜¯å¯¹è±¡è‡ªèº«çš„å±æ€§ï¼Œè¿˜æ˜¯ç»§æ‰¿çš„å±æ€§**ã€‚\n\n`for...in`ä¼šæšä¸¾å‡ºæ‰€æœ‰**å¯æšä¸¾çš„å±æ€§ï¼Œä¸è®ºæ˜¯è‡ªèº«çš„è¿˜æ˜¯ç»§æ‰¿çš„**\n\n## é¢å‘å¯¹è±¡ç¼–ç¨‹æ¨¡å¼\n\n### æ„é€ å‡½æ•°çš„ç»§æ‰¿\n\nä¸€ä¸ªæ„é€ å‡½æ•°ç»§æ‰¿å¦ä¸€ä¸ªæ„é€ å‡½æ•°\n\n```js\nfunction Shape() {\n  this.x = 0;\n  this.y = 0;\n}\nShape.prototype.move = function(x,y){\n  this.x+=x;\n  this.y+=y;\n  console.log('shape moved');\n}\n```\n\nç„¶åç”¨ `Rectange` æ„é€ å‡½æ•°ç»§æ‰¿ `Shape`\n\n```js\n//ç¬¬ä¸€æ­¥ å­ç±»æ„é€ å‡½æ•°ç»§æ‰¿çˆ¶ç±»çš„å®ä¾‹ \n//å°±ç›¸å½“äºåœ¨å­ç±»æ„é€ å‡½æ•°ä¸­ç”¨å­ç±»thisè°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°\nfunction Rectange(){\n  Shape.call(this);\n}\n\n//å¦ä¸€ç§å†™æ³•\nfunction Rectange(){\n  this.base = Shape;\n  this.base();\n}\n\n//å­ç±»ç»§æ‰¿çˆ¶ç±»çš„åŸå‹\nRectange.prototype = Object.create(Shape.prototype);\nRectange.prototype.constructor = Rectange;\n```\n\nåœ¨æ­¤å¤„ `Rectange.prototype` ä¸èƒ½ç›´æ¥ç­‰äº `Shape.prototype` ï¼Œè¦ç­‰äº `Object.create(Shape.prototype)`ï¼Œç›¸å½“äºç­‰äº `Shape.prototype`çš„ä¸€ä¸ªå‰¯æœ¬ï¼Œç›´æ¥ç­‰äºçš„è¯åé¢åœ¨ä¿®æ”¹ `Rectange.prototype` çš„æ—¶å€™ä¼šè¿ `Shape.prototype` ä¸€åŒä¿®æ”¹æ‰\n\nä¹Ÿå¯ä»¥ä»…å®ç°å•ä¸ªæ–¹æ³•çš„ç»§æ‰¿\n\n```js\nRectange.prototype.printf = function(){\n  Shape.prototype.printf.call(this);\n}\n```\n\n[å…³äºæ¨¡å—ï¼Œå¤šé‡ç»§æ‰¿ï¼Œå°è£…ç§æœ‰å˜é‡](http://javascript.ruanyifeng.com/oop/pattern.html)\n\n\n\n\n\n\n\n\n","tags":["ES5"],"categories":["Note"]},{"title":"LeanJsã€Œ ES5 ã€-- æ ‡å‡†åº“","url":"%2F2018%2F01%2F24%2FLearnJS%E6%A0%87%E5%87%86%E5%BA%93%2F","content":"\n![Js](LearnJSæ ‡å‡†åº“/js.png)\n\n<!--more-->\n\n## Object\n\n### Object()\n\n`Object()`æœ¬èº«æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå¯ä»¥å°†ä»»æ„å€¼è½¬æ¢ä¸ºå¯¹è±¡\n\n```js\nvar obj = Object();\n// ç­‰åŒäº\nvar obj = Object(undefined);\nvar obj = Object(null);\n```\n\nå¦‚æœè¦è¢«è½¬æ¢çš„å€¼ä¸ºåŸå§‹ç±»å‹ï¼Œ`Object`ä¼šå°†å…¶è½¬æ¢æˆå¯¹åº”çš„åŒ…è£…ç±»å‹ï¼Œå¦‚æœè¦è½¬æ¢çš„å€¼æ˜¯å¯¹è±¡ï¼Œå®ƒæ€»æ˜¯è¿”å›è¯¥å¯¹è±¡ï¼Œå³ä¸ç”¨è½¬æ¢\n\n```js\nvar obj = Object(1);\nobj instanceof Object // true\nobj instanceof Number // true\n\nvar obj = Object('foo');\nobj instanceof Object // true\nobj instanceof String // true\n\nvar obj = Object(true);\nobj instanceof Object // true\nobj instanceof Boolean // true\n```\n\nå› æ­¤å¯ä»¥ç”¨`Object`æ¥åˆ¤æ–­æ˜¯å¦ä¸ºå¯¹è±¡\n\n```js\nvar arr = [];\nvar obj = Object(arr); // è¿”å›åŸæ•°ç»„\nobj === arr // true\n\nvar value = {};\nvar obj = Object(value) // è¿”å›åŸå¯¹è±¡\nobj === value // true\n\nvar fn = function () {};\nvar obj = Object(fn); // è¿”å›åŸå‡½æ•°\nobj === fn // true\n\nfunction isObj(value){\n  return value === Object(value);\n}\n```\n\n### Objectæ„é€ å‡½æ•°\n\n```js\nvar obj = new Object();\n\n//ç­‰åŒäº\n\nvar obj = {};\n```\n\n`new Object(value)`ä¸­ä¹Ÿå¯ä»¥ä¼ å…¥å€¼ï¼Œå’Œ`Object(value)`ç›¸åŒï¼Œåªä¸è¿‡åœ¨è¯­ä¹‰ä¸Šæœ‰æ‰€å·®åˆ«ã€‚å‰è€…è¡¨ç¤ºç”Ÿæˆä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒçš„å€¼ä¸º`value`ï¼Œåè€…è¡¨ç¤ºå°†`value`è½¬æ¢ä¸ºå¯¹è±¡\n\n### é™æ€æ–¹æ³•\n\néƒ¨ç½²åœ¨`Object`å¯¹è±¡è‡ªèº«çš„æ–¹æ³•\n\n#### Object.keys() && Object.getOwnPropertyNames()\n\n`Object.keys`æ–¹æ³•å’Œ`Object.getOwnPropertyNames`æ–¹æ³•éƒ½ç”¨æ¥éå†å¯¹è±¡çš„å±æ€§ã€‚\n\n`Object.keys()`å’Œ`Object.getOwnPropertyNames()`æ–¹æ³•çš„å‚æ•°æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè¿”å›ä¸€ä¸ªæ•°ç»„ã€‚è¯¥æ•°ç»„çš„æˆå‘˜éƒ½æ˜¯è¯¥å¯¹è±¡è‡ªèº«çš„ï¼ˆè€Œä¸æ˜¯ç»§æ‰¿çš„ï¼‰æ‰€æœ‰å±æ€§åã€‚\n\n`Object.getOwnPropertyNames()`è¿˜å¯ä»¥éå†å‡ºä¸å¯æšä¸¾çš„å±æ€§ï¼Œ`Object.keys()`ä¸å¯ä»¥\n\n```js\nvar a = ['Hello', 'World'];\n\nObject.keys(a) // [\"0\", \"1\"]\nObject.getOwnPropertyNames(a) // [\"0\", \"1\", \"length\"]\n```\n\n#### Object.prototype.toString\n\n`toString`æ–¹æ³•çš„ä½œç”¨æ˜¯è¿”å›ä¸€ä¸ªå¯¹è±¡çš„å­—ç¬¦ä¸²å½¢å¼ï¼Œé»˜è®¤æƒ…å†µä¸‹è¿”å›ç±»å‹å­—ç¬¦ä¸²ã€‚\n\næ•°ç»„ã€å­—ç¬¦ä¸²ã€å‡½æ•°ã€Dateå¯¹è±¡éƒ½åˆ†åˆ«éƒ¨ç½²äº†è‡ªå®šä¹‰çš„`toString`æ–¹æ³•\n\nå¯ä»¥ç”¨æ¥å‡†ç¡®çš„åˆ¤æ–­æ•°æ®ç±»å‹\n\n```js\nObject.prototype.toString.call(value)\n```\n\nè¿™æ ·å¯ä»¥ä»»æ„è°ƒç”¨`Object.prototype.toString`æ–¹æ³•\n\nå„ç§ç±»å‹çš„è¿”å›ç»“æœ\n\n```\næ•°å€¼ï¼šè¿”å›[object Number]ã€‚\nå­—ç¬¦ä¸²ï¼šè¿”å›[object String]ã€‚\nå¸ƒå°”å€¼ï¼šè¿”å›[object Boolean]ã€‚\nundefinedï¼šè¿”å›[object Undefined]ã€‚\nnullï¼šè¿”å›[object Null]ã€‚\næ•°ç»„ï¼šè¿”å›[object Array]ã€‚\narguments å¯¹è±¡ï¼šè¿”å›[object Arguments]ã€‚\nå‡½æ•°ï¼šè¿”å›[object Function]ã€‚\nError å¯¹è±¡ï¼šè¿”å›[object Error]ã€‚\nDate å¯¹è±¡ï¼šè¿”å›[object Date]ã€‚\nRegExp å¯¹è±¡ï¼šè¿”å›[object RegExp]ã€‚\nå…¶ä»–å¯¹è±¡ï¼šè¿”å›[object Object]ã€‚\n```\n\nåˆ©ç”¨è¿™ä¸ªå¯ä»¥å†™å‡ºæ¯”`typeof`æ›´åŠ å‡†ç¡®çš„ç±»å‹åˆ¤æ–­å‡½æ•°\n\n```js\nfunction checkType(value){\n  var s = Object.prototype.toString.call(value);\n  return s.match(/\\[object (.*?)\\]/)[1].toLowerCase();\n}\n```\n\nJavaScriptä¸­`match`å‡½æ•°æ–¹æ³•è¿”å›çš„æ•°ç»„æœ‰ä¸‰ä¸ªå±æ€§ï¼š`input`ã€`index`å’Œ`lastIndex`ã€‚`Input` å±æ€§åŒ…å«æ•´ä¸ªçš„è¢«æŸ¥æ‰¾å­—ç¬¦ä¸²ã€‚`Index` å±æ€§åŒ…å«äº†åœ¨æ•´ä¸ªè¢«æŸ¥æ‰¾å­—ç¬¦ä¸²ä¸­åŒ¹é…çš„å­å­—ç¬¦ä¸²çš„ä½ç½®ã€‚`LastIndex` å±æ€§åŒ…å«äº†æœ€åä¸€æ¬¡åŒ¹é…ä¸­æœ€åä¸€ä¸ªå­—ç¬¦çš„ä¸‹ä¸€ä¸ªä½ç½®ã€‚å¦‚æœæ²¡æœ‰è®¾ç½®å…¨å±€æ ‡å¿— `g`ï¼Œæ•°ç»„çš„0å…ƒç´ åŒ…å«æ•´ä¸ªåŒ¹é…ï¼Œè€Œç¬¬ 1 åˆ° n å…ƒç´ åŒ…å«äº†åŒ¹é…ä¸­æ›¾å‡ºç°è¿‡çš„ä»»ä¸€ä¸ª**å­åŒ¹é…(åœ¨å…¶ä¸­ç”¨è¿‡åœ†æ‹¬å·)**ã€‚è¿™ç›¸å½“äºæ²¡æœ‰è®¾ç½®å…¨å±€æ ‡å¿—çš„ `exec` æ–¹æ³•ã€‚å¦‚æœè®¾ç½®äº†å…¨å±€æ ‡å¿—ï¼Œå…ƒç´ 0åˆ°nä¸­åŒ…å«æ‰€æœ‰åŒ¹é…\n\n#### Object.prototype.toLocaleString\n\nè¿”å›å€¼å’Œ`Object.prototype.toString`ç›¸åŒï¼Œç”¨æ¥ç•™ä¸€ä¸ªå‡ºå£è¿”å›é’ˆå¯¹åœ°åŸŸçš„æŸäº›ç‰¹å®šçš„å€¼.\n\n## Arrayå¯¹è±¡\n\n### åˆ›å»º\n\n```js\nvar arr = [];\n\nvar arr = new Array()\n\nvar arr = new Array(3);\narr.length // 3\n\narr[0] // undefined\narr[1] // undefined\narr[2] // undefined\n\n0 in arr // false\n1 in arr // false\n2 in arr // false\n```\n\næ³¨æ„ï¼Œå¦‚æœå‚æ•°æ˜¯ä¸€ä¸ªæ­£æ•´æ•°ï¼Œè¿”å›æ•°ç»„çš„æˆå‘˜éƒ½æ˜¯ç©ºä½ã€‚è™½ç„¶è¯»å–çš„æ—¶å€™è¿”å›`undefined`ï¼Œä½†å®é™…ä¸Šè¯¥ä½ç½®æ²¡æœ‰ä»»ä½•å€¼ã€‚è™½ç„¶å¯ä»¥å–åˆ°`length`å±æ€§ï¼Œä½†æ˜¯å–ä¸åˆ°é”®åã€‚\n\n### æ–¹æ³•\n\n#### æ”¹å˜åŸæ•°ç»„\n\npop\n\n`pop`æ–¹æ³•ç”¨äºåˆ é™¤æ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¿”å›è¯¥å…ƒç´ \n\n```js\n[].pop()//undefined\n```\n\npush\n\n`push`æ–¹æ³•ç”¨äºåœ¨æ•°ç»„çš„æœ«ç«¯æ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ ï¼Œå¹¶è¿”å›æ·»åŠ æ–°å…ƒç´ åçš„æ•°ç»„é•¿åº¦\n\nshift\n\n`shift`æ–¹æ³•ç”¨äºåˆ é™¤æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¿”å›è¯¥å…ƒç´ \n\nunshift\n\n`unshift`æ–¹æ³•ç”¨äºåœ¨æ•°ç»„çš„ç¬¬ä¸€ä¸ªä½ç½®æ·»åŠ å…ƒç´ ï¼Œå¹¶è¿”å›æ·»åŠ æ–°å…ƒç´ åçš„æ•°ç»„é•¿åº¦\n\nreverse\n\n`reverse`æ–¹æ³•ç”¨äºé¢ å€’æ•°ç»„ä¸­å…ƒç´ çš„é¡ºåºï¼Œè¿”å›æ”¹å˜åçš„æ•°ç»„\n\nsplice\n\n`splice`æ–¹æ³•ç”¨äºåˆ é™¤åŸæ•°ç»„çš„ä¸€éƒ¨åˆ†æˆå‘˜ï¼Œå¹¶å¯ä»¥åœ¨è¢«åˆ é™¤çš„ä½ç½®æ·»åŠ å…¥æ–°çš„æ•°ç»„æˆå‘˜ï¼Œè¿”å›å€¼æ˜¯è¢«åˆ é™¤çš„å…ƒç´ \n\n```js\narr.splice(index, count_to_remove, addElement1, addElement2, ...)\n```\n\nsort\n\n`sort`æ–¹æ³•å¯¹æ•°ç»„æˆå‘˜è¿›è¡Œæ’åºï¼Œé»˜è®¤æ˜¯æŒ‰ç…§å­—å…¸é¡ºåºæ’åº.\n\n```js\n[\n  { name: \"å¼ ä¸‰\", age: 30 },\n  { name: \"æå››\", age: 24 },\n  { name: \"ç‹äº”\", age: 28  }\n].sort(function (o1, o2) {\n  return o1.age - o2.age;\n})\n// [\n//   { name: \"æå››\", age: 24 },\n//   { name: \"ç‹äº”\", age: 28 },\n//   { name: \"å¼ ä¸‰\", age: 30 }\n// ]\n```\n\n#### ä¸æ”¹å˜åŸæ•°ç»„\n\njoin\n\n`join`æ–¹æ³•ä»¥å‚æ•°ä½œä¸ºåˆ†éš”ç¬¦ï¼Œå°†æ‰€æœ‰æ•°ç»„æˆå‘˜ç»„æˆä¸€ä¸ªå­—ç¬¦ä¸²è¿”å›ã€‚å¦‚æœä¸æä¾›å‚æ•°ï¼Œé»˜è®¤ç”¨é€—å·åˆ†éš”ã€‚\n\n```js\n[undefined,null].join('#')//#\n```\n\nå¦‚æœæ•°ç»„æˆå‘˜æ˜¯`undefined`ï¼Œ`null`ï¼Œæˆ–ç©ºä½ä¼šè¢«è½¬æ¢æˆç©ºå­—ç¬¦ä¸²\n\nconcat\n\n`concat`æ–¹æ³•ç”¨äºå¤šä¸ªæ•°ç»„çš„åˆå¹¶ã€‚å®ƒå°†æ–°æ•°ç»„çš„æˆå‘˜ï¼Œæ·»åŠ åˆ°åŸæ•°ç»„æˆå‘˜çš„åéƒ¨ï¼Œç„¶åè¿”å›ä¸€ä¸ªæ–°æ•°ç»„.\n\nslice\n\n`slice`æ–¹æ³•ç”¨äºæå–åŸæ•°ç»„çš„ä¸€éƒ¨åˆ†ï¼Œè¿”å›ä¸€ä¸ªæ–°æ•°ç»„.\n\n```js\narr.slice(start_index,end_index);//å·¦é—­å³å¼€\n```\n\nä¹Ÿå¯ä»¥ç”¨æ¥å°†ç±»æ•°ç»„è½¬æ¢æˆæ•°ç»„\n\n```js\nArray.prototype.slice.call(arrayLike);\n```\n\nmap\n\n`map`æ–¹æ³•å¯¹æ•°ç»„çš„æ‰€æœ‰æˆå‘˜ä¾æ¬¡è°ƒç”¨ä¸€ä¸ªå‡½æ•°ï¼Œæ ¹æ®å‡½æ•°ç»“æœè¿”å›ä¸€ä¸ªæ–°æ•°ç»„ã€‚\n\n```js\narr.map(function(item,index,arr){\n  //å½“å‰æˆå‘˜,å½“å‰ä½ç½®,æ•°ç»„æœ¬èº«\n},arr)//èŠ±æ‹¬å·åçš„arrè¡¨ç¤ºå›è°ƒå‡½æ•°çš„thisæŒ‡å‘\n//åªæœ‰itemæ˜¯å¿…é¡»å­˜åœ¨çš„\n```\n\n`map`æ–¹æ³•ä¸è·³è¿‡`undefined`å’Œ`null`ï¼Œä½†æ˜¯ä¼šè·³è¿‡ç©ºä½ï¼Œç¢°åˆ°ç©ºä½ä¸æ‰§è¡Œä»»ä½•å‡½æ•°ï¼Œç›´æ¥è·³è¿‡.\n\nforEach\n\n`forEach`æ–¹æ³•ä¸`map`æ–¹æ³•å¾ˆç›¸ä¼¼ï¼Œä¹Ÿæ˜¯éå†æ•°ç»„çš„æ‰€æœ‰æˆå‘˜ï¼Œæ‰§è¡ŒæŸç§æ“ä½œï¼Œä½†æ˜¯`forEach`æ–¹æ³•ä¸€èˆ¬ä¸è¿”å›å€¼ï¼Œåªç”¨æ¥æ“ä½œæ•°æ®ã€‚å¦‚æœéœ€è¦æœ‰è¿”å›å€¼ï¼Œä¸€èˆ¬ä½¿ç”¨`map`æ–¹æ³•ã€‚\n\n```js\narr.forEach(function(item,index,arr){\n  //å½“å‰æˆå‘˜,å½“å‰ä½ç½®,æ•°ç»„æœ¬èº«\n},arr)//èŠ±æ‹¬å·åçš„arrè¡¨ç¤ºå›è°ƒå‡½æ•°çš„thisæŒ‡å‘\n//åªæœ‰itemæ˜¯å¿…é¡»å­˜åœ¨çš„\n```\n\nfilter\n\n`filter`æ–¹æ³•çš„å‚æ•°æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæ‰€æœ‰æ•°ç»„æˆå‘˜ä¾æ¬¡æ‰§è¡Œè¯¥å‡½æ•°ï¼Œè¿”å›ç»“æœä¸º`true`çš„æˆå‘˜ç»„æˆä¸€ä¸ªæ–°æ•°ç»„è¿”å›\n\n```js\narr.filter(function(item,index,arr){\n  //å½“å‰æˆå‘˜,å½“å‰ä½ç½®,æ•°ç»„æœ¬èº«\n},arr)//èŠ±æ‹¬å·åçš„arrè¡¨ç¤ºå›è°ƒå‡½æ•°çš„thisæŒ‡å‘\n//åªæœ‰itemæ˜¯å¿…é¡»å­˜åœ¨çš„\n```\n\nsome\n\n`some`æ–¹æ³•æ˜¯åªè¦æœ‰ä¸€ä¸ªæ•°ç»„æˆå‘˜çš„è¿”å›å€¼æ˜¯`true`ï¼Œåˆ™æ•´ä¸ª`some`æ–¹æ³•çš„è¿”å›å€¼å°±æ˜¯`true`ï¼Œå¦åˆ™`false`ã€‚\n\n```js\narr.some(function(item,index,arr){\n  //å½“å‰æˆå‘˜,å½“å‰ä½ç½®,æ•°ç»„æœ¬èº«\n},arr)//èŠ±æ‹¬å·åçš„arrè¡¨ç¤ºå›è°ƒå‡½æ•°çš„thisæŒ‡å‘\n//åªæœ‰itemæ˜¯å¿…é¡»å­˜åœ¨çš„\n```\n\nevery\n\n`every`æ–¹æ³•åˆ™æ˜¯æ‰€æœ‰æ•°ç»„æˆå‘˜çš„è¿”å›å€¼éƒ½æ˜¯`true`ï¼Œæ‰è¿”å›`true`ï¼Œå¦åˆ™`false`ã€‚\n\n```js\narr.some(function(item,index,arr){\n  //å½“å‰æˆå‘˜,å½“å‰ä½ç½®,æ•°ç»„æœ¬èº«\n},arr)//èŠ±æ‹¬å·åçš„arrè¡¨ç¤ºå›è°ƒå‡½æ•°çš„thisæŒ‡å‘\n//åªæœ‰itemæ˜¯å¿…é¡»å­˜åœ¨çš„\n```\n\nreduce && reduceRight\n\n`reduce`æ–¹æ³•å’Œ`reduceRight`æ–¹æ³•ä¾æ¬¡å¤„ç†æ•°ç»„çš„æ¯ä¸ªæˆå‘˜ï¼Œæœ€ç»ˆç´¯è®¡ä¸ºä¸€ä¸ªå€¼ã€‚\n\nå®ƒä»¬çš„å·®åˆ«æ˜¯ï¼Œ`reduce`æ˜¯ä»å·¦åˆ°å³å¤„ç†ï¼ˆä»ç¬¬ä¸€ä¸ªæˆå‘˜åˆ°æœ€åä¸€ä¸ªæˆå‘˜ï¼‰ï¼Œ`reduceRight`åˆ™æ˜¯ä»å³åˆ°å·¦ï¼ˆä»æœ€åä¸€ä¸ªæˆå‘˜åˆ°ç¬¬ä¸€ä¸ªæˆå‘˜ï¼‰ï¼Œå…¶ä»–å®Œå…¨ä¸€æ ·ã€‚\n\nè¿™ä¸¤ä¸ªæ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°éƒ½æ˜¯ä¸€ä¸ªå‡½æ•°ã€‚è¯¥å‡½æ•°æ¥å—ä»¥ä¸‹å››ä¸ªå‚æ•°ã€‚\n\n```\nç´¯ç§¯å˜é‡ï¼Œé»˜è®¤ä¸ºæ•°ç»„çš„ç¬¬ä¸€ä¸ªæˆå‘˜\nå½“å‰å˜é‡ï¼Œé»˜è®¤ä¸ºæ•°ç»„çš„ç¬¬äºŒä¸ªæˆå‘˜\nå½“å‰ä½ç½®ï¼ˆä»0å¼€å§‹ï¼‰\nåŸæ•°ç»„\n```\n\nè¿™å››ä¸ªå‚æ•°ä¹‹ä¸­ï¼Œåªæœ‰å‰ä¸¤ä¸ªæ˜¯å¿…é¡»çš„ï¼Œåä¸¤ä¸ªåˆ™æ˜¯å¯é€‰çš„ã€‚\n\nindexOf && lastIndexOf\n\n`indexOf`æ–¹æ³•è¿”å›ç»™å®šå…ƒç´ åœ¨æ•°ç»„ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œå¦‚æœæ²¡æœ‰å‡ºç°åˆ™è¿”å›-1ã€‚\n\n`lastIndexOf`æ–¹æ³•è¿”å›ç»™å®šå…ƒç´ åœ¨æ•°ç»„ä¸­æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œå¦‚æœæ²¡æœ‰å‡ºç°åˆ™è¿”å›-1ã€‚\n\n`indexOf`æ–¹æ³•è¿˜å¯ä»¥æ¥å—ç¬¬äºŒä¸ªå‚æ•°ï¼Œè¡¨ç¤ºæœç´¢çš„å¼€å§‹ä½ç½®ã€‚\n\nå¦‚æœæ•°ç»„ä¸­åŒ…å«`NaN`ï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•ä¸é€‚ç”¨ï¼Œå³æ— æ³•ç¡®å®šæ•°ç»„æˆå‘˜æ˜¯å¦åŒ…å«`NaN`\n\nè¿™æ˜¯å› ä¸ºè¿™ä¸¤ä¸ªæ–¹æ³•å†…éƒ¨ï¼Œä½¿ç”¨ä¸¥æ ¼ç›¸ç­‰è¿ç®—ç¬¦`===`è¿›è¡Œæ¯”è¾ƒï¼Œè€Œ`NaN`æ˜¯å”¯ä¸€ä¸€ä¸ªä¸ç­‰äºè‡ªèº«çš„å€¼\n\n## åŒ…è£…å¯¹è±¡\n\næ‰€è°“ã€ŒåŒ…è£…å¯¹è±¡ã€ï¼Œå°±æ˜¯åˆ†åˆ«ä¸æ•°å€¼ã€å­—ç¬¦ä¸²ã€å¸ƒå°”å€¼ç›¸å¯¹åº”çš„`Number`ã€`String`ã€`Boolean`ä¸‰ä¸ªåŸç”Ÿå¯¹è±¡ã€‚è¿™ä¸‰ä¸ªåŸç”Ÿå¯¹è±¡å¯ä»¥æŠŠåŸå§‹ç±»å‹çš„å€¼å˜æˆï¼ˆåŒ…è£…æˆï¼‰å¯¹è±¡ã€‚\n\n```js\nvar r = new Number(123);\ntypeof r //object\n```\n\nå¦‚æœä¸ä½œä¸ºæ„é€ å‡½æ•°è°ƒç”¨ï¼ˆå³è°ƒç”¨ä¸åŠ `new`ï¼‰ï¼Œæ˜¯å°†å…¶å®ƒç±»å‹è½¬æ¢ä¸º`number`,`string`,`boolean`\n\n### åŸå§‹ç±»å‹çš„è‡ªåŠ¨è½¬æ¢\n\nåŸå§‹ç±»å‹çš„å€¼ï¼Œå¯ä»¥è‡ªåŠ¨å½“ä½œå¯¹è±¡è°ƒç”¨ï¼Œå³è°ƒç”¨å„ç§å¯¹è±¡çš„æ–¹æ³•å’Œå‚æ•°ã€‚è¿™æ—¶ï¼ŒJavaScriptå¼•æ“ä¼šè‡ªåŠ¨å°†åŸå§‹ç±»å‹çš„å€¼è½¬ä¸ºåŒ…è£…å¯¹è±¡ï¼Œ**åœ¨ä½¿ç”¨åç«‹åˆ»é”€æ¯**ã€‚\n\nå› ä¸ºç«‹å³é”€æ¯ï¼Œæ‰€ä»¥è¿™ä¸ªä¸´æ—¶å¯¹è±¡æ˜¯åªè¯»çš„ï¼Œæ— æ³•è¿›è¡Œä¿®æ”¹ï¼Œæ‰€ä»¥æ— æ³•æ·»åŠ æ–°å±æ€§ã€‚\n\n```js\nvar str = 'abc';\nstr.length // 3\n\n// ç­‰åŒäº\nvar strObj = new String(str)\n// String {\n//   0: \"a\", 1: \"b\", 2: \"c\", length: 3, [[PrimitiveValue]]: \"abc\"\n// }\nstrObj.length // 3\n```\n\n`[[PrimitiveValue]]`ä¿å­˜å­—ç¬¦ä¸²çš„åŸå§‹å€¼ã€‚è¿™ä¸ª`[[PrimitiveValue]]`å†…éƒ¨å±æ€§ï¼Œå¤–éƒ¨æ˜¯æ— æ³•è°ƒç”¨ï¼Œä»…ä¾›`ValueOf`æˆ–`toString`è¿™æ ·çš„æ–¹æ³•å†…éƒ¨è°ƒç”¨ã€‚\n\n### Booleanå¯¹è±¡\n\n`false`å¯¹åº”çš„åŒ…è£…å¯¹è±¡çš„å®ä¾‹,å¸ƒå°”è¿ç®—ç»“æœæ˜¯`true`\n\n```js\nif (new Boolean(false)) {\n  console.log('true');\n} // true\n\nif (new Boolean(false).valueOf()) {\n  console.log('true');\n} // æ— è¾“å‡º\n```\n\nä¸Šé¢ä»£ç çš„ç¬¬ä¸€ä¸ªä¾‹å­ä¹‹æ‰€ä»¥å¾—åˆ°`true`ï¼Œæ˜¯å› ä¸º`false`å¯¹åº”çš„åŒ…è£…å¯¹è±¡å®ä¾‹æ˜¯ä¸€ä¸ª**å¯¹è±¡**ï¼Œè¿›è¡Œé€»è¾‘è¿ç®—æ—¶ï¼Œè¢«è‡ªåŠ¨è½¬åŒ–æˆå¸ƒå°”å€¼`true`ï¼ˆå› ä¸ºæ‰€æœ‰å¯¹è±¡å¯¹åº”çš„å¸ƒå°”å€¼éƒ½æ˜¯`true`ï¼‰ã€‚è€Œå®ä¾‹çš„`valueOf`æ–¹æ³•ï¼Œåˆ™è¿”å›å®ä¾‹å¯¹åº”çš„åŸå§‹å€¼ï¼Œæœ¬ä¾‹ä¸º`false`ã€‚\n\n## Number\n\n### å±æ€§\n\n```js\nNumber.POSITIVE_INFINITYï¼šæ­£çš„æ— é™ï¼ŒæŒ‡å‘Infinityã€‚\nNumber.NEGATIVE_INFINITYï¼šè´Ÿçš„æ— é™ï¼ŒæŒ‡å‘-Infinityã€‚\nNumber.NaNï¼šè¡¨ç¤ºéæ•°å€¼ï¼ŒæŒ‡å‘ NaNã€‚\nNumber.MAX_VALUEï¼šè¡¨ç¤ºæœ€å¤§çš„æ­£æ•°ï¼Œç›¸åº”çš„ï¼Œæœ€å°çš„è´Ÿæ•°ä¸º-Number.MAX_VALUEã€‚\nNumber.MIN_VALUEï¼šè¡¨ç¤ºæœ€å°çš„æ­£æ•°ï¼ˆå³æœ€æ¥è¿‘0çš„æ­£æ•°ï¼Œåœ¨64ä½æµ®ç‚¹æ•°ä½“ç³»ä¸­ä¸º5e-324ï¼‰ï¼Œç›¸åº”çš„ï¼Œæœ€æ¥è¿‘0çš„è´Ÿæ•°ä¸º-Number.MIN_VALUEã€‚\nNumber.MAX_SAFE_INTEGERï¼šè¡¨ç¤ºèƒ½å¤Ÿç²¾ç¡®è¡¨ç¤ºçš„æœ€å¤§æ•´æ•°ï¼Œå³9007199254740991ã€‚\nNumber.MIN_SAFE_INTEGERï¼šè¡¨ç¤ºèƒ½å¤Ÿç²¾ç¡®è¡¨ç¤ºçš„æœ€å°æ•´æ•°ï¼Œå³-9007199254740991ã€‚\n```\n\n### æ–¹æ³•\n\n#### toString\n\næ¥å—å‚æ•°å¯ä»¥è½¬ä¸ºç›¸åº”è¿›åˆ¶çš„å­—ç¬¦ä¸²\n\n```js\n(10).toString(2) // \"1010\"\n(10).toString(8) // \"12\"\n(10).toString(16) // \"a\"\n```\n\n#### toFixed\n\n`toFixed`æ–¹æ³•çš„å‚æ•°ä¸ºæŒ‡å®šçš„å°æ•°ä½æ•°ï¼Œæœ‰æ•ˆèŒƒå›´ä¸º0åˆ°20ï¼Œè¶…å‡ºè¿™ä¸ªèŒƒå›´å°†æŠ›å‡º`RangeError`é”™è¯¯ã€‚\n\n#### toExponential\n\n`toExponential`æ–¹æ³•çš„å‚æ•°è¡¨ç¤ºå°æ•°ç‚¹åæœ‰æ•ˆæ•°å­—çš„ä½æ•°ï¼ŒèŒƒå›´ä¸º0åˆ°20ï¼Œè¶…å‡ºè¿™ä¸ªèŒƒå›´ï¼Œä¼šæŠ›å‡ºä¸€ä¸ª`RangeError`ã€‚\n\n#### toPrecision\n\n`toExponential`æ–¹æ³•çš„å‚æ•°è¡¨ç¤ºå°æ•°ç‚¹åæœ‰æ•ˆæ•°å­—çš„ä½æ•°ï¼ŒèŒƒå›´ä¸º0åˆ°20ï¼Œè¶…å‡ºè¿™ä¸ªèŒƒå›´ï¼Œä¼šæŠ›å‡ºä¸€ä¸ª`RangeError`ã€‚\n\n\n## String\n\n### String.fromCharCode\n\nè¯¥æ–¹æ³•çš„å‚æ•°æ˜¯ä¸€ç³»åˆ—`Unicode`ç ç‚¹ï¼Œè¿”å›å¯¹åº”çš„å­—ç¬¦ä¸²ã€‚\n\nè¯¥æ–¹æ³•ä¸æ”¯æŒ`Unicode`ç ç‚¹å¤§äº`0xFFFF`çš„å­—ç¬¦ï¼Œå³ä¼ å…¥çš„å‚æ•°ä¸èƒ½å¤§äº`0xFFFF`ã€‚\n\n### charAt\n\nå¯ä»¥ç”¨ä¸‹æ ‡ä»£æ›¿ï¼Œå¦‚æœå‚æ•°ä¸ºè´Ÿæ•°ï¼Œæˆ–å¤§äºç­‰äºå­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œ`charAt`è¿”å›ç©ºå­—ç¬¦ä¸²ã€‚\n\n### charCodeAt\n\n`charCodeAt`æ–¹æ³•è¿”å›ç»™å®šä½ç½®å­—ç¬¦çš„`Unicode`ç ç‚¹ï¼ˆåè¿›åˆ¶è¡¨ç¤ºï¼‰ï¼Œç›¸å½“äº`String.fromCharCode()`çš„é€†æ“ä½œ\n\n:exclamation: æ³¨æ„\n\nå¦‚æœæ²¡æœ‰ä»»ä½•å‚æ•°ï¼Œ`charCodeAt`è¿”å›é¦–å­—ç¬¦çš„`Unicode`ç ç‚¹ã€‚\n\n`charCodeAt`æ–¹æ³•è¿”å›çš„`Unicode`ç ç‚¹ä¸å¤§äº`65536ï¼ˆ0xFFFFï¼‰`ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåªè¿”å›ä¸¤ä¸ªå­—èŠ‚çš„å­—ç¬¦çš„ç ç‚¹ã€‚å¦‚æœé‡åˆ°`Unicode`ç ç‚¹å¤§äº`65536`çš„å­—ç¬¦ï¼Œå¿…éœ€è¿ç»­ä½¿ç”¨ä¸¤æ¬¡`charCodeAt`ï¼Œä¸ä»…è¯»å…¥`charCodeAt(i)`ï¼Œè¿˜è¦è¯»å…¥`charCodeAt(i+1)`ï¼Œå°†ä¸¤ä¸ª16å­—èŠ‚æ”¾åœ¨ä¸€èµ·ï¼Œæ‰èƒ½å¾—åˆ°å‡†ç¡®çš„å­—ç¬¦ã€‚\n\nå¦‚æœå‚æ•°ä¸ºè´Ÿæ•°ï¼Œæˆ–å¤§äºç­‰äºå­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œ`charCodeAt`è¿”å›`NaN`ã€‚\n\n### indexOf()ï¼ŒlastIndexOf()\n\nè¿™ä¸¤ä¸ªæ–¹æ³•ç”¨äºç¡®å®šä¸€ä¸ªå­—ç¬¦ä¸²åœ¨å¦ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­çš„ä½ç½®ï¼Œéƒ½è¿”å›ä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºåŒ¹é…å¼€å§‹çš„ä½ç½®ã€‚å¦‚æœè¿”å›`-1`ï¼Œå°±è¡¨ç¤ºä¸åŒ¹é…ã€‚ä¸¤è€…çš„åŒºåˆ«åœ¨äºï¼Œ`indexOf`ä»å­—ç¬¦ä¸²å¤´éƒ¨å¼€å§‹åŒ¹é…ï¼Œ`lastIndexOf`ä»å°¾éƒ¨å¼€å§‹åŒ¹é…ã€‚\n\n### concat\n\n`concat`æ–¹æ³•ç”¨äºè¿æ¥ä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œè¿”å›ä¸€ä¸ªæ–°å­—ç¬¦ä¸²ï¼Œä¸æ”¹å˜åŸå­—ç¬¦ä¸²ã€‚\n\n### slice\n\n`slice`æ–¹æ³•ç”¨äºä»åŸå­—ç¬¦ä¸²å–å‡ºå­å­—ç¬¦ä¸²å¹¶è¿”å›ï¼Œä¸æ”¹å˜åŸå­—ç¬¦ä¸²ã€‚\n\nå®ƒçš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å­å­—ç¬¦ä¸²çš„å¼€å§‹ä½ç½®ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å­å­—ç¬¦ä¸²çš„ç»“æŸä½ç½®ï¼ˆä¸å«è¯¥ä½ç½®ï¼‰ã€‚å·¦é—­å³å¼€\n\nå¦‚æœå‚æ•°æ˜¯è´Ÿå€¼ï¼Œè¡¨ç¤ºä»ç»“å°¾å¼€å§‹å€’æ•°è®¡ç®—çš„ä½ç½®ï¼Œå³è¯¥**è´Ÿå€¼åŠ ä¸Šå­—ç¬¦ä¸²é•¿åº¦**ã€‚\n\nå¦‚æœç¬¬ä¸€ä¸ªå‚æ•°å¤§äºç¬¬äºŒä¸ªå‚æ•°ï¼Œsliceæ–¹æ³•è¿”å›ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ã€‚\n\n### substring\n\n`substring`æ–¹æ³•ç”¨äºä»åŸå­—ç¬¦ä¸²å–å‡ºå­å­—ç¬¦ä¸²å¹¶è¿”å›ï¼Œä¸æ”¹å˜åŸå­—ç¬¦ä¸²\n\n`substring`æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°è¡¨ç¤ºå­å­—ç¬¦ä¸²çš„å¼€å§‹ä½ç½®ï¼Œç¬¬äºŒä¸ªä½ç½®è¡¨ç¤ºç»“æŸä½ç½®ã€‚\n\nå¦‚æœç¬¬äºŒä¸ªå‚æ•°å¤§äºç¬¬ä¸€ä¸ªå‚æ•°ï¼Œ`substring`æ–¹æ³•ä¼šè‡ªåŠ¨æ›´æ¢ä¸¤ä¸ªå‚æ•°çš„ä½ç½®ã€‚\n\nå¦‚æœå‚æ•°æ˜¯è´Ÿæ•°ï¼Œ`substring`æ–¹æ³•ä¼šè‡ªåŠ¨å°†è´Ÿæ•°è½¬ä¸º0ã€‚\n\nä¸å»ºè®®ä½¿ç”¨ï¼Œä¼˜å…ˆä½¿ç”¨`slice`\n\n### substr\n\n`substr`æ–¹æ³•ç”¨äºä»åŸå­—ç¬¦ä¸²å–å‡ºå­å­—ç¬¦ä¸²å¹¶è¿”å›ï¼Œä¸æ”¹å˜åŸå­—ç¬¦ä¸²ã€‚\n\n`substr`æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å­å­—ç¬¦ä¸²çš„å¼€å§‹ä½ç½®ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å­å­—ç¬¦ä¸²çš„é•¿åº¦ã€‚\n\nå¦‚æœç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è´Ÿæ•°ï¼Œè¡¨ç¤ºå€’æ•°è®¡ç®—çš„å­—ç¬¦ä½ç½®ã€‚å¦‚æœç¬¬äºŒä¸ªå‚æ•°æ˜¯è´Ÿæ•°ï¼Œå°†è¢«è‡ªåŠ¨è½¬ä¸º0ï¼Œå› æ­¤ä¼šè¿”å›ç©ºå­—ç¬¦ä¸²ã€‚\n\n### trim\n\n`trim`æ–¹æ³•ç”¨äºå»é™¤å­—ç¬¦ä¸²ä¸¤ç«¯çš„ç©ºæ ¼ï¼Œè¿”å›ä¸€ä¸ªæ–°å­—ç¬¦ä¸²ï¼Œä¸æ”¹å˜åŸå­—ç¬¦ä¸²ã€‚\n\nè¯¥æ–¹æ³•å»é™¤çš„ä¸ä»…æ˜¯ç©ºæ ¼ï¼Œè¿˜åŒ…æ‹¬åˆ¶è¡¨ç¬¦`\\tã€\\v`ã€æ¢è¡Œç¬¦`\\n`å’Œå›è½¦ç¬¦`\\r`ã€‚\n\n### toLowerCase()ï¼ŒtoUpperCase()\n\n`toLowerCase`æ–¹æ³•ç”¨äºå°†ä¸€ä¸ªå­—ç¬¦ä¸²å…¨éƒ¨è½¬ä¸ºå°å†™ï¼Œ`toUpperCase`åˆ™æ˜¯å…¨éƒ¨è½¬ä¸ºå¤§å†™ã€‚å®ƒä»¬éƒ½è¿”å›ä¸€ä¸ªæ–°å­—ç¬¦ä¸²ï¼Œä¸æ”¹å˜åŸå­—ç¬¦ä¸²ã€‚\n\n### localeCompare()\n\n`localeCompare`æ–¹æ³•ç”¨äºæ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²ã€‚å®ƒè¿”å›ä¸€ä¸ªæ•´æ•°ï¼Œå¦‚æœå°äº0ï¼Œè¡¨ç¤ºç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²å°äºç¬¬äºŒä¸ªå­—ç¬¦ä¸²ï¼›å¦‚æœç­‰äº0ï¼Œè¡¨ç¤ºä¸¤è€…ç›¸ç­‰ï¼›å¦‚æœå¤§äº0ï¼Œè¡¨ç¤ºç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²å¤§äºç¬¬äºŒä¸ªå­—ç¬¦ä¸²ã€‚\n\n### match\n\n`match`æ–¹æ³•ç”¨äºç¡®å®šåŸå­—ç¬¦ä¸²æ˜¯å¦åŒ¹é…æŸä¸ªå­å­—ç¬¦ä¸²ï¼Œè¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œæˆå‘˜ä¸ºåŒ¹é…çš„ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚å¦‚æœæ²¡æœ‰æ‰¾åˆ°åŒ¹é…ï¼Œåˆ™è¿”å›`null`ã€‚\n\nè¿”å›æ•°ç»„è¿˜æœ‰`index`å±æ€§å’Œ`input`å±æ€§ï¼Œåˆ†åˆ«è¡¨ç¤ºåŒ¹é…å­—ç¬¦ä¸²å¼€å§‹çš„ä½ç½®å’ŒåŸå§‹å­—ç¬¦ä¸²ã€‚\n\n### search\n\n`search`æ–¹æ³•çš„ç”¨æ³•ç­‰åŒäº`match`ï¼Œä½†æ˜¯è¿”å›å€¼ä¸ºåŒ¹é…çš„ç¬¬ä¸€ä¸ªä½ç½®ã€‚å¦‚æœæ²¡æœ‰æ‰¾åˆ°åŒ¹é…ï¼Œåˆ™è¿”å›-1ã€‚\n\n### replace\n\n`replace`æ–¹æ³•ç”¨äºæ›¿æ¢åŒ¹é…çš„å­å­—ç¬¦ä¸²ï¼Œä¸€èˆ¬æƒ…å†µä¸‹åªæ›¿æ¢ç¬¬ä¸€ä¸ªåŒ¹é…\n\n### split\n\n`split`æ–¹æ³•æŒ‰ç…§ç»™å®šè§„åˆ™åˆ†å‰²å­—ç¬¦ä¸²ï¼Œè¿”å›ä¸€ä¸ªç”±åˆ†å‰²å‡ºæ¥çš„å­å­—ç¬¦ä¸²ç»„æˆçš„æ•°ç»„ã€‚\n\n## Math\n\n### å±æ€§\n\n```js\nMath.Eï¼šå¸¸æ•°eã€‚\nMath.LN2ï¼š2çš„è‡ªç„¶å¯¹æ•°ã€‚\nMath.LN10ï¼š10çš„è‡ªç„¶å¯¹æ•°ã€‚\nMath.LOG2Eï¼šä»¥2ä¸ºåº•çš„eçš„å¯¹æ•°ã€‚\nMath.LOG10Eï¼šä»¥10ä¸ºåº•çš„eçš„å¯¹æ•°ã€‚\nMath.PIï¼šå¸¸æ•°Piã€‚\nMath.SQRT1_2ï¼š0.5çš„å¹³æ–¹æ ¹ã€‚\nMath.SQRT2ï¼š2çš„å¹³æ–¹æ ¹ã€‚\n```\n\n### æ–¹æ³•\n\n```js\nMath.abs()ï¼šç»å¯¹å€¼\nMath.ceil()ï¼šå‘ä¸Šå–æ•´\nMath.floor()ï¼šå‘ä¸‹å–æ•´\nMath.max()ï¼šæœ€å¤§å€¼\nMath.min()ï¼šæœ€å°å€¼\nMath.pow()ï¼šæŒ‡æ•°è¿ç®—\nMath.sqrt()ï¼šå¹³æ–¹æ ¹\nMath.log()ï¼šè‡ªç„¶å¯¹æ•°\nMath.exp()ï¼šeçš„æŒ‡æ•°\nMath.round()ï¼šå››èˆäº”å…¥\nMath.random()ï¼šéšæœºæ•° \n```\n\n#### Math.random\n\nè¿”å›ä»»æ„é•¿åº¦çš„å­—ç¬¦\n\n```js\nfunction random_str(length) {\n  var ALPHABET = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';\n  ALPHABET += 'abcdefghijklmnopqrstuvwxyz';\n  ALPHABET += '0123456789-_';\n  var str = '';\n  for (var i=0; i < length; ++i) {\n    var rand = Math.floor(Math.random() * ALPHABET.length);\n    str += ALPHABET.substring(rand, rand + 1);\n  }\n  return str;\n}\n\nrandom_str(6) // \"NdQKOr\"\n```\n\n### ä¸‰è§’å‡½æ•°çš„æ–¹æ³•\n\n```js\nMath.sin()ï¼šè¿”å›å‚æ•°çš„æ­£å¼¦\nMath.cos()ï¼šè¿”å›å‚æ•°çš„ä½™å¼¦\nMath.tan()ï¼šè¿”å›å‚æ•°çš„æ­£åˆ‡\nMath.asin()ï¼šè¿”å›å‚æ•°çš„åæ­£å¼¦ï¼ˆå¼§åº¦å€¼ï¼‰\nMath.acos()ï¼šè¿”å›å‚æ•°çš„åä½™å¼¦ï¼ˆå¼§åº¦å€¼ï¼‰\nMath.atan()ï¼šè¿”å›å‚æ•°çš„åæ­£åˆ‡ï¼ˆå¼§åº¦å€¼ï¼‰\n```\n\n## Date\n\n### new Date()\n\n`Date`å¯¹è±¡æ¥å—ä»`1970å¹´1æœˆ1æ—¥00:00:00 UTC`å¼€å§‹è®¡ç®—çš„æ¯«ç§’æ•°ä½œä¸ºå‚æ•°ã€‚è¿™æ„å‘³ç€å¦‚æœå°†`Unix`æ—¶é—´æˆ³ï¼ˆå•ä½ä¸ºç§’ï¼‰ä½œä¸ºå‚æ•°ï¼Œå¿…é¡»å°†`Unix`æ—¶é—´æˆ³ä¹˜ä»¥`1000`ã€‚\n\n`Date`å¯¹è±¡è¿˜æ¥å—ä¸€ä¸ªæ—¥æœŸå­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ï¼Œè¿”å›æ‰€å¯¹åº”çš„æ—¶é—´ã€‚\n\næ—¥æœŸå­—ç¬¦ä¸²çš„å®Œæ•´æ ¼å¼æ˜¯`month day, year hours:minutes:seconds`ï¼Œæ¯”å¦‚`December 25, 1995 13:30:00`ã€‚å¦‚æœçœç•¥äº†å°æ—¶ã€åˆ†é’Ÿæˆ–ç§’æ•°ï¼Œè¿™äº›å€¼ä¼šè¢«è®¾ä¸º0ã€‚\n\næ³¨æ„ï¼Œåœ¨ES5ä¹‹ä¸­ï¼Œå¦‚æœæ—¥æœŸé‡‡ç”¨è¿è¯çº¿`-`æ ¼å¼åˆ†éš”ï¼Œä¸”å…·æœ‰å‰å¯¼0ï¼ŒJavaScriptä¼šè®¤ä¸ºè¿™æ˜¯ä¸€ä¸ª`ISO`æ ¼å¼çš„æ—¥æœŸå­—ç¬¦ä¸²ï¼Œå¯¼è‡´è¿”å›çš„æ—¶é—´æ˜¯ä»¥`UTC`æ—¶åŒºè®¡ç®—çš„ã€‚\n\n```js\nnew Date('2014-01-01')\n// Wed Jan 01 2014 08:00:00 GMT+0800 (CST)\n\nnew Date('2014-1-1')\n// Wed Jan 01 2014 00:00:00 GMT+0800 (CST)\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œæ—¥æœŸå­—ç¬¦ä¸²æœ‰æ²¡æœ‰å‰å¯¼0ï¼Œè¿”å›çš„ç»“æœæ˜¯ä¸ä¸€æ ·çš„ã€‚å¦‚æœæ²¡æœ‰å‰å¯¼0ï¼ŒJavaScriptå¼•æ“å‡è®¾ç”¨æˆ·å¤„äºæœ¬åœ°æ—¶åŒºï¼Œæ‰€ä»¥æœ¬ä¾‹è¿”å›0ç‚¹0åˆ†ã€‚å¦‚æœæœ‰å‰å¯¼0ï¼ˆå³å¦‚æœä½ ä»¥`ISO`æ ¼å¼è¡¨ç¤ºæ—¥æœŸï¼‰ï¼Œå°±å‡è®¾ç”¨æˆ·å¤„äºæ ¼æ—å°¼æ²»å›½é™…æ ‡å‡†æ—¶çš„æ—¶åŒºï¼Œæ‰€ä»¥è¿”å›8ç‚¹0åˆ†ã€‚ä½†æ˜¯ï¼ŒES6æ”¹å˜äº†è¿™ç§åšæ³•ï¼Œè§„å®šå‡¡æ˜¯æ²¡æœ‰æŒ‡å®šæ—¶åŒºçš„æ—¥æœŸå­—ç¬¦ä¸²ï¼Œä¸€å¾‹è®¤å®šç”¨æˆ·å¤„äºæœ¬åœ°æ—¶åŒºã€‚\n\næ€»ä¹‹ï¼Œå¯¹äº`YYYY-MM-DD`å½¢å¼çš„å­—ç¬¦ä¸²ï¼ŒJavaScriptå¼•æ“å¯èƒ½ä¼šå°†å…¶å½“ä½œ`ISO`æ ¼å¼æ¥è§£æï¼Œé‡‡ç”¨æ ¼æ—å°¼æ²»æ—¶åŒºä½œä¸ºè®¡æ—¶æ ‡å‡†ï¼›è€Œå¯¹äºå…¶ä»–æ ¼å¼çš„æ—¥æœŸå­—ç¬¦ä¸²ï¼Œä¸€å¾‹è§†ä¸ºéISOæ ¼å¼ï¼Œé‡‡ç”¨æœ¬åœ°æ—¶åŒºä½œä¸ºè®¡æ—¶æ ‡å‡†ã€‚\n\n```js\nnew Date('2014-12-11')\n// Thu Dec 11 2014 08:00:00 GMT+0800 (CST)\n\nnew Date('2014/12/11')\n// Thu Dec 11 2014 00:00:00 GMT+0800 (CST)\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œç¬¬ä¸€ä¸ªæ—¥æœŸå­—ç¬¦ä¸²æ˜¯ISOæ ¼å¼ï¼Œç¬¬äºŒä¸ªä¸æ˜¯ï¼Œå¯¼è‡´ç”Ÿæˆçš„æ—¶é—´ä¸ä¸€æ ·ã€‚\n\n`Date`å¯¹è±¡è¿˜å¯ä»¥æ¥å—å¤šä¸ªæ•´æ•°ä½œä¸ºå‚æ•°ï¼Œä¾æ¬¡è¡¨ç¤ºå¹´ã€æœˆã€æ—¥ã€å°æ—¶ã€åˆ†é’Ÿã€ç§’å’Œæ¯«ç§’ã€‚å¦‚æœé‡‡ç”¨è¿™ç§æ ¼å¼ï¼Œ**æœ€å°‘éœ€è¦æä¾›ä¸¤ä¸ªå‚æ•°ï¼ˆå¹´å’Œæœˆï¼‰**ï¼Œå…¶ä»–å‚æ•°éƒ½æ˜¯å¯é€‰çš„ï¼Œé»˜è®¤ç­‰äº0ã€‚å› ä¸ºå¦‚æœåªä½¿ç”¨ã€Œå¹´ã€è¿™ä¸€ä¸ªå‚æ•°ï¼Œ`Date`å¯¹è±¡ä¼šå°†å…¶è§£é‡Šä¸ºæ¯«ç§’æ•°ã€‚\n\n### æ—¥æœŸçš„è¿ç®—\n\nç±»å‹è½¬æ¢æ—¶ï¼Œ`Date`å¯¹è±¡çš„å®ä¾‹å¦‚æœè½¬ä¸ºæ•°å€¼ï¼Œåˆ™ç­‰äºå¯¹åº”çš„æ¯«ç§’æ•°ï¼›å¦‚æœè½¬ä¸ºå­—ç¬¦ä¸²ï¼Œåˆ™ç­‰äºå¯¹åº”çš„æ—¥æœŸå­—ç¬¦ä¸²ã€‚æ‰€ä»¥ï¼Œä¸¤ä¸ªæ—¥æœŸå¯¹è±¡è¿›è¡Œå‡æ³•è¿ç®—ï¼Œè¿”å›çš„å°±æ˜¯å®ƒä»¬é—´éš”çš„æ¯«ç§’æ•°ï¼›è¿›è¡ŒåŠ æ³•è¿ç®—ï¼Œè¿”å›çš„å°±æ˜¯è¿æ¥åçš„ä¸¤ä¸ªå­—ç¬¦ä¸²ã€‚\n\n### Dateå¯¹è±¡çš„é™æ€æ–¹æ³•                                                                            \n#### Date.now\n\n`Date.now`æ–¹æ³•è¿”å›å½“å‰è·ç¦»1970å¹´1æœˆ1æ—¥ 00:00:00 UTCçš„æ¯«ç§’æ•°ï¼ˆUnixæ—¶é—´æˆ³ä¹˜ä»¥1000ï¼‰ã€‚\n\n```js\nDate.now() // 1364026285194\n```\nå¦‚æœéœ€è¦æ¯”æ¯«ç§’æ›´ç²¾ç¡®çš„æ—¶é—´ï¼Œå¯ä»¥ä½¿ç”¨`window.performance.now()`ã€‚å®ƒæä¾›é¡µé¢åŠ è½½åˆ°å‘½ä»¤è¿è¡Œæ—¶çš„å·²ç»è¿‡å»çš„æ—¶é—´ï¼Œå¯ä»¥ç²¾ç¡®åˆ°åƒåˆ†ä¹‹ä¸€æ¯«ç§’ã€‚\n\n```js\nwindow.performance.now() // 21311140.415\n```\n\n#### Date.parse\n\n`Date.parse`æ–¹æ³•ç”¨æ¥è§£ææ—¥æœŸå­—ç¬¦ä¸²ï¼Œè¿”å›è·ç¦»1970å¹´1æœˆ1æ—¥ 00:00:00çš„æ¯«ç§’æ•°\n\nå¦‚æœè§£æå¤±è´¥ï¼Œè¿”å›`NaN`ã€‚\n\n#### Date.UTC\n\né»˜è®¤æƒ…å†µä¸‹ï¼Œ`Date`å¯¹è±¡è¿”å›çš„éƒ½æ˜¯å½“å‰æ—¶åŒºçš„æ—¶é—´ã€‚`Date.UTC`æ–¹æ³•å¯ä»¥è¿”å›`UTC`æ—¶é—´ï¼ˆä¸–ç•Œæ ‡å‡†æ—¶é—´ï¼‰ã€‚è¯¥æ–¹æ³•æ¥å—å¹´ã€æœˆã€æ—¥ç­‰å˜é‡ä½œä¸ºå‚æ•°ï¼Œè¿”å›å½“å‰è·ç¦»1970å¹´1æœˆ1æ—¥ 00:00:00 UTCçš„æ¯«ç§’æ•°ã€‚\n\n### Dateå®ä¾‹å¯¹è±¡\n\n#### toç±»æ–¹æ³•\n\n```js\nDate.prototype.toString : è¿”å›ä¸€ä¸ªå®Œæ•´çš„æ—¥æœŸå­—ç¬¦ä¸²\nDate.prototype.toUTCString : è¿”å›å¯¹åº”çš„UTCæ—¶é—´ï¼Œä¹Ÿå°±æ˜¯æ¯”åŒ—äº¬æ—¶é—´æ™š8ä¸ªå°æ—¶ã€‚\nDate.prototype.toISOString : æ–¹æ³•è¿”å›å¯¹åº”æ—¶é—´çš„ISO8601å†™æ³•\nDate.prototype.toJSON : ç¬¦åˆJSONæ ¼å¼çš„ISOæ ¼å¼çš„æ—¥æœŸå­—ç¬¦ä¸²ï¼Œä¸toISOStringæ–¹æ³•çš„è¿”å›ç»“æœå®Œå…¨ç›¸åŒã€‚\nDate.prototype.toDateString : æ–¹æ³•è¿”å›æ—¥æœŸå­—ç¬¦ä¸²ã€‚\nDate.prototype.toTimeString : æ–¹æ³•è¿”å›æ—¶é—´å­—ç¬¦ä¸²ã€‚\nDate.prototype.toLocaleDateString : æ–¹æ³•è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä»£è¡¨æ—¥æœŸçš„å½“åœ°å†™æ³•ã€‚\nDate.prototype.toLocaleTimeString : æ–¹æ³•è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä»£è¡¨æ—¶é—´çš„å½“åœ°å†™æ³•ã€‚\n```\n\n#### getç±»æ–¹æ³•\n\n```js\ngetTime()ï¼šè¿”å›è·ç¦»1970å¹´1æœˆ1æ—¥00:00:00çš„æ¯«ç§’æ•°ï¼Œç­‰åŒäºvalueOfæ–¹æ³•ã€‚\ngetDate()ï¼šè¿”å›å®ä¾‹å¯¹è±¡å¯¹åº”æ¯ä¸ªæœˆçš„å‡ å·ï¼ˆä»1å¼€å§‹ï¼‰ã€‚\ngetDay()ï¼šè¿”å›æ˜ŸæœŸå‡ ï¼Œæ˜ŸæœŸæ—¥ä¸º0ï¼Œæ˜ŸæœŸä¸€ä¸º1ï¼Œä»¥æ­¤ç±»æ¨ã€‚\ngetYear()ï¼šè¿”å›è·ç¦»1900çš„å¹´æ•°ã€‚\ngetFullYear()ï¼šè¿”å›å››ä½çš„å¹´ä»½ã€‚\ngetMonth()ï¼šè¿”å›æœˆä»½ï¼ˆ0è¡¨ç¤º1æœˆï¼Œ11è¡¨ç¤º12æœˆï¼‰ã€‚\ngetHours()ï¼šè¿”å›å°æ—¶ï¼ˆ0-23ï¼‰ã€‚\ngetMilliseconds()ï¼šè¿”å›æ¯«ç§’ï¼ˆ0-999ï¼‰ã€‚\ngetMinutes()ï¼šè¿”å›åˆ†é’Ÿï¼ˆ0-59ï¼‰ã€‚\ngetSeconds()ï¼šè¿”å›ç§’ï¼ˆ0-59ï¼‰ã€‚\ngetTimezoneOffset()ï¼šè¿”å›å½“å‰æ—¶é—´ä¸UTCçš„æ—¶åŒºå·®å¼‚ï¼Œä»¥åˆ†é’Ÿè¡¨ç¤ºï¼Œè¿”å›ç»“æœè€ƒè™‘åˆ°äº†å¤ä»¤æ—¶å› ç´ ã€‚\n```\n\nè¿”å›å¯¹åº”çš„UTCæ—¶é—´\n\n```js\ngetUTCDate()\ngetUTCFullYear()\ngetUTCMonth()\ngetUTCDay()\ngetUTCHours()\ngetUTCMinutes()\ngetUTCSeconds()\ngetUTCMilliseconds()\n```\n\n#### setç±»\n\n```js\nsetDate(date)ï¼šè®¾ç½®å®ä¾‹å¯¹è±¡å¯¹åº”çš„æ¯ä¸ªæœˆçš„å‡ å·ï¼ˆ1-31ï¼‰ï¼Œè¿”å›æ”¹å˜åæ¯«ç§’æ—¶é—´æˆ³ã€‚\nsetYear(year): è®¾ç½®è·ç¦»1900å¹´çš„å¹´æ•°ã€‚\nsetFullYear(year [, month, date])ï¼šè®¾ç½®å››ä½å¹´ä»½ã€‚\nsetHours(hour [, min, sec, ms])ï¼šè®¾ç½®å°æ—¶ï¼ˆ0-23ï¼‰ã€‚\nsetMilliseconds()ï¼šè®¾ç½®æ¯«ç§’ï¼ˆ0-999ï¼‰ã€‚\nsetMinutes(min [, sec, ms])ï¼šè®¾ç½®åˆ†é’Ÿï¼ˆ0-59ï¼‰ã€‚\nsetMonth(month [, date])ï¼šè®¾ç½®æœˆä»½ï¼ˆ0-11ï¼‰ã€‚\nsetSeconds(sec [, ms])ï¼šè®¾ç½®ç§’ï¼ˆ0-59ï¼‰ã€‚\nsetTime(milliseconds)ï¼šè®¾ç½®æ¯«ç§’æ—¶é—´æˆ³ã€‚\n```\n\nå¯¹åº”çš„UTCæ–¹æ³•\n\n```js\nsetUTCDate()\nsetUTCFullYear()\nsetUTCHours()\nsetUTCMilliseconds()\nsetUTCMinutes()\nsetUTCMonth()\nsetUTCSeconds()\n```\n\n### valueOf\n\n`valueOf`æ–¹æ³•è¿”å›å®ä¾‹å¯¹è±¡è·ç¦»1970å¹´1æœˆ1æ—¥00:00:00 UTCå¯¹åº”çš„æ¯«ç§’æ•°ï¼Œè¯¥æ–¹æ³•ç­‰åŒäº`getTime`æ–¹æ³•ã€‚\n\n## RegExpå¯¹è±¡\n\næ­£åˆ™è¡¨è¾¾å¼ï¼ˆregular expressionï¼‰æ˜¯ä¸€ç§è¡¨è¾¾æ–‡æœ¬æ¨¡å¼ï¼ˆå³å­—ç¬¦ä¸²ç»“æ„ï¼‰çš„æ–¹æ³•ï¼Œæœ‰ç‚¹åƒå­—ç¬¦ä¸²çš„æ¨¡æ¿ï¼Œå¸¸å¸¸ç”¨ä½œæŒ‰ç…§â€œç»™å®šæ¨¡å¼â€åŒ¹é…æ–‡æœ¬çš„å·¥å…·ã€‚æ¯”å¦‚ï¼Œæ­£åˆ™è¡¨è¾¾å¼ç»™å‡ºä¸€ä¸ª Email åœ°å€çš„æ¨¡å¼ï¼Œç„¶åç”¨å®ƒæ¥ç¡®å®šä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯å¦ä¸º Email åœ°å€ã€‚JavaScript çš„æ­£åˆ™è¡¨è¾¾å¼ä½“ç³»æ˜¯å‚ç…§ Perl 5 å»ºç«‹çš„ã€‚\n\n## JSONå¯¹è±¡\n\nä¸¥æ ¼è§„å®š\n\nå¤åˆç±»å‹çš„å€¼åªèƒ½æ˜¯æ•°ç»„æˆ–å¯¹è±¡ï¼Œä¸èƒ½æ˜¯å‡½æ•°ã€æ­£åˆ™è¡¨è¾¾å¼å¯¹è±¡ã€æ—¥æœŸå¯¹è±¡ã€‚\n\nç®€å•ç±»å‹çš„å€¼åªæœ‰å››ç§ï¼šå­—ç¬¦ä¸²ã€æ•°å€¼ï¼ˆå¿…é¡»ä»¥åè¿›åˆ¶è¡¨ç¤ºï¼‰ã€å¸ƒå°”å€¼å’Œ`null`ï¼ˆä¸èƒ½ä½¿ç”¨`NaN`,`Infinity`, `-Infinity`å’Œ`undefined`ï¼‰ã€‚\n\nå­—ç¬¦ä¸²å¿…é¡»ä½¿ç”¨åŒå¼•å·è¡¨ç¤ºï¼Œä¸èƒ½ä½¿ç”¨å•å¼•å·ã€‚\n\nå¯¹è±¡çš„é”®åå¿…é¡»æ”¾åœ¨åŒå¼•å·é‡Œé¢ã€‚\n\næ•°ç»„æˆ–å¯¹è±¡æœ€åä¸€ä¸ªæˆå‘˜çš„åé¢ï¼Œä¸èƒ½åŠ é€—å·ã€‚\n\n### JSON.stringify\n\n`JSON.stringify`æ–¹æ³•ç”¨äºå°†ä¸€ä¸ªå€¼è½¬ä¸ºå­—ç¬¦ä¸²ã€‚è¯¥å­—ç¬¦ä¸²ç¬¦åˆ`JSON`æ ¼å¼ï¼Œå¹¶ä¸”å¯ä»¥è¢«`JSON.parse`æ–¹æ³•è¿˜åŸã€‚\n\n```js\nvar arr = [undefined, function () {}];\nJSON.stringify(arr) // \"[null,null]\"\n```\n\nå¦‚æœæ•°ç»„çš„æˆå‘˜æ˜¯`undefined`ã€å‡½æ•°æˆ– XML å¯¹è±¡ï¼Œåˆ™è¿™äº›å€¼è¢«è½¬æˆ`null`\n\n```js\nJSON.stringify(/foo/) // \"{}\"\n```\n\næ­£åˆ™å¯¹è±¡ä¼šè¢«è½¬æˆç©ºå¯¹è±¡ã€‚\n\n`JSON.stringify`æ–¹æ³•ä¼šå¿½ç•¥å¯¹è±¡çš„ä¸å¯éå†å±æ€§ã€‚\n\n`JSON.stringify`æ–¹æ³•è¿˜å¯ä»¥æ¥å—ä¸€ä¸ªæ•°ç»„ï¼Œä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ï¼ŒæŒ‡å®šéœ€è¦è½¬æˆå­—ç¬¦ä¸²çš„å±æ€§\n\n```js\nvar obj = {\n  'prop1': 'value1',\n  'prop2': 'value2',\n  'prop3': 'value3'\n};\n\nvar selectedProperties = ['prop1', 'prop2'];\n\nJSON.stringify(obj, selectedProperties)\n// \"{\"prop1\":\"value1\",\"prop2\":\"value2\"}\"\n```\n\nè¿™ä¸ªç±»ä¼¼ã€Œç™½åå•ã€çš„æ•°ç»„ï¼Œåªå¯¹å¯¹è±¡çš„å±æ€§æœ‰æ•ˆï¼Œå¯¹æ•°ç»„æ— æ•ˆã€‚\n\nç¬¬äºŒä¸ªå‚æ•°è¿˜å¯ä»¥æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œç”¨æ¥æ›´æ”¹JSON.stringifyçš„é»˜è®¤è¡Œä¸ºã€‚\n\n```js\nfunction f(key, value) {\n  if (typeof value === \"number\") {\n    value = 2 * value;\n  }\n  return value;\n}\n\nJSON.stringify({ a: 1, b: 2 }, f)\n// '{\"a\": 2,\"b\": 4}'\n```\n\n`JSON.stringify`è¿˜å¯ä»¥æ¥å—ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œç”¨äºå¢åŠ è¿”å›çš„JSONå­—ç¬¦ä¸²çš„å¯è¯»æ€§ã€‚å¦‚æœæ˜¯æ•°å­—ï¼Œè¡¨ç¤ºæ¯ä¸ªå±æ€§å‰é¢æ·»åŠ çš„ç©ºæ ¼ï¼ˆæœ€å¤šä¸è¶…è¿‡10ä¸ªï¼‰ï¼›å¦‚æœæ˜¯å­—ç¬¦ä¸²ï¼ˆä¸è¶…è¿‡10ä¸ªå­—ç¬¦ï¼‰ï¼Œåˆ™è¯¥å­—ç¬¦ä¸²ä¼šæ·»åŠ åœ¨æ¯è¡Œå‰é¢ã€‚\n\n### toJSON\n\nå¦‚æœå¯¹è±¡æœ‰è‡ªå®šä¹‰çš„`toJSON`æ–¹æ³•ï¼Œé‚£ä¹ˆ`JSON.stringify`ä¼šä½¿ç”¨è¿™ä¸ªæ–¹æ³•çš„è¿”å›å€¼ä½œä¸ºå‚æ•°ï¼Œè€Œå¿½ç•¥åŸå¯¹è±¡çš„å…¶ä»–å±æ€§ã€‚\n\n```js\nvar user = {\n  firstName: 'ä¸‰',\n  lastName: 'å¼ ',\n  fullName: 'å¼ ä¸‰',\t\n\n  toJSON: function () {\n    var data = {\n      firstName: this.firstName,\n      lastName: this.lastName\n    };\n    return data;\n  }\n};\n\nJSON.stringify(user)\n// \"{\"firstName\":\"ä¸‰\",\"lastName\":\"å¼ \"}\"\n```\n\nå¯ä»¥ç»™æ­£åˆ™å®šä¹‰``toJSON``æ–¹æ³•ï¼Œå°±å¯ä»¥ç”¨æ¥è½¬æ¢æ­£åˆ™äº†\n\n```js\nvar obj = {\n  reg: /foo/\n};\n\n// ä¸è®¾ç½® toJSON æ–¹æ³•æ—¶\nJSON.stringify(obj) // \"{\"reg\":{}}\"\n\n// è®¾ç½® toJSON æ–¹æ³•æ—¶\nRegExp.prototype.toJSON = RegExp.prototype.toString;\nJSON.stringify(/foo/) // \"\"/foo/\"\"\n```\n\n### JSON.parse\n\n`JSON.parse`æ–¹æ³•ç”¨äºå°†JSONå­—ç¬¦ä¸²è½¬åŒ–æˆå¯¹è±¡ã€‚\n\nå¦‚æœä¼ å…¥çš„å­—ç¬¦ä¸²ä¸æ˜¯æœ‰æ•ˆçš„JSONæ ¼å¼ï¼Œ`JSON.parse`æ–¹æ³•å°†æŠ¥é”™ã€‚\n\n## consoleå¯¹è±¡\n\n### æµè§ˆå™¨å®ç°\n\næ‰“å¼€å¼€å‘è€…å·¥å…·\n\n```\nElementsï¼šæŸ¥çœ‹ç½‘é¡µçš„HTMLæºç å’ŒCSSä»£ç ã€‚\nResourcesï¼šæŸ¥çœ‹ç½‘é¡µåŠ è½½çš„å„ç§èµ„æºæ–‡ä»¶ï¼ˆæ¯”å¦‚ä»£ç æ–‡ä»¶ã€å­—ä½“æ–‡ä»¶ã€cssæ–‡ä»¶ç­‰ï¼‰ï¼Œä»¥åŠåœ¨ç¡¬ç›˜ä¸Šåˆ›å»ºçš„å„ç§å†…å®¹ï¼ˆæ¯”å¦‚æœ¬åœ°ç¼“å­˜ã€Cookieã€Local Storageç­‰ï¼‰ã€‚\nNetworkï¼šæŸ¥çœ‹ç½‘é¡µçš„ HTTP é€šä¿¡æƒ…å†µã€‚\nSourcesï¼šæŸ¥çœ‹ç½‘é¡µåŠ è½½çš„æ‰€æœ‰æºç ã€‚\nTimelineï¼šæŸ¥çœ‹å„ç§ç½‘é¡µè¡Œä¸ºéšæ—¶é—´å˜åŒ–çš„æƒ…å†µã€‚\nPerformanceï¼šæŸ¥çœ‹ç½‘é¡µçš„æ€§èƒ½æƒ…å†µï¼Œæ¯”å¦‚ CPU å’Œå†…å­˜æ¶ˆè€—ã€‚\nConsoleï¼šç”¨æ¥è¿è¡Œ JavaScript å‘½ä»¤ã€‚\n```\n\n### console.log()ï¼Œconsole.debug()ï¼Œconsole.info()\n\n`console.info()`å’Œ`console.debug()`éƒ½æ˜¯`console.log`æ–¹æ³•çš„åˆ«åï¼Œç”¨æ³•å®Œå…¨ä¸€æ ·ã€‚åªä¸è¿‡`console.info`æ–¹æ³•ä¼šåœ¨è¾“å‡ºä¿¡æ¯çš„å‰é¢ï¼ŒåŠ ä¸Šä¸€ä¸ªè“è‰²å›¾æ ‡ã€‚\n\nè‡ªå®šä¹‰`console`æ–¹æ³•\n\n```js\n['log', 'info', 'warn', 'error'].forEach(function(method) {\n  console[method] = console[method].bind(\n    console,\n    new Date().toISOString()\n  );\n});\n\nconsole.log(\"å‡ºé”™äº†ï¼\");\n// 2014-05-18T09:00.000Z å‡ºé”™äº†ï¼\n```\n\n### console.warn(),console.error()\n\n`warn`æ–¹æ³•å’Œ`error`æ–¹æ³•ä¹Ÿæ˜¯åœ¨æ§åˆ¶å°è¾“å‡ºä¿¡æ¯ï¼Œå®ƒä»¬ä¸`log`æ–¹æ³•çš„ä¸åŒä¹‹å¤„åœ¨äºï¼Œ`warn`æ–¹æ³•è¾“å‡ºä¿¡æ¯æ—¶ï¼Œåœ¨æœ€å‰é¢åŠ ä¸€ä¸ªé»„è‰²ä¸‰è§’ï¼Œè¡¨ç¤ºè­¦å‘Šï¼›`error`æ–¹æ³•è¾“å‡ºä¿¡æ¯æ—¶ï¼Œåœ¨æœ€å‰é¢åŠ ä¸€ä¸ªçº¢è‰²çš„å‰ï¼Œè¡¨ç¤ºå‡ºé”™ï¼ŒåŒæ—¶ä¼šæ˜¾ç¤ºé”™è¯¯å‘ç”Ÿçš„å †æ ˆã€‚å…¶ä»–æ–¹é¢éƒ½ä¸€æ ·ã€‚\n\n### console.table()\n\nå¯¹äºæŸäº›å¤åˆç±»å‹çš„æ•°æ®ï¼Œ`console.table`æ–¹æ³•å¯ä»¥å°†å…¶è½¬ä¸ºè¡¨æ ¼æ˜¾ç¤ºã€‚\n\n### console.count()\n\n`count`æ–¹æ³•ç”¨äºè®¡æ•°ï¼Œè¾“å‡ºå®ƒè¢«è°ƒç”¨äº†å¤šå°‘æ¬¡ã€‚\n\nè¯¥æ–¹æ³•å¯ä»¥æ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ï¼Œä½œä¸ºæ ‡ç­¾ï¼Œå¯¹æ‰§è¡Œæ¬¡æ•°è¿›è¡Œåˆ†ç±»ã€‚\n\n```js\nfunction greet(user) {\n  console.count(user);\n  return \"hi \" + user;\n}\n\ngreet('bob')\n// bob: 1\n// \"hi bob\"\n\ngreet('alice')\n// alice: 1\n// \"hi alice\"\n\ngreet('bob')\n// bob: 2\n// \"hi bob\"\n```\n\n### console.dir()ï¼Œconsole.dirxml()\n\n`dir`æ–¹æ³•ç”¨æ¥å¯¹ä¸€ä¸ªå¯¹è±¡è¿›è¡Œæ£€æŸ¥ï¼ˆinspectï¼‰ï¼Œå¹¶ä»¥æ˜“äºé˜…è¯»å’Œæ‰“å°çš„æ ¼å¼æ˜¾ç¤ºã€‚\n\n`dirxml`æ–¹æ³•ä¸»è¦ç”¨äºä»¥ç›®å½•æ ‘çš„å½¢å¼ï¼Œæ˜¾ç¤º DOM èŠ‚ç‚¹ã€‚\n\n### console.assert()\n\n`assert`æ–¹æ³•ä¸»è¦ç”¨äºç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ï¼Œè¿›è¡Œæ¡ä»¶åˆ¤æ–­ï¼Œå¦‚æœä¸æ»¡è¶³æ¡ä»¶ï¼Œå°±æ˜¾ç¤ºä¸€ä¸ªé”™è¯¯ï¼Œä½†ä¸ä¼šä¸­æ–­ç¨‹åºæ‰§è¡Œã€‚è¿™æ ·å°±ç›¸å½“äºæç¤ºç”¨æˆ·ï¼Œå†…éƒ¨çŠ¶æ€ä¸æ­£ç¡®ã€‚\n\n```js\nconsole.assert(false, 'åˆ¤æ–­æ¡ä»¶ä¸æˆç«‹')\n// Assertion failed: åˆ¤æ–­æ¡ä»¶ä¸æˆç«‹\n\n// ç›¸å½“äº\ntry {\n  if (false) {\n    throw new Error('åˆ¤æ–­æ¡ä»¶ä¸æˆç«‹');\n  }\n} catch(e) {\n  console.error(e);\n}\n```\n\n### console.time()ï¼Œconsole.timeEnd()\n\n```js\nconsole.time('Array initialize');\n\nvar array= new Array(1000000);\nfor (var i = array.length - 1; i >= 0; i--) {\n    array[i] = new Object();\n};\n\nconsole.timeEnd('Array initialize');\n// Array initialize: 1914.481ms\n```\n\n### console.profile()ï¼Œconsole.profileEnd()\n\n`console.profile`æ–¹æ³•ç”¨æ¥æ–°å»ºä¸€ä¸ªæ€§èƒ½æµ‹è¯•å™¨ï¼ˆprofileï¼‰ï¼Œå®ƒçš„å‚æ•°æ˜¯æ€§èƒ½æµ‹è¯•å™¨çš„åå­—ã€‚\n\n`console.profileEnd`æ–¹æ³•ç”¨æ¥ç»“æŸæ­£åœ¨è¿è¡Œçš„æ€§èƒ½æµ‹è¯•å™¨ã€‚\n\n```js\nconsole.profile('p')\n// Profile 'p' started.\n\nconsole.profileEnd()\n// Profile 'p' finished.\n```\n\næ‰“å¼€æµè§ˆå™¨çš„å¼€å‘è€…å·¥å…·ï¼Œåœ¨`profile`é¢æ¿ä¸­ï¼Œå¯ä»¥çœ‹åˆ°è¿™ä¸ªæ€§èƒ½è°ƒè¯•å™¨çš„è¿è¡Œç»“æœã€‚\n\n### console.group()ï¼Œconsole.groupend()ï¼Œconsole.groupCollapsed()\n\n`console.group`å’Œ`console.groupend`è¿™ä¸¤ä¸ªæ–¹æ³•ç”¨äºå°†æ˜¾ç¤ºçš„ä¿¡æ¯åˆ†ç»„ã€‚å®ƒåªåœ¨è¾“å‡ºå¤§é‡ä¿¡æ¯æ—¶æœ‰ç”¨ï¼Œåˆ†åœ¨ä¸€ç»„çš„ä¿¡æ¯ï¼Œå¯ä»¥ç”¨é¼ æ ‡æŠ˜å /å±•å¼€ã€‚\n\n`console.groupCollapsed`æ–¹æ³•ä¸`console.group`æ–¹æ³•å¾ˆç±»ä¼¼ï¼Œå”¯ä¸€çš„åŒºåˆ«æ˜¯è¯¥ç»„çš„å†…å®¹ï¼Œåœ¨ç¬¬ä¸€æ¬¡æ˜¾ç¤ºæ—¶æ˜¯æ”¶èµ·çš„ï¼ˆcollapsedï¼‰ï¼Œè€Œä¸æ˜¯å±•å¼€çš„ã€‚\n\n### console.trace()ï¼Œconsole.clear()\n\n`console.trace`æ–¹æ³•æ˜¾ç¤ºå½“å‰æ‰§è¡Œçš„ä»£ç åœ¨å †æ ˆä¸­çš„è°ƒç”¨è·¯å¾„ã€‚\n\n`console.clear`æ–¹æ³•ç”¨äºæ¸…é™¤å½“å‰æ§åˆ¶å°çš„æ‰€æœ‰è¾“å‡ºï¼Œå°†å…‰æ ‡å›ç½®åˆ°ç¬¬ä¸€è¡Œã€‚å¦‚æœç”¨æˆ·é€‰ä¸­äº†æ§åˆ¶å°çš„`Preserve log`é€‰é¡¹ï¼Œç½‘é¡µè„šæœ¬è°ƒç”¨`console.log`å°†ä¸èµ·ä½œç”¨ï¼Œä½†æ‰‹åŠ¨åœ¨æ§åˆ¶å°æ‰§è¡Œè¯¥æ–¹æ³•ä¾ç„¶æœ‰æ•ˆ\n\n### å‘½ä»¤è¡ŒAPI\n\nå…·ä½“è¯¦ç»†å†…å®¹ http://javascript.ruanyifeng.com/stdlib/console.html\n\n## å±æ€§æè¿°å¯¹è±¡\n\n### Object.defineProperty()ï¼ŒObject.defineProperties()\n\n`Object.defineProperty`æ–¹æ³•å’Œåé¢çš„`Object.defineProperties`æ–¹æ³•ï¼Œéƒ½æœ‰æ€§èƒ½æŸè€—ï¼Œä¼šæ‹–æ…¢æ‰§è¡Œé€Ÿåº¦ï¼Œä¸å®œå¤§é‡ä½¿ç”¨ã€‚\n\nè¿™æ—¶éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸€æ—¦å®šä¹‰äº†å–å€¼å‡½æ•°`get`ï¼ˆæˆ–å­˜å€¼å‡½æ•°`set`ï¼‰ï¼Œå°±ä¸èƒ½å°†`writable`è®¾ä¸º`true`ï¼Œæˆ–è€…åŒæ—¶å®šä¹‰`value`å±æ€§ï¼Œä¼šæŠ¥é”™ã€‚\n\n```js\nvar o = {};\n\nObject.defineProperty(o, 'p', {\n  value: 123,\n  get: function() { return 456; }\n});\n// TypeError: Invalid property.\n// A property cannot both have accessors and be writable or have a value,\n```\n\nä¸Šé¢ä»£ç åŒæ—¶å®šä¹‰äº†`get`å±æ€§å’Œ`value`å±æ€§ï¼Œç»“æœå°±æŠ¥é”™ã€‚\n","tags":["ES5"],"categories":["Note"]},{"title":"LeanJsã€Œ ES5 ã€-- è¯­æ³•","url":"%2F2018%2F01%2F23%2FLeanJS%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95%2F","content":"![Js](LeanJSåŸºç¡€è¯­æ³•/js.png)\n\n<!--more-->\n\n## åŸºæœ¬è¯­æ³•\n\n### è¯­å¥\n\nJavaScript ç¨‹åºçš„æ‰§è¡Œå•ä½ä¸ºè¡Œã€Œ line ã€ï¼Œä¹Ÿå°±æ˜¯**ä¸€è¡Œä¸€è¡Œ**ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ¯ä¸€è¡Œå°±æ˜¯ä¸€ä¸ªè¯­å¥ã€‚\n\n\n```js\nvar a = 1 + 3\n```\n\nè¿™æ¡è¯­å¥å…ˆç”¨ `var` å‘½ä»¤ï¼Œå£°æ˜äº†å˜é‡ `a`ï¼Œç„¶åå°† `1 + 3` çš„è¿ç®—ç»“æœèµ‹å€¼ç»™å˜é‡ `a`ã€‚\n\n`1 + 3` å«åšè¡¨è¾¾å¼ï¼ˆexpressionï¼‰ï¼ŒæŒ‡ä¸€ä¸ªä¸ºäº†å¾—åˆ°è¿”å›å€¼çš„è®¡ç®—å¼ã€‚è¯­å¥å’Œè¡¨è¾¾å¼çš„åŒºåˆ«åœ¨äºï¼Œå‰è€…ä¸»è¦ä¸ºäº†è¿›è¡ŒæŸç§æ“ä½œï¼Œä¸€èˆ¬æƒ…å†µä¸‹ä¸éœ€è¦è¿”å›å€¼ï¼›åè€…åˆ™æ˜¯ä¸ºäº†å¾—åˆ°è¿”å›å€¼ï¼Œä¸€å®šä¼šè¿”å›ä¸€ä¸ªå€¼ã€‚å‡¡æ˜¯ JavaScript è¯­è¨€ä¸­é¢„æœŸä¸ºå€¼çš„åœ°æ–¹ï¼Œéƒ½å¯ä»¥ä½¿ç”¨è¡¨è¾¾å¼ã€‚æ¯”å¦‚ï¼Œèµ‹å€¼è¯­å¥çš„ç­‰å·å³è¾¹ï¼Œé¢„æœŸæ˜¯ä¸€ä¸ªå€¼ï¼Œå› æ­¤å¯ä»¥æ”¾ç½®å„ç§è¡¨è¾¾å¼ã€‚\n\n### å˜é‡\n\nåœ¨ JS ä¸­, **å˜é‡çš„å£°æ˜ä¸èµ‹å€¼æ˜¯åˆ†å¼€çš„ä¸¤ä¸ªæ­¥éª¤**\n\nJavaScript å¼•æ“çš„å·¥ä½œæ–¹å¼æ˜¯ï¼Œå…ˆè§£æä»£ç ï¼Œè·å–æ‰€æœ‰è¢«å£°æ˜çš„å˜é‡ï¼Œç„¶åå†ä¸€è¡Œä¸€è¡Œåœ°è¿è¡Œã€‚è¿™é€ æˆçš„ç»“æœï¼Œå°±æ˜¯æ‰€æœ‰çš„å˜é‡çš„å£°æ˜è¯­å¥ï¼Œéƒ½ä¼šè¢«æå‡åˆ°ä»£ç çš„å¤´éƒ¨ï¼Œè¿™å°±å«åšå˜é‡æå‡ã€Œ hoisting ã€ã€‚\n\n```JS\nvar a = 1\n```\n\nä¸Šé¢çš„ä»£ç å®é™…ä¸Šæ˜¯\n\n```js\nvar a\na = 1\n```\n\nè¿™é‡Œå¼ºè°ƒä¸€ç‚¹\n\n```js\nvar a = 1\nvar a\nconsole.log(a)//1\n```\n\nå¦‚æœç”¨ `var` å£°æ˜ä¸€ä¸ªå·²ç»å­˜åœ¨çš„å˜é‡ï¼Œæ˜¯æ— æ•ˆçš„ã€‚ä½†æ˜¯ä¸€æ—¦è¿›è¡Œäº†**èµ‹å€¼**æ“ä½œï¼Œåˆ™ä¼šè¦†ç›–æ‰å…ˆå‰çš„å€¼\n\n### åŒºå—\n\nJavaScript ä½¿ç”¨å¤§æ‹¬å·ï¼Œå°†å¤šä¸ªç›¸å…³çš„è¯­å¥ç»„åˆåœ¨ä¸€èµ·ï¼Œç§°ä¸º ã€Œ åŒºå— ã€ï¼ˆblockï¼‰\n\n```js\n{\n  var a = 1\n}\nconsole.log(a)//1\n```\n\nåŒºå—å¯¹äº `var` å‘½ä»¤ä¸æ„æˆå•ç‹¬çš„ä½œç”¨åŸŸï¼Œä¸ä¸ä½¿ç”¨åŒºå—æ²¡æœ‰ä»»ä½•åŒºåˆ«ã€‚å¸¸è§çš„åŒºå—`for`,`if`,`while`,`function`ç­‰\n\n`function` ä¸­çš„åŒºå—æ˜¯å‡½æ•°ä½œç”¨åŸŸ\n\n### æ ‡ç­¾\n\nJavaScript è¯­è¨€å…è®¸ï¼Œè¯­å¥çš„å‰é¢æœ‰æ ‡ç­¾ï¼ˆlabelï¼‰ï¼Œç›¸å½“äºå®šä½ç¬¦ï¼Œç”¨äºè·³è½¬åˆ°ç¨‹åºçš„ä»»æ„ä½ç½®,é€šå¸¸ä¸ `continue` å’Œ `break` æ­é…\n\n```js\ntop:\n  for(var i=0; i<3; i++){\n    if(i==1) continue top\n    console.log(i)\n  }\n//0\n//2\n```\n\n## æ•°æ®ç±»å‹\n\n### æ¦‚å¿µ\n\nES5ä¸­æœ‰å…­ç§æ•°æ®ç±»å‹:æ•°å€¼(number),å­—ç¬¦ä¸²(string),å¸ƒå°”å€¼(boolean),undefined,null,å¯¹è±¡(object)\n\næ•°å€¼ã€å­—ç¬¦ä¸²ã€å¸ƒå°”å€¼è¿™ä¸‰ç§ç±»å‹ï¼Œåˆç§°ä¸ºåŸå§‹ç±»å‹ï¼ˆprimitive typeï¼‰çš„å€¼ï¼Œå³å®ƒä»¬æ˜¯æœ€åŸºæœ¬çš„æ•°æ®ç±»å‹ï¼Œä¸èƒ½å†ç»†åˆ†äº†ã€‚å¯¹è±¡åˆ™ç§°ä¸ºåˆæˆç±»å‹ï¼ˆcomplex typeï¼‰çš„å€¼ï¼Œå› ä¸ºä¸€ä¸ªå¯¹è±¡å¾€å¾€æ˜¯å¤šä¸ªåŸå§‹ç±»å‹çš„å€¼çš„åˆæˆï¼Œå¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªå­˜æ”¾å„ç§å€¼çš„å®¹å™¨ã€‚è‡³äº `undefined` å’Œ `null` ï¼Œä¸€èˆ¬å°†å®ƒä»¬çœ‹æˆä¸¤ä¸ªç‰¹æ®Šå€¼ã€‚\n\nå¯¹è±¡æ˜¯æœ€å¤æ‚çš„æ•°æ®ç±»å‹ï¼Œåˆå¯ä»¥åˆ†æˆä¸‰ä¸ªå­ç±»å‹ã€‚\n\nç‹­ä¹‰çš„å¯¹è±¡(object),æ•°ç»„(array),å‡½æ•°(function)\n\n### null å’Œ undefined\n\nä¸¤è€…è¿˜æ˜¯æœ‰ä¸€äº›ç»†å¾®çš„å·®åˆ«\n\n**nullè¡¨ç¤º\"æ²¡æœ‰å¯¹è±¡\"ï¼Œå³è¯¥å¤„ä¸åº”è¯¥æœ‰å€¼** è½¬ä¸ºæ•°å€¼æ—¶ä¸º 0\n\n```\n1.ä½œä¸ºå‡½æ•°çš„å‚æ•°ï¼Œè¡¨ç¤ºä¸ºç©º\n2.ä½œä¸ºå¯¹è±¡åŸå‹é“¾çš„ç»ˆç‚¹\n3.ä¸ºå¯¹è±¡å’Œå€¼èµ‹å€¼ä¸ºç©º\n```\n\n**undefinedè¡¨ç¤º\"ç¼ºå°‘å€¼\"ï¼Œå°±æ˜¯æ­¤å¤„åº”è¯¥æœ‰ä¸€ä¸ªå€¼ï¼Œä½†æ˜¯è¿˜æ²¡æœ‰å®šä¹‰** è½¬ä¸ºæ•°å€¼æ—¶ä¸º ``NaN``\n\n```\n1.å˜é‡è¢«å£°æ˜äº†ï¼Œä½†æ²¡æœ‰èµ‹å€¼æ—¶ï¼Œå°±ç­‰äº undefinedã€‚\n2.è°ƒç”¨å‡½æ•°æ—¶ï¼Œåº”è¯¥æä¾›çš„å‚æ•°æ²¡æœ‰æä¾›ï¼Œè¯¥å‚æ•°ç­‰äº undefinedã€‚\n3.å¯¹è±¡æ²¡æœ‰èµ‹å€¼çš„å±æ€§ï¼Œè¯¥å±æ€§çš„å€¼ä¸º undefinedã€‚\n4.å‡½æ•°æ²¡æœ‰è¿”å›å€¼æ—¶ï¼Œé»˜è®¤è¿”å› undefinedã€‚\n```\n\n### å¸ƒå°”å€¼\n\nå¦‚æœ JavaScript é¢„æœŸæŸä¸ªä½ç½®åº”è¯¥æ˜¯å¸ƒå°”å€¼ï¼Œä¼šå°†è¯¥ä½ç½®ä¸Šç°æœ‰çš„å€¼è‡ªåŠ¨è½¬ä¸ºå¸ƒå°”å€¼ã€‚è½¬æ¢è§„åˆ™æ˜¯é™¤äº†ä¸‹é¢å…­ä¸ªå€¼è¢«è½¬ä¸º `false`ï¼Œå…¶ä»–å€¼éƒ½è§†ä¸º `true`ã€‚\n\n```js\nundefined\nnull\n0\n'' æˆ– \"\"\nNaN\nfalse\n```\n\n:heavy_exclamation_mark:æ³¨æ„\n\nç©ºå¯¹è±¡å’Œç©ºæ•°ç»„ä¹Ÿæ˜¯ ``true``\n\n## æ•°å€¼\n\n### æ•´æ•°ä¸æµ®ç‚¹æ•°\n\nJavaScript å†…éƒ¨ï¼Œæ‰€æœ‰æ•°å­—éƒ½æ˜¯ä»¥ 64 ä½æµ®ç‚¹æ•°å½¢å¼å‚¨å­˜ï¼Œå³ä½¿æ•´æ•°ä¹Ÿæ˜¯å¦‚æ­¤ã€‚æ‰€ä»¥ï¼Œ1 ä¸ 1.0 æ˜¯ç›¸åŒçš„ï¼Œæ˜¯åŒä¸€ä¸ªæ•°ã€‚\n\n```js\n1 === 1.0 // true\n```\n\nè¿™å°±æ˜¯è¯´ï¼ŒJavaScript è¯­è¨€çš„åº•å±‚æ ¹æœ¬æ²¡æœ‰æ•´æ•°ï¼Œæ‰€æœ‰æ•°å­—éƒ½æ˜¯å°æ•°ï¼ˆ64ä½æµ®ç‚¹æ•°ï¼‰ã€‚å®¹æ˜“é€ æˆæ··æ·†çš„æ˜¯ï¼ŒæŸäº›è¿ç®—åªæœ‰æ•´æ•°æ‰èƒ½å®Œæˆï¼Œæ­¤æ—¶ JavaScript ä¼šè‡ªåŠ¨æŠŠ 64 ä½æµ®ç‚¹æ•°ï¼Œè½¬æˆ 32 ä½æ•´æ•°ï¼Œç„¶åå†è¿›è¡Œè¿ç®—\n\n```js\n0.3 / 0.1 //2.9999999999999996\n0.1 + 0.2 === 0.3 //false\n```\n#### æ•°å€¼ç²¾åº¦\n\nç²¾åº¦æœ€å¤šåªèƒ½åˆ° 53 ä¸ªäºŒè¿›åˆ¶ä½ï¼Œè¿™æ„å‘³ç€ï¼Œç»å¯¹å€¼å°äºç­‰äº 2 çš„ 53 æ¬¡æ–¹çš„æ•´æ•°ï¼Œå³ -2^53 åˆ° 2^53\n\n#### æ•°å€¼èŒƒå›´\n\næ ¹æ®æ ‡å‡†ï¼Œ64 ä½æµ®ç‚¹æ•°çš„æŒ‡æ•°éƒ¨åˆ†çš„é•¿åº¦æ˜¯ 11 ä¸ªäºŒè¿›åˆ¶ä½ï¼Œæ„å‘³ç€æŒ‡æ•°éƒ¨åˆ†çš„æœ€å¤§å€¼æ˜¯ 2047ï¼ˆ2 çš„ 11 æ¬¡æ–¹å‡ 1ï¼‰ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ64 ä½æµ®ç‚¹æ•°çš„æŒ‡æ•°éƒ¨åˆ†çš„å€¼æœ€å¤§ä¸º2047ï¼Œåˆ†å‡ºä¸€åŠè¡¨ç¤ºè´Ÿæ•°ï¼Œåˆ™ JavaScript èƒ½å¤Ÿè¡¨ç¤ºçš„æ•°å€¼èŒƒå›´ä¸º 2^1024 åˆ°2^-1023ï¼ˆå¼€åŒºé—´ï¼‰ï¼Œè¶…å‡ºè¿™ä¸ªèŒƒå›´çš„æ•°æ— æ³•è¡¨ç¤ºã€‚**æ­£å‘æº¢å‡ºä¸º ``Infinity``,è´Ÿå‘æº¢å‡ºä¸º 0**\n\n#### ç§‘å­¦è®¡æ•°æ³•\n\nå°æ•°ç‚¹å‰æ•°å­—å¤šäº 21 ä½ï¼Œå°æ•°ç‚¹åçš„é›¶å¤šäº 5 ä¸ªå°±ä¼šè‡ªåŠ¨è½¬æ¢ä¸ºç§‘å­¦è®¡æ•°æ³•\n\n\n#### +0 å’Œ -0\n\nå‡ ä¹æ‰€æœ‰åœºåˆ +0 å’Œ-0éƒ½æ˜¯ç›¸ç­‰çš„,åªæœ‰å½“ +0 å’Œ -0 ä½œä¸ºåˆ†æ¯çš„æ—¶å€™æ‰ä¸ç›¸åŒ\n\n```js\n(1/+0) //+Infinity\n(1/-0) //-Infinity\n```\n\nè¿™ä¸¤ä¸ªçš„ç»“æœæ˜¯ä¸æƒ³ç­‰çš„\n\n#### NaN\n\n``NaN``æ˜¯ JavaScript çš„ç‰¹æ®Šå€¼ï¼Œè¡¨ç¤ºâ€œéæ•°å­—â€ï¼ˆNot a Numberï¼‰ï¼Œä¸»è¦å‡ºç°åœ¨å°†å­—ç¬¦ä¸²è§£ææˆæ•°å­—å‡ºé”™çš„åœºåˆã€‚\n\nç‰¹ç‚¹\n\n```js\n0 / 0 //NaN\nNaN === NaN//false\nNaN ä¸ä»»ä½•æ•°è¿ç®—éƒ½æ˜¯ NaN\nNaN ä¸æ˜¯ç‹¬ç«‹çš„æ•°æ®ç±»å‹ï¼Œè€Œæ˜¯ä¸€ä¸ªç‰¹æ®Šæ•°å€¼ï¼Œå®ƒçš„æ•°æ®ç±»å‹ä¾ç„¶å±äº Number\ntypeof NaN//'number'\n```\n\n### parseInt && parseFloat && Number\n\n``parseInt`` å’Œ ``parseFloat`` ç›¸ä¼¼ï¼Œç”¨äºå°†å­—ç¬¦ä¸²è½¬æ¢æˆæ•°å€¼.ç‰¹ç‚¹å¦‚ä¸‹\n\n```\n1.å¦‚æœå­—ç¬¦ä¸²å¤´éƒ¨æœ‰ç©ºæ ¼,ç©ºæ ¼ä¼šè‡ªåŠ¨å»é™¤\n2.æ˜¯ä¸€ä¸ªä¸€ä¸ªå­—ç¬¦ä¾æ¬¡è½¬æ¢,å¦‚æœç¢°åˆ°ä¸èƒ½è½¬æ¢æˆæ•°å­—çš„å­—ç¬¦,å°±ä¸åœ¨è¿›è¡Œä¸‹å»ï¼Œè¿”å›å·²ç»è½¬å¥½çš„éƒ¨åˆ†\n3.å¦‚æœå­—ç¬¦ä¸²çš„ç¬¬ä¸€æ¬¡å­—ç¬¦å°±ä¸èƒ½è½¬æ¢æˆæ•°å­—ï¼Œåˆ™è¿”å› NaN\n4.``parseFloat``å¯ä»¥è½¬æ¢ç§‘å­¦æŠ€æœ¯æ³•ä¸ºåè¿›åˆ¶æ•°å­—\n5.é‡åˆ°ç©ºå­—ç¬¦ä¸²è½¬ä¸º NaN\n```\n\n``Number`` åªè¦ç¢°åˆ°å­—ç¬¦ä¸²å°±è¿”å› ``NaN``\n\n### isNaN\n\nåˆ¤æ–­ä¸€ä¸ªå€¼æ˜¯å¦ä¸º ``NaN``\n\nä½†æ˜¯ï¼Œ`isNaN` åªå¯¹æ•°å€¼æœ‰æ•ˆï¼Œ**å¦‚æœä¼ å…¥å…¶ä»–å€¼ï¼Œä¼šè¢«å…ˆè½¬æˆæ•°å€¼**ã€‚æ¯”å¦‚ï¼Œä¼ å…¥å­—ç¬¦ä¸²çš„æ—¶å€™ï¼Œå­—ç¬¦ä¸²ä¼šè¢«å…ˆè½¬æˆ `NaN`ï¼Œæ‰€ä»¥æœ€åè¿”å› `true`ï¼Œè¿™ä¸€ç‚¹è¦ç‰¹åˆ«å¼•èµ·æ³¨æ„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ`isNaN` ä¸º `true` çš„å€¼ï¼Œæœ‰å¯èƒ½ä¸æ˜¯ `NaN`ï¼Œè€Œæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚\n\nå› æ­¤åˆ¤æ–­æ˜¯å¦ä¸º ``NaN`` å¯ä»¥åˆ©ç”¨å®ƒä¸è‡ªèº«ä¸ç­‰çš„ç‰¹æ€§\n\n```js\nfunction myIsNaN(value){\n  return value !== value\n}\n```\n\n## å­—ç¬¦ä¸²\n\n```js\n'a\nb\nc'\n// SyntaxError: Unexpected token ILLEGAL\n```\nä¸Šé¢ä»£ç å°†ä¸€ä¸ªå­—ç¬¦ä¸²åˆ†æˆä¸‰è¡Œï¼ŒJavaScript å°±ä¼šæŠ¥é”™ã€‚\n\nå¦‚æœé•¿å­—ç¬¦ä¸²å¿…é¡»åˆ†æˆå¤šè¡Œï¼Œå¯ä»¥åœ¨æ¯ä¸€è¡Œçš„å°¾éƒ¨ä½¿ç”¨åæ–œæ ã€‚\n\n```js\nvar str = 'a\\\nb\\\nc'\nstr // abc\n```\n\nå­—ç¬¦ä¸²å¯ä»¥è¢«è§†ä¸ºå­—ç¬¦æ•°ç»„ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨æ•°ç»„çš„æ–¹æ‹¬å·è¿ç®—ç¬¦ï¼Œç”¨æ¥è¿”å›æŸä¸ªä½ç½®çš„å­—ç¬¦ï¼ˆä½ç½®ç¼–å·ä»0å¼€å§‹ï¼‰ã€‚**ä½†æ˜¯ä»…ä»…æ˜¯ç›¸ä¼¼è€Œå·²ï¼Œæ— æ³•æ”¹å˜å­—ç¬¦ä¸²ä¸­çš„å•ä¸ªå­—ç¬¦** ``length``å±æ€§ä¹Ÿæ˜¯å¦‚æ­¤\n\n### å­—ç¬¦é›†\n\næ¯ä¸ªå­—ç¬¦åœ¨ JavaScript å†…éƒ¨éƒ½æ˜¯ä»¥ 16 ä½ï¼ˆå³2ä¸ªå­—èŠ‚ï¼‰çš„ UTF-16 æ ¼å¼å‚¨å­˜ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒJavaScript çš„å•ä½å­—ç¬¦é•¿åº¦å›ºå®šä¸º 16 ä½é•¿åº¦ï¼Œå³ 2 ä¸ªå­—èŠ‚ã€‚ç”±äºå†å²é—ç•™é—®é¢˜,JavaScriptåªæ”¯æŒä¸¤ä¸ªå­—èŠ‚çš„å­—ç¬¦ï¼Œ**å››ä¸ªå­—èŠ‚çš„å­—ç¬¦ä¼šè¯†åˆ«æˆä¸¤ä¸ªå­—ç¬¦**\n\n### Base64è½¬ç \n\n```js\nbtoa()ï¼šä»»æ„å€¼è½¬ä¸º Base64 ç¼–ç \natob()ï¼šBase64 ç¼–ç è½¬ä¸ºåŸæ¥çš„å€¼\n```\n\nä½†è¿™ä¸¤ç§æ–¹æ³•ä¸é€‚åˆéASCIIç çš„å­—ç¬¦,è¦åŠ ä¸€ä¸ªè½¬ç ç¯èŠ‚\n\n```js\nfunction b64Encode(str) {\n  return btoa(encodeURIComponent(str))\n}\n\nfunction b64Decode(str) {\n  return decodeURIComponent(atob(str))\n}\n```\n\n## å¯¹è±¡\n\n### å€¼ä¼ é€’\n\n[è°ˆè°ˆå€¼ä¼ é€’](https://blog.haoqinzz.cn/2017/07/25/%E8%B0%88%E8%B0%88%E5%80%BC%E4%BC%A0%E9%80%92/#more)\n\n### è¡¨è¾¾å¼è¿˜æ˜¯è¯­å¥ï¼Ÿ\n\n```js\n{foo:123}\n```\n\nJavaScript å¼•æ“è¯»åˆ°ä¸Šé¢è¿™è¡Œä»£ç ï¼Œä¼šå‘ç°å¯èƒ½æœ‰ä¸¤ç§å«ä¹‰ã€‚ç¬¬ä¸€ç§å¯èƒ½æ˜¯ï¼Œè¿™æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œè¡¨ç¤ºä¸€ä¸ªåŒ…å« `foo` å±æ€§çš„å¯¹è±¡ï¼›ç¬¬äºŒç§å¯èƒ½æ˜¯ï¼Œè¿™æ˜¯ä¸€ä¸ªè¯­å¥ï¼Œè¡¨ç¤ºä¸€ä¸ªä»£ç åŒºå—ï¼Œé‡Œé¢æœ‰ä¸€ä¸ªæ ‡ç­¾ `foo`ï¼ŒæŒ‡å‘è¡¨è¾¾å¼ `123`ã€‚\n\nä¸ºäº†é¿å…è¿™ç§æ­§ä¹‰ï¼ŒJavaScript è§„å®šï¼Œå¦‚æœè¡Œé¦–æ˜¯å¤§æ‹¬å·ï¼Œä¸€å¾‹è§£é‡Šä¸ºè¯­å¥ï¼ˆå³ä»£ç å—ï¼‰ã€‚å¦‚æœè¦è§£é‡Šä¸ºè¡¨è¾¾å¼ï¼ˆå³å¯¹è±¡ï¼‰ï¼Œå¿…é¡»åœ¨å¤§æ‹¬å·å‰åŠ ä¸Šåœ†æ‹¬å·ã€‚\n\n```js\n({foo:123})\n```\n\nåœ¨``eval``ä¸­å¯ä»¥ä½“ç°å‡ºå·®å¼‚\n\n```js\neval('{foo: 123}') // 123\neval('({foo: 123})') // {foo: 123}\n```\n\n### å±æ€§(é”®å)\n\nå¯ä»¥é‡‡ç”¨ç‚¹è¿ç®—ç¬¦å’Œæ–¹è¿ç®—ç¬¦\n\n:heavy_exclamation_mark:æ³¨æ„\n\næ•°å€¼é”®åä¸èƒ½ä½¿ç”¨ç‚¹è¿ç®—ç¬¦ï¼ˆå› ä¸ºä¼šè¢«å½“æˆå°æ•°ç‚¹ï¼‰ï¼Œåªèƒ½ä½¿ç”¨æ–¹æ‹¬å·è¿ç®—ç¬¦ã€‚\n\n```js\nvar str = 'foo'\nvar obj = {\n  123: 2,\n  foo: 6,\n  str: 5\n}\nobj.123//é”™è¯¯\nobj[123]//2\nobj[str]//6\nobj['str']//5\n```\n\n### æŸ¥çœ‹æ‰€æœ‰å±æ€§\n\n```js\nvar obj = {\n  123: 2,\n  foo: 6,\n  str: 5\n}\nObject.keys(obj)//(3) [\"123\", \"foo\", \"str\"]\n```\n\n### åˆ é™¤å±æ€§\n\n``delete``ç”¨äºåˆ é™¤å¯¹è±¡çš„å±æ€§\n\n```js\nvar obj = {\n  123: 2,\n  foo: 6,\n  str: 5\n}\ndelete obj.foo\nobj.foo //undefined\n```\n\n:heavy_exclamation_mark:æ³¨æ„\n\nç”¨ ``delete`` åˆ é™¤ä¸€ä¸ªå±æ€§,ä¸ä¼šæŠ¥é”™,è€Œä¸”è¿˜ä¼šè¿”å› `true`,å› æ­¤ä¸èƒ½æ ¹æ®``delete``è¿”å›çš„ç»“æœæ¥åˆ¤æ–­æ˜¯å¦æœ‰è¯¥å±æ€§\n\nåªæœ‰ä¸€ç§æƒ…å†µ,``delete`` è¿”å› ``false``,é‚£å°±æ˜¯è¯¥å±æ€§å­˜åœ¨ï¼Œä¸”ä¸å¾—åˆ é™¤\n\n``delete``å‘½ä»¤åªèƒ½åˆ é™¤å¯¹è±¡æœ¬èº«çš„å±æ€§ï¼Œæ— æ³•åˆ é™¤ç»§æ‰¿çš„å±æ€§\n\n\n### inè¿ç®—ç¬¦\n\n``in`` è¿ç®—ç¬¦ç”¨äºæ£€æŸ¥å¯¹è±¡æ˜¯å¦åŒ…å«æŸä¸ªå±æ€§ï¼ˆæ³¨æ„ï¼Œæ£€æŸ¥çš„æ˜¯é”®åï¼Œä¸æ˜¯é”®å€¼ï¼‰ï¼Œå¦‚æœåŒ…å«å°±è¿”å› `true`ï¼Œå¦åˆ™è¿”å› `false`ã€‚\n\n```js\nvar obj = {\n  123: 2,\n  foo: 6,\n  str: 5\n}\n\n'foo' in obj//true\n```\n\nä½†æ˜¯ ``in`` è¿ç®—ç¬¦æ— æ³•åˆ¤æ–­å“ªäº›å±æ€§æ˜¯è‡ªèº«çš„ï¼Œå“ªäº›å±æ€§æ˜¯ç»§æ‰¿çš„ã€‚ä»–éƒ½ä¼šè¿”å› ``true``\n\n:coffee: ``for..in..`` å°±æ˜¯ç”¨æ¥éå†å¯¹è±¡çš„æ‰€æœ‰å±æ€§\n\n### with\n\næ“ä½œåŒä¸€ä¸ªå¯¹è±¡çš„å¤šä¸ªå±æ€§\n\n```js\n// ä¾‹ä¸€\nvar obj = {\n  p1: 1,\n  p2: 2,\n}\nwith (obj) {\n  p1 = 4\n  p2 = 5\n}\n// ç­‰åŒäº\nobj.p1 = 4\nobj.p2 = 5\n\n// ä¾‹äºŒ\nwith (document.links[0]){\n  console.log(href)\n  console.log(title)\n  console.log(style)\n}\n// ç­‰åŒäº\nconsole.log(document.links[0].href)\nconsole.log(document.links[0].title)\nconsole.log(document.links[0].style)\n```\n\nå¦‚æœ``with``åŒºå—å†…éƒ¨æœ‰å˜é‡çš„èµ‹å€¼æ“ä½œï¼Œå¿…é¡»æ˜¯å½“å‰å¯¹è±¡å·²ç»å­˜åœ¨çš„å±æ€§ï¼Œå¦åˆ™ä¼šåˆ›é€ ä¸€ä¸ªå½“å‰ä½œç”¨åŸŸçš„å…¨å±€å˜é‡ã€‚\n\nè¿™å°±é€ æˆä¸€ä¸ªå¼Šç«¯ï¼Œå°±æ˜¯ç»‘å®šå¯¹è±¡ä¸æ˜ç¡®,æ‰€ä»¥ä¸æ¨èä½¿ç”¨\n\n## æ•°ç»„\n\næœ¬è´¨ä¸Šå°±æ˜¯å¯¹è±¡\n\nç”±äºæ•°ç»„æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªå¯¹è±¡,æ‰€ä»¥å¯ä»¥ä¸ºæ•°ç»„æ·»åŠ å±æ€§ï¼Œä½†æ˜¯è¿™å¹¶ä¸å½±å“ ``length`` å±æ€§çš„å€¼ã€‚å› ä¸º ``length`` å±æ€§çš„å€¼å°±æ˜¯æœ€å¤§çš„æ•°å­—é”®åŠ  1,å¦‚æœè¿™ä¸ªæ•°ç»„æ²¡æœ‰æ•°å­—é”®ï¼Œé‚£å®ƒçš„ ``lenth`` ä¿æŒä¸º 0\n\n:heavy_exclamation_mark:æ³¨æ„\n\nå¦‚æœé”®åæ˜¯è¶…å‡ºèŒƒå›´çš„æ•°å€¼ï¼Œä¹Ÿä¼šè¢«è½¬æ¢æˆå­—ç¬¦ä¸²\n\n### ç©ºä½\n\nå½“æ•°ç»„çš„æŸä¸ªä½ç½®æ˜¯ç©ºå…ƒç´ ï¼Œå³ä¸¤ä¸ªé€—å·ä¹‹é—´æ²¡æœ‰ä»»ä½•å€¼ï¼Œæˆ‘ä»¬ç§°è¯¥æ•°ç»„å­˜åœ¨ç©ºä½ï¼ˆholeï¼‰ã€‚\n\nç©ºä½ä¸ä¼šå½±å“ `length` å±æ€§\n\n```js\nvar arr = [1,,3] //length 3 \nvar arr1 = [1,2,3,] //length 3\n```\n\næ•°ç»„çš„ç©ºä½å¯ä»¥è¯»å–ï¼Œä¸º ``ndefined``ï¼Œä½†æ˜¯ç©ºä½ç”¨éå†çš„æ˜¯è¯»å–ä¸åˆ°çš„ï¼Œè€Œ``undefined``æ˜¯å¯ä»¥è¯»å–å‡ºæ¥çš„\n\nä½¿ç”¨``delete``åˆ é™¤ä¸€ä¸ªæ•°ç»„æˆå‘˜ï¼Œä¼šå½¢æˆç©ºä½ï¼Œä¸ä¼šå½±å“``length``\n\n### ç±»æ•°ç»„å¯¹è±¡\n\nå¦‚æœä¸€ä¸ªå¯¹è±¡çš„æ‰€æœ‰é”®åéƒ½æ˜¯æ­£æ•´æ•°æˆ–é›¶ï¼Œå¹¶ä¸”æœ‰ `length` å±æ€§ï¼Œé‚£ä¹ˆè¿™ä¸ªå¯¹è±¡å°±å¾ˆåƒæ•°ç»„ï¼Œè¯­æ³•ä¸Šç§°ä¸º â€œç±»ä¼¼æ•°ç»„çš„å¯¹è±¡â€ï¼ˆarray-like objectï¼‰\n\nå…¸å‹çš„ç±»æ•°ç»„å¯¹è±¡\n\n```js\n// argumentså¯¹è±¡\nfunction args() { return arguments }\nvar arrayLike = args('a', 'b')\n\narrayLike[0] // 'a'\narrayLike.length // 2\narrayLike instanceof Array // false\n\n// DOMå…ƒç´ é›†\nvar elts = document.getElementsByTagName('h3')\nelts.length // 3\nelts instanceof Array // false\n\n// å­—ç¬¦ä¸²\n'abc'[1] // 'b'\n'abc'.length // 3\n'abc' instanceof Array // false\n```\n\nç”¨æ•°ç»„çš„``slice``æ–¹æ³•å¯ä»¥è½¬æ¢æˆçœŸæ­£çš„æ•°ç»„\n\n```js\nvar arr = Array.prototype.slice.call(arrayLike)\n```\n\n`slice` ä¸ºä»€ä¹ˆå¯ä»¥è½¬æ¢æˆæ•°ç»„å‘¢ï¼Œ`slice` å†…éƒ¨å¯èƒ½æ‰§è¡Œäº†å¦‚ä¸‹çš„ä»£ç \n\n```js\nArray.prototype.slice = function(start,end){\n     var result = new Array()\n     start = start || 0\n     end = end || this.length //thisæŒ‡å‘è°ƒç”¨çš„å¯¹è±¡ï¼Œå½“ç”¨äº†callåï¼Œèƒ½å¤Ÿæ”¹å˜thisçš„æŒ‡å‘ï¼Œä¹Ÿå°±æ˜¯æŒ‡å‘ä¼ è¿›æ¥çš„å¯¹è±¡ï¼Œè¿™æ˜¯å…³é”®\n     for(var i = start; i < end; i++){\n          result.push(this[i])\n     }\n     return result\n}\n```\n\nè¿˜å¯ä»¥ä½¿ç”¨``call``æ–¹æ³•ä½¿ç±»æ•°ç»„ä½¿ç”¨æ•°ç»„çš„æ–¹æ³•\n\n```js\nArray.prototype.forEach.call(arrayLike,funtion(){..})\n```\n\nä½†æ˜¯è¿™ç§æ–¹æ³•è¦æ¯”åŸç”Ÿçš„ ``forEach`` è¦æ…¢ï¼Œå› æ­¤è¿˜æ˜¯æ¨èå…ˆè½¬æ¢æˆæ•°ç»„å†ç”¨``forEach``\n\n## å‡½æ•°\n\n### ç¬¬ä¸€ç­‰å…¬æ°‘\n\nJavaScript è¯­è¨€å°†å‡½æ•°çœ‹ä½œä¸€ç§å€¼ï¼Œä¸å…¶å®ƒå€¼ï¼ˆæ•°å€¼ã€å­—ç¬¦ä¸²ã€å¸ƒå°”å€¼ç­‰ç­‰ï¼‰åœ°ä½ç›¸åŒã€‚**å‡¡æ˜¯å¯ä»¥ä½¿ç”¨å€¼çš„åœ°æ–¹ï¼Œå°±èƒ½ä½¿ç”¨å‡½æ•°**ã€‚æ¯”å¦‚ï¼Œå¯ä»¥æŠŠå‡½æ•°èµ‹å€¼ç»™å˜é‡å’Œå¯¹è±¡çš„å±æ€§ï¼Œä¹Ÿå¯ä»¥å½“ä½œå‚æ•°ä¼ å…¥å…¶ä»–å‡½æ•°ï¼Œæˆ–è€…ä½œä¸ºå‡½æ•°çš„ç»“æœè¿”å›ã€‚å‡½æ•°åªæ˜¯ä¸€ä¸ªå¯ä»¥æ‰§è¡Œçš„å€¼ï¼Œæ­¤å¤–å¹¶æ— ç‰¹æ®Šä¹‹å¤„ã€‚\n\nç”±äºå‡½æ•°ä¸å…¶ä»–æ•°æ®ç±»å‹åœ°ä½å¹³ç­‰ï¼Œæ‰€ä»¥åœ¨ JavaScript è¯­è¨€ä¸­åˆç§°å‡½æ•°ä¸ºç¬¬ä¸€ç­‰å…¬æ°‘ã€‚\n\n```js\nfunction add(x,y){\n  return x+y\n}\n```\n\n### å‡½æ•°åçš„æå‡\n\n```js\nvar f = function(){\n  console.log(1)\n}\nfunction f(){\n  console.log(2)\n}\nf()//1\n```\nç”±äºå­˜åœ¨å‡½æ•°åçš„æå‡ï¼Œå…¶å®ä¼šå˜æˆä»¥ä¸‹æ ·å­\n\n```js\nvar f\n\nfunction f(){\n  console.log(2)\n}\nf = function(){\n  console.log(1)\n}\nf()\n```\n\nå‡½æ•°å£°æ˜å½¢å¼ç­‰åŒäºèµ‹å€¼è¯­å¥å£°æ˜åŒä¸€ä¸ªå‡½æ•°ï¼Œæ‰€ä»¥åé¢æ‰§è¡Œçš„ä¼š**è¦†ç›–**å…ˆå‰ç›¸åŒçš„å‡½æ•°.\n\n\n### ä¸èƒ½åœ¨æ¡ä»¶è¯­å¥ä¸­å£°æ˜å‡½æ•°\n\næ ¹æ® ES5 çš„è§„èŒƒï¼Œä¸å¾—åœ¨éå‡½æ•°çš„ä»£ç å—ä¸­å£°æ˜å‡½æ•°ï¼Œæœ€å¸¸è§çš„æƒ…å†µå°±æ˜¯ifå’Œtryè¯­å¥ã€‚\n\nè¦è¾¾åˆ°åœ¨æ¡ä»¶è¯­å¥ä¸­å®šä¹‰å‡½æ•°çš„ç›®çš„ï¼Œåªæœ‰ä½¿ç”¨å‡½æ•°è¡¨è¾¾å¼ã€‚\n\n```js\nif (false) {\n  var f = function () {}\n}\n\nf() // undefined\n```\n\n### name\n\nå‡½æ•°``name``å±æ€§è¿”å›ç´§è·Ÿåœ¨``function``å…³é”®å­—ä¹‹åçš„é‚£ä¸ªå‡½æ•°å\n\n```js\nfunction f1() {}\nf1.name // 'f1'\n\nvar f2 = function () {}\nf2.name // ''\n\nvar f3 = function myName() {}\nf3.name // 'myName'\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œå‡½æ•°çš„``name``å±æ€§æ€»æ˜¯è¿”å›ç´§è·Ÿåœ¨``function``å…³é”®å­—ä¹‹åçš„é‚£ä¸ªå‡½æ•°åã€‚å¯¹äºf2æ¥è¯´ï¼Œè¿”å›ç©ºå­—ç¬¦ä¸²ï¼ŒåŒ¿åå‡½æ•°çš„``name``å±æ€§æ€»æ˜¯ä¸ºç©ºå­—ç¬¦ä¸²ï¼›å¯¹äºf3æ¥è¯´ï¼Œè¿”å›å‡½æ•°è¡¨è¾¾å¼çš„åå­—ï¼ˆ**çœŸæ­£çš„å‡½æ•°åè¿˜æ˜¯f3ï¼ŒmyNameè¿™ä¸ªåå­—åªåœ¨å‡½æ•°ä½“å†…éƒ¨å¯ç”¨**ï¼‰ã€‚\n\n### length\n\nå‡½æ•°çš„``length``å±æ€§è¿”å›å‡½æ•°é¢„æœŸä¼ å…¥çš„å‚æ•°ä¸ªæ•°ï¼Œå³**å‡½æ•°å®šä¹‰ä¹‹ä¸­çš„å‚æ•°ä¸ªæ•°**ã€‚åœ¨ä¹‹åè°ƒç”¨çš„è¯ï¼Œæ— è®ºè¾“å…¥å¤šå°‘ä¸ªå‚æ•°,``length``å±æ€§å§‹ç»ˆè¿”å›å‡½æ•°å®šä¹‰æ—¶çš„å‚æ•°ä¸ªæ•°\n\n```js\nfunction len(a,b){\n  len.length //2\n}\n```\n\n``length``å±æ€§æä¾›äº†ä¸€ç§æœºåˆ¶ï¼Œåˆ¤æ–­å®šä¹‰æ—¶å’Œè°ƒç”¨æ—¶å‚æ•°çš„å·®å¼‚ï¼Œä»¥ä¾¿å®ç°é¢å‘å¯¹è±¡ç¼–ç¨‹çš„ã€Œé‡è½½ã€ï¼ˆoverloadï¼‰ã€‚\n\n### toString\n\nå‡½æ•°çš„ `toString` æ–¹æ³•è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå†…å®¹æ˜¯å‡½æ•°çš„æºç ,æ³¨é‡Šä¹Ÿå¯ä»¥è¿”å›.\n\n[å‡½æ•°åŸºç¡€](https://blog.haoqinzz.cn/2017/08/17/js%E5%87%BD%E6%95%B0%E5%9F%BA%E7%A1%80/)\n\n### å‡½æ•°ä½œç”¨åŸŸ\n\n:heavy_exclamation_mark: æ³¨æ„\n\nå‡½æ•°æœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªå€¼ï¼Œä¹Ÿæœ‰è‡ªå·±çš„ä½œç”¨åŸŸã€‚å®ƒçš„ä½œç”¨åŸŸä¸å˜é‡ä¸€æ ·ï¼Œå°±æ˜¯å…¶**å£°æ˜æ—¶æ‰€åœ¨çš„ä½œç”¨åŸŸï¼Œä¸å…¶è¿è¡Œæ—¶æ‰€åœ¨çš„ä½œç”¨åŸŸæ— å…³**ã€‚\n\nå¯¹äº `var` å‘½ä»¤æ¥è¯´ï¼Œå±€éƒ¨å˜é‡åªèƒ½åœ¨å‡½æ•°å†…éƒ¨å£°æ˜ï¼Œåœ¨å…¶ä»–åŒºå—ä¸­å£°æ˜ï¼Œä¸€å¾‹éƒ½æ˜¯å…¨å±€å˜é‡ã€‚\n\n```js\nvar a = 1\nvar x = function () {\n  console.log(a)\n}\n\nfunction f() {\n  var a = 2\n  x()\n}\n\nf() // 1\n```\n\nx å‡½æ•°å®šä¹‰çš„æ—¶å€™å°±æ˜¯å…¨å±€ä½œç”¨åŸŸ,x å‡½æ•°å†…éƒ¨çš„ a ä¸ä¼šåˆ° f å‡½æ•°ä¸­å– a çš„å€¼ã€‚\n\n```js\nvar x = function () {\n  console.log(a)\n}\n\nfunction y(f) {\n  var a = 2\n  f()\n}\n\ny(x)\n// ReferenceError: a is not defined\n```\n\nä¸Šé¢ä»£ç å°†å‡½æ•° x ä½œä¸ºå‚æ•°ï¼Œä¼ å…¥å‡½æ•° yã€‚ä½†æ˜¯ï¼Œå‡½æ•° x æ˜¯åœ¨å‡½æ•° y ä½“å¤–å£°æ˜çš„ï¼Œä½œç”¨åŸŸç»‘å®šå¤–å±‚ï¼Œå› æ­¤æ‰¾ä¸åˆ°å‡½æ•° y çš„å†…éƒ¨å˜é‡ aï¼Œå¯¼è‡´æŠ¥é”™ã€‚\n\n```js\nfunction foo() {\n  var x = 1\n  function bar() {\n    console.log(x)\n  }\n  return bar\n}\n\nvar x = 2\nvar f = foo()\nf() // 1\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œå‡½æ•°``foo``å†…éƒ¨å£°æ˜äº†ä¸€ä¸ªå‡½æ•°`bar`ï¼Œ`bar`çš„ä½œç”¨åŸŸç»‘å®š`foo`ã€‚å½“æˆ‘ä»¬åœ¨`foo`å¤–éƒ¨å–å‡º`bar`æ‰§è¡Œæ—¶ï¼Œå˜é‡`x`æŒ‡å‘çš„æ˜¯`foo`å†…éƒ¨çš„`x`ï¼Œè€Œä¸æ˜¯`foo`å¤–éƒ¨çš„`x`ã€‚æ­£æ˜¯è¿™ç§æœºåˆ¶ï¼Œæ„æˆäº†ä¸‹æ–‡è¦è®²è§£çš„ã€Œé—­åŒ…ã€ç°è±¡ã€‚\n\n### ä¼ é€’æ–¹å¼\n\n```js\nvar a = 2\nfunction b(a){\n  a = 3\n}\nb()\na//2\n```\n\n```js\nvar a = 2\nfunction b(){\n  a = 3\n}\nb()\na//3\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œå˜é‡`a`æ˜¯ä¸€ä¸ªåŸå§‹ç±»å‹çš„å€¼ï¼Œä¼ å…¥å‡½æ•°`b`çš„æ–¹å¼æ˜¯ä¼ å€¼ä¼ é€’ã€‚å› æ­¤ï¼Œåœ¨å‡½æ•°å†…éƒ¨ï¼Œ`a`çš„å€¼æ˜¯åŸå§‹å€¼çš„æ‹·è´ï¼Œæ— è®ºæ€ä¹ˆä¿®æ”¹ï¼Œéƒ½ä¸ä¼šå½±å“åˆ°åŸå§‹å€¼ã€‚\n\nä½†æ˜¯ï¼Œå¦‚æœå‡½æ•°å‚æ•°æ˜¯**å¤åˆç±»å‹çš„å€¼ï¼ˆæ•°ç»„ã€å¯¹è±¡ã€å…¶ä»–å‡½æ•°ï¼‰**ï¼Œä¼ é€’æ–¹å¼æ˜¯ä¼ å€ä¼ é€’ï¼ˆpass by referenceï¼‰ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¼ å…¥å‡½æ•°çš„åŸå§‹å€¼çš„åœ°å€ï¼Œå› æ­¤åœ¨å‡½æ•°**å†…éƒ¨ä¿®æ”¹å‚æ•°**ï¼Œå°†ä¼šå½±å“åˆ°åŸå§‹å€¼ã€‚\n\n### åŒåå‚æ•°\n\nå¦‚æœæœ‰åŒåå‚æ•°,åˆ™å–æœ€åé‚£ä¸ªå€¼\n```js\nfunction f(a, a) {\n  console.log(a)\n}\n\nf(1, 2) // 2\n```\nä¸Šé¢ä»£ç ä¸­ï¼Œå‡½æ•°fæœ‰ä¸¤ä¸ªå‚æ•°ï¼Œä¸”å‚æ•°åéƒ½æ˜¯aã€‚å–å€¼çš„æ—¶å€™ï¼Œä»¥åé¢çš„aä¸ºå‡†ï¼Œå³ä½¿åé¢çš„aæ²¡æœ‰å€¼æˆ–è¢«çœç•¥ï¼Œä¹Ÿæ˜¯ä»¥å…¶ä¸ºå‡†ã€‚\n\n```js\nfunction f(a, a) {\n  console.log(a)\n}\n\nf(1) // undefined\n```\n\nè°ƒç”¨å‡½æ•°fçš„æ—¶å€™ï¼Œæ²¡æœ‰æä¾›ç¬¬äºŒä¸ªå‚æ•°ï¼Œaçš„å–å€¼å°±å˜æˆäº†undefinedã€‚è¿™æ—¶ï¼Œå¦‚æœè¦è·å¾—ç¬¬ä¸€ä¸ªaçš„å€¼ï¼Œå¯ä»¥ä½¿ç”¨argumentså¯¹è±¡ã€‚\n\n```js\nfunction f(a, a) {\n  console.log(arguments[0])\n}\n\nf(1) // 1\n```\n\n\n### arguments\n\nå‡½æ•°ä½“å†…æ˜¯ä¸¥æ ¼æ¨¡å¼ï¼Œè¿™æ—¶ä¿®æ”¹``arguments``å¯¹è±¡å°±æ˜¯æ— æ•ˆçš„ã€‚\n\n``arguments``ä¸ºç±»æ•°ç»„å¯¹è±¡,è¦è½¬æ¢æˆçœŸæ­£çš„æ•°ç»„\n\n```js\nvar args = Array.prototype.slice.call(arguments)\n\n// æˆ–è€…\nvar args = []\nfor (var i = 0; i < arguments.length; i++) {\n  args.push(arguments[i])\n}\n\n```\n\n``arguments``å¯¹è±¡å¸¦æœ‰ä¸€ä¸ª`callee`å±æ€§ï¼Œè¿”å›å®ƒæ‰€å¯¹åº”çš„åŸå‡½æ•°ã€‚è°ƒç”¨è‡ªèº«å‡½æ•°ï¼Œä¸å¸¸ç”¨ã€‚\n\n### é—­åŒ…\n\né—­åŒ…å°±æ˜¯å°†å‡½æ•°å†…éƒ¨å’Œå‡½æ•°å¤–éƒ¨è¿æ¥èµ·æ¥çš„ä¸€åº§æ¡¥æ¢\n\n:heavy_exclamation_mark: æ³¨æ„\n\nå¤–å±‚å‡½æ•°æ¯æ¬¡è¿è¡Œï¼Œéƒ½ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„é—­åŒ…ï¼Œè€Œè¿™ä¸ªé—­åŒ…åˆä¼šä¿ç•™å¤–å±‚å‡½æ•°çš„å†…éƒ¨å˜é‡ï¼Œæ‰€ä»¥å†…å­˜æ¶ˆè€—å¾ˆå¤§ã€‚å› æ­¤ä¸èƒ½æ»¥ç”¨é—­åŒ…ï¼Œå¦åˆ™ä¼šé€ æˆç½‘é¡µçš„æ€§èƒ½é—®é¢˜\n\n\n### ç«‹å³è°ƒç”¨çš„å‡½æ•°è¡¨è¾¾å¼ï¼ˆIIFEï¼‰\n\nåœ¨ Javascript ä¸­ï¼Œåœ†æ‹¬å·``()``æ˜¯ä¸€ç§è¿ç®—ç¬¦ï¼Œè·Ÿåœ¨å‡½æ•°åä¹‹åï¼Œè¡¨ç¤ºè°ƒç”¨è¯¥å‡½æ•°ã€‚æ¯”å¦‚ï¼Œ``print()``å°±è¡¨ç¤ºè°ƒç”¨``print``å‡½æ•°ã€‚\n\næœ‰æ—¶ï¼Œæˆ‘ä»¬éœ€è¦åœ¨å®šä¹‰å‡½æ•°ä¹‹åï¼Œç«‹å³è°ƒç”¨è¯¥å‡½æ•°ã€‚è¿™æ—¶ï¼Œä½ ä¸èƒ½åœ¨å‡½æ•°çš„å®šä¹‰ä¹‹ååŠ ä¸Šåœ†æ‹¬å·ï¼Œè¿™ä¼šäº§ç”Ÿè¯­æ³•é”™è¯¯ã€‚\n\n```js\nfunction(){ /* code */ }()\n// SyntaxError: Unexpected token (\n```\n\näº§ç”Ÿè¿™ä¸ªé”™è¯¯çš„åŸå› æ˜¯ï¼Œ``function``è¿™ä¸ªå…³é”®å­—å³å¯ä»¥å½“ä½œè¯­å¥ï¼Œä¹Ÿå¯ä»¥å½“ä½œè¡¨è¾¾å¼ã€‚\n\n```js\n// è¯­å¥\nfunction f() {}\n\n// è¡¨è¾¾å¼\nvar f = function f() {}\n```\n\nä¸ºäº†é¿å…è§£æä¸Šçš„æ­§ä¹‰ï¼ŒJavaScript å¼•æ“è§„å®šï¼Œå¦‚æœ``function``å…³é”®å­—å‡ºç°åœ¨è¡Œé¦–ï¼Œä¸€å¾‹è§£é‡Šæˆè¯­å¥ã€‚å› æ­¤ï¼ŒJavaScriptå¼•æ“çœ‹åˆ°è¡Œé¦–æ˜¯`function`å…³é”®å­—ä¹‹åï¼Œè®¤ä¸ºè¿™ä¸€æ®µéƒ½æ˜¯å‡½æ•°çš„å®šä¹‰ï¼Œä¸åº”è¯¥ä»¥åœ†æ‹¬å·ç»“å°¾ï¼Œæ‰€ä»¥å°±æŠ¥é”™äº†ã€‚\n\nè§£å†³æ–¹æ³•å°±æ˜¯**ä¸è¦è®©`function`å‡ºç°åœ¨è¡Œé¦–**ï¼Œè®©å¼•æ“å°†å…¶ç†è§£æˆä¸€ä¸ªè¡¨è¾¾å¼ã€‚æœ€ç®€å•çš„å¤„ç†ï¼Œå°±æ˜¯å°†å…¶æ”¾åœ¨ä¸€ä¸ªåœ†æ‹¬å·é‡Œé¢ã€‚\n\n```js\n(function(){ /* code */ }())\n// æˆ–è€…\n(function(){ /* code */ })()\n```\n\nä¸Šé¢ä¸¤ç§å†™æ³•éƒ½æ˜¯ä»¥åœ†æ‹¬å·å¼€å¤´ï¼Œ(ä¸ä¸€å®šéè¦æ˜¯åœ†æ‹¬å·)å¼•æ“å°±ä¼šè®¤ä¸ºåé¢è·Ÿçš„æ˜¯ä¸€ä¸ªè¡¨ç¤ºå¼ï¼Œè€Œä¸æ˜¯å‡½æ•°å®šä¹‰è¯­å¥ï¼Œæ‰€ä»¥å°±é¿å…äº†é”™è¯¯ã€‚è¿™å°±å«åšã€Œç«‹å³è°ƒç”¨çš„å‡½æ•°è¡¨è¾¾å¼ã€ï¼ˆImmediately-Invoked Function Expressionï¼‰ï¼Œç®€ç§° IIFEã€‚\n\næ³¨æ„ï¼Œä¸Šé¢ä¸¤ç§å†™æ³•æœ€åçš„åˆ†å·éƒ½æ˜¯å¿…é¡»çš„ã€‚å¦‚æœçœç•¥åˆ†å·ï¼Œé‡åˆ°è¿ç€ä¸¤ä¸ª IIFEï¼Œå¯èƒ½å°±ä¼šæŠ¥é”™\n\n```js\n// æŠ¥é”™\n(function(){ /* code */ }())\n(function(){ /* code */ }())\n```\n\nä¸Šé¢ä»£ç çš„ä¸¤è¡Œä¹‹é—´æ²¡æœ‰åˆ†å·ï¼ŒJavaScript ä¼šå°†å®ƒä»¬è¿åœ¨ä¸€èµ·è§£é‡Šï¼Œ**å°†ç¬¬äºŒè¡Œè§£é‡Šä¸ºç¬¬ä¸€è¡Œçš„å‚æ•°**ã€‚\n\n### eval\n\n`eval`å‘½ä»¤çš„ä½œç”¨æ˜¯ï¼Œå°†å­—ç¬¦ä¸²å½“ä½œè¯­å¥æ‰§è¡Œã€‚\n\næ”¾åœ¨`eval`ä¸­çš„å­—ç¬¦ä¸²ï¼Œåº”è¯¥æœ‰ç‹¬è‡ªå­˜åœ¨çš„æ„ä¹‰ï¼Œä¸èƒ½ç”¨æ¥ä¸`eval`ä»¥å¤–çš„å‘½ä»¤é…åˆä½¿ç”¨\n\n`eval`æ²¡æœ‰è‡ªå·±çš„ä½œç”¨åŸŸï¼Œéƒ½åœ¨å½“å‰ä½œç”¨åŸŸå†…æ‰§è¡Œï¼Œå› æ­¤å¯èƒ½ä¼šä¿®æ”¹å½“å‰ä½œç”¨åŸŸçš„å˜é‡çš„å€¼ï¼Œé€ æˆå®‰å…¨é—®é¢˜ã€‚\n\n```js\nvar a = 2\neval('a=3')\na//3\n```\n\nå¦‚æœä½¿ç”¨ä¸¥æ ¼æ¨¡å¼ï¼Œ`eval`å†…éƒ¨å£°æ˜çš„å˜é‡ï¼Œä¸ä¼šå½±å“åˆ°å¤–éƒ¨ä½œç”¨åŸŸã€‚ä½†æ˜¯è¿˜æ˜¯ä¼šä¿®æ”¹å½“å‰ä½œç”¨åŸŸä¸‹çš„å˜é‡\n\n```js\n'use strict'\nvar a = 2\neval('a=3')\na//3\n\n'use strict'\neval('var b = 4')\nb//Uncaught ReferenceError: b is not defined\n```\n\næ­¤å¤–ï¼Œ`eval`çš„å‘½ä»¤å­—ç¬¦ä¸²ä¸ä¼šå¾—åˆ° JavaScript å¼•æ“çš„ä¼˜åŒ–ï¼Œè¿è¡Œé€Ÿåº¦è¾ƒæ…¢ã€‚è¿™ä¹Ÿæ˜¯ä¸€ä¸ªä¸åº”è¯¥ä½¿ç”¨å®ƒçš„ç†ç”±ã€‚\n\nå¸¸æƒ…å†µä¸‹ï¼Œ`eval`æœ€å¸¸è§çš„åœºåˆæ˜¯è§£æ JSON æ•°æ®å­—ç¬¦ä¸²ï¼Œä¸è¿‡æ­£ç¡®çš„åšæ³•åº”è¯¥æ˜¯ä½¿ç”¨æµè§ˆå™¨æä¾›çš„`JSON.parse`æ–¹æ³•ã€‚\n\nJavaScript å¼•æ“å†…éƒ¨ï¼Œ`eval`å®é™…ä¸Šæ˜¯ä¸€ä¸ªå¼•ç”¨ï¼Œé»˜è®¤è°ƒç”¨ä¸€ä¸ªå†…éƒ¨æ–¹æ³•ã€‚è¿™ä½¿å¾—`eval`çš„ä½¿ç”¨åˆ†æˆä¸¤ç§æƒ…å†µï¼Œä¸€ç§æ˜¯åƒä¸Šé¢è¿™æ ·çš„è°ƒç”¨`eval(expression)`ï¼Œè¿™å«åšã€Œç›´æ¥ä½¿ç”¨ã€ï¼Œè¿™ç§æƒ…å†µä¸‹`eval`çš„ä½œç”¨åŸŸå°±æ˜¯å½“å‰ä½œç”¨åŸŸã€‚é™¤æ­¤ä¹‹å¤–çš„è°ƒç”¨æ–¹æ³•ï¼Œéƒ½å«ã€Œé—´æ¥è°ƒç”¨ã€ï¼Œæ­¤æ—¶`eval`çš„ä½œç”¨åŸŸæ€»æ˜¯**å…¨å±€ä½œç”¨åŸŸ**ã€‚\n\n```js\nvar a = 1\n\nfunction f() {\n  var a = 2\n  var e = eval\n  e('console.log(a)')\n}\n\nf() // 1\n```\nä¸Šé¢ä»£ç ä¸­ï¼Œ`eval`æ˜¯é—´æ¥è°ƒç”¨ï¼Œæ‰€ä»¥å³ä½¿å®ƒæ˜¯åœ¨å‡½æ•°ä¸­ï¼Œå®ƒçš„ä½œç”¨åŸŸè¿˜æ˜¯å…¨å±€ä½œç”¨åŸŸï¼Œå› æ­¤è¾“å‡ºçš„`a`ä¸ºå…¨å±€å˜é‡ã€‚\n\n`eval`çš„é—´æ¥è°ƒç”¨çš„å½¢å¼äº”èŠ±å…«é—¨ï¼Œ**åªè¦ä¸æ˜¯ç›´æ¥è°ƒç”¨ï¼Œéƒ½å±äºé—´æ¥è°ƒç”¨**\n\n[å›¾è§£ä½œç”¨åŸŸå’Œé—­åŒ…](https://blog.haoqinzz.cn/2017/08/20/%E5%9B%BE%E8%A7%A3%E4%BD%9C%E7%94%A8%E5%9F%9F%E5%8F%8A%E9%97%AD%E5%8C%85/#more)\n\n## è¿ç®—ç¬¦\n\n### åŠ æ³•è¿ç®—ç¬¦\n\n```js\n3+5+'6' //86\n'6'+3+5 //635\n```\n\nä»å·¦åˆ°å³çš„è¿ç®—é¡ºåºï¼Œå­—ç¬¦ä¸²æˆ–å­—ç¬¦å‡ºç°çš„é¡ºåºå°†å¯¼è‡´ç»“æœçš„ä¸åŒ,å‡æ³•é™¤æ³•ä¹˜æ³•è¿ç®—ç¬¦éƒ½ä¼šå…ˆå°†å­—ç¬¦ä¸²è½¬æ¢æˆæ•°å­—å†è¿›è¡Œè¿ç®—ã€‚\n\nå¦‚æœè¿ç®—æ˜¯å¯¹è±¡ï¼Œå¿…é¡»å…ˆè½¬æ¢æˆåŸå§‹ç±»å‹ï¼Œç„¶åå†è¿›è¡Œç›¸åŠ \n\n```js\nvar obj = { p: 1 }\nobj + 2 // \"[object Object]2\"\n```\n\n`obj`è½¬æ¢æˆåŸå§‹ç±»å‹ä¸º`[object Object]`\n\nå¯¹è±¡è½¬æ¢æˆåŸå§‹ç±»å‹ï¼Œè§„åˆ™å¦‚ä¸‹\n\né¦–å…ˆï¼Œè‡ªåŠ¨è°ƒç”¨`valueOf`æ–¹æ³•,ä¸€èˆ¬æ¥è¯´`valueOf`æ–¹æ³•ä¼šè¿”å›å¯¹è±¡æœ¬èº«ï¼Œç„¶åå†è°ƒç”¨`toString()`æ–¹æ³•å°†å…¶è½¬æ¢ä¸ºå­—ç¬¦ä¸²\n\n```js\nvar obj = {p:1}\nobj.valueOf().toString()//[object Object]\n```\n\nå½“çŸ¥é“äº†è¿™ä¸ªè§„åˆ™ä¹‹åï¼Œå°±å¯ä»¥è‡ªå·±å®šä¹‰`valueOf`å’Œ`toString`æ–¹æ³•æ¥å¾—åˆ°è‡ªå·±æƒ³è¦çš„ç»“æœ\n\n```js\nvar obj = {\n  valueOf: function () {\n    return 1\n  }\n}\n\nobj + 2 // 3\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰`obj`å¯¹è±¡çš„`valueOf`æ–¹æ³•è¿”å›1ï¼Œäºæ˜¯`obj` + 2å°±å¾—åˆ°äº†3ã€‚è¿™ä¸ªä¾‹å­ä¸­ï¼Œç”±äº`valueOf`æ–¹æ³•ç›´æ¥è¿”å›ä¸€ä¸ªåŸå§‹ç±»å‹çš„å€¼ï¼Œæ‰€ä»¥ä¸å†è°ƒç”¨`toString`æ–¹æ³•ã€‚\n\nä¸‹é¢æ˜¯è‡ªå®šä¹‰`toString`æ–¹æ³•çš„ä¾‹å­ã€‚\n```js\nvar obj = {\n  toString: function () {\n    return 'hello'\n  }\n}\n\nobj + 2 // \"hello2\"\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œå¯¹è±¡`obj`çš„`toString`æ–¹æ³•è¿”å›å­—ç¬¦ä¸²`hello`ã€‚å‰é¢è¯´è¿‡ï¼Œåªè¦æœ‰ä¸€ä¸ªè¿ç®—å­æ˜¯å­—ç¬¦ä¸²ï¼ŒåŠ æ³•è¿ç®—ç¬¦å°±å˜æˆè¿æ¥è¿ç®—ç¬¦ï¼Œè¿”å›è¿æ¥åçš„å­—ç¬¦ä¸²ã€‚\n\n:heavy_exclamation_mark: æ³¨æ„\n\nè¿™é‡Œæœ‰ä¸€ä¸ªç‰¹ä¾‹ï¼Œå¦‚æœè¿ç®—å­æ˜¯ä¸€ä¸ª`Date`å¯¹è±¡çš„å®ä¾‹ï¼Œé‚£ä¹ˆä¼šä¼˜å…ˆæ‰§è¡Œ`toString`æ–¹æ³•\nã€‚\n```js\nvar obj = new Date()\nobj.valueOf = function () { return 1 }\nobj.toString = function () { return 'hello' }\n\nobj + 2 // \"hello2\"\n```\n\nä¸Šé¢ä»£ç ä¸­ï¼Œå¯¹è±¡`obj`æ˜¯ä¸€ä¸ª`Date`å¯¹è±¡çš„å®ä¾‹ï¼Œå¹¶ä¸”è‡ªå®šä¹‰äº†`valueOf`æ–¹æ³•å’Œ`toString`æ–¹æ³•ï¼Œç»“æœ`toString`æ–¹æ³•ä¼˜å…ˆæ‰§è¡Œã€‚\n\n\n### æ¯”è¾ƒè¿ç®—ç¬¦\n\nå­—ç¬¦ä¸²æ¯”è¾ƒæ˜¯æŒ‰ç…§å­—å…¸é¡ºåºï¼Œå¦‚æœç¬¬ä¸€ä¸ªç›¸ç­‰å°±æ¯”è¾ƒä¸‹ä¸€ä¸ª\n\nä¸åŸå§‹ç±»å‹æ¯”è¾ƒçš„è¯ï¼Œå¦‚æœä¸æ˜¯æ•°å­—ï¼Œéƒ½æ˜¯å…ˆç”¨`Number` è½¬æˆæ•°å­—å†è¿›è¡Œæ¯”è¾ƒã€‚å…¶ä¸­å’Œ`NaN`æ¯”è¾ƒéƒ½è¿”å›`false`\n\nä¸éåŸå§‹ç±»å‹æ¯”è¾ƒå°±å…ˆè½¬æ¢æˆåŸå§‹ç±»å‹ï¼Œè§„åˆ™è¿˜æ˜¯å¤åˆç±»å‹å…ˆè°ƒç”¨`valueOf`å†è°ƒç”¨`toString`ï¼Œ`Date`è¿˜æ˜¯ä¸€æ ·ç‰¹æ®Š\n\n### === && == \n\n`===`å…ˆä¼šæ¯”è¾ƒä¸¤ä¸ªå€¼çš„ç±»å‹ï¼Œå¦‚æœç±»å‹ä¸ç›¸åŒï¼Œåˆ™ç›´æ¥è¿”å›`false`,`==`ä¹Ÿæ˜¯å…ˆæ¯”è¾ƒç±»å‹ï¼Œå¦‚æœç±»å‹ä¸ç›¸åŒï¼Œä»–ä¼šå…ˆè½¬æ¢æˆåŒä¸€ç±»å‹çš„å€¼ç„¶åå†è¿›è¡Œ`===`æ¯”è¾ƒ\n\n#### ===\n\nä¸åŒç±»å‹ç›´æ¥è¿”å›`false`\n\néƒ½æ˜¯åŸå§‹ç±»å‹å€¼ç›¸ç­‰è¿”å›`true`,`NaN`ä¸ä¸¥æ ¼ç­‰äºä»»ä½•å€¼ä¹Ÿä¸å’Œè‡ªå·±ä¸¥æ ¼ç›¸ç­‰\n\néƒ½æ˜¯å¤åˆç±»å‹ä¸æ˜¯åˆ¤æ–­ä»–ä»¬çš„å€¼æ˜¯å¦ç›¸ç­‰ï¼Œè€Œæ˜¯åˆ¤æ–­ä»–ä»¬æŒ‡å‘çš„åœ°å€æ˜¯å¦ç›¸ç­‰\n\n`undefined`å’Œ`null`åªä¸è‡ªå·±ä¸¥æ ¼ç›¸ç­‰\n\n`!==`æ˜¯å¯¹`===`çš„å–å\n\n#### == \n\nç›¸åŒç±»å‹çš„è¯å’Œ`===`åˆ¤æ–­ç®—æ³•ç›¸åŒ\n\nåŸå§‹ç±»å‹çš„æ•°æ®ä¼šè½¬æ¢æˆæ•°å€¼æ¥æ¯”è¾ƒï¼Œè°ƒç”¨`Number`æ–¹æ³•\n\nå¤åˆç±»å‹å’ŒåŸå§‹ç±»å‹è¿›è¡Œæ¯”è¾ƒï¼Œå¤åˆç±»å‹å…ˆè½¬æ¢æˆåŸå§‹ç±»å‹\n\n```js\n//ä¸æ•°å­—æ¯”è¾ƒ\n[1] == 1 // true\n// ç­‰åŒäº Number([1]) == 1\n\n//ä¸å­—ç¬¦ä¸²æ¯”è¾ƒ\n[1] == '1' // true\n// ç­‰åŒäº String([1]) == '1'\n\n//ä¸å¸ƒå°”å€¼æ¯”è¾ƒ\n[1] == true // true\n// ç­‰åŒäº Number([1]) == Number(true)\n```\n\n`undefined`å’Œ`null`ä¸å…¶å®ƒç±»å‹æ¯”è¾ƒæ—¶éƒ½ä¸º`false`,**ç›¸äº’æ¯”è¾ƒæ—¶ä¸º`true`**\n\n`!=`æ˜¯å¯¹`==`ç»“æœçš„å–å\n\n### å–å\n\nä»»ä½•ç±»å‹çš„æ•°å€¼ç»è¿‡`!`åéƒ½å˜æˆäº†å¸ƒå°”å€¼ï¼Œ`!!x`ç›¸å½“äº`Boolean(x)`\n\n### ä½è¿ç®—\n\nä½è¿ç®—ç¬¦åªå¯¹æ•´æ•°èµ·ä½œç”¨ï¼Œå¦‚æœä¸€ä¸ªè¿ç®—å­ä¸æ˜¯æ•´æ•°ï¼Œ**ä¼šè‡ªåŠ¨è½¬ä¸ºæ•´æ•°åå†æ‰§è¡Œ**ã€‚å¦å¤–ï¼Œè™½ç„¶åœ¨ JavaScript å†…éƒ¨ï¼Œæ•°å€¼éƒ½æ˜¯ä»¥64ä½æµ®ç‚¹æ•°çš„å½¢å¼å‚¨å­˜ï¼Œä½†æ˜¯åšä½è¿ç®—çš„æ—¶å€™ï¼Œæ˜¯ä»¥32ä½å¸¦ç¬¦å·çš„æ•´æ•°è¿›è¡Œè¿ç®—çš„ï¼Œå¹¶ä¸”è¿”å›å€¼ä¹Ÿæ˜¯ä¸€ä¸ª32ä½å¸¦ç¬¦å·çš„æ•´æ•°ã€‚\n\n```js\ni = i | 0 //å°±æ˜¯å°†iè½¬ä¸º32ä½çš„æ•´æ•°\n~~i //å¯¹iå–æ•´ æ–¹æ³•æœ€å¿«\ni^0//å¯¹iå–æ•´\n```\n\n#### å¼‚æˆ–\n\nå¼‚æˆ–è¿ç®—ï¼ˆ^ï¼‰åœ¨ä¸¤ä¸ªäºŒè¿›åˆ¶ä½ä¸åŒæ—¶è¿”å›1ï¼Œç›¸åŒæ—¶è¿”å›0ã€‚\n\n```js\n//ç”¨æ¥äº¤æ¢\nvar a = 1\nvar b = 2\na ^=b,b^=a,a^=b\na//2\nb//1\n```\n\n#### å·¦ç§»å³ç§»\n\n```js\n4 << 1\n```\n\nå·¦ç§»1ä¸º 4çš„äºŒè¿›åˆ¶ä¸º100ï¼Œå·¦ç§»ä¸º1000ï¼Œç»“æœå°±ä¸º8ï¼Œæ‰€ä»¥`x`å·¦ç§»`n`ä½ç›¸å½“äº`x`ä¹˜`2`çš„`n`æ¬¡æ–¹\n\n### void\n\n`void`è¿ç®—ç¬¦çš„ä½œç”¨æ˜¯æ‰§è¡Œä¸€ä¸ªè¡¨è¾¾å¼ï¼Œç„¶åä¸è¿”å›ä»»ä½•å€¼ï¼Œæˆ–è€…è¯´è¿”å›`undefined`ã€‚\n\n\n```js\n<a href=\"javascript: void(document.form.submit())\">\n  æäº¤\n</a>\n```\n\n`void`æ‰§è¡Œé€Ÿåº¦å¿«ï¼Œæ‰§è¡Œæäº¤åä¸è¿”å›ä»»ä½•å€¼æ‰€ä»¥ä¹Ÿé˜»æ­¢äº†`a`æ ‡ç­¾çš„é»˜è®¤è·³è½¬\n\n### é€—å·è¿ç®—ç¬¦\n\n```js\n'a', 'b' // \"b\"\n\nvar x = 0\nvar y = (x++, 10)\nx // 1\ny // 10\n```\n\n### ä¼˜å…ˆçº§\n\næ ¹æ®è¯­è¨€è§„æ ¼ï¼Œè¿™äº”ä¸ªè¿ç®—ç¬¦çš„ä¼˜å…ˆçº§ä»é«˜åˆ°ä½ä¾æ¬¡ä¸ºï¼šå°äºç­‰äº`<=`ã€ä¸¥æ ¼ç›¸ç­‰`===`ã€æˆ–`||`ã€ä¸‰å…ƒ`?:`ã€ç­‰å·`=`ã€‚å› æ­¤ä¸Šé¢çš„è¡¨è¾¾å¼ï¼Œå®é™…çš„è¿ç®—é¡ºåºå¦‚ä¸‹ã€‚\n\n### åœ†æ‹¬å·\n\nåœ†æ‹¬å·ä¸æ˜¯è¿ç®—ç¬¦ï¼Œè€Œæ˜¯ä¸€ç§**è¯­æ³•ç»“æ„**ã€‚å®ƒä¸€å…±æœ‰ä¸¤ç§ç”¨æ³•ï¼šä¸€ç§æ˜¯æŠŠè¡¨è¾¾å¼æ”¾åœ¨åœ†æ‹¬å·ä¹‹ä¸­ï¼Œæå‡è¿ç®—çš„ä¼˜å…ˆçº§ï¼›å¦ä¸€ç§æ˜¯è·Ÿåœ¨å‡½æ•°çš„åé¢ï¼Œä½œç”¨æ˜¯è°ƒç”¨å‡½æ•°ã€‚\n\nåœ†æ‹¬å·ä¸­åªèƒ½æ”¾ç½®è¡¨è¾¾å¼ï¼Œä¸èƒ½æ”¾ç½®è¯­å¥ï¼Œå¦‚æœå°†è¯­å¥æ”¾ç½®åœ¨åœ†æ‹¬å·ä¸­ä¼šæŠ¥é”™\n\n\n## æ•°æ®ç±»å‹çš„è½¬æ¢\n\n### Number\n\n`Number`è½¬æ¢å¯¹è±¡æ—¶ï¼Œå°†è¿”å›`NaN`ï¼Œé™¤éæ˜¯æœ‰å•ä¸ªæ•°å€¼çš„æ•°ç»„\n\n`Number`è½¬æ¢çš„è§„åˆ™\n\nç¬¬ä¸€æ­¥ï¼Œè°ƒç”¨å¯¹è±¡è‡ªèº«çš„`valueOf`æ–¹æ³•ã€‚å¦‚æœè¿”å›åŸå§‹ç±»å‹çš„å€¼ï¼Œåˆ™ç›´æ¥å¯¹è¯¥å€¼ä½¿ç”¨`Number`å‡½æ•°ï¼Œä¸å†è¿›è¡Œåç»­æ­¥éª¤ã€‚\n\nç¬¬äºŒæ­¥ï¼Œå¦‚æœ`valueOf`æ–¹æ³•è¿”å›çš„è¿˜æ˜¯å¯¹è±¡ï¼Œåˆ™æ”¹ä¸ºè°ƒç”¨å¯¹è±¡è‡ªèº«çš„`toString`æ–¹æ³•ã€‚å¦‚æœ`toString`æ–¹æ³•è¿”å›åŸå§‹ç±»å‹çš„å€¼ï¼Œåˆ™å¯¹è¯¥å€¼ä½¿ç”¨`Number`å‡½æ•°ï¼Œä¸å†è¿›è¡Œåç»­æ­¥éª¤ã€‚\n\nç¬¬ä¸‰æ­¥ï¼Œå¦‚æœ`toString`æ–¹æ³•è¿”å›çš„æ˜¯å¯¹è±¡ï¼Œå°±æŠ¥é”™ã€‚\n\n### String\n\n`String`æ–¹æ³•çš„å‚æ•°å¦‚æœæ˜¯å¯¹è±¡ï¼Œè¿”å›ä¸€ä¸ªç±»å‹å­—ç¬¦ä¸²ï¼›å¦‚æœæ˜¯æ•°ç»„ï¼Œè¿”å›è¯¥æ•°ç»„çš„å­—ç¬¦ä¸²å½¢å¼ã€‚\n\n`String`æ–¹æ³•èƒŒåçš„è½¬æ¢è§„åˆ™ï¼Œä¸`Number`æ–¹æ³•åŸºæœ¬ç›¸åŒï¼Œåªæ˜¯äº’æ¢äº†`valueOf`æ–¹æ³•å’Œ`toString`æ–¹æ³•çš„æ‰§è¡Œé¡ºåºã€‚\n\n### Boolean\n\n`Boolean`å‡½æ•°å¯ä»¥å°†ä»»æ„ç±»å‹çš„å€¼è½¬ä¸ºå¸ƒå°”å€¼ã€‚\n\né™¤äº†ä»¥ä¸‹ä¸º`false`ï¼Œå…¶ä½™éƒ½ä¸º`true`\n\n```\nundefined\nnull\n''\n+0 -0\nNaN\n```\n\n:heavy_exclamation_mark:æ³¨æ„\n\n`undefined`è½¬æ¢æˆæ•°å­—ä¸º`NaN` `null`ä¸º0\n\n## é”™è¯¯(Error)\n\n### SyntaxError\n\n``SyntaxError``å¯¹è±¡æ˜¯è§£æä»£ç æ—¶å‘ç”Ÿçš„è¯­æ³•é”™è¯¯ã€‚\n\n```js\n// å˜é‡åé”™è¯¯\nvar 1a\n// Uncaught SyntaxError: Invalid or unexpected token\n\n// ç¼ºå°‘æ‹¬å·\nconsole.log 'hello')\n// Uncaught SyntaxError: Unexpected string      \n```\n\n### ReferenceError\n\n``ReferenceError``å¯¹è±¡æ˜¯å¼•ç”¨ä¸€ä¸ªä¸å­˜åœ¨çš„å˜é‡æ—¶å‘ç”Ÿçš„é”™è¯¯ã€‚\n\n```js\n// ä½¿ç”¨ä¸€ä¸ªä¸å­˜åœ¨çš„å˜é‡\nunknownVariable\n// Uncaught ReferenceError: unknownVariable is not defined\n```\n\nå¦ä¸€ç§è§¦å‘åœºæ™¯æ˜¯ï¼Œå°†ä¸€ä¸ªå€¼åˆ†é…ç»™æ— æ³•åˆ†é…çš„å¯¹è±¡ï¼Œæ¯”å¦‚å¯¹å‡½æ•°çš„è¿è¡Œç»“æœæˆ–è€…`this`èµ‹å€¼ã€‚\n\n```js\n// ç­‰å·å·¦ä¾§ä¸æ˜¯å˜é‡\nconsole.log() = 1\n// Uncaught ReferenceError: Invalid left-hand side in assignment\n\n// this å¯¹è±¡ä¸èƒ½æ‰‹åŠ¨èµ‹å€¼\nthis = 1\n// ReferenceError: Invalid left-hand side in assignment\n```\n\n### RangeError\n\n`RangeError`å¯¹è±¡æ˜¯ä¸€ä¸ªå€¼è¶…å‡ºæœ‰æ•ˆèŒƒå›´æ—¶å‘ç”Ÿçš„é”™è¯¯ã€‚ä¸»è¦æœ‰å‡ ç§æƒ…å†µï¼Œä¸€æ˜¯æ•°ç»„é•¿åº¦ä¸ºè´Ÿæ•°ï¼ŒäºŒæ˜¯`Number`å¯¹è±¡çš„æ–¹æ³•å‚æ•°è¶…å‡ºèŒƒå›´ï¼Œä»¥åŠå‡½æ•°å †æ ˆè¶…è¿‡æœ€å¤§å€¼ã€‚\n\n### TypeError \n\n`TypeError`å¯¹è±¡æ˜¯å˜é‡æˆ–å‚æ•°ä¸æ˜¯é¢„æœŸç±»å‹æ—¶å‘ç”Ÿçš„é”™è¯¯ã€‚æ¯”å¦‚ï¼Œå¯¹å­—ç¬¦ä¸²ã€å¸ƒå°”å€¼ã€æ•°å€¼ç­‰åŸå§‹ç±»å‹çš„å€¼ä½¿ç”¨`new`å‘½ä»¤ï¼Œå°±ä¼šæŠ›å‡ºè¿™ç§é”™è¯¯ï¼Œå› ä¸º`new`å‘½ä»¤çš„å‚æ•°åº”è¯¥æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ã€‚  \n\n### URIError\n\n`URIError`å¯¹è±¡æ˜¯ URI ç›¸å…³å‡½æ•°çš„å‚æ•°ä¸æ­£ç¡®æ—¶æŠ›å‡ºçš„é”™è¯¯ï¼Œä¸»è¦æ¶‰åŠ`encodeURI()`ã€`decodeURI()`ã€`encodeURIComponent()`ã€`decodeURIComponent()`ã€`escape()`å’Œ`unescape()`è¿™å…­ä¸ªå‡½æ•°ã€‚\n\n### EvalError\n\n`eval`å‡½æ•°æ²¡æœ‰è¢«æ­£ç¡®æ‰§è¡Œæ—¶ï¼Œä¼šæŠ›å‡º`EvalError`é”™è¯¯ã€‚è¯¥é”™è¯¯ç±»å‹å·²ç»ä¸å†ä½¿ç”¨äº†ï¼Œåªæ˜¯ä¸ºäº†ä¿è¯ä¸ä»¥å‰ä»£ç å…¼å®¹ï¼Œæ‰ç»§ç»­ä¿ç•™ã€‚\n\n### try .. catch .. finally\n\nä¸€æ—¦å‘ç”Ÿé”™è¯¯ï¼Œç¨‹åºå°±ä¸­æ­¢æ‰§è¡Œäº†ã€‚JavaScript æä¾›äº†`try...catch`ç»“æ„ï¼Œå…è®¸å¯¹é”™è¯¯è¿›è¡Œå¤„ç†ï¼Œé€‰æ‹©æ˜¯å¦å¾€ä¸‹æ‰§è¡Œã€‚\n\n```js\ntry{\n  \n}catch(err){//æ¥å—é”™è¯¯ç±»å‹\n  //å¤„ç†é”™è¯¯\n}finally{\n  //ä¸ç®¡å‡ºç°ä»»ä½•é”™è¯¯éƒ½æ‰§è¡Œ\n}\n```\n\n\n","tags":["ES5"],"categories":["Note"]},{"title":"prop å’Œ attr çš„ä¸€äº›ç†è§£","url":"%2F2017%2F11%2F24%2Fprop%E5%92%8Cattr%E7%9A%84%E4%B8%80%E4%BA%9B%E7%90%86%E8%A7%A3%2F","content":"\n> å‰å‡ å¤©åšä¸€ä¸ªè¿·ä½ äº¬ä¸œå°é¡¹ç›®çš„æ—¶å€™æ¶‰åŠåˆ°ä¸€ä¸ªå…¨é€‰çš„å°åŠŸèƒ½ï¼Œä¸€å¼€å§‹ç”¨çš„æ˜¯ `attr`ï¼Œä½†æ˜¯æ•ˆæœå®Œå…¨ä¸æ˜¯è‡ªå·±æƒ³è¦çš„ï¼Œå½“å•†å“æŒ‰é’®ç‚¹å‡»è¿‡ä¸€æ¬¡åï¼Œ`attr` å°±æ— æ³•å¯¹å…¶çŠ¶æ€è¿›è¡Œæ›´æ”¹ï¼Œæœ€åè°·æ­Œäº†ä¸€ç•ªå‘ç°éœ€è¦ç”¨ `prop` æ¥ä»£æ›¿ã€‚è™½ç„¶æ•ˆæœé—®é¢˜è§£å†³äº†ï¼Œä½†æ˜¯è‡ªå·±è¿˜æ˜¯æƒ³å¼„æ‡‚ `prop` å’Œ `attr` çš„åŒºåˆ«.\n\n<!--more-->\n\n## ç‰ˆæœ¬ä½¿ç”¨ä¸åŒ\n\né‡åˆ°é—®é¢˜æˆ‘ä¸€èˆ¬å…ˆä¼šå»æŸ¥ç›¸å…³çš„å®˜æ–¹æ–‡æ¡£ï¼Œå¯åœ¨ jq çš„ api ä¸­æ–‡æ–‡æ¡£ä¸­æ²¡æœ‰å‘ç°æœ‰ä»·å€¼çš„ä¸œè¥¿ï¼Œåªæ˜¯å‘ç°é€‚ç”¨çš„ç‰ˆæœ¬å’Œæ¦‚å¿µæœ‰æ‰€è½»å¾®çš„ä¸åŒã€‚\n\n`attr` : è®¾ç½®æˆ–è¿”å›è¢«é€‰å…ƒç´ çš„å±æ€§å€¼.ç‰ˆæœ¬ï¼š1.0\n\n`prop` : è·å–åœ¨åŒ¹é…çš„å…ƒç´ é›†ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„å±æ€§å€¼ã€‚ç‰ˆæœ¬ï¼š1.6+\n\nä»æ¦‚å¿µä¸­å‘ç°æ“ä½œçš„å¯¹è±¡å’Œä½¿ç”¨ä¹Ÿå¥½åƒåŸºæœ¬ç›¸åŒï¼Œç„¶åå¸¦ç€ç–‘æƒ‘å»è¿›è¡Œäº†ä¸€ç•ªå®éªŒå¹¶å»æŸ¥é˜…äº†ä¸€äº›ç›¸å…³èµ„æ–™\n\nç¤ºä¾‹ä»£ç \n\n```HTML\n<table>\n        <thead>\n            <tr><input type=\"checkbox\" class=\"checkAll\">å…¨é€‰</tr>\n        </thead>\n        <tbody>\n            <tr><input class=\"item\" type=\"checkbox\">å•é€‰</tr>\n            <tr><input class=\"item\" type=\"checkbox\">å•é€‰</tr>\n            <tr><input class=\"item\" type=\"checkbox\">å•é€‰</tr>\n            <tr><input class=\"item\" type=\"checkbox\">å•é€‰</tr>\n            <tr><input class=\"item\" type=\"checkbox\">å•é€‰</tr>\n            <tr><input class=\"item\" type=\"checkbox\">å•é€‰</tr>\n        </tbody>\n    </table>\n```\n\n```js\n$('.checkAll').click(function() {\n  $('.item').attr('checked', this.checked)\n})\n```\n\n## é—®é¢˜æè¿°\n\nå½“å…¨é€‰æŒ‰é’®é€‰ä¸­æ—¶å•é€‰æŒ‰é’®å…¨éƒ¨é€‰ä¸­ï¼Œå½“å…¨é€‰æŒ‰é’®ä¸é€‰ä¸­æ—¶å•é€‰æŒ‰é’®å…¨éƒ¨ä¸é€‰ä¸­ï¼Œåªç‚¹å…¨é€‰æŒ‰é’®æ—¶ï¼Œåå¤å‡ æ¬¡éƒ½æ²¡é—®é¢˜ï¼Œä½†æ˜¯è¦æ˜¯ç‚¹å‡»äº†å…¶ä¸­ä¸€ä¸ªå•é€‰æŒ‰é’®ï¼Œé‚£è¿™ä¸ªå•é€‰æŒ‰é’®å°±ä¸ä¼šåœ¨åƒå…¶å®ƒå•é€‰æŒ‰é’®ä¸€æ ·è·Ÿéšå…¨é€‰æŒ‰é’®çš„çŠ¶æ€çš„æ”¹å˜è€Œæ”¹å˜ã€‚\n\n## attr å’Œ prop çš„æœ¬è´¨\n\n`attr` æ˜¯ `attribute` çš„ç¼©å†™,`prop` æ˜¯ `property` çš„ç¼©å†™ï¼Œéƒ½æœ‰å±æ€§çš„æ„æ€ï¼Œåªä¸è¿‡ `attr` æ˜¯æ“ä½œ html æ–‡æ¡£èŠ‚ç‚¹å±æ€§ï¼Œ`prop` æ˜¯æ“ä½œ js å¯¹è±¡å±æ€§. `attr` åœ¨ js ä¸­ä½¿ç”¨çš„æ˜¯ `setAttribute` å’Œ `getAttribute` è€Œ `prop` ç›´æ¥ä½¿ç”¨åŸç”Ÿ js çš„ `element[value]` å’Œ `element[value]=key`ã€‚\n\n## attr å’Œ prop çš„åŒºåˆ«\n\n`attr` è®¾ç½®çš„å±æ€§å€¼åªèƒ½æ˜¯**å­—ç¬¦ä¸²ç±»å‹**,å¦‚æœä¸æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œä¹Ÿä¼šè°ƒç”¨å…¶ `toString()` æ–¹æ³•ï¼Œå°†å…¶è½¬æ¢æˆå­—ç¬¦ä¸²ç±»å‹ã€‚\n\n`prop` è®¾ç½®çš„å±æ€§å€¼å¯ä»¥åŒ…æ‹¬æ•°ç»„å’Œå¯¹è±¡åœ¨å†…çš„ä»»æ„ç±»å‹\n\n### æœ‰å…³å¸ƒå°”å€¼çš„å±æ€§\n\n1.6 ä¹‹å, `attr` è¿”å›çš„ä¹Ÿæ˜¯**å­—ç¬¦ä¸²ç±»å‹**, é€‰ä¸­æˆ–ç¦ç”¨ç›´æ¥è¿”å› `checked`,`selected`,`disabled`ã€‚å¦åˆ™è¿”å›`undefined`ã€‚è§£å†³æˆ‘é—®é¢˜çš„å…³é”®å°±æ˜¯åé¢ä¸€å¥è¯\n\n> jQuery è®¤ä¸ºï¼šattribute çš„ checkedã€selectedã€disabled å°±æ˜¯è¡¨ç¤ºè¯¥å±æ€§åˆå§‹çŠ¶æ€çš„å€¼ï¼Œproperty çš„ checkedã€selectedã€disabled æ‰è¡¨ç¤ºè¯¥å±æ€§å®æ—¶çŠ¶æ€çš„å€¼(å€¼ä¸º true æˆ– false)ã€‚\n\nå½“æ¶‰åŠåˆ° boolean å€¼æ—¶ï¼Œæ¯”å¦‚ `checkbox` è¿™æ ·çš„ï¼Œæœ‰ `true` å’Œ `false` è¿™æ ·çš„å¸ƒå°”å€¼çš„å…ƒç´ å±æ€§ï¼Œ`attributes` åœ¨é¡µé¢åŠ è½½çš„æ—¶å€™å°±è¢«è®¾ç½®ï¼Œå¹¶ä¸”ä¸€ç›´ä¿æŒåˆå§‹å€¼ï¼Œè€Œ `properties` åˆ™å­˜å‚¨ç€å…ƒç´ å±æ€§çš„å½“å‰å€¼ã€‚\n\næ‰€ä»¥å½“æˆ‘æ²¡æœ‰ç‚¹å‡»å•é€‰æŒ‰é’®çš„æ—¶å€™ï¼Œå®ƒå°±æ˜¯æ²¡è¢«ç”¨æˆ·ç‚¹å‡»è¿‡çš„æµè§ˆå™¨åˆšåŠ è½½å‡ºæ¥çš„åˆå§‹çŠ¶æ€ï¼Œæ­¤æ—¶å¯ä»¥é€šè¿‡ `attr` å»è®¾ç½®å¹¶æ“æ§ï¼Œå½“æœ‰ç”¨æˆ·ç‚¹å‡»çš„æ—¶å€™ï¼Œå½“å‰æŒ‰é’®å°±ä¸æ˜¯åˆå§‹çŠ¶æ€ï¼Œ`attr`è‡ªç„¶ä¹Ÿå°±æ— æ³•æ“æ§ã€‚\n","tags":["JQ"],"categories":["Explore"]},{"title":"ç®€æ˜“æ‰«é›·å°æ¸¸æˆ","url":"%2F2017%2F09%2F07%2F%E7%AE%80%E6%98%93%E6%89%AB%E9%9B%B7%E5%B0%8F%E6%B8%B8%E6%88%8F%2F","content":"\n> å‰é˜µå­æ— èŠï¼ŒLOL ä¹Ÿä¸æ˜¯å¾ˆæƒ³ç©ï¼Œå‘ç°äº†ç”µè„‘ä¸­è‡ªå¸¦çš„æ‰«é›·, å½“æ—¶åœ¨ä¸€ä¸ªç¥å¥‡çš„åœ°æ–¹ï¼Œç”¨çš„æ˜¯ä¸€ä¸ª windows2000 çš„ç³»ç»Ÿç•Œé¢ä½†æ˜¯æ‰«é›·ç¡®æ˜¯ win7 çš„æ ·å¼, \n\n<!--more-->\n\n![pic1](ç®€æ˜“æ‰«é›·å°æ¸¸æˆ/pic1.jpg)\n\nè¿™ç§æƒ…å†µï¼Œå°±æ˜¯è€ƒéªŒè¿æ°”çš„æ—¶å€™äº†ï¼Œä½†æ˜¯æœä¸å…¶ç„¶ã€‚ã€‚ã€‚\n\n![pic2](ç®€æ˜“æ‰«é›·å°æ¸¸æˆ/pic2.jpg)\n\næˆ‘æˆåŠŸé€‰æ‹©äº†æœ‰ç‚¸å¼¹çš„é‚£ä¸€ä¸ªï¼Œä»è¿™é‡Œé¢æˆ‘æ˜ç™½äº†ä¸€ä¸ªé“ç†ï¼Œé‚£å°±æ˜¯ï¼š**æˆåŠŸéœ€è¦ 99% çš„åŠªåŠ›å†åŠ ä¸Š 1% çš„è¿æ°”**ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚\n\n## åŸç†(æ€è·¯)\n\n### å¸ƒå±€\n\nç©äº†å‡ å¥ææ¸…äº†æ¸¸æˆè§„åˆ™ï¼Œå°±æƒ³è‡ªå·±åŠ¨æ‰‹åšä¸€ä¸ªï¼Œå› ä¸ºä»¥å‰åšè¿‡ 2048ï¼Œæ‰€ä»¥é¦–å…ˆæƒ³åˆ°çš„å°±æ˜¯ç”¨äºŒç»´æ•°ç»„å¸ƒå±€\n\næ·»åŠ ä¸‰ä¸ªéš¾åº¦çš„æŒ‰é’®\n\n```html\n<a class=\"type\" href=\"#\" data-width=\"9\" data-height=\"9\" data-mine=\"10\">ç®€å•</a>\n<a class=\"type\" href=\"#\" data-width=\"16\" data-height=\"16\" data-mine=\"40\">ä¸­çº§</a>\n<a class=\"type\" href=\"#\" data-width=\"30\" data-height=\"16\" data-mine=\"99\">é«˜çº§</a>\n```\n\nç‚¹å‡»ç›¸åº”æŒ‰é’®é€šè¿‡ js è·å–å¯¹åº”çš„ `data` å±æ€§,ç„¶ååŠ¨æ€çš„ç”Ÿæˆç›¸åº”çš„æ–¹æ ¼,ç„¶ååŠ¨æ€è®¡ç®—åŒ…è£¹æ‰€æœ‰å°æ–¹æ ¼çš„å®½åº¦å’Œé«˜åº¦,ä¸ºäº†ä»¥åæ–¹ä¾¿æ“ä½œæ¯ä¸€ä¸ªå°æ–¹æ ¼,ç»™æ¯ä¸€ä¸ªå°æ–¹æ ¼æŒ‰è¡Œåˆ—æ·»åŠ ç‹¬æœ‰çš„ `id`ã€‚\n\n### ç›’å­å¯¹è±¡\n\n#### å±æ€§\n\nå› ä¸ºæ‰«é›·æ˜¯å¯¹æ¯ä¸ªæ ¼å­è¿›è¡Œæ“ä½œï¼Œå› æ­¤æˆ‘æŠŠæ¯ä¸ªæ ¼å­éƒ½çœ‹æˆä¸€ä¸ªç‹¬ç«‹çš„ä¸ªä½“ï¼Œè¿™ä¸ªä¸ªä½“å…·æœ‰å±æ€§å’Œæ–¹æ³•ï¼Œå°±ç›¸å½“äºä¸€ä¸ªå°å¯¹è±¡ã€‚å®šä¹‰äº†ä¸¤ä¸ªæ•°ç»„\n\n```js\n// ä»£è¡¨ç›’å­èº«ä»½çš„æ•°ç»„\nvar boxArr = []\n// ç”¨äºå­˜å‚¨å‘¨å›´å…«ä¸ªæ ¼å­ä¸­é›·çš„ä¸ªæ•°\nvar MineArr = []\n```\n\né€šè¿‡è¿™ä¸¤ä¸ªæ•°ç»„,æˆ‘å¯ä»¥çŸ¥é“æ¯ä¸ªæ ¼å­æ˜¯å¦æ˜¯ç‚¸å¼¹,è¿˜æœ‰æ¯ä¸ªæ ¼å­å‘¨å›´å¯¹åº”å…«ä¸ªæ ¼å­ä¸­æœ‰å¤šå°‘ä¸ªç‚¸å¼¹ï¼Œè¿™å±äºæ ¼å­å¯¹è±¡çš„å±æ€§ã€‚\n\n#### æ–¹æ³•\n\nç›’å­å¯¹è±¡è¿˜æœ‰é¼ æ ‡æŒ‰ä¸‹å’ŒæŠ¬èµ·çš„æ–¹æ³•ï¼Œè¿™é‡Œè¦æ³¨æ„ï¼Œä¸è¦ç»™æ¯ä¸ªç›’å­éƒ½æ·»åŠ äº‹ä»¶ã€‚å‡è®¾æœ‰ 100 ä¸ªç›’å­çš„è¯ï¼Œå°±è¦æ·»åŠ  100 ä¸ªäº‹ä»¶ï¼Œäº‹å®ä¸Šé«˜çº§éš¾åº¦ä¸‹çš„ç›’å­è¯è¿˜æœ‰æ›´å¤šï¼Œè¿™æ ·å°±ä¸å¦‚åœ¨ `container` ä¸Šç»‘å®šäº‹ä»¶ï¼Œåˆ©ç”¨å†’æ³¡ã€‚ä¹Ÿå¯ä»¥å®ç°ç›¸åŒçš„æ•ˆæœï¼Œå¹¶ä¸”åªéœ€è¦ç»‘å®šä¸€ä¸ªäº‹ä»¶\n\n```js\ncontainer.on('mousedown', '.box', function (e) {\n  $(e.target)//è·å–ç‚¹å‡»åˆ°çš„classä¸ºboxçš„å…ƒç´ \n}\n```\n\næœ‰çš„æ—¶å€™æ ¼å­çš„ `MineArr` é‡Œé¢å­˜çš„å¯èƒ½æ˜¯ 0 ,è¿™å°±ä»£è¡¨ä»–å‘¨å›´ 8 ä¸ªæ–¹æ ¼ä¸å­˜åœ¨ç‚¸å¼¹,åƒè¿™ç§çš„è¯å°±ç›´æ¥å°†å…¶å‘¨å›´çš„å…«ä¸ªæ ¼å­ç›´æ¥è‡ªåŠ¨ç‚¹å¼€å°±å¥½äº†,ä¸‹é¢è¿™å¹…å›¾ï¼Œæˆ‘åªç‚¹äº†ä¸€ä¸‹,å°±æ˜¯ç‚¹åˆ°äº† `MineArr[i][j]==0` çš„æ ¼å­,ç„¶åè®©ä»–å‘¨å›´å…«ä¸ªç›´æ¥æ˜¾ç¤º `MineArr` ä¸­çš„æ•°å€¼,å¦‚æœå‘¨å›´å…«ä¸ªæ ¼å­è¿˜æœ‰ `MineArr[i][j]==0` çš„æƒ…å†µï¼Œå°±ç»§ç»­æ‰“å¼€å»æ˜¾ç¤ºã€‚\n\n![pic3](ç®€æ˜“æ‰«é›·å°æ¸¸æˆ/pic3.png)\n\næ‰«é›·ä¸­è¿˜æœ‰ä¸€ä¸ªä¸€å®šè¦æœ‰çš„æ–¹æ³•å°±æ˜¯å·¦å³é”®ä¸€èµ·æŒ‰ä¸€ä¸ªç‚¹å¼€çš„æ ¼å­ï¼Œä¼šè‡ªåŠ¨åˆ¤æ–­å‘¨å›´æ ¼å­ä¸­ä½ æ ‡è®°é›·çš„ä¸ªæ•°å’Œä½ ç‚¹å‡»çš„è¿™ä¸ªæ ¼å­çš„æ•°å€¼ã€‚å¦‚æœä½ æ ‡è®°é›·çš„ä¸ªæ•°ç­‰äºå·¦å³é”®ç‚¹å‡»çš„æ ¼å­ä¸­çš„æ•°å€¼ï¼Œä»–ä¼šè‡ªåŠ¨å¸®ä½ ç‚¹å¼€å‰©ä¸‹çš„è¿˜æ²¡ç‚¹å‡»è¿‡çš„æ ¼å­ï¼Œè¿™äº›æ ¼å­ä¸­å¯èƒ½æœ‰é›·ä¹Ÿå¯èƒ½æ²¡é›·ï¼Œè¿™è¦çœ‹ä½ è‡ªå·±æ ‡è®°çš„é›·æ˜¯ä¸æ˜¯å¯¹çš„ã€‚\n\nè¿™ä¸ªä¹Ÿè›®å¥½å®ç°,å³é”®æŒ‰ä¸‹çš„æ—¶å€™å°†å‘¨å›´æ²¡ç‚¹å‡»è¿‡ä¹Ÿæ²¡è¢«æ ‡è®°è¿‡é›·çš„æ–¹æ ¼æ·»åŠ å¸¦æœ‰åˆ«çš„é¢œè‰²çš„ `class`ï¼Œç„¶åè®°å½•å‘¨å›´å…«ä¸ªæ–¹æ ¼æ ‡è®°çš„é›·çš„ä¸ªæ•°ï¼Œç„¶ååœ¨å³é”®æ¾å¼€çš„æ—¶å€™ç§»é™¤æ­¤ `class`,å¹¶åˆ¤æ–­åˆšè®°å½•çš„æ ‡è®°çš„é›·çš„ä¸ªæ•°å’Œå½“å‰ç‚¹å‡»çš„æ ¼å­çš„æ•°å€¼æ˜¯å¦ç›¸ç­‰ï¼Œç„¶åå»åšä¸‹ä¸€æ­¥å¤„ç†ã€‚\n\n### æˆåŠŸå¤±è´¥åˆ¤æ–­\n\nå¤±è´¥å¾ˆå¥½åˆ¤æ–­ï¼Œç‚¹ä¸­äº† `boxArr` ä¸º 1 çš„æ ¼å­å°±åˆ¤å¤±è´¥ï¼Œå°±æ˜¯ç‚¹ä¸­äº†é›·ã€‚\n\næˆåŠŸçš„è¯æˆ‘æ˜¯é€šè¿‡ç‚¹å‡»å‡ºæ¥çš„æ ¼å­çš„æ•°é‡æ¥åˆ¤æ–­çš„ï¼ŒæˆåŠŸæ˜¾ç°çš„æ ¼å­åªè¦ç­‰äºæ€»æ ¼å­å‡å»é›·çš„æ ¼å­å°±åˆ¤æ–­ä¸ºæ¸¸æˆèƒœåˆ©\n\n## æ€»ç»“\n\nè™½ç„¶æ˜¯ä¸€ä¸ªæ¯”è¾ƒç®€å•çš„æ¸¸æˆï¼Œä½†æ˜¯è‡ªå·±åœ¨åšçš„æ—¶å€™è¿˜æ˜¯ç¢°åˆ°è¿‡ä¸å°‘çš„ bug,ä¹Ÿå­¦åˆ°äº†è›®å¤šçš„,è¿™é‡Œåˆ—ä¸€ä¸‹ã€‚\n\n### æ¸…ç©ºé—®é¢˜\n\n* æ¯æ¬¡åˆ›å»ºæ–°çš„æ ¼å­éƒ½è¦æ¸…ç©ºä¸Šæ¬¡åˆ›å»ºçš„æ‰€æœ‰æ ¼å­\n\n* æˆ‘æ˜¯é‡‡ç”¨å†’æ³¡çš„æ–¹å¼ç»™ç›’å­æ·»åŠ çš„ç‚¹å‡»äº‹ä»¶ï¼Œæ˜¯æ·»åŠ åœ¨ `container` ä¸Šçš„ï¼Œç„¶å `container` æ˜¯ä¸æ¶ˆå¤±çš„ï¼Œæ‰€ä»¥æ¯æ¬¡åˆ›å»ºæ–°æ ¼å­å‰è¿˜è¦å°† `container` ä¸Šçš„äº‹ä»¶è§£ç»‘\n\n### å³é”®\n\nå³é”®åœ¨ç½‘é¡µä¸Šæ˜¯æœ‰é»˜è®¤è¡Œä¸ºçš„ï¼Œåœ¨è¿™ä¸ªæ¸¸æˆä¸­è¦ç¦æ‰\n\n```js\n//å»æ‰é»˜è®¤çš„contextmenuäº‹ä»¶ï¼Œå¦åˆ™ä¼šå’Œé»˜è®¤å³é”®äº‹ä»¶åŒæ—¶å‡ºç°ã€‚\ndocument.oncontextmenu = function(e) {\n  e.preventDefault()\n}\n```\n\n### each()\n\njquery ä¸­çš„ `each` æ˜¯ä¸èƒ½ç”¨ `break` è·³å‡ºçš„ã€‚æ˜¯ç”¨ `return false` ä»£æ›¿çš„ `break`, `return true` æˆ– `return` ä»£æ›¿çš„ `continue`\n\n### æœ€å\n\nè¿˜æœ‰ä¸€äº›æˆ‘æ€è·¯ä¸Šæˆ–è€…è¯´å†™æ³•ä¸­å­˜åœ¨çš„å° bug,æˆ‘ç”¨ç›¸åº”çš„æ–¹æ³•å»è§£å†³æ‰äº†ã€‚å¤§å®¶å¯ä»¥çœ‹[æºç ](https://github.com/MLuminary/subentry/tree/master/cleanMine),å› ä¸ºèŠ±çš„æ—¶é—´æ¯”è¾ƒçŸ­,å¯èƒ½é‡Œé¢è¿˜å­˜åœ¨ä¸€äº›é—®é¢˜,è¿˜è¯·å¤§ä½¬ä»¬å¤šå¤šåŒ…æ¶µ,ä¹Ÿæ¬¢è¿å¤§ä½¬ä»¬æ¥æŒ‡æ­£ã€‚æœ¬å°ç™½æ„Ÿæ¿€ä¸å°½ï¼Œå–œæ¬¢çš„è¯è¿˜è¯·ç‚¹ä¸ª :star:\n\n[å°æ¸¸æˆè¯•ç©](https://www.haoqinzz.cn/cleanMine)\n","tags":["Idea"],"categories":["Fun"]},{"title":"å¯¹è±¡ç±»å‹çš„è¾¨åˆ«","url":"%2F2017%2F08%2F24%2F%E5%AF%B9%E8%B1%A1%E7%B1%BB%E5%9E%8B%E7%9A%84%E8%BE%A8%E5%88%AB%2F","content":"\n> å¯¹è±¡ç±»å‹çš„åˆ¤åˆ«ä¸åŒäºåŸºç¡€ç±»å‹çš„åˆ¤åˆ«ï¼Œjs ä¸­åˆæœ‰ä¸€å¥è¯å«ä¸‡ç‰©çš†å¯¹è±¡ï¼Œ\bå› æ­¤å¯¹è±¡çš„åˆ¤åˆ«å·¥ä½œè¦æ¯”åŸºç¡€æ•°æ®ç±»å‹è¦ç¨å¾®éº»çƒ¦ä¸€ç‚¹\n\n<!--more -->\n\n## åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯ä¸æ˜¯æ•°ç»„ç±»å‹\n\n### typeof\n\nå°‘éƒ¨åˆ†äººå¯èƒ½é¦–å…ˆä¼šæƒ³åˆ° `typeof`\n\n```js\nvar n = 3,\n  b = true,\n  s = 'Hello',\n  x = null,\n  y,\n  obj1 = function() {},\n  obj2 = {},\n  obj3 = [],\n  obj4 = new Date();\nconsole.log(\n  typeof n, //number\n  typeof b, //boolean\n  typeof s, //string\n  typeof x, //object\n  typeof y, //undefined\n  typeof obj1, //function\n  typeof obj2, //object\n  typeof obj3, //object\n  typeof obj4 //object\n)\n```\n\nå¯ä»¥çœ‹å‡º `typeof` æ˜¯å¯ä»¥åˆ¤æ–­å‡ºåŸºæœ¬æ•°æ®ç±»å‹çš„ï¼Œå‡½æ•°ä¹Ÿèƒ½åˆ¤æ–­å‡ºæ¥ï¼Œä½†æ˜¯å¯¹è±¡ã€æ•°ç»„ã€æ—¥æœŸéƒ½ä¼šè¿”å› `object` ,è¿™æ ·å°±æ ¹æœ¬æ— æ³•åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯ä¸æ˜¯æ•°ç»„ç±»å‹ã€‚æ‰€ä»¥ `typeof` å®£å‘Šæ— èƒ½ä¸ºåŠ›\n\n### åˆ¤æ–­å…¶çˆ¶çº§åŸå‹å¯¹è±¡\n\n```js\nvar obj1 = {},\n  obj2 = [1, 2, 3],\n  obj3 = new Date()\n\nconsole.log(obj1.__proto__ === Array.prototype) //false\nconsole.log(obj2.__proto__ === Array.prototype) //true\nconsole.log(obj3.__proto__ === Array.prototype) //false\n```\n\nä½†æ˜¯ `__proto__` æ˜¯å†…éƒ¨å±æ€§ï¼Œæœ¬ä¸åº”è¯¥è¢«è®¿é—®åˆ°ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ `Object.getPrototypeOf(obj)` æ–¹æ³•æ¥ä»£æ›¿ä»–ï¼Œè™½ç„¶è¿™ä¸ªæ–¹æ³•å…¶å®å†…éƒ¨åŸç†ä¹Ÿæ˜¯ä»–ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰ä¸åŒçš„ã€‚\n\n```js\nconsole.log(Object.getPrototypeOf(obj1) === Array.prototype) //false\nconsole.log(Object.getPrototypeOf(obj2) === Array.prototype) //true\nconsole.log(Object.getPrototypeOf(obj3) === Array.prototype) //false\n```\n\n### åˆ¤æ–­å…¶æ„é€ å‡½æ•°\n\n`obj instanceof Array` åˆ¤æ–­ `obj` æ˜¯ä¸æ˜¯è¢«æ„é€ å‡½æ•° `Array` åˆ›é€ å‡ºæ¥çš„\n\n```js\nconsole.log(obj1 instanceof Array) //false\nconsole.log(obj2 instanceof Array) //true\nconsole.log(obj3 instanceof Array)\t//false\n```\n\nä½† `instanceof` ä¸ä»…åˆ¤æ–­ç›´æ¥çˆ¶ç±»å‹ï¼Œè€Œæ˜¯æ‰€æœ‰åœ¨åŸå‹é“¾ä¸Šçš„ç±»å‹ï¼Œéƒ½è¿”å› `true` ,æ‰€ä»¥å¦‚æœä½ åˆ›å»ºä¸€ä¸ªå¯¹è±¡ä½†æ˜¯æŠŠä»–çš„ `__proto__` æŒ‡å‘ `Array` çš„åŸå‹ï¼Œç„¶ååˆ¤æ–­å…¶ç±»å‹ï¼Œä¹Ÿä¼šè¿”å› `true`ã€‚\n\n```js\nobj1.__proto__ = Array.prototype\nconsole.log(obj1 instanceof Array) //true\n```\n\n\n### åˆ¤æ–­å¯¹è±¡å†…éƒ¨çš„ class å±æ€§\n\næ¯ä¸ªå¯¹è±¡å†…éƒ¨ï¼Œéƒ½æœ‰ä¸€ä¸ªéšè—çš„ `class` å±æ€§ï¼Œè®°å½•è¯¥å¯¹è±¡åˆ›å»ºæ—¶çš„æ•°æ®ç±»å‹ `class` å±æ€§ä¸ä¼šéšç»§æ‰¿å…³ç³»çš„æ”¹å˜è€Œæ”¹å˜ã€‚ï¼ˆå°±ç›¸å½“äºæŸ¥äººçš„ DNAï¼Œå°æ ·è¿˜æƒ³ä¼ªè£…ï¼‰\n\nè¿™é‡Œæœ‰ä¸€ä¸ªé—®é¢˜ï¼šå†…ç½®ç±»å‹çš„åŸå‹å¯¹è±¡ä¸­å‡ ä¹éƒ½é‡å†™äº†æ–°çš„ `toString()`ï¼Œåªæœ‰æœ€é¡¶å±‚çš„ `toString()` æ‰èƒ½è¾“å‡ºå¯¹è±¡çš„ `class` å±æ€§å€¼ï¼Œ\n\nå› æ­¤æˆ‘ä»¬å¯ä»¥ç”¨ `call` æ¥ä½¿ç”¨æœ€ç‰›çš®çš„èº«ä»½é‰´åˆ«\n\n```js\nconsole.log(\n  Object.prototype.toString.call(obj1) === /*[object Object]*/ '[object Array]'\n) //false\nconsole.log(\n  Object.prototype.toString.call(obj2) === /*[object Array]*/ '[object Array]'\n) //true\nconsole.log(\n  Object.prototype.toString.call(obj3) === /*[object Date]*/ '[object Array]'\n) //false\n```\n\n### Array.isArray\n\n`Array.isArray` ä¹Ÿå¯ä»¥å¼¥è¡¥ `typeof` çš„ä¸è¶³\n\n```js\nArray.isArray(obj1) //false\nArray.isArray(obj2) //true\nArray.isArray(obj3) //false\n```\n\nä½†å…¶å® `isArray` çš„åŸç†å°±æ˜¯åˆ¤åˆ«å…¶å†…éƒ¨çš„ `class` \n\n```js\nif (!Array.isArray) {\n  Array.isArray = function(arg) {\n    return Object.prototype.toString.call(arg) === '[object Array]'\n  }\n}\n// -- æ¥è‡ª MDN\n```\n\n\n","tags":["Base"],"categories":["Explore"]},{"title":"å›¾è§£ä½œç”¨åŸŸåŠé—­åŒ…","url":"%2F2017%2F08%2F20%2F%E5%9B%BE%E8%A7%A3%E4%BD%9C%E7%94%A8%E5%9F%9F%E5%8F%8A%E9%97%AD%E5%8C%85%2F","content":"\n> ç½‘ç»œä¸Šå…³äºä½œç”¨åŸŸåŠé—­åŒ…çš„æ–‡ç« å¾ˆå¤šï¼Œè‡ªå·±å¯¹äºçº¯ç†è®ºçŸ¥è¯†å¹¶ä¸èƒ½å¾ˆå¿«çš„ç†è§£ï¼Œä½†è‡ªå·±å¯¹äºå›¾ç”»æœ‰å¾ˆå¼ºçš„è®°å¿†èƒ½åŠ›ï¼Œå› æ­¤å†³å®šå°†æ­¤çŸ¥è¯†ç‚¹ä»¥å›¾ç”»çš„çŸ¥è¯†è¡¨ç°å‡ºæ¥ï¼ŒåŠ æ·±è‡ªèº«ç†è§£çš„åŒæ—¶å¦‚æœèƒ½å¸®åˆ°æ­£åœ¨å­¦ä¹ çš„ç«¥é‹å°±å†å¥½ä¸è¿‡äº†, <br> ä¸‹é¢æˆ‘ä»¥å‡½æ•°çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸæ¥è¯‰è¯´æ­¤éƒ¨åˆ†çŸ¥è¯†\n\n<!--more-->\n\n## å‡½æ•°ç”Ÿå‘½å‘¨æœŸ\n\nå…ˆå†™ä¸€ä¸‹ç¤ºä¾‹ä»£ç \n\n```js\nvar a = 10 \nfunction func(a) {\n  var a = 20 \n  a++ \n  console.log(a) \n}\nfunc() \nconsole.log(a) \n```\n\n### å¼€å§‹æ‰§è¡Œç¨‹åºå‰\n\n![pic2](å›¾è§£ä½œç”¨åŸŸåŠé—­åŒ…/pic2.jpg)\n\n1.  å…ˆåˆ›å»º ECSï¼ŒECS å…¶å®å°±æ˜¯ä¸“é—¨ä¿å­˜æ­£åœ¨è°ƒç”¨çš„å‡½æ•°çš„æ‰§è¡Œç¯å¢ƒçš„æ•°ç»„ï¼Œä¹Ÿå¯ä»¥è¯´å¯¹è±¡ï¼Œå…¶å®å…³è”æ•°ç»„ä¹Ÿå°±ç›¸å½“äºå¯¹è±¡ã€‚\n\n2.  ç„¶ååœ¨ ECS ä¸­æ·»åŠ æµè§ˆå™¨ä¸»ç¨‹åºçš„æ‰§è¡Œç¯å¢ƒ main\n\n3.  åˆ›å»ºå…¨å±€ä½œç”¨åŸŸå¯¹è±¡ window\n\n4.  main æ‰§è¡Œç¯å¢ƒå¼•ç”¨ window\n\n### å®šä¹‰å‡½æ•°æ—¶\n\n![pic3](å›¾è§£ä½œç”¨åŸŸåŠé—­åŒ…/pic3.jpg)\n\n1.  åŸå§‹ç±»å‹çš„å…¨å±€å˜é‡ä¼šç›´æ¥å­˜å…¥ window ç¯å¢ƒå½“ä¸­ï¼Œå› ä¸ºå‡½æ•°æ˜¯å¼•ç”¨ç±»å‹ï¼Œæ‰€ä»¥é¦–å…ˆç”¨å‡½æ•°åå£°æ˜å…¨å±€å˜é‡\n\n2.  ç„¶ååˆ›å»ºå‡½æ•°å¯¹è±¡ï¼Œå°è£…å‡½æ•°å®šä¹‰\n\n3.  å‡½æ•°å¯¹è±¡çš„ scope å±æ€§ï¼ŒæŒ‡å›å‡½æ•°åˆ›å»ºæ—¶çš„ä½œç”¨åŸŸï¼Œæ„æ€æ˜¯ï¼Œå‡½æ•°æ‰§è¡Œæ—¶å¦‚æœå‡½æ•°æœ¬èº«æä¾›çš„å˜é‡ä¸èƒ½è®©å‡½æ•°æ‰§è¡Œå®Œå…¨ï¼Œé‚£å®ƒä¾¿ä¼šå»å›å®ƒåˆ›å»ºæ—¶çš„é‚£ä¸ªä½œç”¨åŸŸå»å¯»æ‰¾å˜é‡ã€‚\n\n4.  å‡½æ•°ååé¢å­˜å…¥æŒ‡å‘å‡½æ•°å¯¹è±¡çš„åœ°å€\n\nå¼•ç”¨ç±»å‹åœ¨å…¶ä¸­åªèƒ½å­˜å‚¨åœ°å€ï¼Œè¿™ä¸ªåœ¨æ­¤ç¬”è®°[è°ˆè°ˆå€¼ä¼ é€’](https://github.com/MLuminary/Blog/issues/1)ä¸­æœ‰è¯¦ç»†è¯´æ˜\n\n### å‡½æ•°è°ƒç”¨æ—¶\n\n![pic4](å›¾è§£ä½œç”¨åŸŸåŠé—­åŒ…/pic4.jpg)\n\n1.  å‘ ECS ä¸­å‹å…¥æœ¬æ¬¡å‡½æ•°è°ƒç”¨çš„æ‰§è¡Œç¯å¢ƒå…ƒç´ \n\n2.  åˆ›å»ºæœ¬æ¬¡å‡½æ•°è°ƒç”¨æ—¶ä½¿ç”¨çš„å‡½æ•°ä½œç”¨åŸŸå¯¹è±¡ï¼ˆAOï¼‰ï¼Œä¹Ÿå°±æ˜¯ä¸´æ—¶ä½œç”¨åŸŸ\n\n3.  åœ¨ AO ä¸­åˆ›å»ºå‚¨å­˜æ‰€æœ‰çš„å±€éƒ¨å˜é‡ï¼ŒåŒ…æ‹¬å½¢å‚å˜é‡å’Œå‡½æ•°å†…ç”¨ var å£°æ˜çš„å˜é‡\n\n4.  è®¾ç½® AO çš„ parent å±æ€§å’Œå¼•ç”¨å‡½æ•°çš„ scope å±æ€§æŒ‡å‘çˆ¶çº§ä½œç”¨åŸŸå¯¹è±¡\n\n5.  å‡½æ•°çš„æ‰§è¡Œç¯å¢ƒå¼•ç”¨ AO\n\n6.  é¡ºç€é‚£ä¸ªç®­å¤´ï¼Œå…ˆåœ¨ AO ä¸­æ‰¾å˜é‡ï¼Œä¹Ÿå°±æ˜¯å±€éƒ¨å˜é‡ï¼Œå¦‚æœ AO ä¸­æ²¡æœ‰ï¼Œå†é¡ºç€ç®­å¤´å»çˆ¶çº§ä½œç”¨åŸŸä¸­æ‰¾\n\n### å‡½æ•°è°ƒç”¨å\n\n![pic5](å›¾è§£ä½œç”¨åŸŸåŠé—­åŒ…/pic5.jpg)\n\nå‡½æ•°çš„æ‰§è¡Œç¯å¢ƒå‡ºæ ˆï¼ŒAO é‡Šæ”¾ï¼ŒAO ä¸­çš„å±€éƒ¨å˜é‡ä¸€åŒè¢«é‡Šæ”¾æ‰ã€‚\n\næˆ‘ä»¬å¾—çŸ¥æ•´ä¸ªç»“æœä¹‹åï¼Œè‡ªç„¶è€Œç„¶é‚£ä¸¤ä¸ª `console` çš„ç»“æœä¹Ÿæ˜¾ç„¶æ„è§ã€‚\n\n## é—­åŒ…\n\nå‰é¢æˆ‘ä»¬æåˆ°è¿‡ï¼Œå…¨å±€å˜é‡æ˜¯å¯é‡ç”¨ä½†æ˜¯æ±¡æŸ“å…¨å±€ï¼Œå±€éƒ¨å˜é‡ä¸ä¼šæ±¡æŸ“å…¨å±€ä½†æ˜¯ä¸å¯é‡ç”¨ã€‚\n\næˆ‘è‡ªå·±è®¤ä¸ºé—­åŒ…å°±æ˜¯é‡ç”¨å˜é‡åˆä¿æŠ¤å˜é‡ä¸è¢«æ±¡æŸ“çš„æœºåˆ¶ï¼Œå°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸€æƒ…å†µè€Œç”Ÿçš„ã€‚\n\n### ç‰¹ç‚¹\n\n**åŒ…è£¹å—ä¿æŠ¤çš„å˜é‡å’Œæ“ä½œå˜é‡çš„å†…å±‚å‡½æ•°çš„å¤–å±‚å‡½æ•°**\n\n**å¤–å±‚å‡½æ•°è¦è¿”å›å†…å±‚å‡½æ•°çš„å¯¹è±¡**\n\n* `return function(){..}`\n* ç›´æ¥ç»™å…¨å±€å˜é‡èµ‹å€¼ä¸€ä¸ªå†…éƒ¨ `function`\n* å°†å†…éƒ¨å‡½æ•°ä¿å­˜åœ¨ä¸€ä¸ªå¯¹è±¡çš„å±æ€§æˆ–æ•°ç»„å…ƒç´ ä¸­ `return [function function function]` æˆ– `return {fun:function(){...}}`\n\n**è°ƒç”¨å¤–å±‚å‡½æ•°ï¼Œç”¨å¤–éƒ¨å˜é‡æ¥ä½è¿”å›çš„å†…å±‚å‡½æ•°å¯¹è±¡,å½¢æˆé—­åŒ…ã€‚**\n\n### åŸç†\n\nå…ˆè´´å‡ºç¤ºä¾‹ä»£ç \n\n```js\nfunction outer() {\n  var num = 1 \n  return function() {\n    console.log(num++) \n  } \n}\n\nvar getNum = outer() \ngetNum() \ngetNum() \nnum = 1 \ngetNum() \n```\n\nä¸‹é¢æˆ‘æŠŠé—­åŒ…å½¢æˆçš„åŸç†ç”¨ç”»å›¾å·¥å…·ç”»å‡ºæ¥\n\n![pic6](å›¾è§£ä½œç”¨åŸŸåŠé—­åŒ…/pic6.jpg)\n\nwindow ä¸­å­˜å…¥ outer åå¹¶æŒ‡å‘ outer å‡½æ•°å¯¹è±¡ï¼Œ`getNum` å› ä¸ºå£°æ˜æå‰ä¹Ÿå…ˆå°†å˜é‡åå­˜åœ¨ window ä¸­ã€‚\n\n`getNum = outer()` å…¶å®åŒ…å« outer çš„åˆ›å»ºå’Œ `getNum` çš„èµ‹å€¼ã€‚\n\nä¸Šé¢çš„å›¾ç”»çš„æ˜¯ outer å‡½æ•°è¿›è¡Œåˆ° `var num = 1 ` ,å‰é¢éƒ½æœ‰è¯´è¿‡ï¼Œä¸è¿‡å¤šé‡å¤ã€‚\n\n![pic7](å›¾è§£ä½œç”¨åŸŸåŠé—­åŒ…/pic7.jpg)\n\nåˆ›å»ºäº†åŒ¿åå‡½æ•°ï¼Œ`getNum` æŒ‡å‘äº†åŒ¿åå‡½æ•°å¯¹è±¡ï¼ŒåŒ¿åå¯¹è±¡çš„ scope æŒ‡å‘å®ƒçš„çˆ¶çº§ä½œç”¨åŸŸï¼Œä¹Ÿå°±æ˜¯ outer çš„ä½œç”¨åŸŸï¼Œé‚£è¿™æ ·å°±å½¢æˆäº†å›¾ä¸­çš„ä¸‰è§’å…³ç³»ï¼Œæ­¤æ—¶ outer æ‰§è¡Œå®Œæ¯•ï¼Œç¦»å¼€ ECS æ‰§è¡Œç¯å¢ƒï¼Œouter çš„ AO æœ¬ä¹Ÿåº”è¯¥éšç€ç¦»å¼€ï¼Œ**ä½†æ˜¯å› ä¸ºè¿™å¼ºå¤§çš„ä¸‰è§’å…³ç³»ï¼Œå¼ºè¡Œæ‹‰ä½ä¸è®©å…¶é‡Šæ”¾**ï¼Œä¹Ÿå°±å½¢æˆäº†æ‰€è°“çš„é—­åŒ…ã€‚\n\n**é‚£å…¶å®é—­åŒ…çš„åŸå› å°±æ˜¯**:å¤–å±‚å‡½æ•°çš„ä½œç”¨åŸŸå¯¹è±¡æ— æ³•é‡Šæ”¾\n\n![pic8](å›¾è§£ä½œç”¨åŸŸåŠé—­åŒ…/pic8.jpg)\n\n`getNum=outer()`getNum å…¶å®å°±æ˜¯ä¸€ä¸ªå‡½æ•°\n\n![pic9](å›¾è§£ä½œç”¨åŸŸåŠé—­åŒ…/pic9.png)\n\nè°ƒç”¨`getNum()`,ä¼šç”Ÿæˆ `getNum` çš„ä¸´æ—¶ä½œç”¨åŸŸ,å›¾ä¸­å¯çœ‹å‡º,`getNum` å…¶å®å°±æ˜¯åœ¨ outer ä¸­çš„åŒ¿åå‡½æ•°ï¼Œæ‰€ä»¥ä»–çš„ parent å°±æŒ‡å‘ outer ç•™ä¸‹çš„ä½œç”¨åŸŸã€‚å½“ä»–æ‰§è¡Œ `console.log(num++)` çš„æ—¶å€™ï¼Œåœ¨ä»–çš„ä½œç”¨åŸŸä¸­æ²¡æœ‰ `num` å˜é‡ä»–å°±ä¼šé¡ºç€ä½œç”¨åŸŸé“¾å»å¯»æ‰¾ï¼Œæœ€ç»ˆåœ¨ outer ä¸­çš„ä½œç”¨åŸŸä¸­æ‰¾åˆ° `num` å¹¶å¯¹å…¶è¿›è¡Œè‡ªåŠ æ“ä½œã€‚**æ‰€ä»¥å½“ä¸‹æ¬¡è°ƒç”¨ getNum çš„æ—¶å€™ num ä¼šä» 2 å¼€å§‹ï¼Œä¸ä¼šæ˜¯ä¸€å¼€å§‹çš„ 1**ã€‚\n\nnum ä¸æ˜¯å…¨å±€å˜é‡ï¼Œè¿˜å®ç°äº† num å˜é‡çš„é‡å¤è°ƒç”¨ã€‚å°±è¾¾åˆ°äº†é—­åŒ…çš„ç›®çš„ã€‚\n\n![pic10](å›¾è§£ä½œç”¨åŸŸåŠé—­åŒ…/pic10.jpg)\n\nè®¾ç½® `num = 1` åªæ˜¯åœ¨ `window` å¯¹è±¡ä¸Šæ·»åŠ å­˜å‚¨ `num` çš„å€¼ï¼Œå½“ä¸‹æ¬¡è°ƒç”¨ `getNum` çš„æ—¶å€™ js å¼•æ“è¿˜ä¼šä» `getNum` ä½œç”¨åŸŸå¼€å§‹é¡ºç€ä½œç”¨åŸŸé“¾å¯»æ‰¾ `num`,åœ¨ outerAO å°±ä¼šå¯»æ‰¾åˆ° `num`,æ‰€ä»¥æ ¹æœ¬ä¸ä¼šå½±å“åˆ° window ä¸­çš„ `num`,ä¹Ÿä¸ä¼šå—å…¶å½±å“ã€‚å› æ­¤æ­¤æ®µä»£ç è¾“å‡ºçš„ç»“æœä¸º `1 2 3`ã€‚\n\n### ç¼ºç‚¹\n\nå½“ç„¶é—­åŒ…ä¹Ÿæœ‰å…¶ç¼ºç‚¹\n\n* æ¯”æ™®é€šå‡½æ•°å ç”¨æ›´å¤šå†…å­˜ï¼Œå› ä¸ºå¤–å±‚å‡½æ•°çš„ä½œç”¨åŸŸå¯¹è±¡ï¼ˆAOï¼‰å§‹ç»ˆå­˜åœ¨\n\n* å®¹æ˜“é€ æˆå†…å­˜æ³„æ¼\n\n### è§£å†³åŠæ³•\n\nå°†å¼•ç”¨å†…å­˜å‡½æ•°å¯¹è±¡çš„å¤–éƒ¨å˜é‡é‡ç½®ä¸º null\n\n```js\ngetNum = null \n```\n\n![pic11](å›¾è§£ä½œç”¨åŸŸåŠé—­åŒ…/pic11.jpg)\n\ngetNum æŒ‡å‘ outer å‡½æ•°å¯¹è±¡çš„é‚£æ ¹çº¿å°±ä¼šæ–­æ‰ï¼Œä¸‰è§’å…³ç³»ç ´è£‚ï¼Œé‚£å‡½æ•°å¯¹è±¡å’Œ outerAO ä¹Ÿä¼šç›¸ç»§è¢«é”€æ¯ã€‚\n\n","tags":["Deep"],"categories":["Explore"]},{"title":"Js å‡½æ•°åŸºç¡€","url":"%2F2017%2F08%2F17%2Fjs%E5%87%BD%E6%95%B0%E5%9F%BA%E7%A1%80%2F","content":"\n> æ¯å¤©éƒ½åœ¨å’Œå‡½æ•°æ‰“äº¤é“ï¼Œåˆ°åº•å‡½æ•°æ˜¯ä¸ªå•¥ï¼Œè¿˜æœ‰å•¥éšè—çš„ç§˜å¯†å—\n\n<!--more -->\n\n## å‡½æ•°çš„å®šä¹‰\n\n**å‡½æ•°å…¶å®å°±æ˜¯ä¸€ä¸ªå°è£…ä¸€æ®µä»£ç æ®µçš„å¯¹è±¡ï¼Œå‡½æ•°åå…¶å®ä»…æ˜¯ç”¨æ¥å¼•ç”¨å‡½æ•°å¯¹è±¡çš„ä¸€ä¸ªæ™®é€šå˜é‡**,å†™ä»£ç çš„æ—¶å€™æˆ‘ä»¬é¿å…ä¸äº†è¦é‡å¤ç”¨ä¸€äº›ä»£ç ï¼Œä¸€ç›´é‡å¤å†™å¾ˆè€—æ—¶ï¼Œè€Œä¸”ä¸ç¾è§‚ä¹Ÿä¸åˆ©äºç»´æŠ¤ï¼Œå› æ­¤å‡½æ•°çš„å‡ºç°å°±æ˜¯æ¥è®©ä»£ç é‡ç”¨ï¼Œä¾¿äºç»´æŠ¤ã€‚ä¸€æ®µå¯èƒ½è¢«åå¤ä½¿ç”¨çš„ä»£ç ï¼Œå°±å¯ä»¥å®šä¹‰ä¸ºå‡½æ•°ï¼Œç„¶åè°ƒç”¨å‡½æ•°æ¥ä½¿ç”¨è¿™æ®µä»£ç ã€‚\n\n## å‡½æ•°çš„åˆ›å»º\n\n**function å£°æ˜**\n\n```js\nfunction å‡½æ•°å(å‚æ•°åˆ—è¡¨) {\n  å‡½æ•°ä½“\n  return è¿”å›å€¼\n}\n```\n\n**ç›´æ¥é‡å£°æ˜**\n\n```js\nvar å‡½æ•°å = function(å‚æ•°åˆ—è¡¨) {\n  å‡½æ•°ä½“\n  return è¿”å›å€¼\n};\n```\n\n**ç”¨ new åˆ›å»º**\n\nå› ä¸º Function æ˜¯å†…ç½®ç±»å‹ï¼Œæœ¬èº«æœ‰ä¸€ä¸ª Function çš„æ„é€ å‡½æ•°ï¼Œæ‰€ä»¥æ˜¯å¯ä»¥ `new` çš„\n\n```js\nvar å‡½æ•°å = new Function(\"å‚æ•°å1\",\"å‚æ•°å2\",...,\"å‡½æ•°ä½“; return è¿”å›å€¼\")\n```\n\nè¿™é‡Œæ³¨æ„ï¼Œå‚æ•°å’Œå‡½æ•°ä½“éƒ½è¦ç”¨å¼•å·å¼•èµ·æ¥ï¼Œä½†æ˜¯ä¸€èˆ¬å‡½æ•°çš„åˆ›å»ºéƒ½ä¸ä¼šè¿™æ ·åˆ›å»ºï¼Œä»¥å‰é¢çš„ä¸¤ç§ä¸ºä¸»ï¼Œé‚£å…¶å®å‰é¢ä¸¤ç§çš„åˆ›å»ºæ˜¯å­˜åœ¨ä¸€å®šçš„å·®åˆ«çš„ï¼Œä¸‹é¢ä¼šæåˆ°\n\n## å‡½æ•°çš„å‚æ•°\n\nå‡½æ•°æ‰§è¡Œæ—¶å¿…é¡»çš„æ•°æ®å˜é‡ï¼Œå®ƒåˆ†ä¸ºã€Œ æ˜¾ç¤ºå‚æ•° ã€(Parameters)ä¸ã€Œ éšå¼å‚æ•° ã€(Arguments)\n\n### æ˜¾ç¤ºå‚æ•°\n\n```js\nfunction fun(name, id) {\n  //å‡½æ•°ä½“\n}\n```\n\nè¿™ç§ç›´æ¥ä¼ è¿›æ¥çš„ `name` å’Œ `id` å°±æ˜¯æ˜¾ç¤ºå‚æ•°ï¼Œä¹Ÿå°±æ˜¯ä½ èƒ½çœ‹åˆ°çš„ã€‚å…¶å®å‡½æ•°ä¼ é€’çš„å‚æ•°å°±ç›¸å½“äº**åœ¨å‡½æ•°ä½“å†…åˆå£°æ˜äº†ä¸€ä¸ªå±€éƒ¨å˜é‡**\n\n```js\nvar i = 10\nfunction fun(i) {\n  i++\n  console.log(i)\n}\nfun(i)\n```\n\nä¸Šé¢çš„ä»£ç ï¼Œå°±ç›¸å½“äºä¸‹é¢çš„ä»£ç \n\n```js\nvar i = 10\nfunction fun() {\n  var i = 10 //è¿™ä¸ªå€¼å°±æ˜¯ä¼ è¿›æ¥çš„å‚æ•°çš„å€¼\n  i++\n  console.log(i)\n}\nfun(i) //åœ¨æ­¤å¤„ä¼ å…¥i\n```\n\n### éšå¼å‚æ•°\n\næ¯ä¸ª JavaScript å‡½æ•°å†…éƒ¨éƒ½æœ‰ä¸€ä¸ªå¯¹è±¡ `arguments` å¯¹è±¡,å…¶å®æ˜¯ä¸€ä¸ªç±»æ•°ç»„çš„å¯¹è±¡,å®ƒä¼šè‡ªåŠ¨æ¥å—æ‰€æœ‰ä¼ å…¥å‡½æ•°çš„å‚æ•°å€¼ã€‚\n\n```js\nfunction func(          ) {\n  //arguments[          ]\n}\n```\n\nå€¼å¾—ä¸€è¯´çš„æ˜¯, `arguments` æœ‰ä¸‹æ ‡æœ‰é•¿åº¦ï¼Œå¯ä»¥é€šè¿‡ä¸‹æ ‡æ¥è·å¾—ä¼ å…¥çš„å‚æ•°ï¼Œæ¯”å¦‚ `arguments[0]` å°±æ˜¯ç¬¬ä¸€ä¸ªå‚æ•°, `length` å°±å¯ä»¥éå†è¿™ä¸ªç±»æ•°ç»„å¯¹è±¡ï¼Œä½†æ˜¯ï¼Œæ¯•ç«Ÿä»–ä¸æ˜¯æ•°ç»„ï¼Œæ‰€ä»¥ä¸èƒ½è¿›è¡Œä¸€äº›æ•°ç»„ç‰¹æœ‰çš„æ“ä½œï¼Œæ¯”å¦‚ `sort`\n\n## å£°æ˜æå‰\n\nåœ¨å¼€å§‹æ‰§è¡Œç¨‹åºå‰,js å¼•æ“ä¼šé¦–å…ˆæŸ¥æ‰¾ `var` å£°æ˜çš„å˜é‡å’Œ `function` å£°æ˜çš„å‡½æ•°ï¼Œ**å°†å…¶æå‰åˆ°å½“å‰ä½œç”¨åŸŸçš„é¡¶éƒ¨é›†ä¸­åˆ›å»ºï¼Œè€Œå°†èµ‹å€¼æ“ä½œä¿ç•™åœ¨åŸåœ°**,è¿™é‡Œç‰¹åˆ«è¯´ä¸€ä¸‹, **æœªç”¨ `var` å£°æ˜çš„å˜é‡ä¸ä¼šå£°æ˜æå‰**.\n\n```js\nconsole.log(a) //a is not defined\na = 10\n```\n\n```js\nconsole.log(a) //undefined\nvar a = 10\nconsole.log(a) //10\n```\n\nå› ä¸ºå£°æ˜æå‰,å…¶å®ä»£ç ä¼šå˜æˆä¸‹é¢è¿™ä¸ªæ ·å­\n\n```js\nvar a\nconsole.log(a)\na = 10\nconsole.log(a)\n```\n\nè¿™æ ·çœ‹ï¼Œä¸€åˆ‡éƒ½å˜å¾—å¾ˆåˆç†ã€‚ã€‚\n\nå‡½æ•°ä¹Ÿæ˜¯ä¸€æ ·\n\n```js\nfunction fun() {\n  console.log(1)\n}\nfun() //2\nfunction fun() {\n  console.log(2)\n}\nfun() //2\n```\n\næ§åˆ¶å°ä¼šè¾“å‡ºä¸¤ä¸ª `2`,å› ä¸º `function` å£°æ˜çš„å‡½æ•°ä¹Ÿä¼šå£°æ˜æå‰,ä»£ç å…¶å®æ˜¯ä¸‹é¢è¿™ä¸ªæ ·å­\n\n```js\nfunction fun() {\n  console.log(1)\n}\nfunction fun() {\n  console.log(2)\n}\nfun() //2\nfun() //2\n```\n\nç¬¬äºŒæ¬¡å£°æ˜å› ä¸ºä¸ç¬¬ä¸€æ¬¡å£°æ˜æ–¹æ³•åå­—ä¸€æ ·ï¼Œåè€…è¦†ç›–äº†å‰è€…ï¼Œæ‰€ä»¥å†è°ƒç”¨çš„æ—¶å€™å°±ä¼šè°ƒç”¨æœ€åè¿™ä¸ª\n\nä½†æ˜¯å£°æ˜æå‰ä¼šå¢åŠ ç¨‹åºè§£è¯»çš„éš¾åº¦ï¼Œå› æ­¤æˆ‘ä»¬åœ¨å†™ç¨‹åºæ—¶ï¼Œå°½é‡é¿å…å£°æ˜æå‰æ‰€å¸¦æ¥çš„å±å®³\n\n### å£°æ˜æå‰çš„è§£å†³æ–¹æ³•\n\né‚£æˆ‘ä»¬æ—¢ç„¶çŸ¥é“ä¼šæœ‰å£°æ˜æå‰è¿™ç§æ“ä½œï¼Œå°±åœ¨å˜é‡å’Œå‡½æ•°çš„å£°æ˜æ—¶éƒ½æ”¾åœ¨å½“å‰ä½œç”¨åŸŸçš„é¡¶éƒ¨ã€‚\n\nåœ¨ ES6 ä¸­ å¯ä»¥ç”¨ `let` ä»£æ›¿ `var`,ä¸è¿‡è¦æ±‚åœ¨å½“å‰ä½œç”¨åŸŸä¸­ `let` å˜é‡ä¹‹å‰ä¸å…è®¸å‡ºç°å£°æ˜çš„å˜é‡, ä¹Ÿå¯ä»¥ç”¨ç›´æ¥é‡å£°æ˜å˜é‡çš„æ–¹æ³•\n\n```js\nvar fun = function() {\n  console.log(1)\n}\nfun() //1\nvar fun = function() {\n  console.log(2)\n}\nfun() //2\n```\n\nè¿™ç§å½“ç„¶ä¹Ÿä¼šå£°æ˜æå‰ï¼Œé‚£æˆ‘ä»¬çœ‹ä¸€ä¸‹å£°æ˜æå‰åçš„ä»£ç \n\n```js\nvar fun\nvar fun\nfun = function() {\n  console.log(1)\n}\nfun() //1\nfun = function() {\n  console.log(2)\n}\nfun() //2\n```\n\nå£°æ˜æå‰ä½†æ˜¯èµ‹å€¼è¿˜æ˜¯ç•™åœ¨åŸåœ°ï¼Œæ‰€ä»¥è™½ç„¶æœ‰å£°æ˜æå‰ï¼Œä½†æ˜¯å¹¶ä¸ä¼šæ”¹å˜æˆ‘ä»¬åŸæœ¬æƒ³è¦çš„ç»“æœã€‚ä¹Ÿå°±è§£å†³äº†å£°æ˜æå‰å¸¦æ¥çš„å±å®³ã€‚\n\n## åŒ¿åå‡½æ•°\n\nå‡½æ•°åˆ›å»ºæ—¶æ²¡æœ‰æŒ‡å®šå‡½æ•°å,åŒ¿åå‡½æ•°ä½¿ç”¨åè‡ªåŠ¨é‡Šæ”¾,ä¼šèŠ‚çº¦å†…å­˜,ä»–ä¼šåˆ’åˆ†ä¸´æ—¶ä½œç”¨åŸŸï¼Œé¿å…å…¨å±€å˜é‡æ±¡æŸ“å…¨å±€ã€‚\n\n### ç”¨å¤„\n\n**callback**\n\nå°†ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ä¼ å…¥å¦ä¸€ä¸ªå‡½æ•°å†…ï¼Œè¢«å…¶ä»–å‡½æ•°è°ƒç”¨\n\nä¸¾ä¸ª:chestnut:\n\n```js\narr.sort(function(a, b) {\n  return a - b\n})\n```\n\n```js\nstr.replace(/reg/g, function(kw,$1,$2,...){return æ›¿æ¢å€¼})\n```\n\n**è‡ªè°ƒ**\n\nå®šä¹‰å‡½æ•°åè‡ªå·±è°ƒç”¨è‡ªå·±ï¼Œè°ƒç”¨ç»“æŸåï¼Œç«‹åˆ»é‡Šæ”¾ï¼Œä¸å å†…å­˜\n\nä¸¾ä¸ª:chestnut:\n\n```js\n(function(å‚æ•°åˆ—è¡¨) {\n  å‡½æ•°ä½“\n  return è¿”å›å€¼\n})(å‚æ•°å€¼åˆ—è¡¨)\n```\n\nä¼šå®šä¹‰ä¸€ä¸ªä¸´æ—¶çš„ä½œç”¨åŸŸï¼Œå‡å°‘ä½¿ç”¨å…¨å±€å˜é‡ï¼Œé¿å…å…¨å±€æ±¡æŸ“ã€‚\n\n## é‡è½½\n\nç›¸åŒå‡½æ•°åï¼Œä¸åŒå‚æ•°åˆ—è¡¨çš„å¤šä¸ªå‡½æ•°ã€‚åœ¨è°ƒç”¨æ—¶ï¼Œæ ¹æ®ä¼ å…¥å‚æ•°çš„ä¸åŒï¼Œè‡ªåŠ¨é€‰æ‹©åŒ¹é…çš„å‡½æ•°æ‰§è¡Œã€‚è¿™æ ·å¯ä»¥å‡å°‘ api çš„æ•°é‡ï¼Œå‡è½»è°ƒç”¨è€…çš„è´Ÿæ‹…ã€‚\n\nå¬èµ·æ¥å¾ˆè¯±äººï¼Œä½†æ˜¯ Js è¯­æ³•ä¸æ”¯æŒé‡è½½ï¼ŒåŸå› æ˜¯ Js ä¸å…è®¸å¤šä¸ªåŒåå‡½æ•°åŒæ—¶å­˜åœ¨ï¼Œåå£°æ˜çš„å‡½æ•°ä¼šè¦†ç›–å‰é¢å£°æ˜çš„,ä½†æ˜¯å¯ä»¥é€šè¿‡æŸäº›æ–¹æ³•å®ç°ï¼Œè¿™ä¸ªæ–¹æ³•å°±æ˜¯åˆ©ç”¨ `arguments`\n\n```js\nfunction test() {\n  if (arguments.length == 0) {\n    //ä¸ä¼ å€¼çš„æ“ä½œ\n  } else if (arguments.length == 1) {\n    //ä¼ ä¸€ä¸ªå€¼è¿›è¡Œçš„æ“ä½œ\n  } else {\n    //....ç­‰ç­‰\n  }\n}\n```\n\nå…¶å®ä¹Ÿä¸æ˜¯çœŸæ­£æ„ä¹‰ä¸Šçš„é‡è½½ï¼Œå› ä¸ºå¹¶æ²¡æœ‰åˆ›å»ºåŒåçš„å¤šä¸ªå‡½æ•°ï¼Œä½†æ˜¯å®ç°çš„æ•ˆæœæ˜¯å’Œé‡è½½å·®ä¸å¤šçš„ã€‚\n","tags":["Base"],"categories":["Explore"]},{"title":"ä½ å¥½ï¼BFC!","url":"%2F2017%2F08%2F09%2F%E4%BD%A0%E5%A5%BD%EF%BC%81BFC%2F","content":"\n> BFC è¿™ä¸ªåå­—å¬è¿‡å¾ˆå¤šæ¬¡äº†ï¼Œæ–‡ç« ä¸­æ€»æ˜¯è¯´è§¦å‘ BFC ç„¶åæ€æ ·æ€æ ·ï¼Œå¼€å§‹çš„æ—¶å€™è§‰å¾— BFC å¾ˆç¥ç§˜ï¼Œåº”è¯¥å¾ˆéš¾ï¼Œå½“æ—¶åªä¸ºè§£å†³çœ¼å‰é—®é¢˜çš„æˆ‘ï¼Œå°±æ²¡æœ‰é€‰æ‹©å»äº†è§£ä¸€ä¸‹ BFCï¼Œåªæ˜¯çŸ¥é“æœ‰ BFC çš„å­˜åœ¨ï¼Œä½†å¹¶ä¸è®¤è¯†ä»–ï¼Œä»Šå¤©ç»ˆäºé¼“èµ·å‹‡æ°”æƒ³ä»–æ‰“ä¸ªæ‹›å‘¼ï¼Œè®¤è¯†è®¤è¯†è¿™ä½çœ‹ä¼¼ç¥ç§˜çš„æœ‹å‹.\n\n<!--more-->\n\n## æ–‡æ¡£æµ\n\næˆ‘ä»¬å¸¸è¯´çš„æ–‡æ¡£æµåˆ†ä¸ºä¸‰ç§ï¼Œæ™®é€šæµï¼Œæµ®åŠ¨æµå’Œå®šä½æµã€‚åœ¨è¿™é‡Œç®€å•çš„ä»‹ç»ä¸€ä¸‹ã€‚  \n\nåœ¨ã€Œæ™®é€šæµã€ä¸­ï¼Œå…ƒç´ æŒ‰ç…§åœ¨ HTML ä¸­çš„å…ˆåä½ç½®è‡³ä¸Šè€Œä¸‹å¸ƒå±€ï¼Œå—çº§å…ƒç´ ä»ä¸Šåˆ°ä¸‹ä¾æ¬¡æ’åˆ—ï¼Œæ¡†ä¹‹é—´çš„å‚ç›´è·ç¦»ç”±æ¡†çš„å‚ç›´ `margin` è®¡ç®—å¾—åˆ°ã€‚è¡Œå†…å…ƒç´ åœ¨ä¸€è¡Œä¸­æ°´å¹³å¸ƒç½®ï¼Œç›´åˆ°å æ»¡ä¸€è¡Œåˆ™æ¢è¡Œ  \n\nã€Œæµ®åŠ¨æµã€å°±æ˜¯å…ƒç´ è¢«è®¾ç½®äº†æµ®åŠ¨å±æ€§ï¼Œä¸€å¼€å§‹è¿˜æ˜¯æŒ‰ç…§æ™®é€šæµå¸ƒå±€ï¼Œä½†æ˜¯ä¼šæ ¹æ®æµ®åŠ¨çš„æ–¹å‘ç§»åŠ¨ã€‚\n\nã€Œå®šä½æµã€å°±æ˜¯è®¾ç½®äº†å®šä½å±æ€§ï¼Œå…ƒç´ å®Œå…¨è„±ç¦»æ™®é€šæµã€‚\n\n## BFC å®šä¹‰\n\nBFC(Block Formating Context),ç›´è¯‘è¿‡æ¥å°±æ˜¯ã€Œ å—çº§æ ¼å¼åŒ–ä¸Šä¸‹æ–‡ ã€(åœ¨ CSS3 ä¸­ï¼ŒBFC å«åš Flow Root)ã€‚FC å°±æ˜¯å…¶å®å°±æ˜¯æ™®é€šæµçš„æ„æ€ï¼Œæ˜¯ä¸€å—æ¸²æŸ“åŒºåŸŸï¼Œæœ‰ä»–çš„æ¸²æŸ“è§„åˆ™ã€‚é‚£ B å°±æ˜¯ block å°±æ˜¯å—çº§å…ƒç´ ã€‚**ç®€å•çš„ç†è§£æ¥è¯´ï¼Œæœ‰ä¸€å—ç‹¬ç«‹çš„æ¸²æŸ“åŒºåŸŸï¼Œåªæœ‰ block å…ƒç´ ï¼Œè¿™äº› block å…ƒç´ æŒ‰ç…§æ­¤æ¸²æŸ“åŒºåŸŸçš„è§„åˆ™å¸ƒå±€ï¼Œå¹¶ä¸”ä¸å—è¿™ä¸ªåŒºåŸŸå¤–éƒ¨çš„å…¶å®ƒå…ƒç´ å½±å“ã€‚**\n\n## BFC çš„è§¦å‘\n\n* æ ¹å…ƒç´ \n* æµ®åŠ¨å…ƒç´ \n* ç»å¯¹å®šä½å’Œå›ºå®šå®šä½\n* display ä¸º inline-block||table-cell||table-caption||flex||inline-flex\n* overflow ä¸æ˜¯ visible\n\næ»¡è¶³ä»¥ä¸Šä»»æ„ä¸€ä¸ªæ¡ä»¶éƒ½å¯ä»¥è§¦å‘ BFCï¼Œè¿™é‡Œæ³¨æ„ä¸€ä¸‹ï¼Œè§¦å‘ BFC ä¸æ˜¯å…ƒç´ æœ¬èº«å˜æˆäº† BFCï¼Œè€Œæ˜¯è¿™ä¸ªå…ƒç´ å¸¦æœ‰äº† BFC çš„è§„åˆ™ã€‚\n\n## BFC çš„è§„åˆ™\n\nä¸ºä»€ä¹ˆè¦è§¦å‘ BFCï¼Œé‚£ BFC åˆ°åº•æœ‰ä»€ä¹ˆè§„åˆ™ï¼Œæœ‰ä»€ä¹ˆå¥½å¤„å‘¢ï¼Ÿ\n\n* Box å‚ç›´æ–¹å‘çš„è·ç¦»ç”± margin å†³å®šã€‚å±äºåŒä¸€ä¸ª BFC çš„ä¸¤ä¸ªç›¸é‚» Box çš„ margin ä¼šå‘ç”Ÿé‡å \n\n* BFC çš„åŒºåŸŸä¸ä¼šä¸ float box é‡å ã€‚\n\n* è®¡ç®— BFC çš„é«˜åº¦æ—¶ï¼Œæµ®åŠ¨å…ƒç´ ä¹Ÿå‚ä¸è®¡ç®—\n\n## ä½œç”¨\n\nå…¶å® BFC å®Œå…¨è´¯å½»çš„ä¸€ç‚¹å°±æ˜¯ï¼Œ**BFC æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„ä¸å—å¤–éƒ¨å½±å“çš„ä¸€ä¸ªæ¸²æŸ“åŒºåŸŸï¼Œä»–ä¹Ÿä¸ä¼šå»å½±å“åˆ«çš„å…ƒç´ ã€‚**ï¼Œè®°ä½å¹¶ç†è§£è¿™å¥è¯ä¹Ÿå°±æ˜¯ç†è§£äº† BFC ï¼Œå› ä¸º BFC çš„ä½œç”¨éƒ½æ˜¯æ ¹æ®è¿™ä¸€è§„åˆ™äº§ç”Ÿçš„\n\n### margin é‡å \n\n```css\n.box {\n  background-color: red;\n  margin: 100px;\n  width: 100px;\n  height: 100px;\n}\n```\n\n```html\n<div class=\"box\">box1</div>\n<div class=\"box\">box2</div>\n```\n\næˆ‘ä»¬çŸ¥é“ä¸¤ä¸ª `box1` å’Œ `box2` çš„ä¸­é—´é—´è·ä¼šå‘ç”Ÿ `margin` é‡å å¹¶åªæœ‰ `100px`,é‚£æ˜¯å› ä¸ºä»–ä»¬åŒåœ¨ html ä¸‹çš„ä¸€ä¸ªå¤§çš„ BFC ä¸­çš„ä¸€ä¸ªæ¸²æŸ“åŒºåŸŸä¸­ï¼Œæˆ‘ä»¬åªè¦è®©ä»–ä»¬ä¸¤ä¸ªçš„ BFC åŒºåŸŸä¸åŒï¼Œä»–ä»¬ä¸¤ä¸ªå°±ä¸ä¼šå‘ç”Ÿ `margin` é‡å .\n\nåœ¨ `box2` æ·»åŠ  div åŒ…è£¹å±‚,ç„¶ååœ¨æ­¤åŒ…è£¹å±‚ä¸­æ·»åŠ ä»»æ„è§„åˆ™å±æ€§ï¼Œå°±ä¼šå‘ç° `margin` é‡å é—®é¢˜å·²ç»è§£å†³.å› ä¸ºæ­¤æ—¶ `box2` èº«å¤„çš„ `BFC` å’Œ `box1` å°±ä¸ç›¸åŒäº†ã€‚\n\n### æ¸…é™¤æµ®åŠ¨\n\nå‰©ä¸‹ä¸¤ä¸ªè§„åˆ™éƒ½ä¸æµ®åŠ¨æœ‰å…³ï¼Œå…¶å®æˆ‘å¬è¯´ BFC è¿™ä¸ªåè¯ä¹Ÿæ˜¯å› ä¸ºæ¸…é™¤æµ®åŠ¨ï¼Œå› ä¸º BFC ä¸èƒ½å½±å“å¤–éƒ¨çš„å¸ƒå±€ï¼Œæ‰€ä»¥è®¡ç®—é«˜åº¦æ—¶ï¼Œæµ®åŠ¨ä¹Ÿå‚åŠ è¿ç®—ï¼Œå› æ­¤å°±è§£å†³äº†é«˜åº¦å¡Œé™·è¿™ä¸ªé—®é¢˜ã€‚\n\n## æ€»ç»“\n\nå‰ç«¯ä¹‹è·¯è¿˜åœ¨ç»§ç»­ï¼Œè®¤è¯†äº† BFC ä»¥åä¹Ÿä¼šå»å¤šå¤šäº†è§£ç£¨åˆã€‚æ€»ä¹‹ç°åœ¨ä¸¥æ ¼è®°ä½çš„ä¸€ç‚¹å°±æ˜¯**ä»–æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„ä¸å½±å“å¤–éƒ¨ä¹Ÿä¸å—å¤–éƒ¨å½±å“çš„åŒºåŸŸï¼Œé‚£å…¶ä»–çš„ç‰¹æ€§éƒ½æ˜¯å»ºç«‹åœ¨æ­¤åŸºç¡€ä¸Šçš„ã€‚**\n","tags":["Base"],"categories":["Explore"]},{"title":"è°ˆè°ˆå€¼ä¼ é€’","url":"%2F2017%2F07%2F25%2F%E8%B0%88%E8%B0%88%E5%80%BC%E4%BC%A0%E9%80%92%2F","content":"\n> ECMAScript å˜é‡å¯èƒ½åŒ…å«ä¸¤ç§ä¸åŒçš„æ•°æ®ç±»å‹ï¼šã€ŒåŸºæœ¬æ•°æ®ç±»å‹ã€å’Œã€Œå¼•ç”¨æ•°æ®ç±»å‹ã€ï¼Œè¿™ä¸¤ç§ç±»å‹çš„**å€¼ä¼ é€’**æ˜¯å­˜åœ¨ä¸åŒçš„.åœ¨æˆ‘ä»¬è°ˆè¿™ä¸¤ç§æ•°æ®ç±»å‹çš„å€¼ä¼ é€’å‰ï¼Œä¸ºäº†ä¾¿äºç†è§£ï¼Œæˆ‘æƒ³é¦–å…ˆè°ˆä¸€ä¸‹è¿™ä¸¤ç§æ•°æ®ç±»å‹æœ‰å…³**å¤åˆ¶**æ“ä½œå­˜åœ¨çš„ä¸åŒ\n\n<!--more -->\n\n## æ•°æ®ç±»å‹çš„å¤åˆ¶\n\n### åŸºæœ¬ç±»å‹\n\n```javascript\nvar num1 = 10 \nvar num2 = num1 \nnum2 = 11 \nconsole.log(num1)  //10\nconsole.log(num2)  //11\n```\n\nåŸºæœ¬æ•°æ®ç±»å‹ä»ä¸€ä¸ªå¤åˆ¶åˆ°å¦ä¸€ä¸ªï¼Œä¼šåœ¨å˜é‡å¯¹è±¡ä¸Š**åˆ›å»º**ä¸€ä¸ªæ–°å€¼ï¼Œç„¶åæŠŠè¯¥å€¼å¤åˆ¶åˆ°æ–°å˜é‡åˆ†é…çš„ä½ç½®ä¸Šï¼Œ**æ”¹å˜å…¶ä¸­ä¸€ä¸ªä¸ä¼šå½±å“å¦ä¸€ä¸ª**ã€‚\n\næœ¬å°ç™½ç”¨æ‹™åŠ£çš„ç”»åŠŸæ¼”ç¤ºä¸€ä¸‹\n\n![pic1](è°ˆè°ˆå€¼ä¼ é€’/pic1.jpg)\n\nä¸€å¼€å§‹å£°æ˜å˜é‡ `num1` å¹¶èµ‹å€¼ä¸º `10`,å®ƒä¾¿ä»¥å›¾ä¸­çš„å½¢å¼å­˜æ”¾åœ¨æ ˆå†…å­˜ä¸­ï¼Œå½“ç”¨ `num1` çš„å€¼æ¥åˆå§‹åŒ– `num2` çš„æ—¶å€™ï¼Œæ­¤æ—¶å°±ç›¸å½“äºå£°æ˜å˜é‡ `num2` å¹¶èµ‹å€¼ä¸º `num1` ä¸­çš„å€¼ï¼Œ**è¯¥å€¼åªæ˜¯ `num1` ä¸­çš„ä¸€ä¸ªå‰¯æœ¬**ï¼Œèµ‹å€¼ç»“æŸï¼Œè¿™ä¸¤ä¸ªå˜é‡ä¾¿å†æ— ç“œè‘›ï¼Œè¿›è¡Œåé¢çš„æ“ä½œä¹Ÿä¸ä¼šç›¸äº’å½±å“\n\n### å¼•ç”¨ç±»å‹\n\nå¼•ç”¨ç±»å‹æˆ‘ä»¬é‡‡ç”¨æ•°ç»„æ¥è®²è§£ï¼Œæ•°ç»„çš„å£°æ˜æœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§ä¸º `var æ•°ç»„å = []` å¦ä¸€ç§ä¸º `var æ•°ç»„å = new array()`\n\n```javascript\nvar arr1 = [1, 2, 3, 4] \nvar arr2 = arr1 \narr2[0] = 10 \nconsole.log(arr1)  //[10,2,3,4]\nconsole.log(arr2)  //[10,2,3,4]\n```\n\nå¯ä»¥çœ‹å‡ºè¾“å‡ºçš„ç»“æœéƒ½ä¸º `[10,2,3,4]`ï¼Œ å’ŒåŸºæœ¬æ•°æ®ç±»å‹å®Œå…¨ä¸åŒã€‚æ•°ç»„çš„å­˜å‚¨æ–¹å¼å¦‚ä¸‹å›¾æ‰€ç¤º\n\n![pic2](è°ˆè°ˆå€¼ä¼ é€’/pic2.jpg)\n\nå½“å£°æ˜æ•°ç»„å˜é‡å¹¶èµ‹å€¼çš„æ—¶å€™ï¼ŒåŒæ ·ä¹Ÿä¼šå­˜å…¥ä¸€ä¸ªæ ˆç»“æ„å½“ä¸­ï¼Œä½†æ˜¯è¿™ä¸ªæ ˆç»“æ„ä¸èƒ½å­˜ `[1,2,3,4]` è¿™ç§å¼•ç”¨ç±»å‹çš„æ•°æ®ï¼Œè¦å­˜åˆ°å †å†…å­˜ä¸­å»ï¼Œå°±æ˜¯å›¾ç‰‡å³è¾¹é‚£ä¸ªåœ†å½¢çš„åŒºåŸŸï¼Œä½†æ˜¯å­˜å…¥çš„æ•°æ®è¿˜æ˜¯è¦æ‰¾åˆ°å®ƒï¼Œå› ä¸ºæ¯ä¸ªå­˜å‚¨ä½ç½®éƒ½æœ‰å…¶ç›¸åº”çš„åœ°å€ï¼Œæ‰€ä»¥å®ƒåœ¨æ ˆå†…å­˜ä¸­å­˜å…¥çš„æ˜¯ä¸€ä¸ªæŒ‡å‘æ•°ç»„å¯¹è±¡æ•°æ®çš„è¿™æ ·çš„ä¸€ä¸ªåœ°å€ã€‚\n\n![pic3](è°ˆè°ˆå€¼ä¼ é€’/pic3.jpg)\n\nå› æ­¤å½“å¤åˆ¶å¼•ç”¨ç±»å‹å˜é‡çš„æ—¶å€™ï¼ŒåŒæ ·ä¹Ÿä¼šå°†**å­˜å‚¨åœ¨æ ˆå†…å­˜ä¸­çš„åœ°å€å€¼å¤åˆ¶ä¸€ä»½æ”¾åˆ°ä¸ºæ–°å˜é‡åˆ†é…çš„ç©ºé—´ä¸­å»ï¼Œåªä¸è¿‡å› ä¸ºè¿™ä¸ªå€¼çš„å‰¯æœ¬æ˜¯ä¸€ä¸ªæŒ‡å‘å †ä¸­åŸæ•°ç»„å¯¹è±¡æ•°æ®çš„åœ°å€ï¼Œä¸¤ä¸ªå˜é‡åå°±ç›¸å½“äºå¼•ç”¨äº†åŒä¸€ä¸ªåœ°å€ä¸­çš„å†…å®¹ã€‚å› æ­¤ï¼Œæ”¹å˜å…¶ä¸­çš„ä¸€ä¸ªï¼Œå°±ç›¸å½“äºæ”¹å˜äº†å¦ä¸€ä¸ª**ã€‚\n\nå†çœ‹ä¸‹é¢è¿™ä¸ª:chestnut:\n\n```javascript\nvar arr3 = [1, 2, 3, 4] \nvar arr4 = arr3 \narr4 = [5, 6, 7, 8] \nconsole.log(arr3)  //[1,2,3,4]\nconsole.log(arr4)  //[5,6,7,8]\n```\n\nè¿™ä¸ªç›¸æ¯”äºå‰é¢é‚£ä¸ªï¼Œåªæ˜¯åœ¨ç¬¬ä¸‰è¡Œä»£ç ä¸­å‡ºç°äº†ä¸åŒï¼Œ`arr4 = []` è¿™æ ·ä¹Ÿæ˜¯åˆ›å»ºæ•°ç»„çš„ä¸€ç§æ–¹å¼ï¼Œå› æ­¤ `arr4 = [5,6,7,8]` å…¶å®æ˜¯å°†ä¸€ä¸ªæ–°åˆ›å»ºçš„æ•°ç»„å¯¹è±¡èµ‹ç»™å˜é‡ `arr4` ,è¿™æ—¶ `arr4` åçš„åœ°å€å°±æ”¹å˜äº†,ä¹Ÿå°±æŒ‡å‘äº†æ–°çš„æ•°ç»„å¯¹è±¡ï¼Œè¿™ä¸¤ä¸ªå˜é‡ä¹Ÿå°±å®Œå…¨ä¸ç›¸åŒäº†.\n\n![pic4](è°ˆè°ˆå€¼ä¼ é€’/pic4.jpg)\n\næ–¹ä¾¿ç†è§£å¯ä»¥çœ‹ä¸‹ä¸‹é¢çš„ä»£ç \n\n```js\nconsole.log(new Array(1,2) === new Array(1,2)) //false\n```\n\né‚£å¥½ï¼Œç°åœ¨æœ‰äº†è¿™äº›é“ºå«ï¼Œæˆ‘ä»¬å†æ¥è°ˆæˆ‘ä»¬ä»Šå¤©çš„ä¸»è¦å†…å®¹.\n\n## æ•°æ®ç±»å‹çš„å€¼ä¼ é€’\n\n### åŸºæœ¬ç±»å‹\n\n```javascript\nvar num = 10 \n\nfunction change(num) {\n  num = 11 \n  console.log(num)  //11\n}\n\nchange(num) \nconsole.log(num)  //10\n```\n\nåœ¨å‘å‚æ•°ä¼ é€’åŸºæœ¬ç±»å‹çš„å€¼æ—¶ï¼Œ**è¢«ä¼ é€’çš„å€¼ä¼šè¢«å…ˆå¤åˆ¶ç»™ä¸€ä¸ªå±€éƒ¨å˜é‡**ï¼Œå…¶å®å°±å¯ä»¥ç†è§£ä¸ºåŸºæœ¬æ•°æ®ç±»å‹çš„èµ‹å€¼ã€‚ä»¥ä¸Šçš„ä»£ç ä¹Ÿå¯ä»¥å†™ä¸ºè¿™æ ·\n\n```javascript\nvar num = 10 \n\nfunction change() {\n  var num = 10  //look\n  num = 11 \n  console.log(num)  //11\n}\n\nchange(num) \nconsole.log(num)  //10\n```\n\nåœ¨ look å¤„ï¼Œå‡½æ•°ä¼šå°†å‚æ•°å…ˆå£°æ˜å¹¶èµ‹å€¼ï¼Œå€¼å°±ä¸ºä¸‹é¢ä¼ å…¥çš„å‚æ•°çš„å€¼ï¼Œ`num` çš„å€¼ä¸º `10`,å› æ­¤èµ‹å¾—å€¼ä¹Ÿä¸º `10`ã€‚ä½†æ­¤æ—¶å‡½æ•°ä¸­çš„ `num` å’Œå‡½æ•°å¤–éƒ¨çš„ `num` å…¶å®æ˜¯æ¯«ä¸ç›¸å…³çš„ï¼Œå› æ­¤å¹¶ä¸ä¼šç›¸äº’å½±å“\n\n### å¼•ç”¨ç±»å‹\n\n```javascript\nvar arr = [1, 2, 3, 4] \n\nfunction change(arr) {\n  arr[0] = 10 \n  console.log(arr)  //[10,2,3,4]\n}\n\nchange(arr) \nconsole.log(arr)  //[10,2,3,4]\n```\n\nå¼•ç”¨ç±»å‹ä¹Ÿå¦‚æ­¤ï¼Œä¹Ÿå¯ä»¥ç†è§£ä¸ºå¼•ç”¨ç±»å‹çš„å¤åˆ¶æ“ä½œï¼Œåœ¨å‡½æ•°çš„å¼€å¤´å°±ä¼šå°† `arr` èµ‹å€¼ä¸ºä¼ æ¥çš„æ•°å€¼ï¼Œè™½ç„¶ä¹Ÿæ˜¯ä¸€å¼€å§‹å£°æ˜çš„å¼•ç”¨ç±»å‹çš„å‰¯æœ¬ï¼Œ**ä½†æ˜¯å› ä¸ºå¼•ç”¨ç±»å‹ä¼ æ¥çš„æ•°å€¼æ˜¯åœ°å€ï¼Œå› æ­¤å‡½æ•°ä¸­çš„ `arr` å’Œå‡½æ•°å¤–é¢çš„ `arr` éƒ½å°†å¼•ç”¨åŒä¸€ä¸ªåœ°å€ä¸­çš„æ•°ç»„å¯¹è±¡**ï¼Œå› ä¸º `arr` æŒ‡å‘çš„æ•°ç»„å¯¹è±¡åœ¨å †ä¸­åªæœ‰ä¸€ä¸ªï¼Œåˆæ˜¯å…¨å±€å˜é‡ï¼Œå› æ­¤è¿™ä¸¤ä¸ª `arr` æ˜¯ç›¸åŒçš„ï¼ŒåŒæ ·æˆ‘ä»¬å†çœ‹é‚£ä¸€ç§å£°æ˜æ•°ç»„å¹¶èµ‹å€¼çš„.\n\n```javascript\nvar arr = [1, 2, 3, 4] \n\nfunction change(arr) {\n  arr = [4, 5, 6, 7] \n  console.log(arr)  //[4,5,6,7]\n}\n\nchange(arr) \nconsole.log(arr)  //[1,2,3,4]\n```\n\né‚£è¿™ä¸ªä¹Ÿå°±åº”è¯¥å¯ä»¥ç†è§£äº†ï¼Œè™½ç„¶åœ¨ä¼ å‚çš„æ—¶å€™ä¼ å…¥çš„ç¡®å®æ˜¯ä¸€å¼€å§‹å£°æ˜çš„æ•°ç»„å¯¹è±¡çš„åœ°å€çš„å‰¯æœ¬ï¼Œä½†æ˜¯å› ä¸ºåœ¨å‡½æ•°å†…éƒ¨åˆ**å£°æ˜äº†ä¸€ä¸ªæ–°çš„æ•°ç»„å¯¹è±¡**ï¼Œåœ¨è¿™é‡Œ `arr` å¼•ç”¨çš„å°±æ˜¯ä¸€ä¸ªå±€éƒ¨çš„æ•°ç»„å¯¹è±¡äº†ï¼Œè€Œè¿™ä¸ªå±€éƒ¨å¯¹è±¡å°±ä¼šåœ¨å‡½æ•°ç»“æŸåç«‹å³è¢«é”€æ¯ï¼Œä¸ä¼šå½±å“å‡½æ•°å¤–éƒ¨çš„æ•°ç»„å¯¹è±¡\n\n","tags":["Base"],"categories":["Explore"]},{"title":"å…³äºcsså®ç°divå±…ä¸­é—®é¢˜","url":"%2F2017%2F07%2F18%2F%E5%85%B3%E4%BA%8Ecss%E5%AE%9E%E7%8E%B0div%E5%B1%85%E4%B8%AD%E9%97%AE%E9%A2%98%2F","content":"\n> è‡ªå·±æœ€è¿‘åœ¨åšæœ‰å…³ css å±…ä¸­æ—¶å‘ç°è‡ªå·±ä¸èƒ½å‡†ç¡®çš„æ‰¾åˆ°å±…ä¸­çš„è§£å†³æ–¹æ¡ˆï¼Œè™½ç„¶æœ€åä¹Ÿèƒ½è¯•å‡ºè§£å†³æ–¹æ¡ˆï¼Œä½†æ˜¯æ„Ÿè§‰å¿…é¡»æ·±å…¥å…¶ä¸­ï¼Œäº†è§£å„ä¸ªå±…ä¸­æ–¹æ¡ˆçš„é€‚ç”¨åœºæ™¯ï¼Œæ‰èƒ½å‡†ç¡®çš„å†™å‡ºä¸å¤šä½™åˆæ­£ç¡®çš„ css ä»£ç \n\n<!--more -->\n\n## ç¤ºä¾‹ä»£ç \n\n```html\n<div class=\"header\">\n  <div class=\"nav\"></div>\n</div>\n```\n\n```css\n* {\n  margin: 0;\n  padding: 0;\n}\n.header {\n  height: 70px;\n}\n.nav {\n  height: 70px;\n  background: red;\n}\n```\n\n## å½“éœ€è¦å±…ä¸­çš„ div è®¾ç½®äº†å›ºå®šå®½åº¦\n\n### margin\n\n```css\n.nav {\n  height: 70px;\n  background: red;\n  width: 300px;\n  margin: 0 atuo;\n}\n```\n\n`auto` å¯ä»¥ç†è§£ä¸ºä¸€æ ·çš„æ„æ€ï¼Œå¦‚æœå·¦å³éƒ½è®¾ç½® `auto`ï¼Œæ„æ€å°±æ˜¯è¿™ä¸ª `div` ç¦»å·¦é¢çš„è·ç¦»å’Œå³é¢çš„è·ç¦»æ˜¯ä¸€æ ·çš„,ä½†æ˜¯æ­¤æ–¹æ³•åªé€‚ç”¨äºè®¾ç½®äº†å®½åº¦çš„å—çº§å…ƒç´ ã€‚\n\n\bä½†æ˜¯å¦‚æœä½ è®¾ç½®äº†ä»¥ä¸‹å‡ ç§å±æ€§æ—¶ï¼Œå…¶å±…ä¸­æ•ˆæœä¾¿ä¼šæ¶ˆå¤±\n\n- `postion: absolute`\n- `float`\n- `display:inline`\n\nå—çº§å…ƒç´ å§‹ç»ˆç‹¬å ä¸€è¡Œï¼Œæ— è®ºæ˜¯å¦è®¾ç½®äº†å®½åº¦ï¼Œæœªè®¾ç½®å®½åº¦æ—¶ä»–ä¼šè‡ªåŠ¨å……æ»¡ï¼Œè®¾ç½®äº†å®½åº¦æ—¶ï¼Œè™½ç„¶ä»–çœ‹èµ·æ¥è¿™ä¸€è¡Œå¹¶ä¸éƒ½æ˜¯ä»–çš„ã€Œåœ°ç›˜ã€ï¼Œä½†æ˜¯ä½ å¦‚æœåœ¨ä»–åé¢æ·»åŠ å…ƒç´ çš„æ—¶å€™ï¼Œä½ ä¼šå‘ç°å…ƒç´ ä¼šè¢«æŒ¤åˆ°ä¸‹ä¸€è¡Œå»ã€‚\n\n```html\n<div class=\"header\">\n  <div class=\"nav\"></div>\n  å’‹å›äº‹å•Š\n</div>\n```\n\n![pic2](å…³äºcsså®ç°divå±…ä¸­é—®é¢˜/pic2.png)\n\næ€ä¹ˆè‚¥å››ï¼Œä¸ºæ£®ä¹ˆä¼šå‘ç”Ÿè¿™ç§æƒ…å†µå‘¢ï¼Œçœ‹ä¸€ä¸‹ä¸‹é¢ä¸€å¼ å›¾\n\n![pic3](å…³äºcsså®ç°divå±…ä¸­é—®é¢˜/pic3.png)\n\nå¯ä»¥çœ‹åˆ°ï¼Œè™½ç„¶ `div` è®¾ç½®äº†å®½åº¦ï¼Œä½†æ˜¯ä»–æœ‰ä¸€ç§**æ— å½¢çš„åŠ›é‡å æ®äº†ä»–æ‰€åœ¨çš„è¡Œçš„å‰©ä¸‹çš„ç©ºé—´ï¼Œä»¥è‡³äºå…¶å®ƒå…ƒç´ æ— æ³•ä¸å…¶åœ¨ä¸€è¡Œ**ã€‚è€Œè¿™ä¸€å—æ©™è‰²åŒºåŸŸä¹Ÿå°±æ˜¯ `margin: 0 auto` å¯è°ƒæ§åŒºåŸŸï¼Œ**`auto` ä¼šæ ¹æ®è¿™ä¸€éƒ¨åˆ†çš„å¤§å°åŠæ—¶åˆ†é…å·¦å³çš„è·ç¦»ï¼Œè¾¾åˆ°å±…ä¸­çš„æ•ˆæœ**ï¼Œå½“è®¾ç½®äº†ç»å¯¹å®šä½ã€æµ®åŠ¨æˆ–å°†å…¶è®¾ç½®ä¸ºè¡Œå†…å…ƒç´ çš„æ—¶å€™ï¼Œä»–è¿™ç§ã€Œå¨æ…‘åŠ›ã€ä¾¿ä¼šæ¶ˆå¤±ï¼Œ`auto` å¯åˆ†é…çš„åŒºåŸŸä¾¿ä¼šæ¶ˆå¤±\n\n![pic4](å…³äºcsså®ç°divå±…ä¸­é—®é¢˜/pic4.png)\n\nå¯ä»¥çœ‹åˆ°ï¼Œæ­¤æ—¶é‚£å—é»„è‰²çš„åŒºåŸŸå·²ç»æ¶ˆå¤±ï¼Œ`margin: 0 atuo` ä¹Ÿå°±éšä¹‹å¤±æ•ˆäº†\n\nä¸è¿‡ä¹Ÿæœ‰ä¸€ç§ä¾‹å¤–\n\n```css\n.nav {\n  height: 70px;\n  background: red;\n  width: 300px;\n  position: absolute;\n  left: 0;\n  right: 0;\n  margin: 0 atuo;\n}\n```\n\næ­¤æ—¶è™½ç„¶å·²ç»è®¾ç½®ç»å¯¹å®šä½ï¼Œ`div` ä¹Ÿå·²ç»è„±ç¦»äº†æ ‡å‡†æ–‡æ¡£æµï¼Œä½†æ˜¯ `left:0 right:0` åˆè®©å…¶å…·æœ‰äº†é‚£ç§ã€Œå¨æ…‘åŠ›ã€ï¼Œ\b`margin: 0 auto` ä¹Ÿå°±åˆæ‹¥æœ‰äº†å¯è°ƒæ§çš„åŒºåŸŸ\n\n![pic5](å…³äºcsså®ç°divå±…ä¸­é—®é¢˜/pic5.png)\n\n### ç»å¯¹å®šä½\n\n```css\n.nav {\n  height: 70px;\n  background: red;\n  width: 300px;\n  position: absolute;\n  left: 50%;\n  margin-left: -150px;\n}\n```\n\nè®¾ç½®ç»å¯¹å®šä½è®©å…¶ `left` å±æ€§èµ·ä½œç”¨ï¼Œç„¶åè®¾å®š `left:50%`ï¼Œä½†æ˜¯å› ä¸ºæ­¤ `div` æœ¬èº«è¿˜æœ‰å®½åº¦ï¼Œå› æ­¤è¿˜è¦æ·»åŠ  `margin-left:-æ­¤divå®½åº¦çš„ä¸€åŠpx;` è®©å…¶çœŸæ­£çš„å±…ä¸­\n\n## éœ€è¦å±…ä¸­çš„ div æ²¡æœ‰å®½åº¦\n\nå¾ˆå¤šçŠ¶å†µä¸‹æˆ‘ä»¬è¦å±…ä¸­çš„å…ƒç´ æ˜¯ä¸çŸ¥é“å®½åº¦çš„ï¼Œæœ‰æ—¶å€™å¯èƒ½å®½åº¦ä¹Ÿä¸æ˜¯å›ºå®šçš„ï¼Œå› ä¸ºé‡Œé¢çš„å†…å®¹æœ‰å¯èƒ½ä»¥åè¦å¢åŠ ï¼Œæˆ–è€…éšç€æµè§ˆå™¨çš„å˜åŒ–æ­¤å®½åº¦å¯èƒ½ä¹Ÿè¦è·Ÿéšå˜åŒ–ï¼Œä¸‹é¢å°†ç¤ºä¾‹ä»£ç çš„ css æ”¹ä¸ºå¦‚ä¸‹å½¢å¼\n\n```css\n.nav {\n  height: 70px;\n  background: red;\n}\n```\n\n![pic6](å…³äºcsså®ç°divå±…ä¸­é—®é¢˜/pic6.png)\n\nå¯ä»¥çœ‹åˆ°ï¼Œå½“ä¸è®¾ç½®å®½åº¦çš„æ—¶å€™ï¼Œæ­¤ `div` é»˜è®¤æ˜¯å……æ»¡æ•´ä¸ªæµè§ˆå™¨çš„ï¼Œè¿™æ ·çš„è¯å°±æ— æ‰€è°“å±…ä¸­æˆ–ä¸å±…ä¸­äº†ï¼Œé€šå¸¸æˆ‘ä»¬è¦å±…ä¸­è¿™ä¸ª divï¼Œæ˜¯æƒ³è®©è¿™ä¸ª div ä¸­çš„ä¸€äº›ä¿¡æ¯å±…ä¸­ï¼Œä¸ºäº†ä¾¿äºæ¼”ç¤ºï¼Œæˆ‘åœ¨ html å’Œ css ä¸­å¤šæ·»åŠ äº†å‡ è¡Œä»£ç \n\n```html\n<div class=\"header\">\n  <div class=\"nav\">\n      <ul>\n        <li>çƒ­çˆ±å‰ç«¯</li>\n        <li>çƒ­çˆ±ç¼–ç¨‹</li>\n        <li>çƒ­çˆ±ç”Ÿæ´»</li>\n        <li>æ¸´æœ›çŸ¥è¯†</li>\n      </ul>\n  </div>\n</div>\n```\n\n```css\n* {\n  margin: 0;\n  padding: 0;\n}\n.header {\n  height: 70px;\n}\n.nav {\n  height: 70px;\n  background: red;\n  line-height: 70px;\n  color: #fff;\n}\nul {\n  list-style: none;\n}\nli {\n  float: left;\n  margin-left: 30px;\n}\n```\n\n**æ•ˆæœå›¾**\n\n![pic7](å…³äºcsså®ç°divå±…ä¸­é—®é¢˜/pic7.png)\n\næ­¤æ—¶æˆ‘ä»¬åº”è¯¥æƒ³åŠæ³•è®© `div` çš„å®½åº¦ä¸æ˜¯å……æ»¡æ•´ä¸ªæµè§ˆå™¨ï¼Œè®©å®ƒçš„å®½åº¦ä»…ä»…å°±æ˜¯é‡Œé¢å†…å®¹çš„å®½åº¦ï¼Œè¿™æ ·æˆ‘ä»¬æ‰èƒ½è®©å®ƒå±…ä¸­ã€‚åœ¨å—çŠ¶å…ƒç´ ä¸‹ï¼Œå¦‚æœä¸è®¾ç½®å®½åº¦ï¼Œå®ƒå§‹ç»ˆæ˜¯è¦å……æ»¡æ•´ä¸ªå±å¹•çš„ã€‚\n\n```css\n.nav {\n  height: 70px;\n  background: red;\n  line-height: 70px;\n  color: #fff;\n  display: inline-block;\n}\n```\n\nå½“è®¾ç½® `nav` ä¸ºè¡Œå†…å…ƒç´ ï¼Œæˆ–è€… `table` å…ƒç´ çš„æ—¶å€™ä»–çš„å®½åº¦å°±é»˜è®¤ä¸æ˜¯æœ€å¤§åŒ–ï¼Œè€Œæ˜¯æ ¹æ®åŒ…è£¹çš„å†…å®¹æ”¹å˜ï¼Œä¹Ÿå°±æ˜¯æœ€å°åŒ–ã€‚è®¾ç½®ä¸º `position` æˆ–è€… `display:table` ä¹Ÿä¸€æ ·ã€‚\n\n![pic8](å…³äºcsså®ç°divå±…ä¸­é—®é¢˜/pic8.png)\n\n### text-align:center\n\nç”¨ `text-align:center` å®ç°å…ƒç´ å±…ä¸­ï¼Œè¿™ä¸ªå±æ€§ä¸æ˜¯åªèƒ½è®©æ–‡æœ¬å…ƒç´ å±…ä¸­ï¼Œå®ƒå¯ä»¥è®©**è¡Œå†…å…ƒç´ å±…ä¸­**ï¼Œæ‰€ä»¥åªè¦æŠŠè¦å±…ä¸­çš„å…ƒç´ è®¾ç½®ä¸ºè¡Œå†…å…ƒç´ ï¼Œç„¶åå‘å…¶çˆ¶å…ƒç´ æ·»åŠ  `text-align:center` å±æ€§ï¼Œå°±å¯ä»¥å®ç°å±…ä¸­\n\n```css\n.header {\n  height: 70px;\n  text-align: center;\n}\n.nav {\n  height: 70px;\n  background: red;\n  line-height: 70px;\n  color: #fff;\n  display: inline-block;\n}\n```\n\n### display:table\n\nè®¾ç½® `nav` ä¸º `display:table` ,`nav` å°±ç›¸å½“äºè¯´å°±å…·æœ‰äº† `table` çš„å±æ€§ï¼Œé‚£æˆ‘ä»¬éƒ½çŸ¥é“ `table` çš„å®½åº¦æ˜¯æ ¹æ®å…¶å†…å®¹çš„å¤šå°‘è€Œå˜åŒ–çš„ï¼Œä¹Ÿå°±æ˜¯å®½åº¦æœ€å°åŒ–ï¼Œè€Œæ­¤æ—¶ `nav` ä¾¿ä¹Ÿå¯ä»¥ä½¿ç”¨ `margin:0 auto` æ¥å±…ä¸­\n\n```css\n.nav {\n  height: 70px;\n  background: red;\n  line-height: 70px;\n  color: #fff;\n  display: table;\n  margin: 0 auto;\n}\n```\n","tags":["Base"],"categories":["Explore"]}]