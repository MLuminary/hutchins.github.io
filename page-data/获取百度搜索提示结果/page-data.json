{"componentChunkName":"component---src-templates-post-detail-tsx","path":"/è·å–ç™¾åº¦æœç´¢æç¤ºç»“æœ/","webpackCompilationHash":"5ee947e49c106553cd05","result":{"data":{"site":{"siteMetadata":{"title":"Silence","author":"é»˜å°"}},"markdownRemark":{"id":"0a9fb664-c58d-5a03-9d55-fba01ebc0d2e","excerpt":"è·å–ç™¾åº¦æœç´¢æç¤ºç»“æœ æœ€è¿‘æ¯”è¾ƒé—²å°±æƒ³å»æç‚¹äº‹æƒ…ï¼Œæ³¨è§†ç€æœç´¢å¼•æ“å°±åœ¨æƒ³æˆ‘ä»¬æ¯å¤©éƒ½åœ¨ç”¨æœç´¢å¼•æ“ï¼Œè‡ªå·±å°±æƒ³äº†è§£ä¸€ä¸‹å…¶ä¸­çš„åŸç†ï¼Œäºæ˜¯å°±åŠ¨æ‰‹åšäº†ä¸€ä¸ªï¼Œåªä¸è¿‡æ•°æ®æ˜¯çˆ¬çš„ ğŸ˜ï¼Œå¹¶æƒ³å®ç°å¦‚ä¸‹æœç´¢æç¤ºçš„åŠŸèƒ½  æœ¬æ¥è§‰å¾—æŸ¥æŸ¥ networkâ€¦","html":"<h1>è·å–ç™¾åº¦æœç´¢æç¤ºç»“æœ</h1>\n<blockquote>\n<p>æœ€è¿‘æ¯”è¾ƒé—²å°±æƒ³å»æç‚¹äº‹æƒ…ï¼Œæ³¨è§†ç€æœç´¢å¼•æ“å°±åœ¨æƒ³æˆ‘ä»¬æ¯å¤©éƒ½åœ¨ç”¨æœç´¢å¼•æ“ï¼Œè‡ªå·±å°±æƒ³äº†è§£ä¸€ä¸‹å…¶ä¸­çš„åŸç†ï¼Œäºæ˜¯å°±åŠ¨æ‰‹åšäº†ä¸€ä¸ªï¼Œåªä¸è¿‡æ•°æ®æ˜¯çˆ¬çš„ ğŸ˜ï¼Œå¹¶æƒ³å®ç°å¦‚ä¸‹æœç´¢æç¤ºçš„åŠŸèƒ½</p>\n</blockquote>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/52b71f0afc61ccfef98f3940f44afd54/3b44a/pg1.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 42.96636085626911%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAJABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAQAF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3khiP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEAAQUCX//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABYQAAMAAAAAAAAAAAAAAAAAAAEQMf/aAAgBAQABPyERiP8A/9oADAMBAAIAAwAAABDQz//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABoQAQABBQAAAAAAAAAAAAAAAAEQABExYXH/2gAIAQEAAT8Qdy6hKx8n/9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"pg1\"\n        title=\"pg1\"\n        src=\"/static/52b71f0afc61ccfef98f3940f44afd54/c739e/pg1.jpg\"\n        srcset=\"/static/52b71f0afc61ccfef98f3940f44afd54/8ee9c/pg1.jpg 148w,\n/static/52b71f0afc61ccfef98f3940f44afd54/ebbe7/pg1.jpg 295w,\n/static/52b71f0afc61ccfef98f3940f44afd54/c739e/pg1.jpg 590w,\n/static/52b71f0afc61ccfef98f3940f44afd54/3b44a/pg1.jpg 654w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>æœ¬æ¥è§‰å¾—æŸ¥æŸ¥ network éšä¾¿æŠ“å–ä¸€ä¸‹å°±å¯ä»¥è·å¾—åˆ°æ•°æ®ï¼Œä½†äº‹æƒ…å´ä¸æ˜¯è¿™ä¹ˆç®€å•</p>\n<h2>è¿‡ç¨‹</h2>\n<p>åœ¨ç™¾åº¦åœ¨éšä¾¿è¾“å…¥å­—ç¬¦ï¼ŒæŸ¥çœ‹ networkï¼Œæ‰¾åˆ°æ­¤æ—¶è¯·æ±‚çš„é“¾æ¥</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 399px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/cf53f121af00a2c7525512498b645ced/1341e/pg2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 140.85213032581453%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAcCAIAAADuuAg3AAAACXBIWXMAAAsSAAALEgHS3X78AAACT0lEQVQ4y43V6ZIaMQwEYN7/7Sj4tRTFzQz3fYcl31iEEGAJqsJle9TqlmSb0mg06vV6eZ4bF4vFdDrdbrfdbtdOLIfD4Ww2G4/H5lmWtdvtRqPBAbA0mUzq9Xqr1eKd5dlgMBCl0+kYOVn+emXn85lDSch+vy9kq9kaZAPhEV4uFx7H45HT5Qcrl8sFuNAwHPXz/tfiS6Dlcnn5wKrVaol0YPKarWZn0pYF8s1mI/P5fP4mUKVSKakH9fhVYjycrNdr+PFoDBaB7Ii13+9fgGWIFgm8qnKdJ1utVsE8TBaF+P5jV7DC+ka8EMrmg1JBglH+JucCzAkMZ/CDUavOwfPA9ggGky1+tCQQL0pwPgNeMMPcyONI7Xa7/7bqyux4aa+GOVLOGeXS/giMmWCc8JH2MZneHA6HmGyTPWRRgHkDS9UYN0Hl8U+S2bGMzRfguFXEk2CMrpJgX8RRspeVK8CiBhiJkzRNFqfChK44ZM/Fv54wgsGiW6QGJ5gQcSp/ZI4mwXBVZ7tRHuGi5i9PyBWsNoEPqcorhAlm3bZU830yEfd3BlJUm2A6b6XSs+JVSSlY6r+vxVVLoxKAxbUt+cFziuthFzJGEnzlejqdnmWr4vWE4eFtIgqG202MhM/Jvv+1AozExYAkr9lsikVISIgX8/6qPDLTFvcBORinW2PflPqvbAVDHu+B8cNbVYClR7AyxrsPSUI8+iH4/pz6envbSC5axRUg0gs80zBjnix60UtmwlOIa6sgo9W1Wi1LFvXnKkT8v9jhY7SMpgD+BovtMoydoLOeAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"pg2\"\n        title=\"pg2\"\n        src=\"/static/cf53f121af00a2c7525512498b645ced/1341e/pg2.png\"\n        srcset=\"/static/cf53f121af00a2c7525512498b645ced/cf440/pg2.png 148w,\n/static/cf53f121af00a2c7525512498b645ced/d2d38/pg2.png 295w,\n/static/cf53f121af00a2c7525512498b645ced/1341e/pg2.png 399w\"\n        sizes=\"(max-width: 399px) 100vw, 399px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>ä¼šå‘ç°ä½¿ç”¨ get æ–¹å¼ä¼ äº†å››ä¸ªå€¼,å…¶ä¸­ <code class=\"language-text\">p</code> å’Œ <code class=\"language-text\">cb</code> éƒ½æ˜¯å¯ä»¥å›ºå®šçš„ï¼Œå‰©ä¸‹çš„å°±æ˜¯å…³é”®å­— <code class=\"language-text\">wd</code> å’Œæ­¤æ—¶çš„æ—¶é—´æˆ³ <code class=\"language-text\">t</code>ï¼Œè‡ªå·±å› ä¸ºæœ¬èº«æ˜¯ vue çš„é¡¹ç›®ï¼Œå°±ç”¨ <code class=\"language-text\">axios</code> å¯¹æ­¤è¿›è¡Œè¯·æ±‚ï¼Œç»“æœæŠ¥é”™ä¸º <strong>è·¨åŸŸ</strong> å¹¶ä¸” <strong>ä¸­æ–‡ä¹±ç </strong></p>\n<h3>gzip</h3>\n<p>å› ä¸ºå‘ç”Ÿäº†è·¨åŸŸï¼Œå› æ­¤å°±æƒ³ç”¨ <code class=\"language-text\">node</code> å»ä¿®æ”¹è¯·æ±‚å¤´å»è¯·æ±‚ï¼Œã€Œåæ¥å‘ç°ç”¨ <code class=\"language-text\">node</code> å»è¯·æ±‚ä¸éœ€è¦ä¿®æ”¹è¯·æ±‚å¤´ä¹Ÿä¸ä¼šè·¨åŸŸã€ï¼Œä½†æ˜¯è¿˜æœ‰ä¸€ä¸ªé—®é¢˜è¿”å›çš„ä¸­æ–‡éƒ½æ˜¯ä¹±ç ã€‚ç„¶åæˆ‘å°±å»å…³æ³¨äº†ä¸€ä¸‹å“åº”å¤´ï¼Œå¦‚ä¸Šé¢çš„å›¾ç‰‡ï¼Œå…¶ä¸­ <code class=\"language-text\">content-encoding: gzip</code> å¼•èµ·äº†æˆ‘çš„æ³¨æ„ã€‚</p>\n<p>gzip æ˜¯ä»€ä¹ˆåœ¨æ­¤æˆ‘å°±ä¸åšè¿‡å¤šçš„è§£é‡Šï¼Œå»ç½‘ä¸ŠæŸ¥åªæ˜¯è¯´æƒ³è¦<strong>è·å– gzip æ ¼å¼çš„ç½‘é¡µä¿¡æ¯éœ€è¦è§£å‹ï¼Œè¦ä¸ç„¶è·å¾—åˆ°çš„ä¿¡æ¯ä¼šæ˜¯ä¹±ç </strong>ï¼Œå…¶ä¸­ç”¨åˆ°äº† <code class=\"language-text\">zlib</code> å’Œ <code class=\"language-text\">request</code> ä¸¤ä¸ªåŒ…</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">  zlib <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'zlib'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">response</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">err<span class=\"token punctuation\">,</span> res<span class=\"token punctuation\">,</span> body</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"token comment\">//check res header it is gzip</span>\n console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">.</span>headers<span class=\"token punctuation\">[</span><span class=\"token string\">'content-encoding'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">//now body it is gzip stream buffer</span>\n      zlib<span class=\"token punctuation\">.</span><span class=\"token function\">unzip</span><span class=\"token punctuation\">(</span>body<span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">err<span class=\"token punctuation\">,</span> buffer</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n             console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n       <span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">}</span>\n    request<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        url <span class=\"token punctuation\">:</span> apiUrl<span class=\"token punctuation\">,</span>\n        headers<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token string\">'Accept-Encoding'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'gzip'</span><span class=\"token punctuation\">,</span>\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        encoding <span class=\"token punctuation\">:</span> <span class=\"token keyword\">null</span>  <span class=\"token comment\">// it is very import!!</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> response<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>ä½†æ˜¯æˆ‘æ»¡æ€€æœŸå¾…çš„å°†å…¶è§£å‹æå–ä¿¡æ¯åè·å¾—çš„ç»“æœä¾ç„¶æ˜¯ä¹±ç ï¼Œmake my heart cold cold</p>\n<p><strong>gbk</strong></p>\n<p>æœ€ååˆæŠŠç›®å…‰è½¬å‘å“åº”å¤´ï¼Œæ„Ÿè§‰ <code class=\"language-text\">charset=gbk</code> å¥½åƒæœ‰ç‚¹ä¸œè¥¿, å…¶ä¸­ç”¨åˆ°äº† <code class=\"language-text\">iconv-lite</code> ï¼Œæ˜¯ä¸€ä¸ªè½¬ç¼–ç çš„å·¥å…·ï¼Œ<code class=\"language-text\">iconv.decode</code> æ¥å—åˆ°ç¬¬ä¸€ä¸ªå‚æ•°å¿…é¡»æ˜¯ <code class=\"language-text\">buffer</code>, è€Œ <code class=\"language-text\">request</code> è·å–åˆ°çš„ä¿¡æ¯è¿”å›çš„ä¹Ÿæ˜¯ <code class=\"language-text\">buffer</code> æˆ‘å°±æ„Ÿè§‰å†¥å†¥ä¹‹ä¸­æ”¾ä½›é¢„ç¤ºç€ä»€ä¹ˆ</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function\">request</span><span class=\"token punctuation\">(</span>\n  <span class=\"token punctuation\">{</span>\n    url<span class=\"token punctuation\">,</span>\n    encoding<span class=\"token punctuation\">:</span> <span class=\"token keyword\">null</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">err<span class=\"token punctuation\">,</span> response<span class=\"token punctuation\">,</span> body</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    res<span class=\"token punctuation\">.</span><span class=\"token function\">setHeader</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Content-Type'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'application/json; charset=utf-8'</span><span class=\"token punctuation\">)</span>\n    res<span class=\"token punctuation\">.</span><span class=\"token function\">end</span><span class=\"token punctuation\">(</span>iconv<span class=\"token punctuation\">.</span><span class=\"token function\">decode</span><span class=\"token punctuation\">(</span>body<span class=\"token punctuation\">,</span> <span class=\"token string\">'gbk'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<p>å› æ­¤å°†å“åº”å¤´è®¾ç½®ä¸º utf-8 å¹¶å°†å…¶ gbk ç¼–ç è½¬æ¢ä¸º utf-8 åæˆåŠŸçš„è·å¾—åˆ°äº†éœ€è¦çš„ä¿¡æ¯, ä¸‹é¢å°±æ˜¯å°†æ­¤ api éƒ¨ç½²åˆ°æˆ‘è‡ªå·±çš„æœåŠ¡å™¨ä¸Šï¼Œå…³äºéƒ¨ç½²ç¢°åˆ°çš„ä¸€äº›é—®é¢˜åŸºæœ¬éƒ½åœ¨æˆ‘å¦ä¸€ç¯‡æ–‡ç« ä¸­æœ‰è°ˆåˆ° <a href=\"https://github.com/MLuminary/Blog/issues/15\">è®°ä¸€æ¬¡ oneinstack é…ç½®æœåŠ¡å™¨</a></p>","frontmatter":{"title":"è·å–ç™¾åº¦æœç´¢æç¤ºç»“æœ","date":"August 02, 2018"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/è·å–ç™¾åº¦æœç´¢æç¤ºç»“æœ/","previous":{"fields":{"slug":"/è®©æœåŠ¡å™¨å¸¦ç‚¹ç»¿/"},"frontmatter":{"title":"è®©æœåŠ¡å™¨å¸¦ç‚¹ç»¿"}},"next":{"fields":{"slug":"/åŸºäºmpvueçš„åœ†å½¢è¿›åº¦æ¡ç»„ä»¶/"},"frontmatter":{"title":"åŸºäº mpvue çš„åœ†å½¢è¿›åº¦æ¡ç»„ä»¶"}}}}}