{"componentChunkName":"component---src-templates-post-detail-tsx","path":"/基于mpvue的圆形进度条组件/","webpackCompilationHash":"74f8199dc6732893306b","result":{"data":{"site":{"siteMetadata":{"title":"Silence","author":"默尝"}},"markdownRemark":{"id":"3a17be35-1824-5167-854d-02792e7c1e7b","excerpt":"基于 mpvue 的圆形进度条组件 自己本身是一个微信小程序小白，前几天刚开始学习。碰到一个需求是要实现多个圆形带缺口的进度条，在网上没有找到相关插件后决定自己编写一个，如果能帮到需要的人那真是太好了, 下面会介绍一下自己的实现过程，如果只关心如何用的话可以传送到mini-circleprogress…","html":"<h1>基于 mpvue 的圆形进度条组件</h1>\n<blockquote>\n<p>自己本身是一个微信小程序小白，前几天刚开始学习。碰到一个需求是要实现多个圆形带缺口的进度条，在网上没有找到相关插件后决定自己编写一个，如果能帮到需要的人那真是太好了, 下面会介绍一下自己的实现过程，如果只关心如何用的话可以传送到<a href=\"https://github.com/MLuminary/subentry/tree/master/mini-circleProgress\">mini-circleprogress 源码</a></p>\n</blockquote>\n<p><strong>默认状态</strong></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 128px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/476ed8a7baa845806cae059d9444b393/5b8d2/default.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 96.09374999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAATABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAIBBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAe+ySwAAf//EABgQAAMBAQAAAAAAAAAAAAAAAAECECAx/9oACAEBAAEFAsBQs7f/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/AR//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAUEAEAAAAAAAAAAAAAAAAAAAAw/9oACAEBAAY/Ah//xAAZEAEAAwEBAAAAAAAAAAAAAAABABARMUH/2gAIAQEAAT8htzj7ORtIDE2ABhX/2gAMAwEAAgADAAAAENPAPP/EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8QH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8QH//EABsQAQEAAgMBAAAAAAAAAAAAAAERADEQIVFB/9oACAEBAAE/EN5POLlz5C7xxX23W3DWTCHiXBQQNcf/2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"基于 mpvue 的圆形进度条组件\"\n        title=\"基于 mpvue 的圆形进度条组件\"\n        src=\"/static/476ed8a7baa845806cae059d9444b393/5b8d2/default.jpg\"\n        srcset=\"/static/476ed8a7baa845806cae059d9444b393/5b8d2/default.jpg 128w\"\n        sizes=\"(max-width: 128px) 100vw, 128px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p><strong>圆形带缺口</strong></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 127px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/8fd6a14a4f48101135058fc5b477bbd3/ea714/gap.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 92.91338582677166%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAATABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAIBBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAe+nCwAAf//EABcQAAMBAAAAAAAAAAAAAAAAAAECIBH/2gAIAQEAAQUCgLk//8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPwEf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPwEf/8QAGRAAAQUAAAAAAAAAAAAAAAAAAAEQESAx/9oACAEBAAY/Ang1a//EABkQAQEAAwEAAAAAAAAAAAAAAAERABAgcf/aAAgBAQABPyHdFXltp68//9oADAMBAAIAAwAAABDjzzz/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/EB//xAAVEQEBAAAAAAAAAAAAAAAAAAARIP/aAAgBAgEBPxAj/8QAGxAAAgIDAQAAAAAAAAAAAAAAAREAMRAhUZH/2gAIAQEAAT8QuLG7gK9HRBmBiwwXBFt5/9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"基于 mpvue 的圆形进度条组件\"\n        title=\"基于 mpvue 的圆形进度条组件\"\n        src=\"/static/8fd6a14a4f48101135058fc5b477bbd3/ea714/gap.jpg\"\n        srcset=\"/static/8fd6a14a4f48101135058fc5b477bbd3/ea714/gap.jpg 127w\"\n        sizes=\"(max-width: 127px) 100vw, 127px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h2>过程</h2>\n<p>一开始的思路是用 svg， 自己编写完毕后，发现小程序不支持直接引入 svg， 因此最终实现是使用的小程序自带的 canvas</p>\n<p>如何画圆已经有大佬讲解过了，我就不重复劳动了，<a href=\"https://segmentfault.com/a/1190000013219501\">飞机票</a></p>\n<h2>特点</h2>\n<h3>完全响应式</h3>\n<p><strong>适应包裹元素的宽度和高度</strong></p>\n<p>一开始的思路是设置 canvas 的宽高为 100%，发现并没有什么用，然后想获取 <code class=\"language-text\">canvas</code> 动态改变其宽高，发现小程序不能操作 dom, <code class=\"language-text\">ref</code> 也都不能使用。因此只能设置一个 <code class=\"language-text\">props</code>,麻烦使用者告知一下父元素的宽高，在这里因为此图形是一个正方形，所以只需要传递一个值就可以了。</p>\n<p><strong>适应设备的宽度和高度</strong></p>\n<p><code class=\"language-text\">canvas</code> 中的画布单位默认都是 px，画出来的图形是不能很好的适应宽度不同的设备的，因此自己在内部实现了一个 rpx，具体实现思路如下</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function\">getRpx</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> rpx <span class=\"token operator\">=</span> <span class=\"token number\">1</span> <span class=\"token comment\">// 相对单位</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resolve</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    wx<span class=\"token punctuation\">.</span><span class=\"token function\">getSystemInfo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      <span class=\"token function-variable function\">success</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">res</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        rpx <span class=\"token operator\">=</span> res<span class=\"token punctuation\">.</span>windowWidth <span class=\"token operator\">/</span> <span class=\"token number\">375</span>\n        <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>rpx<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>然后与之前的画布的数值相乘即可，想具体看怎么实现的可以去看下<a href=\"https://github.com/MLuminary/subentry/tree/master/mini-circleProgress\">源码</a></p>\n<h2>有关 canvas-id</h2>\n<p>canvas 在一个页面中 id 是不能相同的，就算出现相同的也只会渲染第一个，因此需要多个 <code class=\"language-text\">canvas</code> 只能让其 id 各不相同。使用者想使用多个圆形进度条组件的时候，请传递 <code class=\"language-text\">canvasId</code> 值。</p>","frontmatter":{"title":"基于 mpvue 的圆形进度条组件","date":"September 10, 2018"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/基于mpvue的圆形进度条组件/","previous":{"fields":{"slug":"/根据url获取图标及title/"},"frontmatter":{"title":"根据 url 获取图标及 title"}},"next":{"fields":{"slug":"/获取百度搜索提示结果/"},"frontmatter":{"title":"获取百度搜索提示结果"}}}}}