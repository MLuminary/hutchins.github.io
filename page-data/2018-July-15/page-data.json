{"componentChunkName":"component---src-templates-post-detail-tsx","path":"/2018-July-15","webpackCompilationHash":"e568bc029a1371d3c988","result":{"data":{"site":{"siteMetadata":{"title":"Silence","author":"é»˜å°"}},"markdownRemark":{"id":"70d6a7ec-f6b5-529f-b0bd-905bc20842e5","excerpt":"â€¦","html":"<blockquote>\n<p>å› ä¸ºè‡ªå·±æ˜¯å¤§å­¦ç”Ÿï¼Œæ‰€ä»¥ä¸€ç›´éƒ½æ˜¯ç”¨çš„è…¾è®¯äº‘å­¦ç”Ÿæœºï¼Œä½†æ˜¯å‰å‡ å¤©è…¾è®¯çªç„¶å‘Šè¯‰æˆ‘è…¾è®¯äº‘å­¦ç”Ÿè®¤è¯åˆ°æœŸäº†ï¼Œå¯èƒ½æ˜¯å½“æ—¶å¡«é”™äº†ï¼Œæ²¡åŠæ³•æˆ‘å°±åˆç”³è¯·äº†å­¦ç”Ÿè®¤è¯ ğŸ˜‚ï¼Œè°è®©æˆ‘è¿˜æ˜¯å­¦ç”Ÿå‘¢ï¼Œä½†æ˜¯ä»¥å‰è€çš„å­¦ç”Ÿä¼˜æƒ çš„å­¦ç”Ÿæœºå°±ä¸èƒ½å†æŒ‰ç…§å­¦ç”Ÿä¼˜æƒ çš„æ–¹å¼ç»­è´¹äº†ï¼Œæ‰€ä»¥æˆ‘åˆä¹°äº†ä¸€ä¸ªæ–°çš„æœåŠ¡å™¨ã€‚ä¹°å®ŒæœåŠ¡å™¨å‡†å¤‡æ‰‹åŠ¨å¼€å§‹å„ç§é…ç½®çš„æ—¶å€™ä¾¿å‘ç°äº†ä¸€ä¸ªç¥å™¨ï¼Œä¹Ÿå°±æ˜¯æ¥ä¸‹æ¥è¦ä»‹ç»ç»™å¤§å®¶çš„ã€‚å°±æ˜¯ <a href=\"https://oneinstack.com/\">oneinstack</a> ,å¯ä»¥å‚»ç“œå¼ã€Œä¸€é”®ã€å®‰è£…ï¼Œæƒ³çœ‹ç¢°åˆ°çš„ bug åŠä¸€äº›è§£å†³æ–¹æ¡ˆå¯ä»¥ç›´æ¥è·³è¿‡é…ç½®æœåŠ¡å™¨éƒ¨åˆ†ã€‚<a href=\"#é‡åˆ°çš„é—®é¢˜\">ã€Œjumpã€</a></p>\n</blockquote>\n<h2>é…ç½®æœåŠ¡å™¨ç¯å¢ƒ</h2>\n<p>æˆ‘å†™æ­¤åšå®¢æ—¶ oneinstack çš„ç‰ˆæœ¬ä¸º 2018-04-24, å…¶ä½¿ç”¨æ–¹å¼å¦‚ä¸‹</p>\n<h3>åŸºæœ¬å®‰è£…</h3>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">yum -y <span class=\"token function\">install</span> <span class=\"token function\">wget</span> <span class=\"token function\">screen</span> <span class=\"token function\">curl</span> python <span class=\"token comment\">#for CentOS/Redhat</span>\n<span class=\"token comment\"># apt-get -y install wget screen curl python #for Debian/Ubuntu</span>\n\n<span class=\"token comment\"># ä¸‹è½½æºç ä¸è„šæœ¬</span>\n<span class=\"token function\">wget</span> http://mirrors.linuxeye.com/oneinstack-full.tar.gz <span class=\"token comment\">#åŒ…å«æºç ï¼Œå›½å†…å¤–å‡å¯ä¸‹è½½</span>\n\n<span class=\"token comment\"># è§£å‹</span>\n<span class=\"token function\">tar</span> xzf oneinstack-full.tar.gz\n\n<span class=\"token comment\"># å¦‚æœéœ€è¦ä¿®æ”¹ç›®å½•(å®‰è£…ã€æ•°æ®å­˜å‚¨ã€Nginxæ—¥å¿—)ï¼Œè¯·ä¿®æ”¹options.confæ–‡ä»¶</span>\n<span class=\"token builtin class-name\">cd</span> oneinstack\n\n<span class=\"token comment\"># å¦‚æœç½‘è·¯å‡ºç°ä¸­æ–­ï¼Œå¯ä»¥æ‰§è¡Œå‘½ä»¤`screen -R oneinstack`é‡æ–°è¿æ¥å®‰è£…çª—å£</span>\n<span class=\"token function\">screen</span> -S oneinstack\n\n<span class=\"token comment\"># æ³¨ï¼šè¯·å‹¿sh install.shæˆ–è€…bash install.shè¿™æ ·æ‰§è¡Œ</span>\n./install.sh\n\n<span class=\"token comment\"># æ¥ä¸‹æ¥æ ¹æ®å…¶æŒ‡ç¤ºå’Œè‡ªå·±å–œå¥½å®‰è£…éœ€è¦çš„è½¯ä»¶å³å¯</span></code></pre></div>\n<h3>node å®‰è£…</h3>\n<p>oneinstack ä¸æ”¯æŒ node ç¯å¢ƒçš„å®‰è£…ï¼Œä½œä¸ºä¸€ä¸ªå‰ç«¯ er, node è¿˜æ˜¯ä¸å¯è·å–çš„ï¼Œä»¥å‰æˆ‘é…ç½® node éƒ½æ˜¯å»å®˜ç½‘ä¸‹è½½ç„¶åè§£å‹ç„¶åå»ºç«‹å…¨å±€è½¯é“¾æ¥çš„å½¢å¼ï¼Œè¿™æ¬¡ä¹Ÿæ˜¯æ¢äº†ä¸€ä¸ªæ›´ç®€å•çš„æ–¹å¼</p>\n<h4>node.js v.8x å®‰è£…å‘½ä»¤</h4>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\">#curl --silent --location https://rpm.nodesource.com/setup_8.x | bash -</span></code></pre></div>\n<h4>å®‰è£… node</h4>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">yum <span class=\"token function\">install</span> -y nodejs</code></pre></div>\n<h4>æŸ¥çœ‹ nodejs å®‰è£…ç‰ˆæœ¬</h4>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">node -v</code></pre></div>\n<p>è‡³æ­¤ node å°±å·²ç»å®‰è£…å®Œæˆï¼Œä¹Ÿæ˜¯å…¨å±€å˜é‡ï¼Œç›¸æ¯”ä»¥å‰ä¹Ÿçœäº†å¾ˆå¤šæ—¶é—´å’ŒåŠ›æ°”ï¼Œå¦‚æœéœ€è¦ä¹Ÿå¯ä»¥å®‰è£… nodejs çš„ç‰ˆæœ¬ç®¡ç†å·¥å…·ï¼Œä½†æ˜¯åœ¨è¿™é‡Œæˆ‘æ²¡æœ‰å®‰è£…ï¼Œæ­£ç¡®ä¸å¦æˆ‘æ²¡æœ‰å°è¯•</p>\n<h3>node.js ç‰ˆæœ¬ç®¡ç†å™¨ n</h3>\n<h4>å®‰è£… n</h4>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> -g n1</code></pre></div>\n<h4>å®‰è£…æŒ‡å®šç‰ˆæœ¬</h4>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\">#n &lt;version>1</span></code></pre></div>\n<h4>å®‰è£…æœ€æ–°ç‰ˆæœ¬</h4>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># n latest1</span></code></pre></div>\n<h4>å®‰è£…ç¨³å®šç‰ˆæœ¬</h4>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\">#n stable1</span></code></pre></div>\n<h4>åˆ é™¤æŸä¸ªç‰ˆæœ¬</h4>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\">#n rm &lt;version> 1</span></code></pre></div>\n<h4>æŸ¥çœ‹æ‰€æœ‰ç‰ˆæœ¬</h4>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\">#n list</span></code></pre></div>\n<h2>å…¶ä»–é…ç½®</h2>\n<h3>æ·»åŠ é™„åŠ ç»„ä»¶</h3>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">./addons.sh</code></pre></div>\n<h3>åˆ›å»º FTP è™šæ‹Ÿç”¨æˆ·è´¦æˆ·</h3>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">./pureftpd_vhost.sh</code></pre></div>\n<h3>å¢åˆ è™šæ‹Ÿä¸»æœº</h3>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># å¢åŠ è™šæ‹Ÿä¸»æœº./vhost.sh# åˆ é™¤è™šæ‹Ÿä¸»æœº</span>\n./vhost.sh</code></pre></div>\n<h3>å¤‡ä»½å’Œè‡ªåŠ¨å¤‡ä»½</h3>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># Set backup options ./backup_setup.sh # Start backup, You can add cron jobs./backup.sh # crontab -l # Examples 0 1 * * * cd ~/oneinstack;./backup.sh  > /dev/null 2>&amp;1 &amp;</span></code></pre></div>\n<h3>æ›´æ–°ç‰ˆæœ¬</h3>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">./upgrade.sh</code></pre></div>\n<h3>å¸è½½</h3>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">./uninstall.sh</code></pre></div>\n<h2>ç®¡ç†æœåŠ¡</h2>\n<p>Nginx/Tengine/OpenResty:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">service</span> nginx <span class=\"token punctuation\">{</span>start<span class=\"token operator\">|</span>stop<span class=\"token operator\">|</span>status<span class=\"token operator\">|</span>restart<span class=\"token operator\">|</span>reload<span class=\"token operator\">|</span>configtest<span class=\"token punctuation\">}</span></code></pre></div>\n<p>MySQL/MariaDB/Percona:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">service</span> mysqld <span class=\"token punctuation\">{</span>start<span class=\"token operator\">|</span>stop<span class=\"token operator\">|</span>restart<span class=\"token operator\">|</span>reload<span class=\"token operator\">|</span>status<span class=\"token punctuation\">}</span></code></pre></div>\n<p>PostgreSQL:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">service</span> postgresql <span class=\"token punctuation\">{</span>start<span class=\"token operator\">|</span>stop<span class=\"token operator\">|</span>restart<span class=\"token operator\">|</span>status<span class=\"token punctuation\">}</span></code></pre></div>\n<p>MongoDB:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">service</span> mongod <span class=\"token punctuation\">{</span>start<span class=\"token operator\">|</span>stop<span class=\"token operator\">|</span>status<span class=\"token operator\">|</span>restart<span class=\"token operator\">|</span>reload<span class=\"token punctuation\">}</span></code></pre></div>\n<p>PHP:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">service</span> php-fpm <span class=\"token punctuation\">{</span>start<span class=\"token operator\">|</span>stop<span class=\"token operator\">|</span>restart<span class=\"token operator\">|</span>reload<span class=\"token operator\">|</span>status<span class=\"token punctuation\">}</span></code></pre></div>\n<p>HHVM:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">service</span> supervisord <span class=\"token punctuation\">{</span>start<span class=\"token operator\">|</span>stop<span class=\"token operator\">|</span>status<span class=\"token operator\">|</span>restart<span class=\"token operator\">|</span>reload<span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong>æ³¨</strong>ï¼šhhvm è¿›ç¨‹äº¤ç»™ supervisord ç®¡ç†ï¼Œäº†è§£æ›´å¤šè¯·è®¿é—®ã€Š<a href=\"https://blog.linuxeye.com/408.html\">Supervisor ç®¡ç† hhvm è¿›ç¨‹</a>ã€‹\nApache:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">service</span> httpd <span class=\"token punctuation\">{</span>start<span class=\"token operator\">|</span>restart<span class=\"token operator\">|</span>stop<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Tomcat:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">service</span> tomcat <span class=\"token punctuation\">{</span>start<span class=\"token operator\">|</span>stop<span class=\"token operator\">|</span>status<span class=\"token operator\">|</span>restart<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Pure-Ftpd:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">service</span> pureftpd <span class=\"token punctuation\">{</span>start<span class=\"token operator\">|</span>stop<span class=\"token operator\">|</span>restart<span class=\"token operator\">|</span>status<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Redis:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">service</span> redis-server <span class=\"token punctuation\">{</span>start<span class=\"token operator\">|</span>stop<span class=\"token operator\">|</span>status<span class=\"token operator\">|</span>restart<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Memcached:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">service</span> memcached <span class=\"token punctuation\">{</span>start<span class=\"token operator\">|</span>stop<span class=\"token operator\">|</span>status<span class=\"token operator\">|</span>restart<span class=\"token operator\">|</span>reload<span class=\"token punctuation\">}</span></code></pre></div>\n<h2>å¯ç”¨ mysql æœåŠ¡</h2>\n<p>oneinstack é»˜è®¤ä»…å…è®¸ä¸»æœºæœ¬æœºé“¾æ¥æ•°æ®åº“ï¼Œéœ€è¦è¿œç¨‹è¿æ¥æ•°æ®åº“çš„è¯ï¼Œéœ€è¦æ‰“å¼€å¯¹åº”ç«¯å£</p>\n<h3>æ‰“å¼€ 3306 ç«¯å£</h3>\n<p>CentOS ç³»ç»Ÿ</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">iptables -I INPUT <span class=\"token number\">4</span> -p tcp -m state --state NEW -m tcp --dport <span class=\"token number\">3306</span> -j ACCEPT <span class=\"token comment\"># å…è®¸è®¿é—® 3306</span>\n<span class=\"token function\">service</span> iptables save <span class=\"token comment\">#ä¿å­˜ iptables è§„åˆ™</span>\niptables -nvl <span class=\"token comment\"># æŸ¥çœ‹ iptables è§„åˆ™</span></code></pre></div>\n<p>Ubuntu/Debian</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">iptables -I INPUT <span class=\"token number\">4</span> -p tcp -m state --state NEW -m tcp --dport <span class=\"token number\">3306</span> -j ACCEPT <span class=\"token comment\"># å…è®¸è®¿é—® 3306</span>\niptables-save <span class=\"token operator\">></span> /etc/iptables.up.rules <span class=\"token comment\">#ä¿å­˜ iptables è§„åˆ™</span></code></pre></div>\n<h3>æ•°æ®åº“æˆæƒ</h3>\n<h4>MySQL8.0 ç‰ˆæœ¬</h4>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># mysql -uroot -p</span>\n MySQL <span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>none<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span> create user db_user@<span class=\"token string\">'%'</span> identified by <span class=\"token string\">'db_pass'</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">#åˆ›å»ºç”¨æˆ·</span>\n MySQL <span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>none<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span> grant all privileges on db_name.* to db_user@<span class=\"token string\">'%'</span> with grant option<span class=\"token punctuation\">;</span> <span class=\"token comment\">#æˆæƒ</span>\n MySQL <span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>none<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span> <span class=\"token builtin class-name\">exit</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">#é€€å‡ºæ•°æ®åº“æ§åˆ¶å°ï¼Œç‰¹åˆ«æ³¨æ„æœ‰åˆ†å·</span></code></pre></div>\n<h4>å…¶ä½™ MySQL ç‰ˆæœ¬</h4>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># mysql -uroot -p</span>\n MySQL <span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>none<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span> grant all privileges on db_name.* to db_user@<span class=\"token string\">'%'</span> identified by <span class=\"token string\">'db_pass'</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">#æˆæƒè¯­å¥ï¼Œç‰¹åˆ«æ³¨æ„æœ‰åˆ†å·</span>\n MySQL <span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>none<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span> flush privileges<span class=\"token punctuation\">;</span>\n MySQL <span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>none<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span> <span class=\"token builtin class-name\">exit</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">#é€€å‡ºæ•°æ®åº“æ§åˆ¶å°ï¼Œç‰¹åˆ«æ³¨æ„æœ‰åˆ†å·</span></code></pre></div>\n<h2>æœåŠ¡å™¨ https</h2>\n<p>ä»¥å‰çš„æœåŠ¡å™¨ https éƒ½æ˜¯è‡ªå·±ä¸Šçš„ï¼Œä½¿ç”¨ oneinstack å¯ä»¥ä¸€é”®è®©è‡ªå·±çš„æœåŠ¡å™¨å¸¦ç‚¹ç»¿ ğŸŒ²</p>\n<p>è¿è¡Œ <code class=\"language-text\">./vhost.sh</code> å°±ä¼šè·³åˆ°é…ç½®è™šæ‹Ÿç¯å¢ƒç•Œé¢ï¼Œoneinstack é‡‡ç”¨ Letâ€™s Encrypt https è¯ä¹¦ï¼Œå…è´¹ä½¿ç”¨ä¸º 90 å¤©ï¼Œåˆ°æœŸå oneinstack ä¼šè‡ªåŠ¨å¸®ä½ ç»­è´¹ï¼Œé…ç½®å®Œæ¯•ååœ¨é»˜è®¤æ–‡ä»¶å¤¹é‡Œæ·»åŠ é¡¹ç›®å°±å¯ä»¥è¾“å…¥ç½‘å€ä»¥ https çš„æ–¹å¼è®¿é—®</p>\n<h2>é‡åˆ°çš„é—®é¢˜</h2>\n<h3>æ— æ³•è®¿é—®å¸¦ç«¯å£åŸŸå</h3>\n<p>æˆ‘è‡ªå·±åˆ›å»ºäº†ä¸€ä¸ªäºŒçº§åŸŸå api.Ã—Ã—Ã—Ã— æ¥ä½œä¸ºæˆ‘ä¸€äº› api æ¥å£çš„æä¾›ç½‘å€ï¼Œç„¶åæƒ³ç”¨ oneinstack ä¸ºå…¶ä¸Š httpsï¼Œå‘æœåŠ¡å™¨ä¸­ä¸Šä¼  node æ–‡ä»¶ç”¨ pm2 è·‘èµ·æ¥åï¼Œæœ¬æ¥åœ¨æœ¬åœ° localhost:3000 å¯ä»¥è®¿é—®çš„æ–‡ä»¶ï¼Œåˆ°äº†æœåŠ¡å™¨åæ— æ³•é€šè¿‡ api.Ã—Ã—Ã—Ã—:3000 æ¥è®¿é—®ï¼Œæœ€å¼€å§‹æƒ³åˆ°äº†ç±»ä¼¼é˜¿é‡Œäº‘å®‰å…¨ç»„çš„é—®é¢˜ï¼Œç„¶åæˆ‘å»åå°çœ‹äº†ä¸‹æˆ‘çš„æœåŠ¡å™¨çš„å®‰å…¨ç»„ï¼Œå¹¶æ²¡æœ‰ç¦ç”¨ <code class=\"language-text\">3000</code> ç«¯å£ã€‚åæ¥è„‘å­é‡Œè‡ªå·±å†’å‡ºæ¥äº†ä¸€ä¸ªæƒ³æ³•ï¼Œç”¨ nginx åå‘ä»£ç†ï¼Œåœ¨è¿™é‡Œæˆ‘å°±ä¸å…·ä½“ç»™å‡ºåå‘ä»£ç†çš„ä»£ç äº†ï¼Œæ ¼å¼å¾ˆç®€å•ï¼Œå°±æ˜¯è®¿é—® api.Ã—Ã—Ã—Ã—/getApi ç›¸å½“äºè®¿é—® api.Ã—Ã—Ã—Ã—:3000/getApi ,ç„¶åç«Ÿç„¶å°±æˆåŠŸè®¿é—®åˆ°äº† ğŸ˜‘</p>\n<p>2018/9/10 è¡¥å……: oneinstack é»˜è®¤ç«¯å£éƒ½æ˜¯ä¸å¼€æ”¾çš„ï¼Œå› æ­¤æˆ‘æ„Ÿè§‰æ˜¯æœªå°† <code class=\"language-text\">3000</code> ç«¯å£å¼€æ”¾çš„åŸå› </p>\n<h3>å¼•ç”¨ api ç¢°åˆ°çš„è·¨åŸŸé—®é¢˜</h3>\n<p>ä¸»åŸŸåä¸‹çš„é¡¹ç›®å¼•ç”¨ api.Ã—Ã—Ã—Ã— ä¸‹çš„ api æ˜¯è¦è·¨åŸŸçš„ï¼Œè°·æ­Œæœç´¢åˆ°çš„è§£å†³æ–¹æ¡ˆåŸºæœ¬æ˜¯å¦‚ä¸‹ä»£ç </p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">app<span class=\"token punctuation\">.</span><span class=\"token function\">all</span><span class=\"token punctuation\">(</span><span class=\"token string\">'*'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res<span class=\"token punctuation\">,</span> next</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  res<span class=\"token punctuation\">.</span><span class=\"token function\">header</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Access-Control-Allow-Origin'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'*'</span><span class=\"token punctuation\">)</span>\n  res<span class=\"token punctuation\">.</span><span class=\"token function\">header</span><span class=\"token punctuation\">(</span>\n    <span class=\"token string\">'Access-Control-Allow-Headers'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'Content-Type,Content-Length, Authorization, Accept,X-Requested-With'</span>\n  <span class=\"token punctuation\">)</span>\n  res<span class=\"token punctuation\">.</span><span class=\"token function\">header</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Access-Control-Allow-Methods'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'PUT,POST,GET,DELETE,OPTIONS'</span><span class=\"token punctuation\">)</span>\n  res<span class=\"token punctuation\">.</span><span class=\"token function\">header</span><span class=\"token punctuation\">(</span><span class=\"token string\">'X-Powered-By'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">' 3.2.1'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>req<span class=\"token punctuation\">.</span>method <span class=\"token operator\">==</span> <span class=\"token string\">'OPTIONS'</span><span class=\"token punctuation\">)</span> res<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token number\">200</span><span class=\"token punctuation\">)</span>\n  <span class=\"token comment\">/*è®©optionsè¯·æ±‚å¿«é€Ÿè¿”å›*/</span> <span class=\"token keyword\">else</span> <span class=\"token function\">next</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>ä½†æ˜¯å¹¶æ²¡æœ‰è§£å†³æˆ‘çš„è·¨åŸŸé—®é¢˜ï¼Œæˆ‘æ˜¯åœ¨ nginx åå‘ä»£ç†æ—¶åŠ å…¥å¦‚ä¸‹ä»£ç å®ç°çš„</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">location / <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    add_header Access-Control-Allow-Origin *<span class=\"token punctuation\">;</span></span>\t<span class=\"token punctuation\">..</span>.\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3>https å¼•ç”¨ http ä¸‹çš„æ¥å£æŠ¥é”™</h3>\n<p>æˆ‘çš„ api.Ã—Ã—Ã—Ã— åŸŸååœ¨å¼€å§‹çš„æ—¶å€™ä¸Š https å¹¶æ²¡æœ‰æˆåŠŸï¼Œæˆ‘å°±ä½¿ç”¨çš„æ˜¯ http åè®®ï¼Œä½†æ˜¯è§£å†³äº†è·¨åŸŸé—®é¢˜ååˆæŠ¥é”™ï¼ŒæŠ¥é”™çš„å†…å®¹å¤§è‡´å°±æ˜¯ https ä¸‹æ— æ³•å¼•ç”¨ http ä¸­çš„æ¥å£ï¼Œæœ€åæˆ‘å…¶å®æ¢äº†ä¸€ä¸ªåŸŸååˆä¸Šäº† https â€¦ ğŸ¶</p>\n<h2>æœ€å</h2>\n<p>æœ€ååŸºæœ¬é¡¹ç›®éƒ½å·²éƒ¨ç½²åˆ°äº†æœåŠ¡å™¨ä¸Šï¼Œè®¿é—®é¡¹ç›®ä¹Ÿæœ‰è€€çœ¼çš„å°ç»¿æ ‡ï¼Œè¿˜æ˜¯ hin å¼€å¿ƒçš„ ğŸ˜ƒ</p>","frontmatter":{"title":"è®°ä¸€æ¬¡ oneinstack é…ç½®æœåŠ¡å™¨","date":"July 15, 2018"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/post-2018-07-15/","previous":{"fields":{"slug":"/post-2018-07-17/"},"frontmatter":{"title":"è®©æœåŠ¡å™¨å¸¦ç‚¹ç»¿","date":"2018-July-17"}},"next":{"fields":{"slug":"/post-2018-05-20/"},"frontmatter":{"title":"FlexDisplayRoom","date":"2018-May-20"}}}}}